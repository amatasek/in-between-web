{"version":3,"mappings":"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","names":["Howl","jsx","styles","jsxs","createContext","useContext","useState","useEffect","io","error","useCallback","lazy","Suspense","createPortal","Fragment","useRef","ReactDOM"],"ignoreList":[],"sources":["../../src/services/SoundService.js","../../src/components/common/LoadingScreen.jsx","../../src/config.js","../../src/contexts/SocketContext.jsx","../../src/contexts/AuthContext.jsx","../../src/contexts/LobbyContext.jsx","../../src/router.jsx","../../src/hooks/useVirtualKeyboard.js","../../src/components/common/BaseModal.jsx","../../src/components/VirtualKeyboard.jsx","../../src/contexts/VirtualKeyboardContext.jsx","../../src/components/Toast.jsx","../../src/contexts/ToastContext.jsx","../../src/App.jsx","../../src/contexts/PreferencesContext.jsx","../../src/contexts/UserDataContext.jsx","../../src/main.jsx"],"sourcesContent":["import { Howl } from 'howler';\n\n/**\n * Sound Service for managing game audio\n * Uses Howler.js for cross-browser audio playback\n */\nclass SoundService {\n  constructor() {\n    this.sounds = {};\n    this.muted = false; // Default state, will be updated from preferences\n    this.initialized = false;\n    this.categories = ['ui']; // Only load UI sounds for now\n    this.lastPlayedTime = {}; // Track when each sound was last played for debouncing\n    this.debounceTime = 500; // Debounce time in milliseconds (half a second)\n    this.audioUnlocked = false; // Track if audio has been unlocked for mobile\n    \n    // Get API URL from environment or use localhost as fallback\n    this.API_URL = import.meta.env.VITE_API_URL || 'http://localhost:3001';\n    \n    // Only initialize in browser environment\n    if (typeof window !== 'undefined') {\n      // Initialize on next tick to avoid SSR issues\n      setTimeout(() => {\n        this.initialize();\n        this._setupMobileAudioUnlock();\n      }, 0);\n    }\n  }\n\n  /**\n   * Initialize the sound service and load all sound categories\n   */\n  initialize() {\n    if (this.initialized) return;\n    \n    // Load only the UI category for now\n    this.loadCategory('ui');\n    \n    // Mark as initialized since we're loading asynchronously\n    this.initialized = true;\n  }\n  \n  /**\n   * Load sounds for a specific category\n   * @param {string} category - Sound category to load\n   */\n  loadCategory(category) {\n    // Skip if already loaded\n    if (this.sounds[category]) return;\n    \n    // Define sprites for each category\n    const sprites = {};\n    \n    // UI category sprites\n    if (category === 'ui') {\n      // Match the exact timing from ui-sounds.json\n      sprites.join = [0, 500]; \n      sprites.leave = [500, 1000];\n      sprites.alert = [1500, 1500]; \n    }\n    \n    // Create the Howl instance with the sprites\n    this.sounds[category] = new Howl({\n      src: [\n        `${this.API_URL}/assets/audio/${category}-sounds.mp3`,\n        `${this.API_URL}/assets/audio/${category}-sounds.webm`\n      ],\n      sprite: sprites,\n      preload: true,\n      // Use HTML5 Audio on mobile for better compatibility\n      html5: this._isMobileDevice(),\n      format: ['mp3', 'webm'],\n      pool: 10 // Increase the pool size to avoid exhaustion\n    });\n  }\n\n  /**\n   * Play a sound effect\n   * @param {string} sound - Sound name (format: category.name or just name for UI category)\n   * @param {number} [volume=1] - Volume level (0-1)\n   * @returns {number|undefined} Sound ID if played, undefined if not\n   */\n  play(sound, volume = 1) {\n    // Skip if muted\n    if (this.muted) return;\n    \n    // Initialize if not already done\n    if (!this.initialized) this.initialize();\n    \n    let category, soundName;\n    if (sound.includes('.')) {\n      [category, soundName] = sound.split('.');\n    } else {\n      category = 'ui';\n      soundName = sound;\n    }\n    \n    if (!this.sounds[category]) {\n      // Try to load the category if it's not loaded yet\n      this.loadCategory(category);\n      return;\n    }\n    \n    // Create a unique key for this sound\n    const soundKey = `${category}.${soundName}`;\n    \n    // Check if this sound was played recently (debounce)\n    const now = Date.now();\n    const lastPlayed = this.lastPlayedTime[soundKey] || 0;\n    if (now - lastPlayed < this.debounceTime) {\n      return;\n    }\n    \n    // Update the last played time\n    this.lastPlayedTime[soundKey] = now;\n    \n    // Set volume and play the sound\n    this.sounds[category].volume(volume);\n    return this.sounds[category].play(soundName);\n  }\n\n  /**\n   * Set muted state\n   * @param {boolean} muted - Whether sound should be muted\n   */\n  setMuted(muted) {\n    this.muted = muted;\n    \n    // Update all sound instances\n    Object.values(this.sounds).forEach(sound => {\n      if (sound && sound.mute) {\n        sound.mute(muted);\n      }\n    });\n  }\n  \n  /**\n   * Sync with user preferences\n   * @param {Object} preferences - User preferences object\n   */\n  syncWithPreferences(preferences) {\n    if (preferences && typeof preferences.muted !== 'undefined') {\n      this.setMuted(preferences.muted);\n    }\n  }\n  \n  /**\n   * Setup audio unlock for mobile devices\n   * @private\n   */\n  _setupMobileAudioUnlock() {\n    if (typeof window === 'undefined' || !this._isMobileDevice()) return;\n    \n    const unlockAudio = () => {\n      if (this.audioUnlocked) return;\n      \n      // Play a silent sound to unlock audio on mobile\n      const silence = new Audio();\n      silence.src = 'data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4LjI5LjEwMAAAAAAAAAAAAAAA//tQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAACAAABIgD///////////////////////////////////////////8AAAA8TEFNRTMuMTAwAQAAAAAAAAAAABSAJAJAQgAAgAAAAiIkfC3/////////////////////';  \n      silence.load();\n      silence.play().then(() => {\n        this.audioUnlocked = true;\n        document.body.removeEventListener('touchstart', unlockAudio);\n        document.body.removeEventListener('touchend', unlockAudio);\n        document.body.removeEventListener('click', unlockAudio);\n      }).catch(e => {\n        // Silent failure - we'll try again on next user interaction\n      });\n    };\n    \n    // Add event listeners to unlock audio on user interaction\n    document.body.addEventListener('touchstart', unlockAudio, false);\n    document.body.addEventListener('touchend', unlockAudio, false);\n    document.body.addEventListener('click', unlockAudio, false);\n  }\n  \n  /**\n   * Check if current device is mobile\n   * @private\n   * @returns {boolean} True if mobile device\n   */\n  _isMobileDevice() {\n    if (typeof navigator === 'undefined') return false;\n    \n    return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) ||\n      (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1); // iPad detection\n  }\n\n}\n\n// Create a singleton instance\nconst soundService = new SoundService();\n\nexport default soundService;\n","import React from 'react';\nimport styles from './LoadingScreen.module.css';\n\n/**\n * A reusable loading screen component\n * @param {Object} props\n * @param {string} props.message - The message to display while loading\n */\nexport const LoadingScreen = ({ message = 'Loading...' }) => {\n  return (\n    <div className={styles.loadingScreen}>\n      <div className={styles.loadingContainer}>\n        <div className={styles.spinner}></div>\n        <p className={styles.message}>{message}</p>\n      </div>\n    </div>\n  );\n};\n","// API and Socket configuration\nconst API_URL = import.meta.env.VITE_API_URL || 'http://localhost:3001';\nconst SOCKET_URL = import.meta.env.VITE_SOCKET_URL || 'http://localhost:3001';\n\nexport {\n  API_URL,\n  SOCKET_URL\n};\n","import React, { createContext, useState, useEffect, useContext } from 'react';\nimport { io } from 'socket.io-client';\nimport { SOCKET_URL } from '../config';\nimport { useAuth } from './AuthContext';\n\nconst SocketContext = createContext();\n\nexport const useSocket = () => useContext(SocketContext);\n\nexport const SocketProvider = ({ children }) => {\n  const { token } = useAuth();\n  const [socket, setSocket] = useState(null);\n  const [isConnected, setIsConnected] = useState(false);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    if (typeof window === 'undefined') {\n      return;\n    }\n    if (!token) {\n      if (socket) {\n        socket.disconnect();\n        setSocket(null);\n        setIsConnected(false);\n        setError(null);\n      }\n      return;\n    }\n\n    const newSocket = io(SOCKET_URL, {\n      auth: { token },\n      reconnection: true,\n      reconnectionAttempts: 5,\n      reconnectionDelay: 1000,\n      transports: ['websocket', 'polling'],\n      timeout: 10000\n    });\n\n    setSocket(newSocket);\n\n    newSocket.on('connect', () => {\n      setError(null);\n    });\n    \n    newSocket.on('authenticated', (userData) => {\n      newSocket.auth = {\n        userId: userData.userId,\n        username: userData.username\n      };\n      \n      setIsConnected(true);\n      \n      newSocket.emit('getGameList');\n    });\n\n    newSocket.on('connect_error', (error) => {\n      setError('Failed to connect to game server: ' + error.message);\n      setIsConnected(false);\n    });\n\n    newSocket.on('disconnect', () => {\n      setIsConnected(false);\n    });\n\n    newSocket.on('error', (err) => {\n      setError(err.message || 'Unknown socket error');\n    });\n\n    const socketEvents = [\n      'connect',\n      'authenticated',\n      'disconnect',\n      'connect_error',\n      'error',\n      'transport'\n    ];\n\n    return () => {\n      if (newSocket) {\n        socketEvents.forEach(event => newSocket.off(event));\n        newSocket.disconnect();\n        setSocket(null);\n        setIsConnected(false);\n        setError(null);\n      }\n    };\n\n  }, [token]);\n\n  const value = {\n    socket,\n    isConnected,\n    error,\n    setError\n  };\n\n  return (\n    <SocketContext.Provider value={value}>\n      {children}\n    </SocketContext.Provider>\n  );\n};\n","import React, { createContext, useState, useContext, useEffect, useCallback } from 'react';\nimport { useSocket } from './SocketContext.jsx';\nimport WelcomePopup from '../components/common/WelcomePopup';\nimport { API_URL } from '../config';\n\nconst AuthContext = createContext(null);\n\nexport const AuthProvider = ({ children }) => {\n  const [user, setUser] = useState(null);\n  const [token, setToken] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [showWelcomePopup, setShowWelcomePopup] = useState(false);\n  \n  // Get socket from socket context to listen for balance updates\n  const socketData = useSocket();\n  const socket = socketData?.socket;\n\n  // Listen for balance updates from the server\n  useEffect(() => {\n    if (socket && user) {\n      // Listen for balance updates\n      socket.on('balanceUpdated', (data) => { \n        console.log('[AuthContext] Received balanceUpdated event:', data); \n        if (data && typeof data.balance === 'number') {\n          console.log(`[AuthContext] Updating user balance from ${user?.balance} to ${data.balance}`); \n          // Update user with new balance\n          const updatedUser = {\n            ...user,\n            balance: data.balance\n          };\n          \n          // Update state\n          setUser(updatedUser);\n        } else {\n          console.warn('[AuthContext] Received invalid balance data:', data);\n        }\n      });\n      \n      // Clean up listener on unmount\n      return () => {\n        socket.off('balanceUpdated');\n      };\n    }\n  }, [socket, user]);\n\n  // Function to fetch user data from the /me endpoint\n  const fetchUserData = async (authToken) => {\n    try {\n      // Use the passed token directly\n      if (!authToken) {\n        return null;\n      }\n\n      const response = await fetch(`${API_URL}/auth/me`, {\n        method: 'GET',\n        headers: {\n          'Authorization': `Bearer ${authToken}`, // Use authToken\n          'Content-Type': 'application/json'\n        }\n      });\n      \n      if (!response.ok) {\n        throw new Error('Failed to fetch user data');\n      }\n      \n      const data = await response.json();\n      return data.user;\n    } catch (error) {\n      console.error('[Auth] Error fetching user data:', error);\n      return null;\n    }\n  };\n\n  // Single Effect for Initial Authentication Check\n  useEffect(() => {\n    const initializeAuth = async () => {\n      let currentToken = null;\n      try {\n        currentToken = localStorage.getItem('token');\n        \n        if (currentToken) {\n          setToken(currentToken); \n        }\n      } catch (error) {\n        console.error('[Auth] Error reading token from localStorage:', error);\n        localStorage.removeItem('token'); // Clear potentially corrupted token\n      }\n\n      // Now, decide whether to fetch user data based on the token found\n      if (currentToken) {\n        try {\n          const userData = await fetchUserData(currentToken); \n          if (userData) {\n            setUser(userData); \n          } else {\n            // Fetch failed or returned no data for a valid token\n            console.error('[Auth] Token valid but failed to fetch user data. Logging out.');\n            setUser(null);\n            setToken(null);\n            localStorage.removeItem('token');\n          }\n        } catch (error) {\n          console.error('[Auth] Error during user data fetch. Logging out.', error);\n          setUser(null);\n          setToken(null);\n          localStorage.removeItem('token');\n        } finally {\n          setLoading(false);\n        }\n      } else {\n        setUser(null);\n        setToken(null);\n        setLoading(false);\n      }\n    };\n\n    initializeAuth();\n  }, []); // Empty dependency array ensures it runs only once on mount\n\n  const login = async (userData, newToken) => {\n    if (!userData || !userData.username || !userData.id || typeof userData.balance !== 'number') {\n      console.error('[Auth] Invalid user data:', userData);\n      throw new Error('Invalid user data provided');\n    }\n\n    if (!newToken) {\n      console.error('[Auth] No token provided');\n      throw new Error('No authentication token provided');\n    }\n    \n    try {\n      // Set initial user data for immediate UI feedback\n      const initialUserData = {\n        username: userData.username,\n        id: userData.id,\n        balance: userData.balance\n      };\n      \n      // Store only the token in localStorage\n      setUser(initialUserData);\n      setToken(newToken);\n      localStorage.setItem('token', newToken);\n      \n      // Show welcome popup when user logs in\n      setShowWelcomePopup(true);\n      \n      // Fetch complete user data from /me endpoint\n      const completeUserData = await fetchUserData(newToken);\n      if (completeUserData) {\n        setUser(completeUserData);\n      }\n      \n    } catch (error) {\n      console.error('[Auth] Error during login:', error);\n      throw error;\n    }\n  };\n\n  const logout = useCallback(() => {\n    // Clear state\n    setUser(null);\n    setToken(null);\n    setShowWelcomePopup(false);\n    \n    // Clear localStorage\n    localStorage.removeItem('token');\n  }, []); // Empty dependency array means this function never changes\n\n  // Function to refresh user data from the /me endpoint\n  const refreshUserData = useCallback(async () => {\n    try {\n      // fetchUserData depends on the 'token' state variable\n      const userData = await fetchUserData(token);\n      if (userData) {\n        setUser(userData);\n      } else {\n        console.error('[Auth] Failed to refresh user data. Logging out.');\n        // logout is now stable thanks to useCallback above\n        logout();\n      }\n    } catch (error) { \n      console.error('[Auth] Error during manual refresh. Logging out.', error);\n      logout();\n    }\n  // Add dependencies: token and logout\n  }, [token, logout]);\n\n  if (loading) {\n    return null; // or a loading spinner\n  }\n  \n  const handleCloseWelcomePopup = () => {\n    setShowWelcomePopup(false);\n  };\n\n  return (\n    <AuthContext.Provider value={{ user, token, login, logout, refreshUserData, loading }}>\n      {children}\n      {/* {showWelcomePopup && user && (\n        <WelcomePopup \n          username={user.username} \n          balance={user.balance} \n          onClose={handleCloseWelcomePopup} \n        />\n      )} */}\n    </AuthContext.Provider>\n  );\n};\n\nexport const useAuth = () => {\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n};\n","import React, { createContext, useState, useEffect, useContext } from 'react';\nimport { useSocket } from './SocketContext';\n\nconst LobbyContext = createContext();\n\nexport const useLobby = () => useContext(LobbyContext);\n\nexport const LobbyProvider = ({ children }) => {\n  const { socket, isConnected } = useSocket();\n  \n  const [gameList, setGameList] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    if (!socket || !isConnected) return;\n    \n    const handleGameList = (games) => {\n      setGameList(games);\n      setLoading(false);\n    };\n    \n    const handleError = (err) => {\n      console.error('[LobbyContext] Socket error:', err.message || err);\n      setError(err.message || 'An error occurred');\n      setLoading(false);\n    };\n    \n    socket.on('gameList', handleGameList);\n    socket.on('error', handleError);\n    \n    socket.emit('getGameList');\n    \n    return () => {\n      socket.off('gameList', handleGameList);\n      socket.off('error', handleError);\n    };\n  }, [socket, isConnected]);\n  \n  const contextValue = {\n    gameList,\n    loading,\n    error,\n  };\n  \n  return (\n    <LobbyContext.Provider value={contextValue}>\n      {children}\n    </LobbyContext.Provider>\n  );\n};\n","import { lazy, Suspense } from 'react';\nimport { createBrowserRouter, Navigate } from 'react-router-dom';\nimport { LoadingScreen } from './components/common/LoadingScreen';\nimport { useAuth } from './contexts/AuthContext';\nimport { LobbyProvider } from './contexts/LobbyContext';\n\n// Lazy load routes for code splitting\nconst AuthPage = lazy(() => import('./components/auth/AuthPage'));\nconst Lobby = lazy(() => import('./components/Lobby'));\nconst GameRoom = lazy(() => import('./components/GameRoom'));\n\n// Auth protection wrapper component\nconst ProtectedRoute = ({ children }) => {\n  const { user, loading } = useAuth();\n  \n  if (loading) {\n    return <LoadingScreen message=\"Checking authentication...\" />;\n  }\n  \n  if (!user) {\n    return <Navigate to=\"/auth\" replace />;\n  }\n  \n  return children;\n};\n\n// Define the router configuration\nexport const router = createBrowserRouter([\n  {\n    path: '/',\n    element: (\n      <ProtectedRoute>\n        <LobbyProvider>\n          <Suspense fallback={<LoadingScreen message=\"Loading...\" />}>\n            <Lobby />\n          </Suspense>\n        </LobbyProvider>\n      </ProtectedRoute>\n    ),\n  },\n  {\n    path: '/auth',\n    element: (\n      <Suspense fallback={<LoadingScreen message=\"Loading...\" />}>\n        <AuthPage />\n      </Suspense>\n    ),\n  },\n  {\n    path: '/:gameId',\n    element: (\n      <ProtectedRoute>\n        <Suspense fallback={<LoadingScreen message=\"Loading...\" />}>\n          <GameRoom />\n        </Suspense>\n      </ProtectedRoute>\n    ),\n  },\n  {\n    path: '*',\n    element: <Navigate to=\"/\" replace />,\n  },\n]);","import { useState, useCallback, useEffect } from 'react';\n\n/**\n * Hook to manage virtual keyboard state and integration with input elements\n * Automatically detects gamepad usage and shows virtual keyboard for controller users\n */\nexport const useVirtualKeyboard = () => {\n  const [isVisible, setIsVisible] = useState(false);\n  const [currentInput, setCurrentInput] = useState(null);\n  const [inputType, setInputType] = useState('text');\n  const [keyboardTitle, setKeyboardTitle] = useState('');\n  const [isGamepadActive, setIsGamepadActive] = useState(false);\n\n  // Detect if gamepad navigation is active (integrate with existing system)\n  useEffect(() => {\n    const checkGamepadNavigation = () => {\n      const connected = document.body.classList.contains('gamepad-navigation-active');\n      setIsGamepadActive(connected);\n    };\n    \n    // Check initially\n    checkGamepadNavigation();\n    \n    // Create observer to watch for gamepad navigation class changes\n    const observer = new MutationObserver(checkGamepadNavigation);\n    observer.observe(document.body, {\n      attributes: true,\n      attributeFilter: ['class']\n    });\n    \n    return () => observer.disconnect();\n  }, []);\n\n  const showKeyboard = useCallback((inputElement, type = 'text', title = '') => {\n    if (!inputElement) return;\n    \n    setCurrentInput(inputElement);\n    setInputType(type);\n    setKeyboardTitle(title);\n    setIsVisible(true);\n    \n    // Blur the input to prevent mobile keyboard from appearing\n    inputElement.blur();\n  }, []);\n\n  const hideKeyboard = useCallback(() => {\n    setIsVisible(false);\n    setCurrentInput(null);\n    setInputType('text');\n    setKeyboardTitle('');\n  }, []);\n\n\n  const handleEnter = useCallback((finalValue) => {\n    if (!currentInput) return;\n    \n    // For React/MUI compatibility, we need to set the value and trigger events in a specific way\n    const nativeInputValueSetter = Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype, 'value').set;\n    nativeInputValueSetter.call(currentInput, finalValue || '');\n    \n    // Create and dispatch input event that React will recognize\n    const inputEvent = new Event('input', { bubbles: true });\n    currentInput.dispatchEvent(inputEvent);\n    \n    // Also dispatch change event\n    const changeEvent = new Event('change', { bubbles: true });\n    currentInput.dispatchEvent(changeEvent);\n    \n    // Just close the keyboard - don't submit forms or trigger enter behavior\n    hideKeyboard();\n  }, [currentInput, hideKeyboard]);\n\n  // Enhanced input wrapper that automatically shows keyboard for gamepad users\n  const enhanceInput = useCallback((inputElement, type = 'text', title = '') => {\n    if (!inputElement) return;\n    \n    // For Material-UI TextField, find the actual input element\n    let actualInput = inputElement;\n    if (inputElement.querySelector && inputElement.querySelector('input')) {\n      actualInput = inputElement.querySelector('input');\n    }\n    \n    const handleClick = (e) => {\n      // Show virtual keyboard on click if gamepad is connected\n      // AND if the gamepad navigation is currently active (showing focus indicators)\n      // This prevents autoFocus from opening the keyboard\n      if (isGamepadActive && document.body.classList.contains('gamepad-navigation-active')) {\n        e.preventDefault();\n        showKeyboard(actualInput, type, title);\n      }\n    };\n    \n    // Add event listeners to the actual input element\n    actualInput.addEventListener('click', handleClick);\n    \n    // Return cleanup function\n    return () => {\n      actualInput.removeEventListener('click', handleClick);\n    };\n  }, [isGamepadActive, showKeyboard]);\n\n  // Get current input value for initializing the virtual keyboard\n  const getCurrentInputValue = useCallback(() => {\n    return currentInput?.value || '';\n  }, [currentInput]);\n\n  return {\n    isVisible,\n    inputType,\n    keyboardTitle,\n    currentInput,\n    isGamepadActive,\n    showKeyboard,\n    hideKeyboard,\n    handleEnter,\n    enhanceInput,\n    getCurrentInputValue\n  };\n};","import React, { useEffect } from 'react';\nimport { createPortal } from 'react-dom';\nimport styles from './BaseModal.module.css';\n\n// Track number of open modals globally\nlet openModalCount = 0;\n\n// BaseModal: Shared modal structure for all app modals\nexport default function BaseModal({ title, onClose, children, footer, headerButtons, className = '', overlayStyle, ...props }) {\n  // Prevent body scroll when modal is open\n  useEffect(() => {\n    if (++openModalCount === 1) document.body.classList.add('modal-open');\n    return () => { if (--openModalCount === 0) document.body.classList.remove('modal-open'); };\n  }, []);\n  \n  const modalContent = (\n    <div className={styles.overlay} style={overlayStyle} onClick={onClose}>\n      <div\n        className={`${styles.modal} ${className}`}\n        onClick={e => e.stopPropagation()}\n        {...props}\n      >\n        {title && (\n          <div className={styles.header}>\n            <h2>{title}</h2>\n            <div style={{ display: 'flex', gap: '0.5rem', alignItems: 'center' }}>\n              {headerButtons}\n              <button\n                className={styles.closeButton}\n                onClick={onClose}\n                aria-label=\"Close\"\n                type=\"button\"\n                data-gamepad-focusable=\"true\"\n              >\n                ×\n              </button>\n            </div>\n          </div>\n        )}\n        <div className={styles.content}>{children}</div>\n        {footer && <div className={styles.footer}>{footer}</div>}\n      </div>\n    </div>\n  );\n\n  // Render modal using portal to document.body to avoid transform context issues\n  return createPortal(modalContent, document.body);\n}","import React, { useState, useEffect, useCallback } from 'react';\nimport BaseModal from './common/BaseModal';\nimport { useVirtualKeyboardContext } from '../contexts/VirtualKeyboardContext';\nimport styles from './VirtualKeyboard.module.css';\n\nconst VirtualKeyboard = ({ \n  isVisible, \n  onClose, \n  onEnter,\n  inputType = 'text',\n  initialValue = ''\n}) => {\n  const { keyboardTitle } = useVirtualKeyboardContext();\n  const [currentLayout, setCurrentLayout] = useState('lowercase');\n  const [tempInput, setTempInput] = useState('');\n\n  // Initialize temp input with current value when keyboard opens\n  useEffect(() => {\n    if (isVisible) {\n      // For number inputs, don't use initial value if it's \"0\"\n      if (inputType === 'number') {\n        setTempInput(initialValue && initialValue !== '0' ? initialValue : '');\n      } else {\n        setTempInput(initialValue || '');\n      }\n    } else {\n      setTempInput('');\n    }\n  }, [isVisible, initialValue, inputType]);\n  \n  // Define keyboard layouts\n  const layouts = {\n    lowercase: [\n      ['1', '2', '3', '4', '5', '6', '7', '8', '9', '0'],\n      ['q', 'w', 'e', 'r', 't', 'y', 'u', 'i', 'o', 'p'],\n      ['a', 's', 'd', 'f', 'g', 'h', 'j', 'k', 'l'],\n      ['shift', 'z', 'x', 'c', 'v', 'b', 'n', 'm', 'backspace'],\n      ['space', 'enter']\n    ],\n    uppercase: [\n      ['1', '2', '3', '4', '5', '6', '7', '8', '9', '0'],\n      ['Q', 'W', 'E', 'R', 'T', 'Y', 'U', 'I', 'O', 'P'],\n      ['A', 'S', 'D', 'F', 'G', 'H', 'J', 'K', 'L'],\n      ['shift', 'Z', 'X', 'C', 'V', 'B', 'N', 'M', 'backspace'],\n      ['space', 'enter']\n    ],\n    numbers: [\n      ['1', '2', '3'],\n      ['4', '5', '6'],\n      ['7', '8', '9'],\n      ['0', 'backspace'],\n      ['enter']\n    ]\n  };\n\n  // Use number layout for number inputs\n  const activeLayout = inputType === 'number' ? 'numbers' : currentLayout;\n  const keys = layouts[activeLayout];\n\n  const handleKeyPress = useCallback((key) => {\n    switch (key) {\n      case 'shift':\n        setCurrentLayout(prev => prev === 'lowercase' ? 'uppercase' : 'lowercase');\n        break;\n      case 'backspace':\n        setTempInput(prev => prev.slice(0, -1));\n        break;\n      case 'enter':\n        onEnter?.(tempInput);\n        break;\n      case 'space':\n        setTempInput(prev => prev + ' ');\n        break;\n      default:\n        setTempInput(prev => prev + key);\n        break;\n    }\n  }, [onEnter, tempInput]);\n\n  const getKeyDisplayText = (key) => {\n    switch (key) {\n      case 'shift':\n        return currentLayout === 'lowercase' ? '⇧' : '⇧';\n      case 'backspace':\n        return '⌫';\n      case 'space':\n        return 'Space';\n      case 'enter':\n        return '↵';\n      default:\n        return key;\n    }\n  };\n\n  const getKeyClass = (key) => {\n    let className = styles.key;\n    \n    if (['shift', 'backspace', 'space', 'enter'].includes(key)) {\n      className += ` ${styles.specialKey}`;\n    }\n    \n    if (key === 'space') {\n      className += ` ${styles.spaceKey}`;\n    }\n    \n    if (key === 'shift' && currentLayout === 'uppercase') {\n      className += ` ${styles.activeShift}`;\n    }\n    \n    return className;\n  };\n\n  // Handle ESC key to close keyboard (BaseModal handles body scroll)\n  useEffect(() => {\n    if (isVisible) {\n      const handleKeyDown = (e) => {\n        if (e.key === 'Escape') {\n          e.preventDefault();\n          onClose?.();\n        }\n      };\n      \n      document.addEventListener('keydown', handleKeyDown);\n      return () => {\n        document.removeEventListener('keydown', handleKeyDown);\n      };\n    }\n  }, [isVisible, onClose]);\n\n  if (!isVisible) return null;\n\n  return (\n    <BaseModal\n      title={keyboardTitle || (inputType === 'number' ? 'Number Pad' : 'Virtual Keyboard')}\n      onClose={onClose}\n      className={styles.keyboardModal}\n      overlayStyle={{ zIndex: 1300 }}\n    >\n      <div className={styles.inputDisplay}>\n        <input\n          type={inputType === 'password' ? 'password' : 'text'}\n          value={tempInput}\n          className={styles.tempInput}\n          readOnly\n          placeholder=\"Type below...\"\n        />\n      </div>\n      <div className={styles.keyboardGrid}>\n        {keys.map((row, rowIndex) => (\n          <div key={rowIndex} className={styles.keyRow}>\n            {row.map((key, keyIndex) => (\n              <button\n                key={`${rowIndex}-${keyIndex}`}\n                className={getKeyClass(key)}\n                onClick={() => handleKeyPress(key)}\n                data-gamepad-focusable=\"true\"\n                aria-label={key === 'backspace' ? 'Backspace' : \n                           key === 'enter' ? 'Enter' : \n                           key === 'space' ? 'Space' : \n                           key === 'shift' ? 'Shift' : key}\n              >\n                {getKeyDisplayText(key)}\n              </button>\n            ))}\n          </div>\n        ))}\n      </div>\n    </BaseModal>\n  );\n};\n\nexport default VirtualKeyboard;","import React, { createContext, useContext } from 'react';\nimport { useVirtualKeyboard } from '../hooks/useVirtualKeyboard';\nimport VirtualKeyboard from '../components/VirtualKeyboard';\n\nconst VirtualKeyboardContext = createContext();\n\nexport const useVirtualKeyboardContext = () => {\n  const context = useContext(VirtualKeyboardContext);\n  if (!context) {\n    throw new Error('useVirtualKeyboardContext must be used within a VirtualKeyboardProvider');\n  }\n  return context;\n};\n\nexport const VirtualKeyboardProvider = ({ children }) => {\n  const keyboardState = useVirtualKeyboard();\n  const { isVisible, inputType, hideKeyboard, handleEnter, getCurrentInputValue } = keyboardState;\n\n  return (\n    <VirtualKeyboardContext.Provider value={keyboardState}>\n      {children}\n      {isVisible && (\n        <VirtualKeyboard\n          isVisible={isVisible}\n          inputType={inputType}\n          initialValue={getCurrentInputValue()}\n          onClose={hideKeyboard}\n          onEnter={handleEnter}\n        />\n      )}\n    </VirtualKeyboardContext.Provider>\n  );\n};","import React, { useEffect, useState } from 'react';\nimport styles from './styles/Toast.module.css';\n\nconst Toast = ({ \n  title, \n  message, \n  emoji = 'ℹ', \n  color = '#3498db', \n  duration = 4000, \n  onClose, \n  position \n}) => {\n  const [isVisible, setIsVisible] = useState(true);\n\n  useEffect(() => {\n    if (duration > 0) {\n      const timer = setTimeout(() => {\n        setIsVisible(false);\n        // Wait for fade animation to complete before removing\n        setTimeout(onClose, 300);\n      }, duration);\n      \n      return () => clearTimeout(timer);\n    }\n  }, [duration, onClose]);\n\n  // Determine if this is an emoji reaction (no title and emoji is not default)\n  const isEmojiReaction = !title && emoji !== 'ℹ';\n\n  return (\n    <div \n      className={`${styles.toast} ${isEmojiReaction && isVisible ? styles.emojiReaction : ''} ${!isVisible ? styles.slideOut : ''}`}\n      style={{ \n        top: '20px', \n        zIndex: 10000 + position,\n        borderColor: color,\n        background: `linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%)`\n      }}\n    >\n      <div \n        className={styles.iconWrapper}\n      >\n        <span \n          className={`${styles.icon} ${isEmojiReaction ? styles.emojiIcon : ''}`} \n          style={{ \n            color: color,\n            textShadow: isEmojiReaction \n              ? `0 0 20px ${color}, 0 0 40px ${color}60` \n              : `0 0 8px ${color}80`\n          }}\n        >\n          {emoji}\n        </span>\n      </div>\n      <div className={styles.content}>\n        {title && <div className={styles.title}>{title}</div>}\n        <div className={`${styles.message} ${isEmojiReaction ? styles.emojiMessage : ''}`}>\n          {isEmojiReaction ? (\n            <>\n              <span className={styles.playerName}>{message}</span>\n              <span className={styles.reactionText}>reacted!</span>\n            </>\n          ) : (\n            message\n          )}\n        </div>\n      </div>\n      <button \n        className={styles.closeButton} \n        onClick={onClose}\n        aria-label=\"Close notification\"\n      >\n        ×\n      </button>\n    </div>\n  );\n};\n\nexport default Toast;","import React, { createContext, useContext, useState, useCallback, useEffect } from 'react';\nimport { useSocket } from './SocketContext';\nimport Toast from '../components/Toast';\n\nconst ToastContext = createContext();\n\nexport const useToast = () => {\n  const context = useContext(ToastContext);\n  if (!context) {\n    throw new Error('useToast must be used within a ToastProvider');\n  }\n  return context;\n};\n\nexport const ToastProvider = ({ children }) => {\n  const [toasts, setToasts] = useState([]);\n  const [toastQueue, setToastQueue] = useState([]);\n  const [lastToastTime, setLastToastTime] = useState(0);\n  const { socket } = useSocket();\n\n  const addToast = useCallback((title, message, emoji = 'ℹ', color = '#3498db', duration = 4000) => {\n    const id = Date.now() + Math.random();\n    const newToast = { id, title, message, emoji, color, duration };\n    \n    const now = Date.now();\n    const timeSinceLastToast = now - lastToastTime;\n    \n    if (timeSinceLastToast >= 600) {\n      // Show immediately if enough time has passed\n      setToasts(prev => [...prev, newToast]);\n      setLastToastTime(now);\n    } else {\n      // Queue the toast for later\n      setToastQueue(prev => [...prev, newToast]);\n    }\n    \n    return id;\n  }, [lastToastTime]);\n\n  const removeToast = useCallback((id) => {\n    setToasts(prev => prev.filter(toast => toast.id !== id));\n  }, []);\n\n  // Convenience methods for common notification patterns\n  const showSuccess = useCallback((title, message, duration) => {\n    return addToast(title, message, '✓', '#27ae60', duration);\n  }, [addToast]);\n\n  const showError = useCallback((title, message, duration) => {\n    return addToast(title, message, '✕', '#e74c3c', duration);\n  }, [addToast]);\n\n  const showWarning = useCallback((title, message, duration) => {\n    return addToast(title, message, '⚠', '#f39c12', duration);\n  }, [addToast]);\n\n  const showInfo = useCallback((title, message, duration) => {\n    return addToast(title, message, 'ℹ', '#3498db', duration);\n  }, [addToast]);\n\n  const showGameEvent = useCallback((title, message, duration) => {\n    return addToast(title, message, '🎮', '#9b59b6', duration);\n  }, [addToast]);\n\n  const showMoneyEvent = useCallback((title, message, duration) => {\n    return addToast(title, message, '💰', '#16a085', duration);\n  }, [addToast]);\n\n  // Process queued toasts with debouncing\n  useEffect(() => {\n    if (toastQueue.length === 0) return;\n\n    const timer = setTimeout(() => {\n      const nextToast = toastQueue[0];\n      setToastQueue(prev => prev.slice(1));\n      setToasts(prev => [...prev, nextToast]);\n      setLastToastTime(Date.now());\n    }, 600);\n\n    return () => clearTimeout(timer);\n  }, [toastQueue, toasts]); // Trigger when queue changes or when toasts change\n\n  // Socket event listeners for toast notifications\n  useEffect(() => {\n    if (!socket) return;\n\n    // Generic toast handler\n    const handleToast = (data) => {\n      addToast(data.title || '', data.message, data.emoji || 'ℹ', data.color || '#3498db', data.duration);\n    };\n\n    // Register socket event listener\n    socket.on('toast', handleToast);\n\n    // Cleanup\n    return () => {\n      socket.off('toast', handleToast);\n    };\n  }, [socket, addToast]);\n\n  const value = {\n    addToast,\n    removeToast,\n    showSuccess,\n    showError,\n    showWarning,\n    showInfo,\n    showGameEvent,\n    showMoneyEvent,\n    toasts\n  };\n\n  return (\n    <ToastContext.Provider value={value}>\n      {children}\n      <div className=\"toast-container\" style={{ position: 'fixed', top: 0, right: 0, zIndex: 10000 }}>\n        {toasts.map((toast, index) => (\n          <Toast\n            key={toast.id}\n            title={toast.title}\n            message={toast.message}\n            emoji={toast.emoji}\n            color={toast.color}\n            duration={toast.duration}\n            position={index}\n            onClose={() => removeToast(toast.id)}\n          />\n        ))}\n      </div>\n    </ToastContext.Provider>\n  );\n};","import React, { useEffect } from 'react';\nimport { RouterProvider } from 'react-router-dom';\nimport soundService from './services/SoundService';\nimport { router } from './router';\nimport { VirtualKeyboardProvider } from './contexts/VirtualKeyboardContext';\nimport { ToastProvider } from './contexts/ToastContext';\nimport './styles/global.css';\n\nfunction App() {\n  // Initialize Sound Service\n  useEffect(() => {\n    soundService.initialize();\n  }, []);\n\n  return (\n    <ToastProvider>\n      <VirtualKeyboardProvider>\n        <RouterProvider router={router} />\n      </VirtualKeyboardProvider>\n    </ToastProvider>\n  );\n}\n\nexport default App;\n","import React, { createContext, useState, useContext, useEffect } from 'react';\nimport { useAuth } from './AuthContext.jsx';\nimport soundService from '../services/SoundService';\n\nconst PreferencesContext = createContext(null);\n\n// Helper function to format image URLs consistently across the application\nconst formatImageUrl = (url) => {\n  if (!url) return null;\n  \n  // Get API URL from environment or use localhost as fallback\n  const API_URL = import.meta.env.VITE_API_URL || 'http://localhost:3001';\n  \n  // If the URL already starts with http, use it as is\n  if (url.startsWith('http')) {\n    return url;\n  } \n  // If the URL is a relative path starting with /files/, use it as is with API_URL\n  else if (url.startsWith('/files/')) {\n    return `${API_URL}${url}`;\n  }\n  // If the URL contains /uploads/, replace it with /files/\n  else if (url.includes('/uploads/')) {\n    // Extract the type and filename from the path\n    const parts = url.split('/');\n    const filename = parts.pop();\n    const type = parts[parts.length - 1]; // images, audio, etc.\n    return `${API_URL}/files/${type}/${filename}`;\n  }\n  // Otherwise, just append the URL to the API_URL\n  else {\n    return `${API_URL}${url}`;\n  }\n};\n\n// Helper function to format preferences data with proper image URLs\nconst formatPreferencesData = (data) => {\n  if (!data) return {};\n  \n  return {\n    ...data,\n    profileImg: formatImageUrl(data.profileImg),\n    twoSecondPotGif: formatImageUrl(data.twoSecondPotGif),\n    twoSecondPotMp3: data.twoSecondPotMp3 // Audio files don't need the same formatting\n  };\n};\n\nexport const PreferencesProvider = ({ children }) => {\n  const [preferences, setPreferences] = useState({\n    profileImg: null,\n    autoAnte: false,\n    muted: false,\n    twoSecondPotGif: null,\n    twoSecondPotMp3: null,\n    selectedTitle: null\n  });\n  const [loading, setLoading] = useState(true);\n  const { user } = useAuth();\n  \n  // Define loadPreferences function with useCallback to handle dependencies properly\n  const loadPreferences = React.useCallback(async () => {\n    if (!user) {\n      setPreferences({ autoAnte: false });\n      setLoading(false);\n      return;\n    }\n    \n      \n    try {\n      setLoading(true);\n      // Get API URL from environment or use localhost as fallback\n      const API_URL = import.meta.env.VITE_API_URL || 'http://localhost:3001';\n      const token = localStorage.getItem('token');\n      \n      if (!token) {\n        console.error('[Preferences] No token available');\n        setLoading(false);\n        return;\n      }\n      \n      const response = await fetch(`${API_URL}/preferences`, {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${token}`\n        }\n      });\n      \n      if (!response.ok) {\n        throw new Error('Failed to load preferences');\n      }\n      \n      const data = await response.json();\n      \n      // Format preferences data with proper image URLs\n      const formattedData = formatPreferencesData(data);\n      \n      const finalPreferences = formattedData || { autoAnte: false, muted: false };\n      setPreferences(finalPreferences);\n      \n      // Sync sound service with loaded preferences\n      if (typeof finalPreferences.muted !== 'undefined') {\n        soundService.setMuted(finalPreferences.muted);\n      }\n    } catch (error) {\n      console.error('[Preferences] Error loading preferences:', error);\n      // Set default preferences on error\n      setPreferences({ autoAnte: false });\n    } finally {\n      setLoading(false);\n    }\n  }, [user]);\n  \n  // Load preferences from the server when the user changes or component mounts\n  useEffect(() => {\n    if (user) {\n      loadPreferences();\n    }\n  }, [user, loadPreferences]);\n  \n  // Update a preference\n  const updatePreference = async (key, value) => {\n    if (!user) {\n      console.error('[Preferences] Cannot update preferences: User not logged in');\n      return false;\n    }\n    \n    try {\n      // Get API URL from environment or use localhost as fallback\n      const API_URL = import.meta.env.VITE_API_URL || 'http://localhost:3001';\n      const token = localStorage.getItem('token');\n      \n      if (!token) {\n        console.error('[Preferences] No token available');\n        return false;\n      }\n      \n      // Optimistically update the UI\n      setPreferences(prev => ({\n        ...prev,\n        [key]: value\n      }));\n      \n      // If updating the muted preference, sync with sound service\n      if (key === 'muted') {\n        soundService.setMuted(value);\n      }\n      \n      // Send the update to the server\n      const response = await fetch(`${API_URL}/preferences/${key}`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${token}`\n        },\n        body: JSON.stringify({ value })\n      });\n      \n      if (!response.ok) {\n        throw new Error(`Failed to update ${key} preference`);\n      }\n      \n      const data = await response.json();\n      \n      // Format preferences data with proper image URLs\n      const formattedData = formatPreferencesData(data);\n      \n      // Update with the formatted server response (in case there were any changes)\n      setPreferences(formattedData);\n      return true;\n    } catch (error) {\n      console.error(`[Preferences] Error updating ${key}:`, error);\n      \n      // Revert the optimistic update on error\n      await loadPreferences();\n      return false;\n    }\n  };\n  \n  // Toggle auto-ante preference\n  const toggleAutoAnte = async () => {\n    const newValue = !preferences.autoAnte;\n    return await updatePreference('autoAnte', newValue);\n  };\n\n  // Toggle mute preference\n  const toggleMute = async () => {\n    const newValue = !preferences.muted;\n    return await updatePreference('muted', newValue);\n  };\n\n  // Update selected title (expects title string, not ID)\n  const updateSelectedTitle = async (titleString) => {\n    return await updatePreference('selectedTitle', titleString);\n  };\n\n  // Upload file for two-second-pot-gif preference\n  const uploadTwoSecondPotGif = async (file) => {\n    if (!file) {\n      console.error('[Preferences] No file provided for GIF upload');\n      return false;\n    }\n    \n    \n    try {\n      const formData = new FormData();\n      formData.append('file', file);\n      \n      // Get API URL from environment or use localhost as fallback\n      const API_URL = import.meta.env.VITE_API_URL || 'http://localhost:3001';\n      const token = localStorage.getItem('token');\n      \n      if (!token) {\n        console.error('[Preferences] No token available');\n        return false;\n      }\n      \n      \n      const response = await fetch(`${API_URL}/preferences/twoSecondPotGif`, {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${token}`\n        },\n        body: formData\n      });\n      \n      const responseText = await response.text();\n      \n      if (!response.ok) {\n        throw new Error(`Failed to upload GIF file: ${responseText}`);\n      }\n      \n      // Parse the response text as JSON\n      const data = responseText ? JSON.parse(responseText) : {};\n      \n      // Format the file URL for consistency\n      const formattedUrl = formatImageUrl(data.fileUrl);\n      \n      // Update preferences with the formatted file URL\n      setPreferences(prev => ({\n        ...prev,\n        twoSecondPotGif: formattedUrl\n      }));\n      \n      return true;\n    } catch (error) {\n      console.error('[Preferences] Error uploading GIF:', error);\n      return false;\n    }\n  };\n\n  // Upload file for two-second-pot-mp3 preference\n  const uploadTwoSecondPotMp3 = async (file) => {\n    if (!file) {\n      console.error('[Preferences] No file provided for MP3 upload');\n      return false;\n    }\n    \n    \n    try {\n      const formData = new FormData();\n      formData.append('file', file);\n      \n      // Get API URL from environment or use localhost as fallback\n      const API_URL = import.meta.env.VITE_API_URL || 'http://localhost:3001';\n      const token = localStorage.getItem('token');\n      \n      if (!token) {\n        console.error('[Preferences] No token available');\n        return false;\n      }\n      \n      \n      const response = await fetch(`${API_URL}/preferences/twoSecondPotMp3`, {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${token}`\n        },\n        body: formData\n      });\n      \n      const responseText = await response.text();\n      \n      if (!response.ok) {\n        throw new Error(`Failed to upload MP3 file: ${responseText}`);\n      }\n      \n      // Parse the response text as JSON\n      const data = responseText ? JSON.parse(responseText) : {};\n      \n      // Update preferences with the file URL\n      setPreferences(prev => ({\n        ...prev,\n        twoSecondPotMp3: data.fileUrl\n      }));\n      \n      return true;\n    } catch (error) {\n      console.error('[Preferences] Error uploading MP3:', error);\n      return false;\n    }\n  };\n  \n  // Upload file for profile image preference\n  const uploadProfileImg = async (file) => {\n    if (!file) {\n      console.error('[Preferences] No file provided for profile image upload');\n      return false;\n    }\n    \n    \n    try {\n      const formData = new FormData();\n      formData.append('file', file);\n      \n      // Get API URL from environment or use localhost as fallback\n      const API_URL = import.meta.env.VITE_API_URL || 'http://localhost:3001';\n      const token = localStorage.getItem('token');\n      \n      if (!token) {\n        console.error('[Preferences] No token available');\n        return false;\n      }\n      \n      \n      const response = await fetch(`${API_URL}/preferences/profileImg`, {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${token}`\n        },\n        body: formData\n      });\n      \n      const responseText = await response.text();\n      \n      if (!response.ok) {\n        throw new Error(`Failed to upload profile image: ${responseText}`);\n      }\n      \n      // Parse the response text as JSON\n      const data = responseText ? JSON.parse(responseText) : {};\n      \n      // Format the file URL for consistency\n      const formattedUrl = formatImageUrl(data.fileUrl);\n      \n      // Update preferences with the formatted file URL\n      setPreferences(prev => ({\n        ...prev,\n        profileImg: formattedUrl\n      }));\n      \n      return true;\n    } catch (error) {\n      console.error('[Preferences] Error uploading profile image:', error);\n      return false;\n    }\n  };\n  \n  // No test upload function needed\n  \n  return (\n    <PreferencesContext.Provider \n      value={{ \n        preferences, \n        updatePreference, \n        toggleAutoAnte,\n        toggleMute,\n        updateSelectedTitle,\n        uploadTwoSecondPotGif,\n        uploadTwoSecondPotMp3,\n        uploadProfileImg,\n        loading \n      }}\n    >\n      {children}\n    </PreferencesContext.Provider>\n  );\n};\n\nexport const usePreferences = () => {\n  const context = useContext(PreferencesContext);\n  if (!context) {\n    throw new Error('usePreferences must be used within a PreferencesProvider');\n  }\n  return context;\n};\n","import React, { createContext, useContext, useState, useEffect, useCallback, useRef } from 'react';\nimport { useSocket } from './SocketContext';\nimport { useAuth } from './AuthContext';\nimport { API_URL } from '../config';\n\nconst UserDataContext = createContext(null);\n\nexport const UserDataProvider = ({ children }) => {\n  const { socket } = useSocket();\n  const { token } = useAuth();\n  const [userCache, setUserCache] = useState(new Map());\n  const pendingFetches = useRef(new Set());\n  const fetchTimer = useRef(null);\n\n  // Subscribe to user data updates via socket\n  useEffect(() => {\n    if (!socket) return;\n\n    const handleUserDataUpdate = ({ userId, data }) => {\n      console.log('[UserDataContext] Received user data update:', userId, data);\n      setUserCache(prev => {\n        const newCache = new Map(prev);\n        newCache.set(userId, data);\n        return newCache;\n      });\n    };\n\n    socket.on('userDataUpdated', handleUserDataUpdate);\n    return () => {\n      socket.off('userDataUpdated', handleUserDataUpdate);\n    };\n  }, [socket]);\n\n  // Clean up timer on unmount\n  useEffect(() => {\n    return () => {\n      if (fetchTimer.current) {\n        clearTimeout(fetchTimer.current);\n      }\n    };\n  }, []);\n\n  const fetchUsersData = useCallback(async (userIds) => {\n    if (!userIds || userIds.length === 0 || !token) return {};\n\n    try {\n      const response = await fetch(`${API_URL}/users`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${token}`\n        },\n        body: JSON.stringify({ userIds })\n      });\n      \n      if (!response.ok) {\n        throw new Error('Failed to fetch users data');\n      }\n      \n      const userData = await response.json();\n      \n      setUserCache(prev => {\n        const newCache = new Map(prev);\n        Object.entries(userData).forEach(([userId, data]) => {\n          newCache.set(userId, data);\n        });\n        return newCache;\n      });\n      \n      return userData;\n    } catch (error) {\n      return {};\n    }\n  }, [token]);\n\n  const executeBatchFetch = useCallback(() => {\n    if (pendingFetches.current.size === 0) return;\n    \n    const userIds = Array.from(pendingFetches.current);\n    pendingFetches.current.clear();\n    \n    fetchUsersData(userIds);\n  }, [fetchUsersData]);\n\n  const getUserData = useCallback((userId) => {\n    if (!userId) return null;\n    \n    const cached = userCache.get(userId);\n    if (cached) return cached;\n    \n    // Add to pending fetches and debounce\n    pendingFetches.current.add(userId);\n    \n    if (fetchTimer.current) {\n      clearTimeout(fetchTimer.current);\n    }\n    \n    fetchTimer.current = setTimeout(() => {\n      executeBatchFetch();\n    }, 10);\n    \n    return null;\n  }, [userCache, executeBatchFetch]);\n\n  const prefetchUsers = useCallback((userIds) => {\n    const uncachedIds = userIds.filter(id => !userCache.has(id));\n    if (uncachedIds.length > 0) {\n      fetchUsersData(uncachedIds);\n    }\n  }, [userCache, fetchUsersData]);\n\n  const value = {\n    getUserData,\n    prefetchUsers\n  };\n\n  return (\n    <UserDataContext.Provider value={value}>\n      {children}\n    </UserDataContext.Provider>\n  );\n};\n\nexport const useUserData = (userId) => {\n  const context = useContext(UserDataContext);\n  \n  if (!context) {\n    throw new Error('useUserData must be used within UserDataProvider');\n  }\n  \n  return context.getUserData(userId);\n};\n\nexport default UserDataContext;","import React from 'react';\nimport ReactDOM from 'react-dom/client';\nimport App from './App';\n\n// Import global styles\nimport './styles/variables.css';\nimport './styles/global.css';\n\n// Import our context providers\nimport { SocketProvider } from './contexts/SocketContext';\nimport { AuthProvider } from './contexts/AuthContext';\nimport { PreferencesProvider } from './contexts/PreferencesContext';\nimport { UserDataProvider } from './contexts/UserDataContext';\n\nReactDOM.createRoot(document.getElementById('root')).render(\n  <React.StrictMode>\n    <AuthProvider>\n      <SocketProvider>\n        <UserDataProvider>\n          <PreferencesProvider>\n            <App />\n          </PreferencesProvider>\n        </UserDataProvider>\n      </SocketProvider>\n    </AuthProvider>\n  </React.StrictMode>\n);\n"],"file":"assets/index-B_3z-Zzg.js"}