import{b as e,j as s,c as t,a,B as n,d as r,e as i,s as l}from"./index-yrjwo6er.js";import{r as o,u as c}from"./vendor-D3vErxIQ.js";import{u as m}from"./useGamepadNavigation-Tj-O-nX_.js";import{A as d}from"./AppHeader-rUQErDwv.js";import{C as u,U as h,R as p,P as x,S as g,a as j,b as N,T as _,G as v}from"./GamepadInput-CW9gQ4IM.js";import"./audio-D4HOgbU8.js";import"./socket-DfKCw8Ob.js";const b="_lobbyScreen_14yt2_1",y="_gameListTitle_14yt2_33",f="_searchContainer_14yt2_46",C="_gameListWrapper_14yt2_83",w="_userDisconnectedGame_14yt2_102",A="_userInGame_14yt2_109",I="_gameListInfo_14yt2_132",S="_gameListId_14yt2_137",k="_disconnectedBadge_14yt2_146",P="_inGameBadge_14yt2_158",B="_gameListPlayers_14yt2_170",$="_emptyStateIcon_14yt2_237",G="_emptyStateMessage_14yt2_243",L="_emptyStateHint_14yt2_250",O="_privatePill_14yt2_256",D="_gameActionsSection_14yt2_269",E="_gameCard_14yt2_276",T="_pill_q09di_1",M="_pulse_q09di_23",W="_text_q09di_49",q=()=>{const{socket:t,isConnected:a}=e(),[n,r]=o.useState(null);return o.useEffect((()=>{if(!t||!a)return;t.emit("getOnlinePlayerCount",(e=>{r(e)}));const e=e=>r(e);return t.on("onlinePlayerCountUpdate",e),()=>{t.off("onlinePlayerCountUpdate",e)}}),[t,a]),null===n?null:s.jsxs("div",{className:T,children:[s.jsx("span",{className:M}),s.jsxs("span",{className:W,children:[n," online"]})]})},U="_balanceSection_1ap8t_1",z="_balanceLabel_1ap8t_10",H="_xpSection_1ap8t_17",R="_xpBarContainer_1ap8t_21",J="_xpOverlay_1ap8t_31",Y="_xpLevel_1ap8t_45",F="_xpNext_1ap8t_52",X="_xpBar_1ap8t_21",Q=({userId:e,balance:a})=>{const n=t(e);return s.jsxs("div",{className:"panel-alt",style:{width:"100%",flex:2},children:[s.jsxs("div",{className:U,children:[s.jsx("span",{className:z,children:"Balance:"}),s.jsx(u,{amount:Number(a)||0,size:"medium"})]}),n&&s.jsx("div",{className:H,children:s.jsxs("div",{className:R,children:[s.jsx("div",{className:X,style:{width:n.level>=100?"100%":`${n.percentToNextLevel||0}%`}}),s.jsxs("div",{className:J,children:[s.jsxs("div",{className:Y,children:["Level ",n.level]}),s.jsx("div",{className:F,children:n.level<100?`${n.xpToNextLevel.toLocaleString()} XP`:"MAX"})]})]})})]})},V={userSection:"_userSection_53k67_2",avatarContainer:"_avatarContainer_53k67_12",headerButtons:"_headerButtons_53k67_16",logoutButton:"_logoutButton_53k67_40"},Z=()=>{const{user:e,logout:t,refreshUserData:n}=a(),[r,i]=o.useState(!1);return s.jsxs("div",{style:{width:"100%"},children:[s.jsxs("div",{className:`panel ${V.userSection}`,children:[s.jsx("div",{className:V.avatarContainer,children:s.jsx(h,{userId:e?.id,size:"medium",showName:!0,namePosition:"right"})}),s.jsx(Q,{userId:e?.id,balance:e?.balance}),s.jsxs("div",{className:V.headerButtons,children:[s.jsx("button",{className:V.logoutButton,onClick:t,"data-gamepad-focusable":"true",children:s.jsx("span",{className:V.buttonText,children:"Logout"})}),s.jsx(p,{"data-gamepad-focusable":"true"}),s.jsx(x,{"data-gamepad-focusable":"true"}),s.jsx(g,{onClick:()=>i(!0),"data-gamepad-focusable":"true"}),s.jsx(j,{"data-gamepad-focusable":"true"})]})]}),r&&s.jsx(N,{onClose:()=>{i(!1),n&&n()}})]})},K=({className:e="",width:t="1em",height:a="1em",...n})=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`feather feather-lock ${e}`,width:t,height:a,...n,children:[s.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),s.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]});function ee({game:e,onJoin:t,userId:a}){const n=e.settings?.customName||`Game ${e.id}`,r=e.disconnectedPlayers?.some((e=>e.userId===a)),i=e.allPlayers?.some((e=>e.userId===a&&!e.disconnected));let l="Join";r?l="Reconnect":i&&(l="Continue");let o=`panel ${E}`;return r?o+=` ${w}`:i&&(o+=` ${A}`),s.jsxs("div",{className:o,children:[" ",s.jsxs("div",{className:I,style:{flex:1},children:[s.jsxs("div",{className:S,children:[" ",n,e.settings?.isPrivate&&s.jsxs("span",{className:O,title:"Private Game",children:[s.jsx(K,{width:"0.9em",height:"0.9em",style:{marginRight:"4px",verticalAlign:"middle"}}),"Private"]}),r&&s.jsx("span",{className:k,title:"You're disconnected from this game",children:"⚠️ Reconnect"}),i&&s.jsx("span",{className:P,title:"You're in this game",children:"You're In"})]}),s.jsxs("div",{className:B,children:[" ",e.playerCount," ",1===e.playerCount?"player":"players"]})]}),s.jsx("button",{className:"btn btn-primary",style:{padding:"0.4rem 1rem",fontSize:"0.9rem",minWidth:"80px",maxWidth:"100px",flexShrink:0},onClick:()=>t(e.id),disabled:!a,"data-gamepad-focusable":"true",children:l})]})}const se={useCustomName:!1,customName:"",isPrivate:!1,password:"",enableAceChoice:!0,enableSecondChance:!0,numberOfBots:0,anteAmount:""},te=({initialSettings:e=se,onSubmit:t,onClose:a})=>{const[i,l]=o.useState({...se,...e}),[c,m]=o.useState({}),d=(e,s)=>{l((t=>{const a={...t,[e]:s};return"useCustomName"!==e||s||(a.customName="",c.customName&&m((e=>{const s={...e};return delete s.customName,s}))),"isPrivate"!==e||s||(a.password="",c.password&&m((e=>{const s={...e};return delete s.password,s}))),a})),"customName"!==e&&"useCustomName"!==e||!c.customName||m((e=>{const s={...e};return delete s.customName,s})),"password"!==e&&"isPrivate"!==e||!c.password||m((e=>{const s={...e};return delete s.password,s})),"numberOfBots"===e&&c.numberOfBots&&m((e=>{const s={...e};return delete s.numberOfBots,s})),"anteAmount"===e&&c.anteAmount&&m((e=>{const s={...e};return delete s.anteAmount,s}))};return s.jsx(n,{title:"Game Options",onClose:a,style:{maxWidth:600},footer:s.jsxs("div",{style:{display:"flex",gap:8},children:[s.jsx("button",{type:"button",onClick:a,className:"btn btn-secondary","data-gamepad-focusable":"true",children:"Cancel"}),s.jsx("button",{type:"submit",form:"gameSettingsForm",className:"btn btn-primary",disabled:Object.keys(c).length>0,"data-gamepad-focusable":"true",children:"Create Game"})]}),children:s.jsx("form",{id:"gameSettingsForm",onSubmit:e=>{e.preventDefault();const s=(e=>{const s={};if(e.useCustomName){const t=e.customName||"";t?t.length<4||t.length>26?s.customName="Name must be 4-26 characters.":/^[a-zA-Z0-9_-]+$/.test(t)||(s.customName="Use letters, numbers, -, or _."):s.customName="Custom name is required."}if(e.isPrivate){const t=e.password||"";t?(t.length<3||t.length>36)&&(s.password="Password must be 3-36 characters."):s.password="Password is required."}const t=e.numberOfBots;(t<0||t>16)&&(s.numberOfBots="Number of bots must be between 0 and 16.");const a=e.anteAmount;if(""!==a&&null!=a){const e=parseInt(a);(isNaN(e)||e<1||e>100)&&(s.anteAmount="Ante amount must be between 1 and 100.")}return s})(i);if(Object.keys(s).length>0)m(s);else{m({});const e={...i,customName:i.useCustomName?i.customName:null,anteAmount:""===i.anteAmount?1:parseInt(i.anteAmount)};delete e.useCustomName,t(e)}},children:s.jsxs("div",{className:r.settingsContainer,children:[s.jsxs("div",{className:`panel-alt ${r.settingItem}`,children:[s.jsxs("div",{className:r.settingDescription,children:[s.jsx("h4",{children:"Custom Game Name"}),s.jsx("p",{children:"Set a custom name for your game lobby"})]}),s.jsxs("div",{className:r.settingControls,children:[s.jsx(_,{isChecked:i.useCustomName,onChange:e=>d("useCustomName",e.target.checked)}),i.useCustomName&&s.jsx(v,{title:"Enter Game Name",type:"text",value:i.customName||"",onChange:e=>d("customName",e.target.value),className:`${r.textInput}${c.customName?" "+r.inputError:""}`,placeholder:"Game Name",maxLength:26,style:{marginTop:8}}),c.customName&&s.jsx("span",{className:"errorMessage",children:c.customName})]})]}),s.jsxs("div",{className:`panel-alt ${r.settingItem}`,children:[s.jsxs("div",{className:r.settingDescription,children:[s.jsx("h4",{children:"Private Game"}),s.jsx("p",{children:"Only players with the password can join"})]}),s.jsxs("div",{className:r.settingControls,children:[s.jsx(_,{isChecked:i.isPrivate,onChange:e=>d("isPrivate",e.target.checked)}),i.isPrivate&&s.jsx(v,{title:"Enter Game Password",type:"text",value:i.password||"",onChange:e=>d("password",e.target.value),className:`${r.textInput}${c.password?" "+r.inputError:""}`,placeholder:"Password",maxLength:36,style:{marginTop:8}}),c.password&&s.jsx("span",{className:"errorMessage",children:c.password})]})]}),s.jsxs("div",{className:`panel-alt ${r.settingItem}`,children:[s.jsxs("div",{className:r.settingDescription,children:[s.jsx("h4",{children:"Number of Bots"}),s.jsx("p",{children:"Add AI players to your game (0-16)"})]}),s.jsxs("div",{className:r.settingControls,children:[s.jsx(v,{title:"Number of AI Players",type:"number",min:"0",max:"16",value:0===i.numberOfBots?"":i.numberOfBots,onChange:e=>d("numberOfBots",""===e.target.value?0:parseInt(e.target.value)||0),className:`${r.textInput} no-validation${c.numberOfBots?" "+r.inputError:""}`,placeholder:"0"}),c.numberOfBots&&s.jsx("span",{className:"errorMessage",children:c.numberOfBots})]})]}),s.jsxs("div",{className:`panel-alt ${r.settingItem}`,children:[s.jsxs("div",{className:r.settingDescription,children:[s.jsx("h4",{children:"Ante Amount"}),s.jsx("p",{children:"Set the ante amount for each round (1-100)"})]}),s.jsxs("div",{className:r.settingControls,children:[s.jsx(v,{title:"Ante Amount",type:"number",min:"1",max:"100",value:i.anteAmount,onChange:e=>d("anteAmount",e.target.value),className:`${r.textInput} no-validation${c.anteAmount?" "+r.inputError:""}`,placeholder:"1"}),c.anteAmount&&s.jsx("span",{className:"errorMessage",children:c.anteAmount})]})]}),s.jsxs("div",{className:`panel-alt ${r.settingItem}`,children:[s.jsxs("div",{className:r.settingDescription,children:[s.jsx("h4",{children:"Enable Ace Choice"}),s.jsx("p",{children:"Allow players to choose high/low on Ace"})]}),s.jsx("div",{className:r.settingControls,children:s.jsx(_,{isChecked:i.enableAceChoice,onChange:e=>d("enableAceChoice",e.target.checked)})})]}),s.jsxs("div",{className:`panel-alt ${r.settingItem}`,children:[s.jsxs("div",{className:r.settingDescription,children:[s.jsx("h4",{children:"Enable Second Chance"}),s.jsx("p",{children:"Allow players to ante up for a second chance"})]}),s.jsx("div",{className:r.settingControls,children:s.jsx(_,{isChecked:i.enableSecondChance,onChange:e=>d("enableSecondChance",e.target.checked)})})]})]})})})},ae=()=>{const{gameList:t}=i(),{user:n,logout:r}=a(),{socket:u,isConnected:h}=e();m(!0);const p=c(),[x,g]=o.useState(""),[j,N]=o.useState(!1),_=n?.username?`user_${n.username}`:null;o.useEffect((()=>{n&&(n.username&&n.id||r())}),[n,r]);const w=e=>{h&&n&&(l.play("ui.click"),p(`/${e}`))},A=e=>{if(!n?.id||!h)return;const s=e=>{u.off("gameCreated",s),e?.game?.id&&p(`/${e.game.id}`)};u.on("gameCreated",s),e?u.emit("createGame",{settings:e}):u.emit("createGame")},I=o.useMemo((()=>{if(!t)return[];let e=t;if(x.trim()){const s=x.trim().toLowerCase();e=t.filter((e=>e.id.toLowerCase().includes(s)))}return e.sort(((e,s)=>{const t=e.allPlayers?.some((e=>e.userId===_)),a=s.allPlayers?.some((e=>e.userId===_)),n=e.disconnectedPlayers?.some((e=>e.userId===_)),r=s.disconnectedPlayers?.some((e=>e.userId===_));return n&&!r?-1:!n&&r?1:t&&!a?-1:!t&&a?1:e.id.localeCompare(s.id)}))}),[t,x,_]);return s.jsxs("div",{className:`screen ${b}`,children:[s.jsx(d,{}),s.jsx("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginTop:"1.1em",marginBottom:"-0.6em"},children:s.jsx(q,{})}),s.jsxs("div",{className:"card",style:{width:"100%",maxWidth:"600px",marginBottom:"2rem"},children:[s.jsx(Z,{}),s.jsx("div",{className:"divider"}),s.jsxs("div",{className:D,children:[s.jsx("button",{className:"btn btn-primary",onClick:()=>A({numberOfBots:5}),disabled:!n?.username,"data-gamepad-focusable":"true",children:"Create Quick Game"}),s.jsx("button",{className:"btn btn-primary",onClick:()=>{N(!0)},disabled:!n?.username,"data-gamepad-focusable":"true",children:"Create Custom Game"})]})]}),s.jsxs("div",{className:"card",style:{width:"100%",maxWidth:"600px",minHeight:"200px"},children:[s.jsx("h2",{className:y,children:"Available Games"}),s.jsx("div",{className:f,children:s.jsxs("div",{className:"input-with-icon",children:[s.jsx("span",{className:"input-icon left",children:"🔍"}),s.jsx(v,{title:"Search Games",type:"search",className:"no-validation",placeholder:"Search games by ID",value:x,onChange:e=>{g(e.target.value)}})]})}),I&&I.length>0?s.jsx("div",{className:C,children:I.map((e=>s.jsx(ee,{game:e,onJoin:w,userId:_},e.id)))}):s.jsxs("div",{className:"panel-alt",style:{textAlign:"center",padding:"2rem",minHeight:"150px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[s.jsx("div",{className:$,children:"🃏"}),s.jsx("p",{className:G,children:x.trim()?"No matching games found":"No games in progress"}),s.jsx("p",{className:L,children:x.trim()?"Try a different search or create a new game":"Create a new game to get started!"})]})]}),j&&s.jsx(te,{onSubmit:e=>{N(!1),A(e)},onClose:()=>N(!1)})]})};export{ae as default};
