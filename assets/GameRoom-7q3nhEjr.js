import{a3 as R,$ as X,a6 as ae,U as e,a9 as H,aa as ge,ac as he,ag as xe}from"./index-DCTCU-m8.js";import{r as m,b as ye,u as je}from"./vendor-KCSzRvRf.js";import{G as me,C as $,a as fe,R as be,P as Ce,S as ve,I as Ne,c as Be,b as Te,U as we,g as le,d as Ae}from"./StoreModal-X3VXbt26.js";import{u as Se}from"./useGamepadNavigation-Vd4_Qxse.js";import"./socket-CA1CrNgP.js";import"./audio-Bhw8yDMU.js";const _e=m.createContext(),I=()=>{const t=m.useContext(_e);if(t===void 0)throw new Error("useGameContext must be used within a GameProvider");return t},ke=({children:t,gameId:n,initialGameState:o=null})=>{const{socket:s,error:c}=R(),{user:r}=X(),[d,a]=m.useState(o),l=m.useRef(null),[i,_]=m.useState(null),h=m.useCallback(()=>{_(null)},[]);m.useEffect(()=>{c&&_(c)},[c]),m.useEffect(()=>{if(s)return s.on("gameReconnected",g=>{console.log(`[Game] Reconnected to game: ${g.gameId}`,g.game),a(g.game),console.log(`[Game] Successfully reconnected as user ID: ${r?.id}`),_(null),g.game&&g.game.id&&setTimeout(()=>{console.log("[Game] Requesting fresh game state after reconnection"),s.emit("getGameState",{gameId:g.game.id})},500)}),s.on("gameState",g=>{if(g&&g.id&&JSON.stringify(d)!==JSON.stringify(g)){if(g.currentPlayerId&&r?.id){const G=g.currentPlayerId===r.id,W=l.current===r.id;G&&!W&&ae.play("ui.alert"),l.current=g.currentPlayerId}a(g),h()}}),s.on("gameError",g=>{console.error("Game error:",g),_(g)}),()=>{s.off("gameReconnected"),s.off("gameState"),s.off("gameError")}},[s]);const u=m.useCallback(g=>{if(!(!s||!n))try{s.emit("placeBet",{bet:g,gameId:n})}catch(G){console.error("Error placing bet:",G),_("Failed to place bet. Please try again.")}},[s,n]),p=m.useCallback(()=>{if(!(!s||!n))try{s.emit("payAnte",{gameId:n})}catch(g){console.error("Error paying ante:",g),_("Failed to pay ante. Please try again.")}},[s,n]),b=m.useCallback(()=>{if(!(!s||!n))try{s.emit("dealCards",{gameId:n})}catch(g){console.error("Error dealing cards:",g),_("Failed to deal cards. Please try again.")}},[s,n]),x=m.useCallback(()=>{if(!(!s||!n))try{s.emit("revealMiddleCard",{gameId:n})}catch(g){console.error("Error revealing middle card:",g),_("Failed to reveal middle card. Please try again.")}},[s,n]),v=m.useCallback(()=>{if(!(!s||!n))try{s.emit("nextRound",{gameId:n})}catch(g){console.error("Error moving to next round:",g),_("Failed to move to next round. Please try again.")}},[s,n]),N=m.useCallback(()=>{if(!(!s||!n))try{s.emit("ready")}catch(g){console.error("Error setting player ready:",g),_("Failed to set player ready. Please try again.")}},[s,n]),w=m.useCallback(()=>{if(!(!s||!n))try{s.emit("unready")}catch(g){console.error("Error setting player unready:",g),_("Failed to set player unready. Please try again.")}},[s,n]),P={gameState:d,error:i,gameId:n,placeBet:u,payAnte:p,playerReady:N,playerUnready:w,dealCards:b,revealMiddleCard:x,nextRound:v,clearError:h};return e.jsx(_e.Provider,{value:P,children:t})},Ie="_modalOverlay_17ksc_1",Pe="_modalContent_17ksc_14",Le="_passwordInput_17ksc_34",$e="_modalActions_17ksc_54",Ee="_modalButton_17ksc_60",Oe="_cancelButton_17ksc_71",Re="_submitButton_17ksc_80",M={modalOverlay:Ie,modalContent:Pe,passwordInput:Le,modalActions:$e,modalButton:Ee,cancelButton:Oe,submitButton:Re};function Me({isOpen:t,onClose:n,onSubmit:o,gameId:s}){const[c,r]=m.useState("");if(!t)return null;const d=l=>{l.preventDefault(),o(c),r("")},a=()=>{r(""),n()};return e.jsx("div",{className:M.modalOverlay,children:e.jsxs("div",{className:M.modalContent,children:[e.jsx("h2",{children:"Password Required"}),e.jsxs("p",{children:["Please enter the password for game ",e.jsx("strong",{children:s||""}),":"]}),e.jsxs("form",{onSubmit:d,autoComplete:"off",children:[e.jsx(me,{title:"Enter Game Password",type:"text",value:c,onChange:l=>r(l.target.value),className:M.passwordInput,autoFocus:!0,required:!0,autoComplete:"off","data-form-type":"other","data-lpignore":"true"}),e.jsxs("div",{className:M.modalActions,children:[e.jsx("button",{type:"button",onClick:a,className:`${M.modalButton} ${M.cancelButton}`,"data-gamepad-focusable":"true",children:"Cancel"}),e.jsx("button",{type:"submit",className:`${M.modalButton} ${M.submitButton}`,"data-gamepad-focusable":"true",children:"Join Game"})]})]})]})})}const De="_gameContainer_1kxnm_1",Ge="_gameScreen_1kxnm_6",Fe="_loadingContainer_1kxnm_41",ze="_errorContainer_1kxnm_50",qe="_errorText_1kxnm_66",Ue="_gameBottomSection_1kxnm_95",F={gameContainer:De,gameScreen:Ge,loadingContainer:Fe,errorContainer:ze,errorText:qe,gameBottomSection:Ue},He="_emojiReactions_1y1z5_1",We="_toggleButton_1y1z5_8",Ye="_emojiPanel_1y1z5_35",Ve="_emojiGrid_1y1z5_60",Je="_emojiButton_1y1z5_66",Y={emojiReactions:He,toggleButton:We,emojiPanel:Ye,emojiGrid:Ve,emojiButton:Je},Ke=()=>{const[t,n]=m.useState(!1),{socket:o}=R(),{gameState:s}=I(),{user:c}=X(),r=m.useRef(null),d=[{emoji:"ğŸ”¥",name:"Fire",color:"#FF6B35"},{emoji:"ğŸ˜„",name:"Happy",color:"#FFD93D"},{emoji:"ğŸ’©",name:"Poop",color:"#8B4513"},{emoji:"ğŸ˜",name:"Cool",color:"#4A5568"},{emoji:"ğŸ¤¯",name:"Mind Blown",color:"#FFA500"},{emoji:"ğŸ˜ˆ",name:"Devilish",color:"#9333EA"},{emoji:"ğŸ˜¬",name:"Worried",color:"#FCD34D"},{emoji:"ğŸ‘",name:"Applause",color:"#FBBF24"},{emoji:"ğŸ˜­",name:"Crying",color:"#3B82F6"},{emoji:"ğŸ¤¡",name:"Clown",color:"#EF4444"},{emoji:"ğŸ’ª",name:"Strong",color:"#F59E0B"},{emoji:"ğŸ˜…",name:"Nervous",color:"#60A5FA"},{emoji:"ğŸ‰",name:"Celebration",color:"#A855F7"},{emoji:"ğŸ¤”",name:"Thinking",color:"#6B7280"},{emoji:"ğŸ™ˆ",name:"See No Evil",color:"#A0522D"},{emoji:"ğŸ˜¤",name:"Confident",color:"#DC2626"}],a=i=>{!o||!s||!c||(o.emit("emojiReaction",{gameId:s.id,emoji:i.emoji,color:i.color,playerName:c.username}),n(!1))},l=()=>{n(!t)};return m.useEffect(()=>{const i=_=>{r.current&&!r.current.contains(_.target)&&n(!1)};return t&&(document.addEventListener("mousedown",i),document.addEventListener("touchstart",i)),()=>{document.removeEventListener("mousedown",i),document.removeEventListener("touchstart",i)}},[t]),e.jsxs("div",{className:Y.emojiReactions,ref:r,children:[e.jsx("button",{className:Y.toggleButton,onClick:l,"data-gamepad-focusable":"true","aria-label":"Toggle emoji reactions",children:"ğŸ˜Š"}),t&&e.jsx("div",{className:Y.emojiPanel,children:e.jsx("div",{className:Y.emojiGrid,children:d.map((i,_)=>e.jsx("button",{className:Y.emojiButton,onClick:()=>a(i),"data-gamepad-focusable":"true",title:i.name,style:{"--emoji-color":i.color},children:i.emoji},_))})})]})},Qe="_headerContainer_1ki61_1",Xe="_header_1ki61_1",Ze="_headerLeft_1ki61_30",et="_gameTitle_1ki61_39",tt="_liveTag_1ki61_50",st="_gameIdText_1ki61_68",nt="_gameIdLink_1ki61_75",at="_headerRight_1ki61_88",ot="_controlsStack_1ki61_94",rt="_balanceDisplay_1ki61_101",ct="_balanceLabel_1ki61_114",it="_controlsGroup_1ki61_120",E={headerContainer:Qe,header:Xe,headerLeft:Ze,gameTitle:et,liveTag:tt,gameIdText:st,gameIdLink:nt,headerRight:at,controlsStack:ot,balanceDisplay:rt,balanceLabel:ct,controlsGroup:it},lt=({color:t="currentColor",size:n=24})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:t,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),e.jsx("polyline",{points:"16 17 21 12 16 7"}),e.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),dt=({handleLeaveGame:t,onModalStateChange:n})=>{const{gameState:o,gameId:s}=I(),{socket:c}=R(),{user:r}=X(),d=c?.auth?.userId,a=d&&o?.players?o.players[d]:null,l=a?.balance??r?.balance??0,i=a?.isReady||!1,[_,h]=m.useState(!1),[u,p]=m.useState(!1),[b,x]=m.useState(!1),[v,N]=m.useState(!1),[w,P]=m.useState(!1);return m.useEffect(()=>{n&&n(_||u||b||v||w)},[_,u,b,v,w,n]),e.jsxs("div",{className:E.headerContainer,children:[e.jsxs("div",{className:E.header,children:[e.jsxs("div",{className:E.headerLeft,children:[e.jsxs("h1",{className:E.gameTitle,children:["In Between ",e.jsx("span",{className:E.liveTag,children:"LIVE"})]}),e.jsx("p",{className:E.gameIdText,children:e.jsxs("span",{className:E.gameIdLink,onClick:()=>h(!0),title:"Click to view game summary","data-gamepad-focusable":"true",tabIndex:"0",children:["Game #",s]})})]}),e.jsx("div",{className:E.headerRight,children:e.jsxs("div",{className:E.controlsStack,children:[e.jsxs("div",{className:E.balanceDisplay,children:[e.jsx("span",{className:E.balanceLabel,children:"Balance:"}),e.jsx($,{amount:Number(l),size:"small"})]}),e.jsxs("div",{className:E.controlsGroup,children:[e.jsx(fe,{inGame:!0,onModalStateChange:x,"data-gamepad-focusable":"true"}),e.jsx(be,{onModalStateChange:N,"data-gamepad-focusable":"true"}),e.jsx(Ce,{onModalStateChange:P,"data-gamepad-focusable":"true"}),e.jsx(ve,{onClick:()=>p(!0),"data-gamepad-focusable":"true"}),e.jsx(Ne,{icon:e.jsx(lt,{color:"white",size:20}),title:"Leave Game",onClick:t,variant:"danger",disabled:i,"data-gamepad-focusable":"true"})]})]})})]}),_&&e.jsx(Be,{onClose:()=>h(!1),gameData:o}),u&&e.jsx(Te,{onClose:()=>p(!1)})]})},ut="_gameLogContainer_avo5w_1",mt="_gameLogHeader_avo5w_15",_t="_expandIcon_avo5w_29",pt="_gameLogEntries_avo5w_53",gt="_logEntry_avo5w_63",ht="_logTime_avo5w_88",xt="_logMessage_avo5w_95",yt="_systemMessage_avo5w_100",jt="_emptyLog_avo5w_111",ft="_showMoreButton_avo5w_119",L={gameLogContainer:ut,gameLogHeader:mt,expandIcon:_t,gameLogEntries:pt,logEntry:gt,logTime:ht,logMessage:xt,systemMessage:yt,emptyLog:jt,showMoreButton:ft},bt="_roundPanel_1npc7_2",Ct="_dividerLine_1npc7_26",vt="_roundLabel_1npc7_38",Z={roundPanel:bt,dividerLine:Ct,roundLabel:vt},Nt=({roundNumber:t})=>e.jsxs("div",{className:`panel-alt ${Z.roundPanel}`,children:[e.jsx("div",{className:Z.dividerLine}),e.jsxs("span",{className:Z.roundLabel,children:["Round ",t]}),e.jsx("div",{className:Z.dividerLine})]}),Bt="_turnPanel_1mzsb_2",Tt="_leftSection_1mzsb_15",wt="_win_1mzsb_22",At="_lose_1mzsb_27",St="_penalty_1mzsb_32",kt="_pass_1mzsb_37",It="_cardsContainer_1mzsb_43",Pt="_playerName_1mzsb_49",Lt="_action_1mzsb_56",$t="_amount_1mzsb_65",O={turnPanel:Bt,leftSection:Tt,win:wt,lose:At,penalty:St,pass:kt,cardsContainer:It,playerName:Pt,action:Lt,amount:$t},Et="_cardMini_tdd1b_2",Ot="_red_tdd1b_18",Rt="_black_tdd1b_22",Mt="_rank_tdd1b_26",Dt="_aceIndicator_tdd1b_34",Gt="_suit_tdd1b_53",Ft="_cardPlaceholder_tdd1b_58",D={cardMini:Et,red:Ot,black:Rt,rank:Mt,aceIndicator:Dt,suit:Gt,cardPlaceholder:Ft},zt={TIMERS:{BETTING_DURATION:3e4,DECISION_DURATION:15e3}},f={HEARTS:"â™¥",DIAMONDS:"â™¦",CLUBS:"â™£",SPADES:"â™ ",ARROW_RIGHT:"â†’",ARROW_UP:"â†‘",ARROW_DOWN:"â†“",ROTATE:"â†»",CHECK:"âœ“",CROSS:"âœ•"},{TIMERS:oe}=zt,ne=({card:t})=>{if(!t)return e.jsx("div",{className:D.cardPlaceholder,children:"?"});const n=l=>{switch(l){case"hearts":case"â™¥":return f.HEARTS;case"diamonds":case"â™¦":return f.DIAMONDS;case"clubs":case"â™£":return f.CLUBS;case"spades":case"â™ ":return f.SPADES;default:return l||""}},o=t.value||"?",s=t.suit||"?",c=s==="â™¥"||s==="â™¦"||s==="hearts"||s==="diamonds",r=o==="A",d=t.isAceLow===!0,a=r&&!d;return e.jsxs("div",{className:`${D.cardMini} ${c?D.red:D.black}`,children:[e.jsxs("span",{className:D.rank,children:[o,r&&(a?e.jsx("span",{className:D.aceIndicator,children:"â†‘"}):d?e.jsx("span",{className:D.aceIndicator,children:"â†“"}):null)]}),e.jsx("span",{className:D.suit,children:n(s)})]})},qt=({summary:t})=>{if(!t)return null;const n=c=>{switch(c){case"win":return O.win;case"lose":return O.lose;case"penalty":case"triple_penalty":return O.penalty;case"pass":return O.pass;default:return O.default}},o=c=>{switch(c){case"win":return"WON";case"lose":return"LOST";case"penalty":return"PENALTY";case"triple_penalty":return"TRIPLE PENALTY";case"pass":return"PASSED";case"bet":return"BET";default:return c?.toUpperCase()||""}},s=()=>t.winAmount?t.winAmount/2:t.lossAmount?t.lossAmount:t.betAmount?t.betAmount:0;return e.jsxs("div",{className:`panel-alt ${O.turnPanel} ${n(t.action)}`,children:[e.jsxs("div",{className:O.leftSection,children:[e.jsxs("div",{className:O.cardsContainer,children:[e.jsx(ne,{card:t.cards?.left}),t.cards?.middle&&e.jsx(ne,{card:t.cards?.middle}),e.jsx(ne,{card:t.cards?.right})]}),e.jsx("span",{className:O.playerName,children:e.jsx(H,{username:t.playerName})}),e.jsx("span",{className:O.action,children:o(t.action)})]}),s()>0&&e.jsx("div",{className:O.amount,children:e.jsx($,{amount:s(),size:"small"})})]})},Ut=()=>{const{gameState:t}=I(),[n,o]=m.useState(!1);if(!t||!t.gameLog)return null;const s=t.gameLog||[],c=t.seats?t.seats.filter(p=>p!==null).length:0,r=Math.max(c,4),[d,a]=m.useState(r);m.useEffect(()=>{n||a(r)},[c,r,n]);const l=p=>new Date(p).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"}),i=()=>{o(!n),n&&a(r)},_=()=>{a(p=>p+Math.max(c,5))},h=n?[]:s.slice(0,d),u=p=>p.type==="turn"?e.jsx(qt,{summary:p},p.id):p.type==="round_start"?e.jsx(Nt,{roundNumber:p.roundNumber},p.id):p.type==="system"||p.type==="error"?e.jsxs("div",{className:`${L.logEntry} ${L.systemMessage}`,children:[e.jsx("span",{className:L.logTime,children:l(p.timestamp)}),e.jsx("span",{className:L.logMessage,children:p.message})]},p.id):e.jsxs("div",{className:L.logEntry,children:[e.jsx("span",{className:L.logTime,children:l(p.timestamp)}),e.jsx("span",{className:L.logMessage,children:p.message})]},p.id);return e.jsxs("div",{className:L.gameLogContainer,children:[e.jsxs("h3",{className:L.gameLogHeader,onClick:i,children:["Game Log",e.jsx("span",{className:L.expandIcon,children:n?"â–¶":"â–¼"})]}),!n&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:L.gameLogEntries,children:s.length===0?e.jsx("div",{className:L.emptyLog,children:"No game events yet"}):h.map(u)}),s.length>d&&e.jsxs("div",{className:L.showMoreButton,onClick:_,children:["Show ",Math.min(Math.max(c,5),s.length-d)," more",s.length-d>Math.max(c,5)&&` (${s.length-d} remaining)`]})]})]})},Ht="_playersContainer_1b112_1",Wt="_playersTitle_1b112_21",Yt="_playersList_1b112_45",Vt="_currentPlayerGlow_1b112_53",Jt="_currentUser_1b112_67",Kt="_playerInfo_1b112_71",Qt="_playerStatus_1b112_79",Xt="_disconnectedIndicator_1b112_86",Zt="_playerBalanceContainer_1b112_93",es="_readyIndicator_1b112_146",ts="_ready_1b112_146",ss="_notReady_1b112_157",ns="_sittingOut_1b112_161",as="_emptyPlayerList_1b112_176",S={playersContainer:Ht,playersTitle:Wt,playersList:Yt,currentPlayerGlow:Vt,currentUser:Jt,playerInfo:Kt,playerStatus:Qt,disconnectedIndicator:Xt,playerBalanceContainer:Zt,readyIndicator:es,ready:ts,notReady:ss,sittingOut:ns,emptyPlayerList:as},os=()=>{const{gameState:t}=I(),{socket:n}=R(),o=m.useContext(ge);if(m.useEffect(()=>{if(t?.players&&o){const a=Object.values(t.players).map(l=>l.userId).filter(Boolean);a.length>0&&o.prefetchUsers(a)}},[t?.players,o]),!t||!t.players)return e.jsx("div",{className:S.emptyPlayerList,children:e.jsx("p",{children:"Waiting for game data..."})});const{players:s,currentPlayerId:c}=t,r=n?.auth?.userId,d=t.totals||{};return!s||Object.keys(s).length===0?e.jsx("div",{className:S.emptyPlayerList,children:e.jsx("p",{children:"Waiting for players to join..."})}):e.jsxs("div",{className:S.playersContainer,children:[e.jsx("h3",{className:S.playersTitle,children:"Scoreboard"}),e.jsx("div",{className:S.playersList,children:t.seats.filter(a=>a!==null&&s[a]).map(a=>{const l=s[a],i=a===c,_=l.userId===r;return e.jsxs("div",{className:`
                  ${i?"panel":"panel-alt"}
                  ${i?S.currentPlayerGlow:""}
                  ${_?S.currentUser:""}
                `,style:{padding:"0.35rem 0.75rem",gap:"0.5rem",flexDirection:"row",fontSize:"0.9rem",alignItems:"center",justifyContent:"space-between",height:"40px"},children:[e.jsxs("div",{className:S.playerInfo,children:[e.jsx(we,{userId:l.userId,size:"small",showName:!0,namePosition:"right",fontWeight:"bold"}),e.jsx("span",{className:S.playerStatus,children:l.disconnected&&e.jsx("span",{className:S.disconnectedIndicator,title:"Player disconnected",children:"âš ï¸ Disconnected"})})]}),e.jsxs("div",{className:S.playerBalanceContainer,children:[e.jsx($,{amount:d[a]||0,size:"small"}),e.jsx("div",{className:`
                    ${S.readyIndicator} 
                    ${l.isSittingOut?S.sittingOut:l.isReady?S.ready:S.notReady}
                  `,title:l.isSittingOut?"Sitting Out":l.isReady?"Ready":"Not Ready"})]})]},a)})})]})},rs="_table_1c3a2_2",cs="_feltTexture_1c3a2_75",is="_sitOutOverlay_1c3a2_104",ee={table:rs,feltTexture:cs,sitOutOverlay:is},ls="_aceOverlay_1apr0_2",ds="_cardGlow_1apr0_14",us="_countdownRing_1apr0_24",ms="_countdownCircle_1apr0_34",_s="_choiceButton_1apr0_43",ps="_highButton_1apr0_74",gs="_lowButton_1apr0_85",hs="_timerDisplay_1apr0_96",xs="_waitingMessage_1apr0_109",ys="_aceControlsBottom_1apr0_136",js="_timerContainer_1apr0_150",fs="_aceButtonContainer_1apr0_158",bs="_choicePrompt_1apr0_165",Cs="_bottomChoiceButton_1apr0_174",vs="_lowButtonBottom_1apr0_200",Ns="_highButtonBottom_1apr0_210",T={aceOverlay:ls,cardGlow:ds,countdownRing:us,countdownCircle:ms,choiceButton:_s,highButton:ps,lowButton:gs,timerDisplay:hs,waitingMessage:xs,aceControlsBottom:ys,timerContainer:js,aceButtonContainer:fs,choicePrompt:bs,bottomChoiceButton:Cs,lowButtonBottom:vs,highButtonBottom:Ns},Bs="_waitingTimer_egezv_2",Ts="_timerContent_egezv_16",ws="_playerName_egezv_23",As="_action_egezv_29",Ss="_timerBar_egezv_35",ks="_timerProgress_egezv_43",z={waitingTimer:Bs,timerContent:Ts,playerName:ws,action:As,timerBar:Ss,timerProgress:ks},re=({playerName:t,action:n="deciding",duration:o=15e3})=>{const[s,c]=m.useState(o),r=m.useRef(Date.now());m.useEffect(()=>{r.current=Date.now(),c(o)},[o]),m.useEffect(()=>{const a=setInterval(()=>{const l=Date.now()-r.current,i=Math.max(0,o-l);c(i),i<=0&&clearInterval(a)},100);return()=>clearInterval(a)},[o]);const d=(o-s)/o*100;return e.jsxs("div",{className:`panel-game ${z.waitingTimer}`,children:[e.jsxs("div",{className:z.timerContent,children:[e.jsx("span",{className:z.playerName,children:e.jsx(H,{username:t})}),e.jsxs("span",{className:z.action,children:["is ",n,"..."]})]}),e.jsx("div",{className:z.timerBar,children:e.jsx("div",{className:z.timerProgress,style:{width:`${d}%`}})})]})},Is="_countdownTimer_1r3bp_3",Ps="_progressRing_1r3bp_19",Ls="_progressRingBackground_1r3bp_25",$s="_progressRingCircle_1r3bp_31",Es="_timeDisplay_1r3bp_40",V={countdownTimer:Is,progressRing:Ps,progressRingBackground:Ls,progressRingCircle:$s,timeDisplay:Es},ce=({duration:t=15,isActive:n=!0})=>{const[o,s]=m.useState(t),c=m.useRef(Date.now());m.useEffect(()=>{n&&(c.current=Date.now(),s(t))},[t,n]),m.useEffect(()=>{if(!n)return;const u=setInterval(()=>{const p=Math.floor((Date.now()-c.current)/1e3),b=Math.max(0,t-p);s(b),b<=0&&clearInterval(u)},100);return()=>clearInterval(u)},[t,n]);const r=o/t*100,d=()=>{const u=o/t*100;return u>66?"var(--color-ready)":u>33?"var(--accent)":"var(--secondary)"},a=50,l=3,i=(a-l*2)/2,_=i*2*Math.PI,h=_-r/100*_;return e.jsxs("div",{className:V.countdownTimer,children:[e.jsxs("svg",{className:V.progressRing,width:a,height:a,viewBox:`0 0 ${a} ${a}`,children:[e.jsx("circle",{className:V.progressRingBackground,cx:a/2,cy:a/2,r:i,strokeWidth:l}),e.jsx("circle",{className:V.progressRingCircle,cx:a/2,cy:a/2,r:i,strokeWidth:l,strokeDasharray:`${_} ${_}`,strokeDashoffset:h,style:{stroke:d()}})]}),e.jsxs("div",{className:V.timeDisplay,children:[o,"s"]})]})},te=({direction:t="up",color:n="currentColor",size:o=24})=>{const s=t==="down"?"rotate(180deg)":"rotate(0deg)";return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:o,height:o,viewBox:"0 0 24 24",fill:"none",stroke:n,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{transform:s,display:"inline-block",transformOrigin:"center"},children:e.jsx("path",{d:"M7 11l5-5 5 5M7 17l5-5 5 5"})})},Os=({isCurrentPlayersTurn:t,bottomPosition:n=!1})=>{const{socket:o}=R(),{gameState:s}=I(),[c,r]=m.useState(null),d=l=>{c===null&&(r(l),o.emit("chooseAceValue",{isAceLow:l}))},a=s.players[s.currentPlayerId]?.name||"Current player";return n?t?e.jsxs("div",{className:`panel-game ${T.aceControlsBottom}`,children:[e.jsx("div",{className:T.timerContainer,children:e.jsx(ce,{duration:15,isActive:!0})}),e.jsxs("div",{className:T.aceButtonContainer,children:[e.jsx("span",{className:T.choicePrompt,children:"ACE VALUE:"}),e.jsxs("button",{className:`${T.bottomChoiceButton} ${T.lowButtonBottom}`,onClick:()=>d(!0),disabled:c!==null,"data-gamepad-focusable":"true",autoFocus:!0,children:[e.jsx(te,{direction:"down",size:16}),e.jsx("span",{children:"LOW"})]}),e.jsxs("button",{className:`${T.bottomChoiceButton} ${T.highButtonBottom}`,onClick:()=>d(!1),disabled:c!==null,"data-gamepad-focusable":"true",children:[e.jsx("span",{children:"HIGH"}),e.jsx(te,{direction:"up",size:16})]})]})]}):e.jsx(re,{playerName:a,action:"choosing ace value",duration:oe.DECISION_DURATION}):e.jsxs("div",{className:T.aceOverlay,children:[e.jsx("div",{className:T.cardGlow}),t&&e.jsx("svg",{className:T.countdownRing,children:e.jsx("circle",{className:T.countdownCircle,cx:"60",cy:"87",r:"80",style:{strokeDasharray:`${countdown/15*502} 502`}})}),t?e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:`${T.choiceButton} ${T.highButton}`,onClick:()=>d(!1),disabled:c!==null,"data-gamepad-focusable":"true",autoFocus:!0,children:[e.jsx(te,{direction:"up",size:20}),e.jsx("span",{children:"HIGH"})]}),e.jsxs("button",{className:`${T.choiceButton} ${T.lowButton}`,onClick:()=>d(!0),disabled:c!==null,"data-gamepad-focusable":"true",children:[e.jsx("span",{children:"LOW"}),e.jsx(te,{direction:"down",size:20})]}),e.jsxs("div",{className:T.timerDisplay,children:[countdown,"s"]})]}):e.jsxs("div",{className:T.waitingMessage,children:[a," is choosing..."]})]})},Rs="_anteControls_68v5e_4",Ms="_anteButton_68v5e_27",Ds="_backOutButton_68v5e_27",Gs="_sitOutHalfWidth_68v5e_27",Fs="_shimmerBorder_68v5e_110",zs="_buttonInfo_68v5e_125",qs="_buttonLabel_68v5e_132",Us="_buttonAmount_68v5e_143",Hs="_notEnoughChipsText_68v5e_154",A={anteControls:Rs,anteButton:Ms,backOutButton:Ds,sitOutHalfWidth:Gs,shimmerBorder:Fs,buttonInfo:zs,buttonLabel:qs,buttonAmount:Us,notEnoughChipsText:Hs},Ws="_toggleLabel_b88gt_2",Ys="_toggleInput_b88gt_9",Vs="_toggleSlider_b88gt_15",Js="_toggleText_b88gt_64",Ks="_loading_b88gt_86",J={toggleLabel:Ws,toggleInput:Ys,toggleSlider:Vs,toggleText:Js,loading:Ks},Qs=()=>{const{preferences:t,toggleAutoAnte:n,loading:o}=he(),{gameState:s,playerReady:c}=I(),{socket:r}=R(),d=async()=>{const a=!t.autoAnte,l=await n();if(a&&l&&c){let i=null;if(r&&r.auth?.userId&&s?.players){const h=Object.keys(s.players);for(const u of h)if(s.players[u].userId===r.auth.userId){i=s.players[u];break}}i?.isReady||c()}};return o?e.jsx("div",{className:J.loading,children:"Loading preferences..."}):e.jsxs("label",{className:J.toggleLabel,children:[e.jsx("input",{type:"checkbox",checked:t.autoAnte,onChange:d,className:J.toggleInput,"data-gamepad-focusable":"true"}),e.jsx("span",{className:J.toggleSlider}),e.jsx("span",{className:J.toggleText,children:"Auto-Ante"})]})},Xs=()=>{const{gameState:t,playerReady:n,playerUnready:o}=I(),{socket:s}=R(),{user:c}=X(),[r,d]=m.useState(!1);if(!t)return null;const{players:a,anteAmount:l,phase:i}=t;if(i!=="waiting")return null;let _=null;if(s&&s.auth?.userId&&a){const b=Object.keys(a);for(const x of b)if(a[x].userId===s.auth.userId){_=a[x];break}}else if(c&&a){const b=Object.keys(a);for(const x of b)if(a[x].userId===c.id){_=a[x],console.log("[AnteControls] Found player by user ID instead of socket ID");break}}const h=Number(_?.balance||0),u=_?.isReady,p=h>=l;return e.jsxs("div",{className:`panel-game ${A.anteControls}`,children:[u?e.jsxs("button",{className:A.backOutButton,onClick:()=>{r||(typeof o=="function"?(d(!0),o()):console.error("playerUnready is not a function"))},disabled:r,"aria-label":"Back out","data-gamepad-focusable":"true",children:[e.jsx("div",{className:A.shimmerBorder}),e.jsx("div",{className:A.buttonInfo,children:e.jsx("span",{className:A.buttonLabel,children:"BACK OUT"})})]}):e.jsxs(e.Fragment,{children:[e.jsx(Qs,{}),e.jsxs("button",{className:A.anteButton,onClick:()=>{r||(d(!0),n())},disabled:!p||r,"aria-label":"Ante up","data-gamepad-focusable":"true",autoFocus:!0,children:[e.jsx("div",{className:A.shimmerBorder}),e.jsxs("div",{className:A.buttonInfo,children:[e.jsx("span",{className:A.buttonLabel,children:"ANTE"}),e.jsx("span",{className:A.buttonAmount,children:e.jsx($,{amount:l})})]})]}),e.jsxs("button",{className:`${A.backOutButton} ${A.sitOutHalfWidth}`,onClick:()=>{r||s&&t&&c&&(d(!0),s.emit("sitOut",{gameId:t.id,userId:s.auth?.userId||c.id}))},disabled:_?.isSittingOut||r,title:_?.isSittingOut?"You are currently sitting out":"Sit out next round","aria-label":"Sit Out","data-gamepad-focusable":"true",children:[e.jsx("div",{className:A.shimmerBorder}),e.jsx("div",{className:A.buttonInfo,children:e.jsx("span",{className:A.buttonLabel,children:"SIT OUT"})})]})]}),!u&&!p&&e.jsx("p",{className:A.notEnoughChipsText,children:"Not enough coins"})]})},Zs="_bettingOverlay_1q32g_2",en="_timerContainer_1q32g_26",tn="_betButton_1q32g_57",sn="_passButton_1q32g_84",nn="_amountButton_1q32g_96",an="_customButton_1q32g_108",on="_amountPill_1q32g_120",rn="_potButtonWrapper_1q32g_137",cn="_customInput_1q32g_142",ln="_betInput_1q32g_152",dn="_confirmButton_1q32g_172",un="_cancelButton_1q32g_173",k={bettingOverlay:Zs,timerContainer:en,betButton:tn,passButton:sn,amountButton:nn,customButton:an,amountPill:on,potButtonWrapper:rn,customInput:cn,betInput:ln,confirmButton:dn,cancelButton:un},mn="_potButton_1pkys_3",_n="_glowEffect_1pkys_37",pn="_potLabel_1pkys_53",gn="_currencyPill_1pkys_63",hn="_disabled_1pkys_102",K={potButton:mn,glowEffect:_n,potLabel:pn,currencyPill:gn,disabled:hn},xn=({amount:t,disabled:n,onClick:o,...s})=>e.jsxs("button",{className:`${K.potButton} ${n?K.disabled:""}`,onClick:o,disabled:n,"aria-label":`Bet the pot: ${t} chips`,"data-gamepad-focusable":"true",...s,children:[e.jsx("div",{className:K.glowEffect}),e.jsx("span",{className:K.potLabel,children:"POT"}),e.jsx("div",{className:K.currencyPill,children:e.jsx($,{amount:t,size:"small"})})]}),yn=({isCurrentPlayersTurn:t})=>{const{gameState:n,placeBet:o}=I(),[s,c]=m.useState(""),[r,d]=m.useState(!1),[a,l]=m.useState(!1);if(!n||!t)return e.jsx(re,{playerName:n?.players[n.currentPlayerId]?.name||"Player",action:"betting",duration:oe.BETTING_DURATION});const{pot:i,firstCard:_,secondCard:h,players:u,currentPlayerId:p,anteAmount:b=1}=n,v=u[p]?.balance||0,N=_?.value==="A"&&h?.value==="A",w=Math.floor(N?v/3:v/2),P=Math.min(i,w),g=b,G=[1,5,10,20,50,100].filter(B=>B>=g&&B<=P).slice(-3),W=B=>{a||B>=g&&B<=P&&(l(!0),o(B),d(!1))},pe=()=>{a||(l(!0),o(0))},ie=()=>{const B=parseInt(s);!isNaN(B)&&B>=g&&B<=P&&(W(B),c(""))};return e.jsxs("div",{className:`panel-game ${k.bettingOverlay}`,children:[e.jsx("div",{className:k.timerContainer,children:e.jsx(ce,{duration:30,isActive:!0})}),r?e.jsxs("div",{className:k.customInput,children:[e.jsx(me,{title:"Enter Custom Bet",type:"number",value:s,onChange:B=>c(B.target.value),onKeyPress:B=>B.key==="Enter"&&ie(),placeholder:`${g}-${P}`,min:g,max:P,autoFocus:!0,className:k.betInput}),e.jsx("button",{onClick:ie,className:k.confirmButton,disabled:a,"data-gamepad-focusable":"true",children:f.CHECK}),e.jsx("button",{onClick:()=>{d(!1),c("")},className:k.cancelButton,disabled:a,"data-gamepad-focusable":"true",children:f.CROSS})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{className:`${k.betButton} ${k.passButton}`,onClick:pe,disabled:a,"data-gamepad-focusable":"true",autoFocus:!0,children:e.jsx("span",{children:"PASS"})}),G.map(B=>e.jsx("button",{className:`${k.betButton} ${k.amountButton}`,onClick:()=>W(B),disabled:a,"data-gamepad-focusable":"true",children:e.jsx("div",{className:k.amountPill,children:e.jsx($,{amount:B,size:"small"})})},B)),P===i&&e.jsx("div",{className:k.potButtonWrapper,children:e.jsx(xn,{onClick:()=>W(i),disabled:a,amount:i})}),e.jsx("button",{className:`${k.betButton} ${k.customButton}`,onClick:()=>d(!0),disabled:a,"data-gamepad-focusable":"true",children:e.jsx("span",{children:"CUSTOM"})})]})]})},jn="_cardsRow_12pga_1",fn="_card_12pga_1",bn="_dealingPhase_12pga_74",Cn="_revealingPhase_12pga_83",vn="_cardBack_12pga_109",Nn="_redCard_12pga_119",Bn="_blackCard_12pga_123",Tn="_cardCorner_12pga_127",wn="_bottomRight_12pga_136",An="_cardValue_12pga_144",Sn="_cardSuit_12pga_150",kn="_cardCenter_12pga_155",In="_aceCard_12pga_212",Pn="_aceIndicator_12pga_216",Ln="_aceHigh_12pga_236",$n="_aceLow_12pga_242",En="_indicatorContent_12pga_248",C={cardsRow:jn,card:fn,dealingPhase:bn,revealingPhase:Cn,cardBack:vn,redCard:Nn,blackCard:Bn,cardCorner:Tn,bottomRight:wn,cardValue:An,cardSuit:Sn,cardCenter:kn,aceCard:In,aceIndicator:Pn,aceHigh:Ln,aceLow:$n,indicatorContent:En},On=()=>{const{gameState:t}=I(),[n,o]=m.useState(le());if(m.useEffect(()=>{const u=()=>{o(le())};return window.addEventListener("cardbackchange",u),()=>window.removeEventListener("cardbackchange",u)},[]),!t)return e.jsx("div",{className:C.loading,children:"Loading game state..."});const{firstCard:s,secondCard:c,thirdCard:r,phase:d}=t,a={2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10",J:"J",Q:"Q",K:"K",A:"A"},l={hearts:f.HEARTS,diamonds:f.DIAMONDS,clubs:f.CLUBS,spades:f.SPADES,[f.HEARTS]:f.HEARTS,[f.DIAMONDS]:f.DIAMONDS,[f.CLUBS]:f.CLUBS,[f.SPADES]:f.SPADES},i=u=>u===f.HEARTS||u===f.DIAMONDS||u==="hearts"||u==="diamonds",_=(u,p)=>{if(!u)return e.jsx("div",{className:C.card,children:e.jsx("div",{className:C.cardBack,style:{backgroundImage:`url(${n})`}})},`empty-${p}`);const b=i(u.suit),x=u.value==="A",v=u.isAceLow,N=p===1;return e.jsxs("div",{className:`${C.card} ${b?C.redCard:C.blackCard} ${x?C.aceCard:""}`,children:[x&&!N&&e.jsx("div",{className:`${C.aceIndicator} ${v?C.aceLow:C.aceHigh} ${b?C.redCard:C.blackCard}`,children:v?e.jsxs("span",{className:C.indicatorContent,children:["LOW ",f.ARROW_DOWN]}):e.jsxs("span",{className:C.indicatorContent,children:["HIGH ",f.ARROW_UP]})}),e.jsxs("div",{className:C.cardCorner,children:[e.jsx("div",{className:C.cardValue,children:a[u.value]}),e.jsx("div",{className:C.cardSuit,children:l[u.suit]})]}),e.jsx("div",{className:C.cardCenter,children:l[u.suit]}),e.jsxs("div",{className:`${C.cardCorner} ${C.bottomRight}`,children:[e.jsx("div",{className:C.cardValue,children:a[u.value]}),e.jsx("div",{className:C.cardSuit,children:l[u.suit]})]})]},`${u.value}-${u.suit}-${p}`)},h=()=>{const u=[null,null,null];return!s&&!c&&!r?u.map((p,b)=>_(p,b)):(s&&(u[0]={...s}),c&&(u[2]={...c}),r&&(u[1]={...r}),u.map((p,b)=>_(p,b)))};return e.jsx("div",{className:`${C.cardsRow} ${d==="dealing"?C.dealingPhase:""} ${d==="revealing"?C.revealingPhase:""}`,children:h()})},Rn="_imBackOverlay_1wm7i_3",Mn="_container_1wm7i_11",Dn="_sittingOutText_1wm7i_21",Gn="_imBackButton_1wm7i_30",Fn="_buttonText_1wm7i_48",zn="_helpText_1wm7i_66",q={imBackOverlay:Rn,container:Mn,sittingOutText:Dn,imBackButton:Gn,buttonText:Fn,helpText:zn},qn=({onClick:t,disabled:n=!1})=>e.jsx("div",{className:q.imBackOverlay,children:e.jsxs("div",{className:q.container,children:[e.jsx("h3",{className:q.sittingOutText,children:"You are sitting out"}),e.jsx("button",{className:q.imBackButton,onClick:t,disabled:n,"data-gamepad-focusable":"true",autoFocus:!0,children:e.jsx("span",{className:q.buttonText,children:"I'M BACK!"})}),e.jsx("p",{className:q.helpText,children:"Click to rejoin the game"})]})}),Un="_potDisplay_1o95d_2",Hn="_potLabel_1o95d_18",de={potDisplay:Un,potLabel:Hn},Wn=()=>{const{gameState:t}=I();if(!t)return null;const{pot:n=0}=t;return e.jsxs("div",{className:de.potDisplay,children:[e.jsx("span",{className:de.potLabel,children:"POT"}),e.jsx($,{amount:n,size:"large"})]})},Yn="_resultsContainer_upvys_2",Vn="_messageArea_upvys_11",Jn="_resultBar_upvys_22",Kn="_playerName_upvys_66",Qn="_resultText_upvys_71",Xn="_winBar_upvys_78",Zn="_winAmount_upvys_82",ea="_lossBar_upvys_91",ta="_lossAmount_upvys_95",sa="_penaltyBar_upvys_104",na="_penaltyText_upvys_108",aa="_penaltyAmount_upvys_114",oa="_animationContainer_upvys_124",ra="_cautionTapeContainer_upvys_132",ca="_cautionTape_upvys_132",j={resultsContainer:Yn,messageArea:Vn,resultBar:Jn,playerName:Kn,resultText:Qn,winBar:Xn,winAmount:Zn,lossBar:ea,lossAmount:ta,penaltyBar:sa,penaltyText:na,penaltyAmount:aa,animationContainer:oa,cautionTapeContainer:ra,cautionTape:ca},ia="_rainContainer_fxhyg_2",la="_fallingItem_fxhyg_10",da="_emoji_fxhyg_18",ua="_confetti_fxhyg_26",U={rainContainer:ia,fallingItem:la,emoji:da,confetti:ua},se=({type:t="emoji",items:n=[],count:o=10,animationDuration:s=2.5,className:c=""})=>{const r=d=>{const a=d/o*s,l=(Math.random()-.5)*.3,i=a+l,_=Math.random()*100;switch(t){case"coin":return e.jsx("div",{className:U.fallingItem,style:{left:`${_}%`,animationDelay:`${i}s`,"--animation-duration":`${s}s`},children:e.jsx(Ae,{size:"large"})},d);case"confetti":const h=n.length>0?n:["#ffd700","#ffed4e","#fff","#ff6b6b","#4CAF50"];return e.jsx("div",{className:`${U.fallingItem} ${U.confetti}`,style:{left:`${_}%`,animationDelay:`${i}s`,"--animation-duration":`${s*1.2}s`,backgroundColor:h[Math.floor(Math.random()*h.length)]}},d);case"emoji":default:const u=n.length>0?n:["ğŸ‰"];return e.jsx("div",{className:U.fallingItem,style:{left:`${_}%`,animationDelay:`${i}s`,"--animation-duration":`${s}s`},children:e.jsx("span",{className:U.emoji,children:u[Math.floor(Math.random()*u.length)]})},d)}};return e.jsx("div",{className:`${U.rainContainer} ${c}`,children:[...Array(o)].map((d,a)=>r(a))})},ma=({result:t,players:n})=>{if(!t)return null;const o=n[t.playerId]?.name||"Player",s=t.outcome;if(s==="win"){const a=t.winnings||0,l=Math.min(a/500,1),i=Math.floor(10+l*40),_=Math.floor(5+l*20);return e.jsxs("div",{className:j.resultsContainer,children:[e.jsxs("div",{className:j.animationContainer,children:[e.jsx(se,{type:"confetti",count:i,animationDuration:3,items:["#ffd700","#ffed4e","#fff","#ff6b6b","#4CAF50"]}),e.jsx(se,{type:"coin",count:_,animationDuration:2})]}),e.jsx("div",{className:j.messageArea,children:e.jsxs("div",{className:`panel ${j.resultBar} ${j.winBar}`,children:[e.jsx("span",{className:j.playerName,children:e.jsx(H,{username:o})}),e.jsx("span",{className:j.resultText,children:"WINS"}),t.winnings&&t.winnings>0&&e.jsx("span",{className:j.winAmount,children:e.jsx($,{amount:t.winnings/2,size:"small"})})]})})]})}if(s==="lose"){const a=t.betAmount||0,l=Math.min(a/500,1),i=Math.floor(8+l*22),_=["ğŸ˜¢","ğŸ˜”","ğŸ˜•","ğŸ‘","ğŸ“‰","ğŸ’”","ğŸ—‘ï¸","ğŸ¤¦â€â™‚ï¸"],h=["ğŸ˜­","ğŸ˜©","ğŸ¤¦","ğŸ’¸","ğŸ“‰","ğŸ˜¤","ğŸ˜£","ğŸ—‘ï¸","ğŸ¤¡","ğŸ’©","ğŸ™ˆ"],u=["ğŸ¤¡","ğŸ’©","ğŸ˜‚","ğŸ¤£","ğŸ—‘ï¸","ğŸ’€","â˜ ï¸","ğŸª¦","âš°ï¸","ğŸ¤ª","ğŸ˜µâ€ğŸ’«","ğŸ™ƒ","ğŸ¤®"];let p;return a<50?p=_:a<200?p=h:p=u,e.jsxs("div",{className:j.resultsContainer,children:[e.jsx("div",{className:j.animationContainer,children:e.jsx(se,{type:"emoji",items:p,count:i,animationDuration:2.5})}),e.jsx("div",{className:j.messageArea,children:e.jsxs("div",{className:`panel ${j.resultBar} ${j.lossBar}`,children:[e.jsx("span",{className:j.playerName,children:e.jsx(H,{username:o})}),e.jsx("span",{className:j.resultText,children:"LOST"}),t.betAmount&&t.betAmount>0&&e.jsx("span",{className:j.lossAmount,children:e.jsx($,{amount:t.betAmount,size:"small"})})]})})]})}const c=(t.betAmount||0)*(t.isTripleAceTie?3:2),r=t.isTripleAceTie?15:8,d=t.isTripleAceTie?["ğŸ’€","â˜ ï¸","âš ï¸","ğŸš¨","â›”","ğŸ’¥","ğŸ”¥","ğŸ˜±","ğŸ°","ğŸ’¸"]:["âš ï¸","ğŸš¨","â›”","ğŸ”´","âŒ","ğŸ’¥","ğŸ¯","ğŸ²"];return e.jsxs("div",{className:j.resultsContainer,children:[e.jsxs("div",{className:j.cautionTapeContainer,children:[e.jsxs("div",{className:j.cautionTape,children:[e.jsx("span",{children:t.isTripleAceTie?"TRIPLE PENALTY":"PENALTY"}),e.jsx("span",{children:t.isTripleAceTie?"TRIPLE PENALTY":"PENALTY"}),e.jsx("span",{children:t.isTripleAceTie?"TRIPLE PENALTY":"PENALTY"})]}),e.jsxs("div",{className:j.cautionTape,children:[e.jsx("span",{children:t.isTripleAceTie?"TRIPLE PENALTY":"PENALTY"}),e.jsx("span",{children:t.isTripleAceTie?"TRIPLE PENALTY":"PENALTY"}),e.jsx("span",{children:t.isTripleAceTie?"TRIPLE PENALTY":"PENALTY"})]})]}),e.jsx("div",{className:j.animationContainer,children:e.jsx(se,{type:"emoji",items:d,count:r,animationDuration:t.isTripleAceTie?2:3})}),e.jsx("div",{className:j.messageArea,children:e.jsxs("div",{className:`panel ${j.resultBar} ${j.penaltyBar}`,children:[e.jsx("span",{className:j.playerName,children:e.jsx(H,{username:o})}),e.jsx("span",{className:j.resultText,children:t.isTripleAceTie?"TRIPLE":""}),e.jsxs("span",{className:j.penaltyText,children:[t.isTripleAceTie?"3x":"2x"," PENALTY"]}),e.jsx("span",{className:j.penaltyAmount,children:e.jsx($,{amount:c,size:"small"})})]})})]})},_a="_revealingOverlay_hpopv_2",pa="_revealingContent_hpopv_26",ga="_playerName_hpopv_35",ha="_actionText_hpopv_43",xa="_betAmount_hpopv_51",Q={revealingOverlay:_a,revealingContent:pa,playerName:ga,actionText:ha,betAmount:xa},ya=({playerName:t,betAmount:n})=>!t||!n?null:e.jsx("div",{className:`panel-game ${Q.revealingOverlay}`,children:e.jsxs("div",{className:Q.revealingContent,children:[e.jsx("span",{className:Q.playerName,children:e.jsx(H,{username:t})}),e.jsx("span",{className:Q.actionText,children:"bets"}),e.jsx("div",{className:Q.betAmount,children:e.jsx($,{amount:n,size:"small"})})]})}),ja="_secondChanceOverlay_1sq4x_2",fa="_bridge_1sq4x_13",ba="_bridgeLine_1sq4x_20",Ca="_matchBadge_1sq4x_57",va="_matchText_1sq4x_69",Na="_choiceContainer_1sq4x_78",Ba="_timer_1sq4x_87",Ta="_buttons_1sq4x_106",wa="_choiceButton_1sq4x_112",Aa="_anteButton_1sq4x_139",Sa="_passButton_1sq4x_151",ka="_buttonIcon_1sq4x_162",Ia="_buttonText_1sq4x_168",Pa="_buttonAmount_1sq4x_174",La="_waitingContainer_1sq4x_180",$a="_waitingMessage_1sq4x_187",Ea="_secondChanceBottom_1sq4x_229",Oa="_timerContainer_1sq4x_243",Ra="_bottomButtonContainer_1sq4x_251",Ma="_choicePrompt_1sq4x_258",Da="_bottomChoiceButton_1sq4x_267",Ga="_anteButtonBottom_1sq4x_293",Fa="_passButtonBottom_1sq4x_302",y={secondChanceOverlay:ja,bridge:fa,bridgeLine:ba,matchBadge:Ca,matchText:va,choiceContainer:Na,timer:Ba,buttons:Ta,choiceButton:wa,anteButton:Aa,passButton:Sa,buttonIcon:ka,buttonText:Ia,buttonAmount:Pa,waitingContainer:La,waitingMessage:$a,secondChanceBottom:Ea,timerContainer:Oa,bottomButtonContainer:Ra,choicePrompt:Ma,bottomChoiceButton:Da,anteButtonBottom:Ga,passButtonBottom:Fa},ue=({isCurrentPlayersTurn:t,bottomPosition:n=!1,indicatorOnly:o=!1})=>{const{gameState:s}=I(),{socket:c}=R(),[r,d]=m.useState(null),{anteAmount:a=1,players:l,currentPlayerId:i}=s,h=l[i]?.name||"Player",u=p=>{r===null&&c&&(d(p),c.emit("secondChance",{anteAgain:p}))};return o?null:n?t?e.jsxs("div",{className:`panel-game ${y.secondChanceBottom}`,children:[e.jsx("div",{className:y.timerContainer,children:e.jsx(ce,{duration:15,isActive:!0})}),e.jsxs("div",{className:y.bottomButtonContainer,children:[e.jsx("span",{className:y.choicePrompt,children:"SECOND CHANCE:"}),e.jsxs("button",{className:`${y.bottomChoiceButton} ${y.anteButtonBottom}`,onClick:()=>u(!0),disabled:r!==null,"data-gamepad-focusable":"true",autoFocus:!0,children:[e.jsx("span",{className:y.buttonIcon,children:f.ROTATE}),e.jsx("span",{children:"ANTE AGAIN"}),e.jsx($,{amount:a,size:"small"})]}),e.jsxs("button",{className:`${y.bottomChoiceButton} ${y.passButtonBottom}`,onClick:()=>u(!1),disabled:r!==null,"data-gamepad-focusable":"true",children:[e.jsx("span",{children:"PASS"}),e.jsx("span",{className:y.buttonIcon,children:f.ARROW_RIGHT})]})]})]}):e.jsx(re,{playerName:h,action:"deciding on second chance",duration:oe.DECISION_DURATION}):e.jsxs("div",{className:y.secondChanceOverlay,children:[e.jsxs("div",{className:y.bridge,children:[e.jsx("div",{className:y.bridgeLine}),e.jsx("div",{className:y.matchBadge,children:e.jsx("span",{className:y.matchText,children:"MATCH!"})})]}),t?e.jsxs("div",{className:y.choiceContainer,children:[e.jsxs("div",{className:y.timer,children:[countdown,"s"]}),e.jsxs("div",{className:y.buttons,children:[e.jsxs("button",{className:`${y.choiceButton} ${y.anteButton}`,onClick:()=>u(!0),disabled:r!==null,"data-gamepad-focusable":"true",autoFocus:!0,children:[e.jsx("span",{className:y.buttonIcon,children:f.ROTATE}),e.jsx("span",{className:y.buttonText,children:"ANTE AGAIN"}),e.jsx("span",{className:y.buttonAmount,children:e.jsx($,{amount:a,size:"small"})})]}),e.jsxs("button",{className:`${y.choiceButton} ${y.passButton}`,onClick:()=>u(!1),disabled:r!==null,"data-gamepad-focusable":"true",children:[e.jsx("span",{className:y.buttonText,children:"PASS"}),e.jsx("span",{className:y.buttonIcon,children:f.ARROW_RIGHT})]})]})]}):e.jsx("div",{className:y.waitingContainer,children:e.jsxs("div",{className:y.waitingMessage,children:[h," is deciding..."]})})]})},za=()=>{const{gameState:t}=I(),{socket:n}=R(),{user:o}=X(),[s,c]=m.useState(!1);if(!t)return null;const{phase:r,currentPlayerId:d,players:a,waitingForAceDecision:l,waitingForSecondChance:i,firstCard:_,secondCard:h,result:u}=t,p=o?.id,b=a&&p?a[p]:null,x=p===d,v=b?.isSittingOut||!1,N=()=>{s||n&&t.id&&(c(!0),n.emit("imBack",{gameId:t.id}))};return e.jsxs("div",{className:ee.table,children:[e.jsx("div",{className:ee.feltTexture}),e.jsx(Wn,{}),e.jsx(On,{}),l&&e.jsx("div",{className:ee.aceGlowEffect}),i&&e.jsx(ue,{firstCard:_,secondCard:h,isCurrentPlayersTurn:x,indicatorOnly:!0}),!v&&e.jsxs(e.Fragment,{children:[r==="betting"&&!l&&!i&&e.jsx(yn,{isCurrentPlayersTurn:x}),l&&e.jsx(Os,{card:_,isCurrentPlayersTurn:x,bottomPosition:!0}),i&&e.jsx(ue,{firstCard:_,secondCard:h,isCurrentPlayersTurn:x,bottomPosition:!0})]}),r==="revealing"&&!v&&e.jsx(ya,{playerName:a[d]?.name||"Player",betAmount:a[d]?.currentBet||0}),r==="results"&&u&&!v&&e.jsx(ma,{result:u,players:a}),r==="waiting"&&!v&&e.jsx(Xs,{}),v&&e.jsx("div",{className:ee.sitOutOverlay,children:e.jsx(qn,{onClick:N,disabled:s})})]})},qa=({onReturnToLobby:t})=>{const[n,o]=m.useState(!1),{gameState:s,error:c,clearError:r}=I();Se(!0),m.useEffect(()=>{if(c){const a=setTimeout(()=>{r()},1e4);return()=>clearTimeout(a)}},[c,r]);const d=()=>{t&&t()};return s?e.jsxs("div",{className:`screen app-gradient-bg ${F.gameContainer}`,children:[e.jsxs("div",{className:`${F.gameScreen} mobile-scale-content`,children:[e.jsx(dt,{handleLeaveGame:d,onModalStateChange:o}),c&&e.jsx("div",{className:F.errorContainer,children:e.jsx("p",{className:F.errorText,children:c})}),e.jsx(za,{}),e.jsxs("div",{className:F.gameBottomSection,children:[e.jsx(os,{}),e.jsx(Ut,{})]})]}),!n&&e.jsx(Ke,{})]}):e.jsx("div",{className:F.loadingContainer,children:e.jsx("p",{children:"Loading game state..."})})},Ka=()=>{const{gameId:t}=ye(),n=je(),{socket:o,isConnected:s}=R(),[c,r]=m.useState(!0),[d,a]=m.useState(null),[l,i]=m.useState(!1),_=m.useRef(!1),h=m.useCallback(()=>{o&&s&&t&&(ae.play("ui.leave"),o.emit("leaveGame",{gameId:t}),n("/"))},[o,s,t,n]),u=m.useCallback(x=>{i(!1),o&&t&&x&&(a(null),o.emit("joinGame",{gameId:t,password:x}),r(!0))},[o,t]),p=m.useCallback(()=>{i(!1),n("/")},[n]);m.useEffect(()=>{a(null),i(!1),r(!0)},[t]),m.useEffect(()=>{if(!o)return;const x=N=>{N&&N.game&&N.game.id===t&&(ae.play("ui.join"),r(!1),a(null),i(!1))},v=N=>{const w=N.message||"An unknown error occurred";w==="Password required"?(console.error(N),i(!0),r(!1),a(null)):w==="Invalid password"?(console.error(N),a("Invalid password."),i(!0),r(!1)):w==="Game not found"?n("/"):w==="Game is full"?(a(w),r(!1),i(!1),setTimeout(()=>n("/"),3e3)):(a(w),r(!1),i(!1))};return o.on("gameJoined",x),o.on("error",v),()=>{o.off("gameJoined",x),o.off("error",v)}},[o,t,n]),m.useEffect(()=>{o&&t&&!_.current&&(_.current=!0,r(!0),a(null),i(!1),o.emit("joinGame",{gameId:t}))},[o,t]);const b=()=>{const{gameState:x}=I(),{socket:v}=R();return m.useEffect(()=>{const N=w=>{const P=v?.auth?.userId;if((P&&x?.players?x.players[P]:null)?.isReady||!1)return w.preventDefault(),w.returnValue="You have money in the pot! Are you sure you want to leave?",w.returnValue};return window.addEventListener("beforeunload",N),()=>{window.removeEventListener("beforeunload",N)}},[x,v]),e.jsxs(e.Fragment,{children:[e.jsx(Me,{isOpen:l,onClose:p,onSubmit:u,gameId:t}),c&&e.jsx(xe,{message:`Joining game ${t}...`}),d&&!c&&!l&&e.jsxs("div",{className:"error-container",style:{padding:"20px",color:"red",textAlign:"center"},children:[e.jsx("h2",{children:"An error occurred"}),e.jsx("p",{children:d}),e.jsx("button",{onClick:()=>window.location.reload(),children:"Refresh Page"})]}),!c&&!d&&x&&e.jsx(qa,{onReturnToLobby:h})]})};return e.jsx(ke,{gameId:t,children:e.jsx(b,{})})};export{Ka as default};
