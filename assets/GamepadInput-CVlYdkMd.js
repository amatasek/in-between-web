import{M as e,R as ce,I as ae,X as le,O as K,$ as I,a0 as de,a1 as ue,T as U,Y as pe,N as me}from"./index-rZxL1wAD.js";import{b as d}from"./vendor-ByZL_ylL.js";const ge="_coinIcon_isycs_1",he="_small_isycs_13",ye="_medium_isycs_17",xe="_large_isycs_21",se={coinIcon:ge,small:he,medium:ye,large:xe},fe=({size:s="small",className:a=""})=>{const n={small:15,medium:19,large:24},t=n[s]||n.small,r=d.useMemo(()=>`goldGradient-${Math.random().toString(36).substr(2,9)}`,[]),p=d.useMemo(()=>`goldShine-${Math.random().toString(36).substr(2,9)}`,[]);return e.jsx("span",{className:`${se.coinIcon} ${se[s]} ${a}`,children:e.jsxs("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:r,x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#FFD700"}),e.jsx("stop",{offset:"50%",stopColor:"#FFA500"}),e.jsx("stop",{offset:"100%",stopColor:"#FF8C00"})]}),e.jsxs("linearGradient",{id:p,x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#FFED4E"}),e.jsx("stop",{offset:"100%",stopColor:"#FFD700"})]})]}),e.jsx("path",{d:"M12 2L22 12L12 22L2 12L12 2Z",fill:`url(#${r})`,stroke:"#D4AF37",strokeWidth:"0.5"}),e.jsx("path",{d:"M12 5L18 12L12 18L6 12L12 5Z",fill:`url(#${p})`,opacity:"0.6"}),e.jsx("path",{d:"M12 2L16 6L12 8L8 6L12 2Z",fill:"#FFFACD",opacity:"0.7"})]})})},be="_userAvatarContainer_32qpa_1",_e="_containerRight_32qpa_6",ve="_containerBelow_32qpa_11",je="_avatar_32qpa_16",we="_small_32qpa_34",ke="_medium_32qpa_40",Ne="_large_32qpa_46",Ce="_avatarImageContainer_32qpa_52",Se="_avatarImage_32qpa_52",Pe="_initialsPlaceholder_32qpa_70",Ie="_userInfo_32qpa_84",Ae="_username_32qpa_92",Te="_userTitle_32qpa_101",$e="_playerCard_32qpa_120",Be="_cardAppear_32qpa_1",Le="_playerCardAvatar_32qpa_149",Me="_playerCardImage_32qpa_158",Ee="_playerCardInitials_32qpa_166",Ue="_playerCardInfo_32qpa_180",De="_playerCardUsername_32qpa_189",Re="_playerCardTitle_32qpa_197",ze="_playerCardXP_32qpa_205",Fe="_playerCardLevelXP_32qpa_213",He="_separator_32qpa_221",Ge="_xpValue_32qpa_225",Oe="_loading_32qpa_230",qe="_shimmerBg_32qpa_1",We="_avatarLoader_32qpa_236",Ve="_shimmerOverlay_32qpa_1",Xe="_skeletonUsername_32qpa_245",Ke="_skeletonTitle_32qpa_255",Ye="_shimmerText_32qpa_1",j={userAvatarContainer:be,containerRight:_e,containerBelow:ve,avatar:je,small:we,medium:ke,large:Ne,avatarImageContainer:Ce,avatarImage:Se,initialsPlaceholder:Pe,userInfo:Ie,username:Ae,userTitle:Te,playerCard:$e,cardAppear:Be,playerCardAvatar:Le,playerCardImage:Me,playerCardInitials:Ee,playerCardInfo:Ue,playerCardUsername:De,playerCardTitle:Re,playerCardXP:ze,playerCardLevelXP:Fe,separator:He,xpValue:Ge,loading:Oe,shimmerBg:qe,avatarLoader:We,shimmerOverlay:Ve,skeletonUsername:Xe,skeletonTitle:Ke,shimmerText:Ye},Ze=({userId:s,size:a="medium",showName:n=!0,namePosition:t="right",className:r="",showTitle:p=!0,fontWeight:c="normal"})=>{const[g,x]=d.useState(!1),C=ce(s);if(!s)return null;if(!C){const A=j[a]||j.medium,L=n?j[`container${t.charAt(0).toUpperCase()+t.slice(1)}`]:"";return e.jsxs("div",{className:`${j.userAvatarContainer} ${L} ${r}`,children:[e.jsx("div",{className:`${j.avatar} ${A} ${j.loading}`,children:e.jsx("div",{className:j.avatarLoader})}),n&&e.jsxs("div",{className:j.userInfo,children:[e.jsx("div",{className:j.skeletonUsername}),p&&e.jsx("div",{className:j.skeletonTitle})]})]})}const{username:h,profileImg:l,title:u,xp:f,level:y}=C,m=Je(h||"Unknown"),b=j[a]||j.medium,S=n?j[`container${t.charAt(0).toUpperCase()+t.slice(1)}`]:"",o="https://api.in-between.live";let v=null;if(l)if(l.startsWith("http"))v=l;else if(l.includes("/uploads/")){const A=l.split("/").pop();v=`${o}/files/images/${A}`}else v=`${o}${l}`;return e.jsxs("div",{className:`${j.userAvatarContainer} ${S} ${r}`,children:[e.jsxs("div",{className:`${j.avatar} ${b}`,onMouseEnter:()=>x(!0),onMouseLeave:()=>x(!1),children:[e.jsxs("div",{className:j.avatarImageContainer,children:[v?e.jsx("img",{src:v,alt:`${h}'s avatar`,className:j.avatarImage,onError:A=>{console.error(`Failed to load profile image for ${h}:`,A),A.target.style.display="none",A.target.nextSibling.style.display="flex"}}):null,e.jsx("div",{className:j.initialsPlaceholder,style:{display:v?"none":"flex"},children:m})]}),g&&e.jsxs("div",{className:j.playerCard,children:[e.jsx("div",{className:j.playerCardAvatar,children:v?e.jsx("img",{src:v,alt:`${h}'s avatar`,className:j.playerCardImage}):e.jsx("div",{className:j.playerCardInitials,children:m})}),e.jsxs("div",{className:j.playerCardInfo,children:[e.jsx("div",{className:j.playerCardUsername,children:h||"Unknown"}),u&&e.jsx("div",{className:j.playerCardTitle,children:u}),y!==void 0&&f!==void 0&&e.jsxs("div",{className:j.playerCardLevelXP,children:["Level ",y," ",e.jsx("span",{className:j.separator,children:"•"})," ",e.jsxs("span",{className:j.xpValue,children:[Qe(f)," XP"]})]})]})]})]}),n&&e.jsxs("div",{className:j.userInfo,children:[e.jsx("div",{className:j.username,style:{fontWeight:c},children:h||"Unknown"}),p&&u&&e.jsx("div",{className:j.userTitle,children:u})]})]})},Je=s=>s.split(" ").map(a=>a.charAt(0)).join("").toUpperCase().substring(0,2),Qe=s=>s>=1e6?(s/1e6).toFixed(1).replace(/\.0$/,"")+"M":s>=1e3?(s/1e3).toFixed(1).replace(/\.0$/,"")+"K":s.toString(),ea="_currencyAmount_rl73n_1",aa="_pillBackground_rl73n_17",ta="_darkBackground_rl73n_28",J={currencyAmount:ea,pillBackground:aa,darkBackground:ta},F=({amount:s=0,size:a,background:n,customClass:t})=>{const r=[J.currencyAmount,n==="dark"?J.darkBackground:"",n==="pill"?J.pillBackground:"",t||""].filter(Boolean).join(" "),p=typeof s=="number"?s:0;return e.jsxs("span",{className:r,children:[e.jsx(fe,{size:a}),e.jsx("span",{children:p.toLocaleString()})]})},sa=({className:s="h-6 w-6",...a})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:s,...a,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.004.827c-.29.24-.438.613-.431.992a6.759 6.759 0 010 1.905c-.007.378.141.75.431.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.29-.24.438-.613.43-.992a6.932 6.932 0 010-1.905c.007-.378-.14-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281zM15 12a3 3 0 11-6 0 3 3 0 016 0z"})}),na="_toggleContainer_1gama_1",ra="_toggleInput_1gama_5",oa="_toggleLabel_1gama_11",la="_toggleSlider_1gama_17",ia="_toggleText_1gama_65",q={toggleContainer:na,toggleInput:ra,toggleLabel:oa,toggleSlider:la,toggleText:ia},ne=({isChecked:s,onChange:a,label:n})=>e.jsx("div",{className:q.toggleContainer,children:e.jsxs("label",{className:q.toggleLabel,children:[e.jsx("input",{type:"checkbox",checked:s,onChange:a,className:q.toggleInput,"data-gamepad-focusable":"true"}),e.jsx("span",{className:q.toggleSlider}),n&&e.jsx("span",{className:q.toggleText,children:n})]})}),ca="_fileUploadContainer_z5fvc_1",da="_fileInput_z5fvc_8",ua="_uploadButton_z5fvc_12",pa="_changeButton_z5fvc_37",ma="_previewContainer_z5fvc_53",ga="_imagePreview_z5fvc_61",ha="_audioPreview_z5fvc_70",ya="_errorMessage_z5fvc_76",M={fileUploadContainer:ca,fileInput:da,uploadButton:ua,changeButton:pa,previewContainer:ma,imagePreview:ga,audioPreview:ha,errorMessage:ya},xa=({onUpload:s,currentFileUrl:a,acceptedFileTypes:n,label:t,previewType:r="image"})=>{const[p,c]=d.useState(!1),[g,x]=d.useState(null),C=d.useRef(null),h=async f=>{const y=f.target.files[0];if(!y){console.error("[FileUpload] No file selected");return}console.log("[FileUpload] File selected:",{name:y.name,type:y.type,size:y.size}),x(null),c(!0);try{console.log("[FileUpload] Calling onUpload function");const m=await s(y);console.log("[FileUpload] Upload result:",m),m?console.log("[FileUpload] Upload successful"):(console.error("[FileUpload] Upload failed"),x("Failed to upload file. Please try again."))}catch(m){console.error("[FileUpload] Error uploading file:",m),x("An error occurred during upload.")}finally{c(!1)}},l=()=>{C.current.click()},u=()=>a?r==="image"?e.jsx("div",{className:M.previewContainer,children:e.jsx("img",{src:a,alt:"Preview",className:M.imagePreview})}):r==="audio"?e.jsx("div",{className:M.previewContainer,children:e.jsx("audio",{controls:!0,src:a,className:M.audioPreview,children:"Your browser does not support the audio element."})}):null:null;return e.jsxs("div",{className:M.fileUploadContainer,children:[e.jsx("input",{type:"file",ref:C,onChange:h,accept:n,className:M.fileInput}),a&&u(),e.jsx("button",{type:"button",onClick:l,className:`${M.uploadButton} ${a?M.changeButton:""}`,disabled:p,"data-gamepad-focusable":"true",children:p?"Uploading...":a?`Change ${t}`:`Upload ${t}`}),g&&e.jsx("div",{className:M.errorMessage,children:g})]})},fa=()=>{const{token:s}=ae(),{preferences:a,updateSelectedTitle:n}=le(),[t,r]=d.useState([]),[p,c]=d.useState(!0),[g,x]=d.useState(null);d.useEffect(()=>{C()},[]);const C=async()=>{try{c(!0);const l=await fetch(`${K}/me/titles`,{headers:{Authorization:`Bearer ${s}`}});if(!l.ok)throw new Error("Failed to load titles");const u=await l.json();r(u)}catch(l){x(l.message)}finally{c(!1)}},h=async l=>{try{await n(l)}catch{x("Failed to update title")}};return p?e.jsx("div",{className:I.loadingMessage,children:"Loading titles..."}):g?e.jsx("div",{className:I.errorMessage,children:g}):t.length===0?e.jsx("div",{style:{textAlign:"center",padding:"20px",color:"var(--text-muted)"},children:"No titles unlocked yet. Play games to earn achievements!"}):e.jsxs("div",{style:{display:"block",width:"100%",overflowX:"auto",overflowY:"hidden",whiteSpace:"nowrap",paddingBottom:"8px",padding:"6px"},children:[e.jsxs("div",{onClick:()=>h(""),tabIndex:0,"data-gamepad-focusable":"true",onKeyDown:l=>{(l.key==="Enter"||l.key===" ")&&(l.preventDefault(),h(""))},style:{display:"inline-flex",width:"120px",height:"36px",padding:"8px",margin:"0 8px 0 0",borderRadius:"6px",cursor:"pointer",textAlign:"center",backgroundColor:a.selectedTitle?"rgba(255, 255, 255, 0.08)":"var(--btn-tertiary-shadow)",border:a.selectedTitle?"2px solid rgba(255, 255, 255, 0.15)":"2px solid var(--btn-tertiary-start)",verticalAlign:"top",whiteSpace:"normal",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[e.jsx("div",{style:{fontWeight:"bold",color:"var(--text-primary)",fontSize:"13px"},children:"No Title"}),e.jsx("div",{style:{color:"var(--text-muted)",fontSize:"10px",marginTop:"2px"},children:"Display no title"})]}),t.map(l=>e.jsxs("div",{onClick:()=>h(l.title),tabIndex:0,"data-gamepad-focusable":"true",onKeyDown:u=>{(u.key==="Enter"||u.key===" ")&&(u.preventDefault(),h(l.title))},style:{display:"inline-flex",flexDirection:"column",justifyContent:"center",alignItems:"center",width:"130px",height:"36px",padding:"8px",margin:"0 8px 0 0",borderRadius:"6px",cursor:"pointer",textAlign:"center",backgroundColor:a.selectedTitle===l.title?"var(--btn-tertiary-shadow)":"rgba(255, 255, 255, 0.08)",border:a.selectedTitle===l.title?"2px solid var(--btn-tertiary-start)":"2px solid rgba(255, 255, 255, 0.15)",verticalAlign:"top",whiteSpace:"normal"},children:[e.jsx("div",{style:{fontWeight:"bold",color:"var(--text-primary)",fontSize:"13px"},children:l.title}),e.jsx("div",{style:{color:"var(--text-muted)",fontSize:"10px",marginTop:"2px"},children:l.description})]},l.title)),t.length===0&&e.jsx("div",{style:{textAlign:"center",padding:"16px",color:"var(--text-muted)",backgroundColor:"rgba(255, 255, 255, 0.05)",borderRadius:"6px",border:"1px solid rgba(255, 255, 255, 0.1)",marginTop:"8px",whiteSpace:"normal"},children:"No titles unlocked yet. Play games to earn achievements!"})]})},ba=[{id:"default",name:"Default",description:"Classic blue theme",primary:"#1a2a3a",accent:"#3498db"},{id:"light",name:"Light Mode",description:"Professional theme",primary:"#f8f9fa",accent:"#ffc107"},{id:"dark",name:"Dark Mode",description:"Deep dark theme",primary:"#0d0d0d",accent:"#2980b9"},{id:"packers",name:"Packers",description:"Go Pack Go!",primary:"#203731",accent:"#FFB612"},{id:"sunset",name:"Sunset",description:"Romantic twilight",primary:"#0c1929",accent:"#ff6b6b"},{id:"miami-vice",name:"Miami Vice",description:"Neon pink & cyan",primary:"#1a0f2e",accent:"#00d2d3"},{id:"purple",name:"Royal Purple",description:"Elegant purple theme",primary:"#1a1a2e",accent:"#8e44ad"}],_a=()=>{const[s,a]=d.useState("default");d.useEffect(()=>{const t=de();a(t)},[]);const n=t=>{a(t),ue(t)};return e.jsx("div",{style:{display:"block",width:"100%",overflowX:"auto",overflowY:"hidden",whiteSpace:"nowrap",paddingBottom:"8px",padding:"6px"},children:ba.map(t=>e.jsxs("div",{onClick:()=>n(t.id),tabIndex:0,"data-gamepad-focusable":"true",onKeyDown:r=>{(r.key==="Enter"||r.key===" ")&&(r.preventDefault(),n(t.id))},style:{display:"inline-flex",flexDirection:"column",justifyContent:"center",alignItems:"center",width:"130px",height:"50px",padding:"8px",margin:"0 8px 0 0",borderRadius:"6px",cursor:"pointer",textAlign:"center",backgroundColor:s===t.id?"var(--btn-tertiary-shadow)":"rgba(255, 255, 255, 0.08)",border:s===t.id?"2px solid var(--btn-tertiary-start)":"2px solid rgba(255, 255, 255, 0.15)",verticalAlign:"top",whiteSpace:"normal",position:"relative"},children:[e.jsxs("div",{style:{position:"absolute",top:"6px",right:"6px",display:"flex",gap:"3px"},children:[e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:t.primary,border:"1px solid rgba(255,255,255,0.3)"}}),e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:t.accent,border:"1px solid rgba(255,255,255,0.3)"}})]}),e.jsx("div",{style:{fontWeight:"bold",color:"var(--text-primary)",fontSize:"13px"},children:t.name}),e.jsx("div",{style:{color:"var(--text-muted)",fontSize:"10px",marginTop:"2px"},children:t.description})]},t.id))})},ee={back01:"/cards/back01.png",back02:"/cards/back02.png",back03:"/cards/back03.png",back04:"/cards/back04.png",back05:"/cards/back05.png",back06:"/cards/back06.png",back07:"/cards/back07.png",back08:"/cards/back08.png"},ie=()=>localStorage.getItem("selectedCardBack")||"back01",es=()=>{const s=ie();return ee[s]||ee.back01},va=s=>{ee[s]&&(localStorage.setItem("selectedCardBack",s),window.dispatchEvent(new CustomEvent("cardbackchange",{detail:s})))},re=[{id:"back01",image:"/cards/back01.png"},{id:"back02",image:"/cards/back02.png"},{id:"back03",image:"/cards/back03.png"},{id:"back04",image:"/cards/back04.png"},{id:"back05",image:"/cards/back05.png"},{id:"back06",image:"/cards/back06.png"},{id:"back07",image:"/cards/back07.png"},{id:"back08",image:"/cards/back08.png"}],ja=()=>{const[s,a]=d.useState("back01");d.useEffect(()=>{const t=ie();a(t)},[]);const n=t=>{a(t),va(t)};return e.jsx("div",{style:{display:"flex",gap:"12px",overflowX:"auto",overflowY:"visible",paddingTop:"8px",paddingBottom:"8px",alignItems:"center",minHeight:"100px"},children:re.map((t,r)=>e.jsx("div",{onClick:()=>n(t.id),tabIndex:0,"data-gamepad-focusable":"true",onKeyDown:p=>{(p.key==="Enter"||p.key===" ")&&(p.preventDefault(),n(t.id))},style:{position:"relative",cursor:"pointer",flexShrink:0,transition:"transform 0.2s ease",transform:s===t.id?"scale(1.1)":"scale(1)",marginLeft:r===0?"8px":0,marginRight:r===re.length-1?"8px":0},children:e.jsx("div",{style:{width:"60px",height:"84px",backgroundImage:`url(${t.image})`,backgroundSize:"cover",backgroundPosition:"center",borderRadius:"6px",boxShadow:s===t.id?"0 0 0 3px var(--btn-tertiary-start), 0 4px 12px rgba(0,0,0,0.3)":"0 2px 8px rgba(0,0,0,0.2)",border:"1px solid rgba(255,255,255,0.1)"}})},t.id))})},wa=({onClose:s})=>{const{preferences:a,toggleAutoAnte:n,toggleMute:t,uploadProfileImg:r,loading:p}=le();return p?e.jsx(U,{title:"Preferences",onClose:s,style:{maxWidth:600,maxHeight:"25vh"},children:e.jsx("div",{className:I.loadingMessage,children:"Loading preferences..."})}):e.jsxs(U,{title:"Preferences",onClose:s,style:{maxWidth:600},children:[e.jsx("div",{className:I.sectionHeader,children:"Game Options"}),e.jsxs("div",{className:"panel-alt",style:{marginBottom:"20px",display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h4",{style:{margin:0},children:"Mute Sound"}),e.jsx(ne,{isChecked:a.muted,onChange:t})]}),e.jsxs("div",{className:"panel-alt",style:{marginBottom:"20px",display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h4",{style:{margin:0},children:"Auto-Ante"}),e.jsx(ne,{isChecked:a.autoAnte,onChange:n})]}),e.jsx("div",{className:I.sectionHeader,children:"Customization Options"}),e.jsxs("div",{className:"panel-alt",style:{marginBottom:"20px",display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h4",{style:{margin:0},children:"Profile Image"}),e.jsx(xa,{onUpload:r,currentFileUrl:a.profileImg,acceptedFileTypes:"image/jpeg,image/png,image/gif",label:"Image",previewType:"image"})]}),e.jsxs("div",{className:"panel-alt",style:{marginBottom:"20px"},children:[e.jsx("h4",{style:{margin:"0 0 12px 0"},children:"Title"}),e.jsx(fa,{})]}),e.jsxs("div",{className:"panel-alt",style:{marginBottom:"20px"},children:[e.jsx("h4",{style:{margin:"0 0 12px 0"},children:"Theme"}),e.jsx(_a,{})]}),e.jsxs("div",{className:"panel-alt",style:{marginBottom:"20px"},children:[e.jsx("h4",{style:{margin:"0 0 12px 0"},children:"Card Back"}),e.jsx(ja,{})]})]})},ka="_iconButton_3xp6j_1",Na="_danger_3xp6j_31",Ca="_preferences_3xp6j_44",Sa="_stats_3xp6j_57",Pa="_store_3xp6j_70",oe={iconButton:ka,default:"_default_3xp6j_18",danger:Na,preferences:Ca,stats:Sa,store:Pa},V=({icon:s,title:a,onClick:n,variant:t="default",compact:r=!0,className:p="",...c})=>e.jsx("button",{className:`${oe.iconButton} ${oe[t]} ${p}`,onClick:n,title:a,type:"button",...c,children:s}),as=({onModalStateChange:s})=>{const[a,n]=d.useState(!1),t=()=>{n(!0)},r=()=>{n(!1)};return d.useEffect(()=>{s&&s(a)},[a,s]),e.jsxs(e.Fragment,{children:[e.jsx(V,{onClick:t,icon:e.jsx(sa,{style:{color:"white",width:20,height:20}}),"aria-label":"Open Preferences",variant:"preferences",title:"Preferences","data-gamepad-focusable":"true"}),a&&e.jsx(wa,{isOpen:a,onClose:r})]})},Ia=({color:s="currentColor",size:a=24})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:a,height:a,viewBox:"0 0 24 24",fill:"none",stroke:s,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("line",{x1:"18",y1:"20",x2:"18",y2:"10"}),e.jsx("line",{x1:"12",y1:"20",x2:"12",y2:"4"}),e.jsx("line",{x1:"6",y1:"20",x2:"6",y2:"14"}),e.jsx("line",{x1:"3",y1:"20",x2:"21",y2:"20"})]}),Aa="_totalsTable_ugw0i_3",Ta="_settleUpTable_ugw0i_3",$a="_totalRow_ugw0i_9",Ba="_paymentRow_ugw0i_9",La="_playerName_ugw0i_18",Ma="_totalAmount_ugw0i_29",Ea="_paymentAmount_ugw0i_29",Ua="_positive_ugw0i_35",Da="_negative_ugw0i_39",Ra="_paymentText_ugw0i_43",za="_noDataMessage_ugw0i_54",Fa="_loadingMessage_ugw0i_61",$={totalsTable:Aa,settleUpTable:Ta,totalRow:$a,paymentRow:Ba,playerName:La,totalAmount:Ma,paymentAmount:Ea,positive:Ua,negative:Da,paymentText:Ra,noDataMessage:za,loadingMessage:Fa},Ha=({color:s="currentColor",size:a=24})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:a,height:a,viewBox:"0 0 24 24",fill:"none",stroke:s,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M14 3v4a1 1 0 0 0 1 1h4"}),e.jsx("path",{d:"M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z"}),e.jsx("path",{d:"M12 15 L12 18"}),e.jsx("path",{d:"M9.5 16.5 L12 19 L14.5 16.5"}),e.jsx("path",{d:"M8 10 L10 10"}),e.jsx("path",{d:"M12 10 L14 10"}),e.jsx("path",{d:"M16 10 L16 10"})]});let Y;try{Y=require("../../contexts/GameContext").useGameContext}catch{Y=()=>({gameState:null})}const Ga=({title:s="Download Transaction Log as CSV",gameState:a,...n})=>{let t;try{t=Y?Y():{gameState:null}}catch{t={gameState:null}}const r=a||t?.gameState,p=r?.gameTransactions||r?.gameData?.gameTransactions||[],c=r?._id||r?.id||"unknown",g=()=>{const x=Array.isArray(p)?p:[];if(x.length===0)return;let C=`Player,Transaction Type,Amount,Round,Timestamp
`;const h=[...x].map(y=>({...y,timestamp:y.timestamp?new Date(y.timestamp):new Date}));h.sort((y,m)=>y.timestamp-m.timestamp),h.forEach(y=>{const m=y.timestamp?new Date(y.timestamp).toLocaleString():"N/A",b=y.playerName||y.player||"Unknown Player",S=b.includes(",")?`"${b}"`:b;let o=y.transactionType||"Transaction";if(!y.transactionType&&y.reason){const v=y.reason.split(" ");o=v[0],v[0]==="Won"?o="Win":y.reason.includes("penalty")&&(o="Penalty")}C+=`${S},${o},${y.amount},${y.round||"N/A"},${m}
`});const l=new Blob([C],{type:"text/csv;charset=utf-8;"}),u=URL.createObjectURL(l),f=document.createElement("a");f.setAttribute("href",u),f.setAttribute("download",`game-${c}-transactions.csv`),f.style.visibility="hidden",document.body.appendChild(f),f.click(),document.body.removeChild(f)};return e.jsx(V,{icon:e.jsx(Ha,{color:"white",size:20}),title:s,onClick:g,variant:"default",...n})},Oa="_noDataMessage_13uuv_2",qa="_statsGrid_13uuv_9",Wa="_statLabel_13uuv_42",Va="_statValue_13uuv_49",Xa="_statSuffix_13uuv_57",W={noDataMessage:Oa,statsGrid:qa,statLabel:Wa,statValue:Va,statSuffix:Xa},Ka=({gameData:s})=>{const a=s.gameTransactions,n=s.players,t={};Object.entries(n).forEach(([c,g])=>{t[c]=g.name}),a.forEach(c=>{c.playerId&&!t[c.playerId]&&(t[c.playerId]=c.playerName||"Unknown Player")});const r=d.useMemo(()=>{if(a.length===0)return[];const c=i=>i.toLocaleString(),g={};a.forEach(i=>{g[i.playerId]||(g[i.playerId]=[]),g[i.playerId].push(i)});const x=s.round||1,C=s.deckCount||1,h=a.filter(i=>i.transactionType==="Ante").reduce((i,N)=>i+Math.abs(N.amount),0),l=a.filter(i=>i.transactionType==="Bet").reduce((i,N)=>i+Math.abs(N.amount),0),u=a.filter(i=>i.transactionType==="Bet"),f=u.length>0?u.reduce((i,N)=>Math.abs(N.amount)>Math.abs(i.amount)?N:i,u[0]):null,y=a.reduce((i,N)=>N.potAmount>i?N.potAmount:i,0),m=a.filter(i=>i.transactionType==="2x"||i.transactionType==="3x"),b=m.reduce((i,N)=>i+Math.abs(N.amount),0),S={};u.forEach(i=>{S[i.playerId]=(S[i.playerId]||0)+1});let o=null,v=0;Object.entries(S).forEach(([i,N])=>{N>v&&(v=N,o=i)});const A={};u.forEach(i=>{A[i.playerId]||(A[i.playerId]={total:0,count:0}),A[i.playerId].total+=Math.abs(i.amount),A[i.playerId].count+=1});let L=null,E=0;Object.entries(A).forEach(([i,N])=>{const te=N.total/N.count;te>E&&(E=te,L=i)});const H={};a.filter(i=>i.transactionType==="Win").forEach(i=>{H[i.playerId]=(H[i.playerId]||0)+1});let R=null,D=0;Object.entries(H).forEach(([i,N])=>{N>D&&(D=N,R=i)});const G={};m.forEach(i=>{G[i.playerId]=(G[i.playerId]||0)+1});let z=null,O=0;Object.entries(G).forEach(([i,N])=>{N>O&&(O=N,z=i)});const w=s.totals||{};let _=null,B=0,X=null,Z=0;return Object.entries(w).forEach(([i,N])=>{N>B&&(B=N,_=i),N<Z&&(Z=N,X=i)}),[{key:"totalDecks",label:"Total Decks",value:C,type:"number"},{key:"totalRounds",label:"Total Rounds",value:x,type:"number"},{key:"totalBets",label:"Total Bets Placed",value:u.length,type:"number"},{key:"totalAnte",label:"Total Ante Amount",value:h,type:"currency"},{key:"totalBetAmount",label:"Total Bet Amount",value:l,type:"currency"},{key:"biggestPot",label:"Biggest Pot",value:y,type:"currency"},{key:"biggestBet",label:"Biggest Single Bet",value:f?Math.abs(f.amount):0,type:"currency",suffix:f?` by ${f.playerName}`:""},{key:"biggestWinner",label:"Biggest Winner",value:_?t[_]||"Unknown Player":"N/A",type:"text",suffix:_?` (+${c(B)})`:""},{key:"biggestLoser",label:"Biggest Loser",value:X?t[X]||"Unknown Player":"N/A",type:"text",suffix:X?` (${c(Z)})`:""},{key:"mostAggressive",label:"Most Aggressive Player",value:o?t[o]||"Unknown Player":"N/A",type:"text",suffix:o?` (${c(v)} bets)`:""},{key:"highestAvgBet",label:"Highest Average Bet",value:L?t[L]||"Unknown Player":"N/A",type:"text",suffix:L?` (avg: ${c(Math.round(E))})`:""},{key:"mostWinning",label:"Most Winning Player",value:R?t[R]||"Unknown Player":"N/A",type:"text",suffix:R?` (${c(D)} wins)`:""},{key:"totalPenalties",label:"Total Penalties",value:m.length,type:"number",suffix:m.length>0?` (${c(b)} coins)`:""},{key:"unluckyPlayer",label:"Most Penalized Player",value:z?t[z]||"Unknown Player":"N/A",type:"text",suffix:z?` (${c(O)} penalties)`:""}]},[a,t]),p=(c,g)=>c==="currency"?e.jsx(F,{amount:g,size:"small"}):c==="percentage"?`${(g*100).toFixed(1)}%`:c==="number"?g.toLocaleString():g;return e.jsx(e.Fragment,{children:r.length===0?e.jsx("p",{className:W.noDataMessage,children:"No statistics available for this game."}):e.jsx("div",{className:W.statsGrid,"data-gamepad-scrollable":"true",tabIndex:"0",children:r.map(c=>e.jsxs("div",{className:"panel-alt",children:[e.jsx("div",{className:W.statLabel,children:c.label}),e.jsxs("div",{className:W.statValue,children:[p(c.type,c.value),c.suffix&&e.jsx("span",{className:W.statSuffix,children:c.suffix})]})]},c.key))})})},Ya=({onClose:s,gameData:a})=>{if(!a)return e.jsx(U,{title:"Game Summary",onClose:s,style:{maxWidth:800,height:"80vh"},children:e.jsx("div",{className:$.loadingMessage,children:"Loading game data..."})});const n=a.gameTransactions||[],t=a.players||{},r=a.id||"unknown",p=a.settings?.isPrivate||!1,c=Array.isArray(n)?n:[],g={};Object.entries(t).forEach(([u,f])=>{g[u]=f.name}),c.forEach(u=>{u.playerId&&!g[u.playerId]&&(g[u.playerId]=u.playerName||"Unknown Player")});const x=a.totals||{},C=d.useMemo(()=>{if(Object.keys(x).length===2){const m=Object.entries(x),[b,S]=m[0],[o,v]=m[1];if(Math.abs(S+v)<.1){if(S>0)return[{from:o,fromName:g[o],to:b,toName:g[b],amount:Math.abs(S)}];if(v>0)return[{from:b,fromName:g[b],to:o,toName:g[o],amount:Math.abs(v)}]}}const u=[],f=Object.entries(x).filter(([m,b])=>b<0).map(([m,b])=>({playerId:m,playerName:g[m]||"Unknown Player",amount:Math.abs(b)})),y=Object.entries(x).filter(([m,b])=>b>0).map(([m,b])=>({playerId:m,playerName:g[m]||"Unknown Player",amount:b}));for(f.sort((m,b)=>b.amount-m.amount),y.sort((m,b)=>b.amount-m.amount);y.length>0&&f.length>0;){const m=y[0],b=f[0],S=Math.min(m.amount,b.amount);if(S>.01)u.push({from:b.playerId,fromName:b.playerName,to:m.playerId,toName:m.playerName,amount:S}),m.amount-=S,b.amount-=S,m.amount<.01&&y.shift(),b.amount<.01&&f.shift();else break}return u},[x,g]),[h,l]=d.useState("totals");return e.jsxs(U,{title:`Game Summary (${r})`,onClose:s,headerButtons:e.jsx(Ga,{gameState:a}),style:{maxWidth:800,height:"80vh"},children:[e.jsxs("div",{className:"tabs-container",children:[e.jsx("button",{className:`tab-button ${h==="totals"?"active":""}`,onClick:()=>l("totals"),"data-gamepad-focusable":"true",children:"Totals"}),e.jsx("button",{className:`tab-button ${h==="stats"?"active":""}`,onClick:()=>l("stats"),"data-gamepad-focusable":"true",children:"Stats"}),p&&e.jsx("button",{className:`tab-button ${h==="payouts"?"active":""}`,onClick:()=>l("payouts"),"data-gamepad-focusable":"true",children:"Payouts"})]}),h==="totals"&&e.jsx("div",{className:"tab-content",children:Object.keys(x).length===0?e.jsx("p",{className:$.noDataMessage,children:"No transactions recorded yet."}):e.jsx("div",{className:$.totalsTable,children:Object.entries(x).map(([u,f])=>e.jsxs("div",{className:$.totalRow,children:[e.jsx("span",{className:$.playerName,children:g[u]||"Unknown Player"}),e.jsx("span",{className:`${$.totalAmount} ${f>=0?$.positive:$.negative}`,children:e.jsx(F,{amount:f,size:"small"})})]},u))})}),h==="stats"&&e.jsx(Ka,{gameData:a}),h==="payouts"&&p&&e.jsx("div",{className:"tab-content",children:C.length===0?e.jsx("p",{className:$.noDataMessage,children:"No payments needed or no transactions recorded yet."}):e.jsx("div",{className:$.settleUpTable,children:C.map((u,f)=>e.jsxs("div",{className:$.paymentRow,children:[e.jsxs("span",{className:$.paymentText,children:[e.jsx("span",{className:$.playerName,children:u.fromName})," pays"," ",e.jsx("span",{className:$.playerName,children:u.toName})]}),e.jsx("span",{className:$.paymentAmount,children:e.jsx(F,{amount:u.amount,size:"small"})})]},f))})})]})},Za="_leaderboardContainer_1al73_1",Ja="_leaderboardHeader_1al73_9",Qa="_durationSelector_1al73_15",et="_durationButton_1al73_24",at="_active_1al73_41",tt="_loadingMessage_1al73_48",st="_errorMessage_1al73_48",nt="_emptyMessage_1al73_48",rt="_loadingSpinner_1al73_60",ot="_leaderboardList_1al73_78",lt="_leaderboardRow_1al73_88",it="_rankCell_1al73_102",ct="_rank_1al73_102",dt="_playerCell_1al73_113",ut="_statsCell_1al73_118",P={leaderboardContainer:Za,leaderboardHeader:Ja,durationSelector:Qa,durationButton:et,active:at,loadingMessage:tt,errorMessage:st,emptyMessage:nt,loadingSpinner:rt,leaderboardList:ot,leaderboardRow:lt,rankCell:it,rank:ct,playerCell:dt,statsCell:ut},pt=()=>{const[s,a]=d.useState([]),[n,t]=d.useState(!0),[r,p]=d.useState(null),[c,g]=d.useState("all"),x=d.useContext(pe);d.useEffect(()=>{C()},[c]);const C=async()=>{t(!0),p(null);try{const l=await fetch(`${K}/leaderboard?duration=${c}`);if(!l.ok)throw new Error("Failed to fetch leaderboard");const u=await l.json();if(a(u.leaderboard||[]),x&&u.leaderboard){const f=u.leaderboard.map(y=>y.userId);x.prefetchUsers(f)}}catch(l){console.error("Error fetching leaderboard:",l),p(l.message)}finally{t(!1)}},h=l=>l===1?"🥇":l===2?"🥈":l===3?"🥉":`#${l}`;return e.jsxs("div",{className:P.leaderboardContainer,children:[e.jsx("div",{className:P.leaderboardHeader,children:e.jsxs("div",{className:P.durationSelector,children:[e.jsx("button",{className:`${P.durationButton} ${c==="all"?P.active:""}`,onClick:()=>g("all"),"data-gamepad-focusable":"true",children:"All Time"}),e.jsx("button",{className:`${P.durationButton} ${c==="30days"?P.active:""}`,onClick:()=>g("30days"),"data-gamepad-focusable":"true",children:"Last 30 Days"})]})}),n?e.jsxs("div",{className:P.loadingMessage,children:[e.jsx("div",{className:P.loadingSpinner}),"Loading leaderboard..."]}):r?e.jsxs("div",{className:P.errorMessage,children:["Error: ",r]}):s.length===0?e.jsx("div",{className:P.emptyMessage,children:"No players found for this time period."}):e.jsx("div",{className:P.leaderboardList,"data-gamepad-scrollable":"true",tabIndex:"0",children:s.map(l=>e.jsxs("div",{className:`panel-alt ${P.leaderboardRow}`,children:[e.jsx("div",{className:P.rankCell,children:e.jsx("span",{className:P.rank,children:h(l.rank)})}),e.jsx("div",{className:P.playerCell,children:e.jsx(Ze,{userId:l.userId,size:"small",showName:!0,showTitle:!0,namePosition:"right"})}),e.jsx("div",{className:P.statsCell,children:e.jsx(F,{amount:l.totalProfit,size:"small"})})]},l.userId))})]})},mt="_statsPlaceholder_1uz5o_1",gt="_statsGrid_1uz5o_14",ht="_statLabel_1uz5o_47",yt="_statValue_1uz5o_54",xt="_statSuffix_1uz5o_62",ft="_historyTable_1uz5o_77",bt="_tableBody_1uz5o_89",_t="_tableHeader_1uz5o_117",vt="_gameNameHeader_1uz5o_130",jt="_playerCountHeader_1uz5o_130",wt="_roundsHeader_1uz5o_130",kt="_endDateHeader_1uz5o_130",Nt="_historyRow_1uz5o_146",Ct="_gameNameCell_1uz5o_159",St="_playerCountCell_1uz5o_167",Pt="_roundsCell_1uz5o_167",It="_endDateCell_1uz5o_175",At="_gameNameLink_1uz5o_183",Tt="_pageButton_1uz5o_262",$t="_pageInfo_1uz5o_293",Bt="_errorMessage_1uz5o_304",Lt="_loadingMessage_1uz5o_325",Mt="_loadingSpinner_1uz5o_336",Et="_dateMobile_1uz5o_351",Ut="_dateDesktop_1uz5o_355",k={statsPlaceholder:mt,statsGrid:gt,statLabel:ht,statValue:yt,statSuffix:xt,historyTable:ft,tableBody:bt,tableHeader:_t,gameNameHeader:vt,playerCountHeader:jt,roundsHeader:wt,endDateHeader:kt,historyRow:Nt,gameNameCell:Ct,playerCountCell:St,roundsCell:Pt,endDateCell:It,gameNameLink:At,pageButton:Tt,pageInfo:$t,errorMessage:Bt,loadingMessage:Lt,loadingSpinner:Mt,dateMobile:Et,dateDesktop:Ut},Dt=({onClose:s})=>{const{token:a}=ae(),[n,t]=d.useState("leaderboard"),[r,p]=d.useState(!0),[c,g]=d.useState(null),[x,C]=d.useState({games:[],pagination:{}}),[h,l]=d.useState(0),[u,f]=d.useState(!1),[y,m]=d.useState(null),[b,S]=d.useState(null),[o,v]=d.useState(!0),[A,L]=d.useState(null),E=5;d.useEffect(()=>{(async()=>{p(!0),g(null);try{const _=await fetch(`${K}/games/history?pageSize=${E}&pageNumber=${h}`,{headers:{Authorization:`Bearer ${a}`}});if(!_.ok)throw new Error("Failed to fetch game history");const B=await _.json();C(B)}catch(_){console.error("Error fetching game history:",_),g(_.message)}finally{p(!1)}})()},[a,h]),d.useEffect(()=>{(async()=>{v(!0),L(null);try{const _=await fetch(`${K}/me/stats`,{headers:{Authorization:`Bearer ${a}`}});if(!_.ok)throw new Error("Failed to fetch lifetime stats");const B=await _.json();S(B.stats)}catch(_){console.error("Error fetching lifetime stats:",_),L(_.message)}finally{v(!1)}})()},[a]);const H=()=>{h>0&&l(h-1)},R=()=>{x.pagination&&x.games.length===E&&l(h+1)},D=(w,_=!1)=>{if(!w)return"Unknown";const B=new Date(w);return _?new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}).format(B):new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(B)},G=(w,_)=>typeof _=="number"?w==="currency"?e.jsx(F,{amount:_,size:"small"}):w==="percentage"?`${(_*100).toFixed(1)}%`:_.toLocaleString():typeof _=="boolean"?_?"Yes":"No":w==="date"||_ instanceof Date?D(_):w==="number"?Number(_).toLocaleString():String(_),z=w=>w.roundCount||0,O=w=>{const _=x.games.find(B=>B.id===w);_&&(m(_),f(!0))};return e.jsxs(e.Fragment,{children:[e.jsxs(U,{title:"Player Stats",onClose:s,style:{maxWidth:800,height:"80vh"},children:[e.jsxs("div",{className:"tabs-container",children:[e.jsx("button",{className:`tab-button ${n==="leaderboard"?"active":""}`,onClick:()=>t("leaderboard"),"data-gamepad-focusable":"true",children:"Leaderboard"}),e.jsx("button",{className:`tab-button ${n==="stats"?"active":""}`,onClick:()=>t("stats"),"data-gamepad-focusable":"true",children:"Lifetime Stats"}),e.jsx("button",{className:`tab-button ${n==="history"?"active":""}`,onClick:()=>t("history"),"data-gamepad-focusable":"true",children:"Game History"})]}),n==="leaderboard"&&e.jsx("div",{className:"tab-content",children:e.jsx(pt,{})}),n==="stats"&&e.jsx("div",{className:"tab-content",children:o?e.jsxs("div",{className:k.loadingMessage,children:[e.jsx("div",{className:k.loadingSpinner}),"Loading your lifetime stats..."]}):A?e.jsxs("div",{className:k.errorMessage,children:["Error: ",A]}):!b||b.length===0?e.jsx("div",{className:k.statsPlaceholder,children:e.jsx("p",{children:"No lifetime statistics available."})}):e.jsx("div",{className:k.statsGrid,"data-gamepad-scrollable":"true",tabIndex:"0",children:b.map((w,_)=>e.jsxs("div",{className:"panel-alt",children:[e.jsx("div",{className:k.statLabel,children:w.label}),e.jsxs("div",{className:k.statValue,children:[G(w.type,w.value),w.suffix&&e.jsx("span",{className:k.statSuffix,children:w.suffix})]})]},w.key||`stat-${_}`))})}),n==="history"&&e.jsx("div",{className:"tab-content",children:r?e.jsxs("div",{className:k.loadingMessage,children:[e.jsx("div",{className:k.loadingSpinner}),"Loading your game history..."]}):c?e.jsxs("div",{className:k.errorMessage,children:["Error: ",c]}):x.games.length===0?e.jsx("div",{className:k.statsPlaceholder,children:e.jsx("p",{children:"No games found in your history."})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`panel-alt ${k.historyTable}`,children:[e.jsxs("div",{className:k.tableHeader,children:[e.jsx("div",{className:k.gameNameHeader,children:"Game"}),e.jsx("div",{className:k.playerCountHeader,children:"Players"}),e.jsx("div",{className:k.roundsHeader,children:"Rounds"}),e.jsx("div",{className:k.endDateHeader,children:"Ended"})]}),e.jsx("div",{className:k.tableBody,"data-gamepad-scrollable":"true",tabIndex:"0",children:x.games.map(w=>e.jsxs("div",{className:k.historyRow,children:[e.jsx("div",{className:k.gameNameCell,children:e.jsxs("span",{className:k.gameNameLink,onClick:()=>O(w.id),tabIndex:"0",role:"button","data-gamepad-focusable":"true",children:["#",w.id]})}),e.jsx("div",{className:k.playerCountCell,children:w.totalPlayerCount}),e.jsx("div",{className:k.roundsCell,children:z(w)}),e.jsxs("div",{className:k.endDateCell,children:[e.jsx("span",{className:k.dateDesktop,children:D(w.endedAt)}),e.jsx("span",{className:k.dateMobile,children:D(w.endedAt,!0)})]})]},w.id))})]}),e.jsxs("div",{className:k.pageInfo,children:[e.jsx("button",{onClick:H,disabled:h===0,className:k.pageButton,"aria-label":"Previous page","data-gamepad-focusable":"true",children:"←"}),"Page ",h+1,x.pagination&&x.pagination.total?` of ${Math.ceil(x.pagination.total/E)}`:"",e.jsx("button",{onClick:R,disabled:!x.pagination||x.games.length<E,className:k.pageButton,"aria-label":"Next page","data-gamepad-focusable":"true",children:"→"})]})]})})]}),u&&y&&e.jsx(Ya,{gameData:y,onClose:()=>{f(!1),m(null)}})]})},ts=({onModalStateChange:s,...a})=>{const[n,t]=d.useState(!1),r=()=>{t(!0)},p=()=>{t(!1)};return d.useEffect(()=>{s&&s(n)},[n,s]),e.jsxs(e.Fragment,{children:[e.jsx(V,{onClick:r,icon:e.jsx(Ia,{color:"white",size:20}),"aria-label":"Open Player Stats",variant:"stats",title:"Player Stats",...a}),n&&e.jsx(Dt,{isOpen:n,onClose:p})]})},Rt=({className:s="h-6 w-6",...a})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.8,stroke:"currentColor",className:s,...a,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 10.5V6a3.75 3.75 0 10-7.5 0v4.5m-2.25 9h12a1.5 1.5 0 001.5-1.5v-6a1.5 1.5 0 00-1.5-1.5h-12a1.5 1.5 0 00-1.5 1.5v6a1.5 1.5 0 001.5 1.5z"})}),ss=({onClick:s,...a})=>e.jsx(V,{onClick:s,icon:e.jsx(Rt,{style:{color:"white",width:20,height:20}}),"aria-label":"Store",variant:"store",title:"Store",...a}),zt=({color:s="currentColor",size:a=24})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:a,height:a,viewBox:"0 0 24 24",fill:"none",stroke:s,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),e.jsx("line",{x1:"12",y1:"17",x2:"12",y2:"17.01"})]}),Ft=({onClose:s})=>e.jsxs(U,{title:"Game Rules",onClose:s,style:{maxWidth:600},children:[e.jsxs("div",{style:{marginBottom:22},children:[e.jsx("div",{className:I.sectionHeader,children:"Objective"}),e.jsx("div",{className:I.settingDescription,children:'The goal is to bet on whether the third card will have a value that falls "in between" the first two cards.'})]}),e.jsxs("div",{style:{marginBottom:22},children:[e.jsx("div",{className:I.sectionHeader,children:"Card Values"}),e.jsx("div",{className:I.settingDescription,children:"Cards are valued numerically: 2-10 as face value, Jack = 11, Queen = 12, King = 13, and Ace = 1 or 14 (player's choice)."})]}),e.jsxs("div",{style:{marginBottom:22},children:[e.jsx("div",{className:I.sectionHeader,children:"Game Flow"}),e.jsx("div",{className:I.settingDescription,children:e.jsxs("ol",{style:{paddingLeft:20,margin:0},children:[e.jsx("li",{children:"Each player antes up to join the round."}),e.jsx("li",{children:"The player to the right of the dealer goes first."}),e.jsx("li",{children:"Two cards are dealt face up."}),e.jsx("li",{children:"Player decides whether to bet or pass."}),e.jsx("li",{children:"If a bet is placed, the third card is revealed."}),e.jsx("li",{children:"Bets are settled."}),e.jsx("li",{children:"Next player goes."}),e.jsx("li",{children:"If the pot is empty, players ante up again to start a new round."})]})})]}),e.jsxs("div",{style:{marginBottom:22},children:[e.jsx("div",{className:I.sectionHeader,children:"Betting"}),e.jsxs("div",{className:I.settingDescription,children:["If you think the third card will fall between the first two cards, you can bet up to the pot amount.",e.jsx("br",{}),"If you win, you receive the amount of your bet from the pot.",e.jsx("br",{}),"If you lose, your bet is added to the pot."]})]}),e.jsxs("div",{style:{marginBottom:22},children:[e.jsx("div",{className:I.sectionHeader,children:"POT Button"}),e.jsx("div",{className:I.settingDescription,children:"The POT button allows you to bet the entire pot amount at once for maximum winnings."})]}),e.jsxs("div",{style:{marginBottom:6},children:[e.jsx("div",{className:I.sectionHeader,children:"Special Rules"}),e.jsx("div",{className:I.settingDescription,children:e.jsxs("ul",{style:{paddingLeft:20,margin:0},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Ace Choice:"})," If the first card is an Ace, you can choose to play it as low (1) or high (14)."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Second Chance:"})," If the first two cards are the same, you can chose to ante again to see another hand."]})]})})]})]}),ns=({title:s="View Game Rules",onModalStateChange:a,...n})=>{const[t,r]=d.useState(!1),p=()=>{r(!0)},c=()=>{r(!1)};return d.useEffect(()=>{a&&a(t)},[t,a]),e.jsxs(e.Fragment,{children:[e.jsx(V,{icon:e.jsx(zt,{color:"white",size:20}),title:s,onClick:p,variant:"default",...n}),t&&e.jsx(Ft,{onClose:c})]})},Ht="_coinPacksGrid_1p81q_3",Gt="_coinPackCard_1p81q_50",Ot="_coinAmount_1p81q_56",qt="_productImage_1p81q_64",Wt="_productDescription_1p81q_78",Vt="_productPrice_1p81q_87",Xt="_free_1p81q_94",Kt="_paid_1p81q_98",Yt="_adButton_1p81q_103",T={coinPacksGrid:Ht,coinPackCard:Gt,coinAmount:Ot,productImage:qt,productDescription:Wt,productPrice:Vt,free:Xt,paid:Kt,adButton:Yt};class Zt{constructor(){this.API_URL="https://api.in-between.live",this.baseURL=`${this.API_URL}/purchases`}getAuthHeaders(a){return{"Content-Type":"application/json",Authorization:a?`Bearer ${a}`:""}}async getOfferingsByType(a,n){try{const t=`${this.baseURL}/offerings?offeringType=${encodeURIComponent(a)}`,r=await fetch(t,{method:"GET",headers:this.getAuthHeaders(n),credentials:"include"});if(!r.ok){const c=await r.json().catch(()=>({}));throw new Error(c.error||`HTTP ${r.status}: Failed to fetch offerings`)}return(await r.json()).offerings||[]}catch(t){throw console.error("[PURCHASE_SERVICE] Error fetching offerings:",t),new Error(`Failed to fetch product offerings: ${t.message}`)}}async getAllOfferings(a){try{const n=await fetch(`${this.baseURL}/offerings`,{method:"GET",headers:this.getAuthHeaders(a),credentials:"include"});if(!n.ok){const r=await n.json().catch(()=>({}));throw new Error(r.error||`HTTP ${n.status}: Failed to fetch offerings`)}return(await n.json()).offerings||[]}catch(n){throw console.error("[PURCHASE_SERVICE] Error fetching all offerings:",n),new Error(`Failed to fetch product offerings: ${n.message}`)}}async processPurchase(a,n){try{if(!a)throw new Error("Product ID is required");const t=await fetch(`${this.baseURL}/process`,{method:"POST",headers:this.getAuthHeaders(n),credentials:"include",body:JSON.stringify({productId:a})});if(!t.ok){const p=await t.json().catch(()=>({}));throw new Error(p.error||`HTTP ${t.status}: Purchase failed`)}const r=await t.json();return console.log("[PURCHASE_SERVICE] Purchase completed:",{productId:a,coinsAdded:r.coinsAdded,newBalance:r.newBalance}),r}catch(t){throw console.error("[PURCHASE_SERVICE] Error processing purchase:",t),new Error(`Purchase failed: ${t.message}`)}}}const Q=new Zt,rs=({onClose:s})=>{const{token:a}=ae(),[n,t]=d.useState("coins"),[r,p]=d.useState([]),[c,g]=d.useState([]),[x,C]=d.useState(!0),[h,l]=d.useState(null),[u,f]=d.useState(null);d.useEffect(()=>{a&&(y(),m())},[a]);const y=async()=>{try{C(!0),f(null);const o=await Q.getOfferingsByType("coin",a);p([{id:"watch-ad",coinAmount:300,priceUSD:0,name:"Watch Ad",description:"Watch a short video ad to earn free coins!",imageUrl:null,isAd:!0},...o])}catch(o){console.error("Failed to load coin offerings:",o),f("Failed to load products. Please try again.")}finally{C(!1)}},m=async()=>{try{const o=await Q.getOfferingsByType("upgrade",a);g(o)}catch(o){console.error("Failed to load upgrade offerings:",o)}},b=async o=>{try{if(l(o),f(null),o==="watch-ad"){console.log("Watch ad clicked - Ad integration coming soon!"),alert("Ad feature coming soon! You would earn 300 coins by watching a short video."),l(null);return}const v=await Q.processPurchase(o,a);console.log("Purchase successful:",v),s()}catch(v){console.error("Purchase failed:",v),f(v.message||"Purchase failed. Please try again.")}finally{l(null)}},S=o=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(o);return x?e.jsx(U,{title:"Store",onClose:s,style:{maxWidth:800,height:"80vh"},children:e.jsx("div",{style:{textAlign:"center",padding:"2rem",color:"#a0b9d6"},children:"Loading products..."})}):e.jsxs(U,{title:"Store",onClose:s,style:{maxWidth:800,height:"80vh"},children:[e.jsxs("div",{className:"tabs-container",children:[e.jsx("button",{className:`tab-button ${n==="coins"?"active":""}`,onClick:()=>t("coins"),"data-gamepad-focusable":"true",children:"Coin Packs"}),e.jsx("button",{className:`tab-button ${n==="upgrade"?"active":""}`,onClick:()=>t("upgrade"),"data-gamepad-focusable":"true",children:"Upgrades"})]}),u&&e.jsx("div",{style:{marginBottom:"1rem",padding:"0.75rem",backgroundColor:"rgba(231, 76, 60, 0.1)",border:"1px solid #e74c3c",borderRadius:"8px",color:"#ffb3b3"},children:u}),n==="coins"&&e.jsx("div",{className:"tab-content",children:r.length===0?e.jsx("div",{style:{textAlign:"center",padding:"2rem",color:"#a0b9d6"},children:"No coin packs available at the moment."}):e.jsx("div",{className:T.coinPacksGrid,"data-gamepad-scrollable":"true",tabIndex:"0",children:r.map(o=>e.jsxs("div",{className:`panel-alt ${T.coinPackCard}`,children:[e.jsx("h3",{className:T.coinAmount,children:e.jsx(F,{amount:o.coinAmount,size:"large"})}),e.jsx("div",{className:T.productImage,children:o.imageUrl&&e.jsx("img",{src:o.imageUrl,alt:o.name,onError:v=>{v.target.style.display="none"}})}),e.jsx("p",{className:T.productDescription,children:o.description}),e.jsx("div",{className:`${T.productPrice} ${o.isAd?T.free:T.paid}`,children:o.isAd?"FREE":S(o.priceUSD)}),e.jsx("button",{onClick:()=>b(o.id),disabled:h===o.id,className:o.isAd?T.adButton:"btn btn-primary","data-gamepad-focusable":"true",children:h===o.id?"Processing...":o.isAd?"Watch Ad":"Purchase"})]},o.id))})}),n==="upgrade"&&e.jsx("div",{className:"tab-content",children:c.length===0?e.jsx("div",{style:{textAlign:"center",padding:"2rem",color:"#a0b9d6"},children:"No upgrades available at the moment."}):e.jsx("div",{className:T.coinPacksGrid,"data-gamepad-scrollable":"true",tabIndex:"0",children:c.map(o=>e.jsxs("div",{className:`panel-alt ${T.coinPackCard}`,children:[e.jsx("h3",{className:T.coinAmount,children:o.name}),e.jsx("div",{className:T.productImage,children:o.imageUrl&&e.jsx("img",{src:o.imageUrl,alt:o.name,onError:v=>{v.target.style.display="none"}})}),e.jsx("p",{className:T.productDescription,children:o.description}),e.jsxs("div",{className:`${T.productPrice} ${T.paid}`,children:[S(o.priceUSD),"/month"]}),e.jsx("button",{onClick:()=>b(o.id),disabled:h===o.id,className:"btn btn-primary","data-gamepad-focusable":"true",children:h===o.id?"Processing...":"Subscribe"})]},o.id))})})]})},os=({type:s="text",title:a="",...n})=>{const t=d.useRef(null);let r=null;try{r=me()?.enhanceInput}catch{console.warn("VirtualKeyboardProvider not found - GamepadInput working as regular input")}return d.useEffect(()=>{if(t.current&&r)return r(t.current,s,a)},[r,s,a]),e.jsx("input",{ref:t,type:s,"data-gamepad-focusable":"true",...n})};export{F as C,os as G,V as I,ts as P,ns as R,ss as S,ne as T,Ze as U,as as a,rs as b,Ya as c,fe as d,es as g};
