import{a1 as T,Z as e,a2 as q,_ as L,a3 as J,a4 as Q}from"./index-CriEyDDD.js";import{b,f as X,u as Y}from"./vendor-CT7sGowS.js";import{u as Z}from"./useGamepadNavigation-DKu7SyYo.js";import{A as H}from"./AppHeader-DNMcF7dd.js";import{F as V}from"./Footer-BrCnmLXK.js";import{c as P}from"./createLucideIcon-D-AJSOET.js";import{B as K,T as w,G as S,C as ee,U as se,R as te,P as ae,S as ne,a as oe,b as re,u as ie,A as ce,c as le,d as D}from"./useAdInterstitial-CY2vJrmM.js";import"./socket-CA1CrNgP.js";import"./audio-hxunv4lQ.js";/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],de=P("lock",me);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],pe=P("search",ue);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],ge=P("zap",he),xe="_lobbyScreen_pke86_1",_e="_withAds_pke86_9",je="_gameListTitle_pke86_30",fe="_searchContainer_pke86_41",be="_gameListWrapper_pke86_73",Ne="_userDisconnectedGame_pke86_80",ve="_userInGame_pke86_92",Ce="_gameListInfo_pke86_114",ye="_gameListId_pke86_120",Se="_disconnectedBadge_pke86_129",we="_inGameBadge_pke86_141",Ae="_gameListPlayers_pke86_153",Ie="_emptyStateMessage_pke86_159",Be="_privatePill_pke86_168",Le="_onlineCountWrapper_pke86_182",Pe="_playerSection_pke86_190",Ge="_gameActionsSection_pke86_196",ke="_gameListSection_pke86_205",$e="_gameCard_pke86_212",l={lobbyScreen:xe,withAds:_e,gameListTitle:je,searchContainer:fe,gameListWrapper:be,userDisconnectedGame:Ne,userInGame:ve,gameListInfo:Ce,gameListId:ye,disconnectedBadge:Se,inGameBadge:we,gameListPlayers:Ae,emptyStateMessage:Ie,privatePill:Be,onlineCountWrapper:Le,playerSection:Pe,gameActionsSection:Ge,gameListSection:ke,gameCard:$e},Ee="_pill_19yh2_1",Oe="_pulse_19yh2_23",De="_text_19yh2_49",B={pill:Ee,pulse:Oe,text:De},Me=()=>{const{socket:n,isConnected:r}=T(),[c,t]=b.useState(null);return b.useEffect(()=>{if(!n||!r)return;n.emit("getOnlinePlayerCount",a=>{t(a)});const x=a=>t(a);return n.on("onlinePlayerCountUpdate",x),()=>{n.off("onlinePlayerCountUpdate",x)}},[n,r]),c===null?null:e.jsxs("div",{className:B.pill,children:[e.jsx("span",{className:B.pulse}),e.jsxs("span",{className:B.text,children:[c," online"]})]})};function Te({game:n,onJoin:r,userId:c}){const t=n.settings?.customName||n.id,x=n.disconnectedPlayers?.some(h=>h.userId===c),a=n.allPlayers?.some(h=>h.userId===c&&!h.disconnected);let p="Join";x?p="Reconnect":a&&(p="Continue");let f=`panel-frost ${l.gameCard}`;return x?f+=` ${l.userDisconnectedGame}`:a&&(f+=` ${l.userInGame}`),e.jsxs("div",{className:f,children:[e.jsxs("div",{className:l.gameListInfo,style:{flex:1},children:[e.jsxs("div",{className:l.gameListId,children:[" ",t,n.settings?.isPrivate&&e.jsxs("span",{className:l.privatePill,title:"Private Game",children:[e.jsx(de,{size:"0.9em",style:{marginRight:"4px",verticalAlign:"middle"}}),"Private"]}),x&&e.jsx("span",{className:l.disconnectedBadge,title:"You're disconnected from this game",children:"⚠️ Reconnect"}),a&&e.jsx("span",{className:l.inGameBadge,title:"You're in this game",children:"You're In"})]}),e.jsxs("div",{className:l.gameListPlayers,children:[" ",n.playerCount," ",n.playerCount===1?"player":"players"]})]}),e.jsx("button",{type:"button",className:"btn btn-primary",style:{padding:"0.4rem 1rem",fontSize:"0.9rem",minWidth:"80px",maxWidth:"100px",flexShrink:0},onClick:()=>r(n.id),disabled:!c,"data-gamepad-focusable":"true",children:p})]})}const ze="_gameSettingItem_tzwbj_1",We="_settingDescription_tzwbj_13",Ue="_settingControls_tzwbj_35",Fe="_textInput_tzwbj_42",Re="_inputError_tzwbj_60",o={gameSettingItem:ze,settingDescription:We,settingControls:Ue,textInput:Fe,inputError:Re},M={useCustomName:!1,customName:"",isPrivate:!1,password:"",enableAceChoice:!0,enableSecondChance:!0,numberOfBots:0,anteAmount:""},qe=({initialSettings:n=M,onSubmit:r,onClose:c})=>{const[t,x]=b.useState({...M,...n}),[a,p]=b.useState({}),f=s=>{const u={};if(s.useCustomName){const d=s.customName||"";d?d.length<4||d.length>26?u.customName="Name must be 4-26 characters.":/^[a-zA-Z0-9_-]+$/.test(d)||(u.customName="Use letters, numbers, -, or _."):u.customName="Custom name is required."}if(s.isPrivate){const d=s.password||"";d?(d.length<3||d.length>36)&&(u.password="Password must be 3-36 characters."):u.password="Password is required."}const m=s.numberOfBots;(m<0||m>16)&&(u.numberOfBots="Number of bots must be between 0 and 16.");const i=s.anteAmount;if(i!==""&&i!==null&&i!==void 0){const d=parseInt(i);(isNaN(d)||d<1||d>100)&&(u.anteAmount="Ante amount must be between 1 and 100.")}return u},h=(s,u)=>{x(m=>{const i={...m,[s]:u};return s==="useCustomName"&&!u&&(i.customName="",a.customName&&p(d=>{const j={...d};return delete j.customName,j})),s==="isPrivate"&&!u&&(i.password="",a.password&&p(d=>{const j={...d};return delete j.password,j})),i}),(s==="customName"||s==="useCustomName")&&a.customName&&p(m=>{const i={...m};return delete i.customName,i}),(s==="password"||s==="isPrivate")&&a.password&&p(m=>{const i={...m};return delete i.password,i}),s==="numberOfBots"&&a.numberOfBots&&p(m=>{const i={...m};return delete i.numberOfBots,i}),s==="anteAmount"&&a.anteAmount&&p(m=>{const i={...m};return delete i.anteAmount,i})},A=s=>{s.preventDefault();const u=f(t);if(Object.keys(u).length>0)p(u);else{p({});const m={...t,customName:t.useCustomName?t.customName:null,anteAmount:t.anteAmount===""?1:parseInt(t.anteAmount)};delete m.useCustomName,r(m)}};return e.jsx(K,{title:"Game Options",onClose:c,style:{maxWidth:600},footer:e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("button",{type:"button",onClick:c,className:"btn btn-secondary","data-gamepad-focusable":"true",children:"Cancel"}),e.jsx("button",{type:"submit",form:"gameSettingsForm",className:"btn btn-primary",disabled:Object.keys(a).length>0,"data-gamepad-focusable":"true",children:"Create Game"})]}),children:e.jsxs("form",{id:"gameSettingsForm",onSubmit:A,children:[e.jsxs("div",{className:`panel-alt ${o.gameSettingItem}`,children:[e.jsxs("div",{className:o.settingDescription,children:[e.jsx("h4",{children:"Custom Game Name"}),e.jsx("p",{children:"Set a custom name for your game lobby"})]}),e.jsxs("div",{className:o.settingControls,children:[e.jsx(w,{isChecked:t.useCustomName,onChange:s=>h("useCustomName",s.target.checked)}),t.useCustomName&&e.jsx(S,{title:"Enter Game Name",type:"text",value:t.customName||"",onChange:s=>h("customName",s.target.value),className:`${o.textInput}${a.customName?` ${o.inputError}`:""}`,placeholder:"Game Name",maxLength:26,style:{marginTop:8}}),a.customName&&e.jsx("span",{className:"errorMessage",children:a.customName})]})]}),e.jsxs("div",{className:`panel-alt ${o.gameSettingItem}`,children:[e.jsxs("div",{className:o.settingDescription,children:[e.jsx("h4",{children:"Private Game"}),e.jsx("p",{children:"Only players with the password can join"})]}),e.jsxs("div",{className:o.settingControls,children:[e.jsx(w,{isChecked:t.isPrivate,onChange:s=>h("isPrivate",s.target.checked)}),t.isPrivate&&e.jsx(S,{title:"Enter Game Password",type:"text",value:t.password||"",onChange:s=>h("password",s.target.value),className:`${o.textInput}${a.password?` ${o.inputError}`:""}`,placeholder:"Password",maxLength:36,style:{marginTop:8}}),a.password&&e.jsx("span",{className:"errorMessage",children:a.password})]})]}),e.jsxs("div",{className:`panel-alt ${o.gameSettingItem}`,children:[e.jsxs("div",{className:o.settingDescription,children:[e.jsx("h4",{children:"Number of Bots"}),e.jsx("p",{children:"Add AI players to your game (0-16)"})]}),e.jsxs("div",{className:o.settingControls,children:[e.jsx(S,{title:"Number of AI Players",type:"number",min:"0",max:"16",value:t.numberOfBots===0?"":t.numberOfBots,onChange:s=>h("numberOfBots",s.target.value===""?0:parseInt(s.target.value)||0),className:`${o.textInput} no-validation${a.numberOfBots?` ${o.inputError}`:""}`,placeholder:"0"}),a.numberOfBots&&e.jsx("span",{className:"errorMessage",children:a.numberOfBots})]})]}),e.jsxs("div",{className:`panel-alt ${o.gameSettingItem}`,children:[e.jsxs("div",{className:o.settingDescription,children:[e.jsx("h4",{children:"Ante Amount"}),e.jsx("p",{children:"Set the ante amount for each round (1-100)"})]}),e.jsxs("div",{className:o.settingControls,children:[e.jsx(S,{title:"Ante Amount",type:"number",min:"1",max:"100",value:t.anteAmount,onChange:s=>h("anteAmount",s.target.value),className:`${o.textInput} no-validation${a.anteAmount?` ${o.inputError}`:""}`,placeholder:"1"}),a.anteAmount&&e.jsx("span",{className:"errorMessage",children:a.anteAmount})]})]}),e.jsxs("div",{className:`panel-alt ${o.gameSettingItem}`,children:[e.jsxs("div",{className:o.settingDescription,children:[e.jsx("h4",{children:"Enable Ace Choice"}),e.jsx("p",{children:"Allow players to choose high/low on Ace"})]}),e.jsx("div",{className:o.settingControls,children:e.jsx(w,{isChecked:t.enableAceChoice,onChange:s=>h("enableAceChoice",s.target.checked)})})]}),e.jsxs("div",{className:`panel-alt ${o.gameSettingItem}`,children:[e.jsxs("div",{className:o.settingDescription,children:[e.jsx("h4",{children:"Enable Second Chance"}),e.jsx("p",{children:"Allow players to ante up for a second chance"})]}),e.jsx("div",{className:o.settingControls,children:e.jsx(w,{isChecked:t.enableSecondChance,onChange:s=>h("enableSecondChance",s.target.checked)})})]})]})})},Je="_userSection_1jcu2_1",Qe="_avatarContainer_1jcu2_10",Xe="_headerButtons_1jcu2_14",Ye="_logoutButton_1jcu2_38",y={userSection:Je,avatarContainer:Qe,headerButtons:Xe,logoutButton:Ye},Ze="_progressContainer_1gewg_1",He="_balanceSection_1gewg_9",Ve="_balanceLeft_1gewg_16",Ke="_balanceLabel_1gewg_22",es="_xpBonusIndicator_1gewg_29",ss="_xpBonusIcon_1gewg_35",ts="_xpBonusText_1gewg_41",as="_xpSection_1gewg_49",ns="_xpBarContainer_1gewg_53",os="_xpOverlay_1gewg_63",rs="_xpLevel_1gewg_77",is="_xpNext_1gewg_84",cs="_xpBar_1gewg_53",_={progressContainer:Ze,balanceSection:He,balanceLeft:Ve,balanceLabel:Ke,xpBonusIndicator:es,xpBonusIcon:ss,xpBonusText:ts,xpSection:as,xpBarContainer:ns,xpOverlay:os,xpLevel:rs,xpNext:is,xpBar:cs},ls=({userId:n,balance:r})=>{const c=q(n),{user:t}=L(),x=t?.subscription?.isPremium;return e.jsxs("div",{className:`panel-frost ${_.progressContainer}`,children:[e.jsxs("div",{className:_.balanceSection,children:[e.jsxs("div",{className:_.balanceLeft,children:[e.jsx("span",{className:_.balanceLabel,children:"Balance:"}),e.jsx(ee,{amount:Number(r)||0,size:"medium"})]}),x&&e.jsxs("div",{className:_.xpBonusIndicator,children:[e.jsx(ge,{size:16,strokeWidth:2.5,className:_.xpBonusIcon}),e.jsx("span",{className:_.xpBonusText,children:"2x XP"})]})]}),c&&e.jsx("div",{className:_.xpSection,children:e.jsxs("div",{className:_.xpBarContainer,children:[e.jsx("div",{className:_.xpBar,style:{width:c.level>=100?"100%":`${c.percentToNextLevel||0}%`}}),e.jsxs("div",{className:_.xpOverlay,children:[e.jsxs("div",{className:_.xpLevel,children:["Level ",c.level]}),e.jsx("div",{className:_.xpNext,children:c.level<100?`${c.xpToNextLevel.toLocaleString()} XP`:"MAX"})]})]})})]})},ms=()=>{const{user:n,logout:r}=L(),[c,t]=b.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`panel-frost ${y.userSection}`,children:[e.jsx("div",{className:y.avatarContainer,children:e.jsx(se,{userId:n?.id,size:"medium",showName:!0,namePosition:"right"})}),e.jsx(ls,{userId:n?.id,balance:n?.balance}),e.jsxs("div",{className:y.headerButtons,children:[e.jsx("button",{type:"button",className:y.logoutButton,onClick:r,"data-gamepad-focusable":"true",children:e.jsx("span",{className:y.buttonText,children:"Logout"})}),e.jsx(te,{"data-gamepad-focusable":"true"}),e.jsx(ae,{"data-gamepad-focusable":"true"}),e.jsx(ne,{onClick:()=>t(!0),"data-gamepad-focusable":"true"}),e.jsx(oe,{"data-gamepad-focusable":"true"})]})]}),c&&e.jsx(re,{onClose:()=>t(!1)})]})},bs=()=>{const{gameList:n}=J(),{user:r,logout:c}=L(),{socket:t,isConnected:x}=T(),a=X();Z(!0);const p=Y(),[f,h]=b.useState(""),[A,s]=b.useState(!1),{shouldShowAd:u,showAd:m,hideAd:i}=ie(),d=!r?.subscription?.isPremium,j=r?.id||null;b.useEffect(()=>{a.state?.fromGame&&m()},[a.state,m]),b.useEffect(()=>{r&&(!r.username||!r.id)&&(console.error("[Lobby] Invalid user data received:",r),c())},[r,c]);const z=g=>{!x||!r||(Q.play("ui.click"),p(`/${g}`))},W=g=>{h(g.target.value)},G=g=>{if(!r?.id||!x)return;const N=v=>{t.off("gameCreated",N),v?.game?.id&&p(`/${v.game.id}`)};t.on("gameCreated",N),g?t.emit("createGame",{settings:g}):t.emit("createGame")},U=()=>G({numberOfBots:5}),F=()=>{s(!0)},R=g=>{s(!1),G(g)},I=b.useMemo(()=>{if(!n)return[];let g=n;if(f.trim()){const N=f.trim().toLowerCase();g=n.filter(v=>v.id.toLowerCase().includes(N))}return g.sort((N,v)=>{const k=N.allPlayers?.some(C=>C.userId===j),$=v.allPlayers?.some(C=>C.userId===j),E=N.disconnectedPlayers?.some(C=>C.userId===j),O=v.disconnectedPlayers?.some(C=>C.userId===j);return E&&!O?-1:!E&&O?1:k&&!$?-1:!k&&$?1:N.id.localeCompare(v.id)})},[n,f,j]);return e.jsxs("div",{className:`screen app-gradient-bg ${l.lobbyScreen} ${d?l.withAds:""}`,children:[e.jsx(H,{}),e.jsx("div",{className:l.onlineCountWrapper,children:e.jsx(Me,{})}),e.jsx("div",{className:l.playerSection,children:e.jsx(ms,{})}),e.jsxs("div",{className:l.gameActionsSection,children:[e.jsx("button",{type:"button",className:"btn btn-primary",onClick:U,disabled:!r?.username,"data-gamepad-focusable":"true",children:"Create Quick Game"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:F,disabled:!r?.username,"data-gamepad-focusable":"true",children:"Create Custom Game"})]}),e.jsxs("div",{className:`panel-frost ${l.gameListSection}`,children:[e.jsx("h2",{className:l.gameListTitle,children:"Available Games"}),e.jsx("div",{className:l.searchContainer,children:e.jsxs("div",{className:"input-with-icon",children:[e.jsx("span",{className:"input-icon left",style:{display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(pe,{size:18,strokeWidth:2.5})}),e.jsx(S,{title:"Search Games",type:"search",className:"no-validation",placeholder:"Search available games",value:f,onChange:W})]})}),I&&I.length>0?e.jsx("div",{className:l.gameListWrapper,children:I.map(g=>e.jsx(Te,{game:g,onJoin:z,userId:j},g.id))}):e.jsx("p",{className:l.emptyStateMessage,children:f.trim()?"No games found":"No games available"})]}),A&&e.jsx(qe,{onSubmit:R,onClose:()=>s(!1)}),e.jsx(V,{}),u&&e.jsx(ce,{onClose:i}),e.jsx(le,{hideAtWidth:1e3}),e.jsx(D,{position:"left"}),e.jsx(D,{position:"right"})]})};export{bs as default};
