import{U as c,k as G,V as u,X as $,c as U,t as V,F as T,D as j,h as R,O as D,Y as H,Z as e,_ as O,$ as C}from"./index--b34lDLk.js";import{u as q,b as r}from"./vendor-DH36gEE2.js";import{u as X}from"./useGamepadNavigation-DaSjAjaT.js";import{g as Y,o as B}from"./openInBrowser-BFnLqAvO.js";import{A as Z}from"./AppHeader-D8s4R8y0.js";import"./socket-CA1CrNgP.js";import"./audio-B6pt64N7.js";const J={async signInWithApple(){return(await c.signInWithApple()).user},async signInWithGoogle(){return(await c.signInWithGoogle()).user},async signInWithFacebook(){return(await c.signInWithFacebook({useLimitedLogin:!0})).user},async signInWithEmail(t,a){return(await c.signInWithEmailAndPassword({email:t,password:a})).user},async createAccountWithEmail(t,a){return(await c.createUserWithEmailAndPassword({email:t,password:a})).user},async getCurrentUser(){return(await c.getCurrentUser()).user},async signOut(){await c.signOut()},async sendPasswordResetEmail(t){await c.sendPasswordResetEmail({email:t})},getErrorMessage(t){return{"auth/invalid-email":"Invalid email address","auth/user-disabled":"This account has been disabled","auth/user-not-found":"No account found with this email","auth/wrong-password":"Incorrect password","auth/email-already-in-use":"An account with this email already exists","auth/weak-password":"Password should be at least 6 characters","auth/operation-not-allowed":"This sign-in method is not enabled","auth/popup-closed-by-user":"Sign-in cancelled","auth/cancelled-popup-request":"Sign-in cancelled","auth/popup-blocked":"Pop-up blocked. Please allow pop-ups and try again"}[t?.code]||t?.message||"An error occurred during authentication"}},K={async signInWithApple(){const t=new D("apple.com");return(await j(u,t)).user},async signInWithGoogle(){const t=new R;return(await j(u,t)).user},async signInWithFacebook(){const t=new T;return(await j(u,t)).user},async signInWithEmail(t,a){return(await V(u,t,a)).user},async createAccountWithEmail(t,a){return(await U(u,t,a)).user},getCurrentUser(){return Promise.resolve(u.currentUser)},async signOut(){await $(u)},async sendPasswordResetEmail(t){await G(u,t,{url:`${window.location.origin}/auth`,handleCodeInApp:!1})},getErrorMessage(t){return{"auth/invalid-email":"Invalid email address","auth/user-disabled":"This account has been disabled","auth/user-not-found":"No account found with this email","auth/wrong-password":"Incorrect password","auth/email-already-in-use":"An account with this email already exists","auth/weak-password":"Password should be at least 6 characters","auth/operation-not-allowed":"This sign-in method is not enabled","auth/popup-closed-by-user":"Sign-in cancelled","auth/cancelled-popup-request":"Sign-in cancelled","auth/popup-blocked":"Pop-up blocked. Please allow pop-ups and try again"}[t?.code]||t?.message||"An error occurred during authentication"}},Q=H.isNativePlatform(),l=Q?J:K,ee="_socialButton_1ecle_1",se="_disabled_1ecle_20",te="_icon_1ecle_35",ae="_label_1ecle_42",ne="_apple_1ecle_48",oe="_google_1ecle_60",ie="_facebook_1ecle_72",re="_spinner_1ecle_84",d={socialButton:ee,disabled:se,icon:te,label:ae,apple:ne,google:oe,facebook:ie,spinner:re},E=({provider:t,onClick:a,disabled:o,loading:m})=>{const n=(()=>{switch(t){case"apple":return{icon:e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M17.05 20.28c-.98.95-2.05.8-3.08.35-1.09-.46-2.09-.48-3.24 0-1.44.62-2.2.44-3.06-.35C2.79 15.25 3.51 7.59 9.05 7.31c1.35.07 2.29.74 3.08.8 1.18-.24 2.31-.93 3.57-.84 1.51.12 2.65.72 3.4 1.8-3.12 1.87-2.38 5.98.48 7.13-.57 1.5-1.31 2.99-2.54 4.09l.01-.01zM12.03 7.25c-.15-2.23 1.66-4.07 3.74-4.25.29 2.58-2.34 4.5-3.74 4.25z"})}),label:"Sign in with Apple",className:d.apple};case"google":return{icon:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),e.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),label:"Continue with Google",className:d.google};case"facebook":return{icon:e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),label:"Continue with Facebook",className:d.facebook};default:return null}})();return n?e.jsx("button",{type:"button",className:`${d.socialButton} ${n.className} ${o?d.disabled:""}`,onClick:a,disabled:o||m,children:m?e.jsx("div",{className:d.spinner}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:d.icon,children:n.icon}),e.jsx("span",{className:d.label,children:n.label})]})}):null},le="_authPage_1ggtc_1",ce="_container_1ggtc_31",ue="_content_1ggtc_43",de="_errorAlert_1ggtc_61",ge="_socialButtons_1ggtc_86",he="_divider_1ggtc_94",pe="_emailButton_1ggtc_116",me="_privacyNote_1ggtc_150",we="_emailForm_1ggtc_159",_e="_inputGroup_1ggtc_165",be="_label_1ggtc_171",fe="_input_1ggtc_165",xe="_submitButton_1ggtc_200",ve="_spinner_1ggtc_231",je="_toggleMode_1ggtc_244",ke="_backButton_1ggtc_263",ye="_forgotPasswordLink_1ggtc_287",Ne="_forgotPasswordText_1ggtc_306",Pe="_successMessage_1ggtc_315",Ce="_migrationBanner_1ggtc_349",Be="_migrationLink_1ggtc_371",Ee="_footer_1ggtc_387",Se="_footerLinks_1ggtc_399",Ae="_footerLink_1ggtc_399",Fe="_footerDivider_1ggtc_420",Ie="_footerVersion_1ggtc_424",s={authPage:le,container:ce,content:ue,errorAlert:de,socialButtons:ge,divider:he,emailButton:pe,privacyNote:me,emailForm:we,inputGroup:_e,label:be,input:fe,submitButton:xe,spinner:ve,toggleMode:je,backButton:ke,forgotPasswordLink:ye,forgotPasswordText:Ne,successMessage:Pe,migrationBanner:Ce,migrationLink:Be,footer:Ee,footerLinks:Se,footerLink:Ae,footerDivider:Fe,footerVersion:Ie},Ve=()=>{const t=q(),{user:a}=O(),[o,m]=r.useState(null),[f,n]=r.useState(null),[S,k]=r.useState(!1),[p,A]=r.useState(!1),[g,x]=r.useState(""),[v,F]=r.useState(""),[h,_]=r.useState(!1),[I,b]=r.useState(!1),[W,y]=r.useState(!1),[N,L]=r.useState(null);X(!1),r.useEffect(()=>{Y().then(L)},[]),r.useEffect(()=>{a&&t("/")},[a,t]);const P=async i=>{n(null),m(i);try{switch(i){case"apple":await l.signInWithApple();break;case"google":await l.signInWithGoogle();break;case"facebook":await l.signInWithFacebook();break;default:throw new Error("Unknown provider")}}catch(w){n(l.getErrorMessage(w))}finally{m(null)}},M=async i=>{i.preventDefault(),n(null),_(!0);try{p?await l.createAccountWithEmail(g,v):await l.signInWithEmail(g,v)}catch(w){n(l.getErrorMessage(w))}finally{_(!1)}},z=async i=>{i.preventDefault(),n(null),_(!0);try{if(!g){n("Please enter your email address");return}await l.sendPasswordResetEmail(g),y(!0)}catch(w){n(l.getErrorMessage(w))}finally{_(!1)}};return e.jsxs("div",{className:`screen app-gradient-bg ${s.authPage}`,children:[e.jsx(Z,{}),e.jsxs("div",{className:s.container,children:[e.jsxs("div",{className:s.migrationBanner,children:[e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"})}),e.jsxs("span",{children:["Have an existing account?"," ",e.jsx("button",{type:"button",className:s.migrationLink,onClick:()=>t("/migrate"),children:"Migrate your account"})]})]}),e.jsxs("div",{className:s.content,children:[f&&e.jsxs("div",{className:s.errorAlert,children:[e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"})}),e.jsx("span",{children:f})]}),S?I?e.jsx(e.Fragment,{children:W?e.jsxs("div",{className:s.successMessage,children:[e.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),e.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),e.jsx("h3",{children:"Check your email"}),e.jsxs("p",{children:["We've sent a password reset link to ",e.jsx("strong",{children:g})]}),e.jsx("button",{type:"button",className:s.backButton,onClick:()=>{b(!1),y(!1),x("")},children:"← Back to sign in"})]}):e.jsxs("form",{onSubmit:z,className:s.emailForm,children:[e.jsx("p",{className:s.forgotPasswordText,children:"Enter your email address and we'll send you a link to reset your password."}),e.jsxs("div",{className:s.inputGroup,children:[e.jsx("label",{htmlFor:"reset-email",className:s.label,children:"Email"}),e.jsx("input",{id:"reset-email",type:"email",value:g,onChange:i=>x(i.target.value),className:s.input,placeholder:"your@email.com",required:!0,autoComplete:"email",autoFocus:!0})]}),e.jsx("button",{type:"submit",className:s.submitButton,disabled:h,children:h?e.jsx("div",{className:s.spinner}):"Send reset link"}),e.jsx("button",{type:"button",className:s.backButton,onClick:()=>{b(!1),n(null)},disabled:h,children:"← Back to sign in"})]})}):e.jsx(e.Fragment,{children:e.jsxs("form",{onSubmit:M,className:s.emailForm,children:[e.jsxs("div",{className:s.inputGroup,children:[e.jsx("label",{htmlFor:"email",className:s.label,children:"Email"}),e.jsx("input",{id:"email",name:"username",type:"email",value:g,onChange:i=>x(i.target.value),className:s.input,placeholder:"your@email.com",required:!0,autoComplete:"username",autoFocus:!0})]}),e.jsxs("div",{className:s.inputGroup,children:[e.jsx("label",{htmlFor:"password",className:s.label,children:"Password"}),e.jsx("input",{id:"password",name:"password",type:"password",value:v,onChange:i=>F(i.target.value),className:s.input,placeholder:"••••••••",required:!0,autoComplete:p?"new-password":"current-password",minLength:"6"}),!p&&e.jsx("button",{type:"button",className:s.forgotPasswordLink,onClick:()=>b(!0),children:"Forgot password?"})]}),e.jsx("button",{type:"submit",className:s.submitButton,disabled:h,children:h?e.jsx("div",{className:s.spinner}):p?"Create Account":"Sign In"}),e.jsx("button",{type:"button",className:s.toggleMode,onClick:()=>A(!p),disabled:h,children:p?"Already have an account? Sign in":"Need an account? Sign up"}),e.jsx("button",{type:"button",className:s.backButton,onClick:()=>{k(!1),b(!1),n(null)},disabled:h,children:"← Back to all sign-in options"})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:s.socialButtons,children:[e.jsx(E,{provider:"google",onClick:()=>P("google"),disabled:o!==null,loading:o==="google"}),e.jsx(E,{provider:"facebook",onClick:()=>P("facebook"),disabled:o!==null,loading:o==="facebook"})]}),e.jsx("p",{className:s.privacyNote,children:"We only access your email address"}),e.jsx("div",{className:s.divider,children:e.jsx("span",{children:"or"})}),e.jsxs("button",{type:"button",className:s.emailButton,onClick:()=>k(!0),disabled:o!==null,children:[e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("rect",{x:"3",y:"5",width:"18",height:"14",rx:"2"}),e.jsx("path",{d:"M3 7l9 6 9-6"})]}),e.jsx("span",{children:"Continue with Email"})]})]})]}),e.jsxs("div",{className:s.footer,children:[e.jsxs("div",{className:s.footerLinks,children:[e.jsx("button",{type:"button",onClick:()=>B(`${C}/terms`),className:s.footerLink,children:"Terms of Service"}),e.jsx("span",{className:s.footerDivider,children:"•"}),e.jsx("button",{type:"button",onClick:()=>B(`${C}/privacy`),className:s.footerLink,children:"Privacy Policy"})]}),N&&e.jsx("div",{className:s.footerVersion,children:N.display})]})]})]})};export{Ve as default};
