import{u as e,j as r,A as o,B as t,a,T as n}from"./ui-D6NhbJM_.js";import{r as i,u as s}from"./vendor--mFYx9eN.js";import{G as l,A as u}from"./AppHeader-BAHraF2A.js";import{u as d,A as c}from"./index-DAqpCjzk.js";import{u as m}from"./useGamepadNavigation-D-XLtfPQ.js";const g="_authForm_n8ohl_1",f="_submitButton_n8ohl_69",p=({onSubmit:a,mode:n})=>{const[s,u]=i.useState(""),[d,c]=i.useState(""),[m,p]=i.useState("");e("(max-width:600px)");const h=e("(max-width:400px)");return r.jsxs("div",{className:`card ${g}`,children:[r.jsx("h2",{style:{color:"white",fontWeight:600,textAlign:"center",marginTop:0},children:"login"===n?"Welcome Back":"Create Account"}),r.jsx("div",{className:"divider",style:{marginBottom:"1.5rem"}}),m&&r.jsx(o,{severity:"error",sx:{mb:2,backgroundColor:"rgba(231, 76, 60, 0.2)",color:"var(--text-primary)"},children:m}),r.jsxs("form",{onSubmit:async e=>{e.preventDefault(),p("");try{await a(s,d)}catch(r){p(r.message)}},children:[r.jsx(l,{title:"Enter Username",label:"Username",variant:"outlined",fullWidth:!0,margin:"normal",value:s,onChange:e=>u(e.target.value),required:!0,size:h?"small":"medium",inputProps:{minLength:3},sx:{"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:"var(--info-light)"},"&:hover fieldset":{borderColor:"var(--info)"},"&.Mui-focused fieldset":{borderColor:"var(--info)"},backgroundColor:"rgba(255, 255, 255, 0.1)"},"& .MuiInputLabel-root":{color:"var(--info-light)",fontSize:h?"0.9rem":"1rem"},"& .MuiOutlinedInput-input":{color:"var(--text-dark)",fontWeight:500,backgroundColor:"rgba(255, 255, 255, 0.85)",padding:h?"12px 14px":"16.5px 14px"},"& .MuiInputLabel-root.Mui-focused":{color:"var(--info)"},marginBottom:h?"0.5rem":"1rem"}}),r.jsx(l,{title:"Enter Password",label:"Password",type:"password",variant:"outlined",fullWidth:!0,margin:"normal",value:d,onChange:e=>c(e.target.value),required:!0,size:h?"small":"medium",inputProps:{minLength:6},sx:{"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:"var(--info-light)"},"&:hover fieldset":{borderColor:"var(--info)"},"&.Mui-focused fieldset":{borderColor:"var(--info)"},backgroundColor:"rgba(255, 255, 255, 0.1)"},"& .MuiInputLabel-root":{color:"var(--info-light)",fontSize:h?"0.9rem":"1rem"},"& .MuiOutlinedInput-input":{color:"var(--text-dark)",fontWeight:500,backgroundColor:"rgba(255, 255, 255, 0.85)",padding:h?"12px 14px":"16.5px 14px"},"& .MuiInputLabel-root.Mui-focused":{color:"var(--info)"},marginBottom:h?"0.5rem":"1rem"}}),r.jsx(t,{type:"submit",variant:"contained",fullWidth:!0,size:"large",className:f,"data-gamepad-focusable":"true",sx:{mt:h?2:3,background:"linear-gradient(to right, var(--info), var(--success))",textTransform:"none",fontWeight:"bold",letterSpacing:"0.5px",padding:h?"10px":"12px",fontSize:h?"0.9rem":"1rem","&:hover":{background:"linear-gradient(to right, var(--info-dark), var(--success-dark))",boxShadow:"var(--shadow-lg)",transform:"translateY(-2px)"}},children:"login"===n?"Sign In":"Create Account"})]})]})},h="_authPage_2uxv5_1",x="_error_2uxv5_19",v="_formContainer_2uxv5_32",b=()=>{const[e,o]=i.useState("login"),{login:l}=d(),g=s();m(!0);const[f,b]=i.useState(null);return r.jsxs(a,{className:`screen ${h}`,children:[r.jsx(u,{}),r.jsxs(a,{className:v,children:[f&&r.jsx(n,{className:x,children:f}),r.jsx(p,{mode:e,onSubmit:async(r,o)=>{if(!r||!o)return void b("Username and password are required");b(null);const t=`${c}/auth/${e}`;try{const e={username:r,password:o},n=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});let i;try{i=await n.json()}catch(a){throw new Error("Invalid response from server")}if(!n.ok)throw new Error(i.message||"Authentication failed");if(!i.user?.username||!i.user?.id||!i.token)throw new Error("Invalid server response format");try{l(i.user,i.token),g("/")}catch(a){throw new Error("Failed to initialize user session")}}catch(a){b(a.message||"Failed to connect to server")}}}),r.jsx(a,{textAlign:"center",mt:3,children:r.jsx(t,{color:"primary",onClick:()=>o("login"===e?"register":"login"),"data-gamepad-focusable":"true",sx:{color:"#ecf0f1",textTransform:"none",fontSize:"1rem","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.1)"}},children:"login"===e?"Don't have an account? Register":"Already have an account? Login"})})]})]})};export{b as default};
