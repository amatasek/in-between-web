import{a2 as W,Z as e,a3 as Q,_ as U,a4 as V,a5 as Y,a6 as X,$ as E}from"./index-DAklXEEH.js";import{b as _,f as Z,u as K}from"./vendor-CT7sGowS.js";import{u as ee}from"./useGamepadNavigation-DKu7SyYo.js";import{A as se}from"./AppHeader-DEwOgV4v.js";import{B as te,T as I,G as w,C as ae,U as ne,R as oe,P as re,S as ie,a as ce,b as le,u as me,A as de,c as ue,d as O}from"./useAdInterstitial-cwENq4IP.js";import{g as pe,o as M}from"./openInBrowser-TQCWIQ5p.js";import"./socket-CA1CrNgP.js";import"./audio-hxunv4lQ.js";const he="_lobbyScreen_3cxga_1",xe="_withAds_3cxga_6",ge="_versionInfo_3cxga_18",fe="_legalLinks_3cxga_28",_e="_legalLink_3cxga_28",je="_legalDivider_3cxga_52",Ne="_gameListTitle_3cxga_86",ve="_searchContainer_3cxga_99",be="_gameListWrapper_3cxga_136",Ce="_userDisconnectedGame_3cxga_155",ye="_userInGame_3cxga_162",Se="_gameListInfo_3cxga_185",we="_gameListId_3cxga_190",Ie="_disconnectedBadge_3cxga_199",Ae="_inGameBadge_3cxga_211",Le="_gameListPlayers_3cxga_223",Be="_emptyStateIcon_3cxga_290",Ge="_emptyStateMessage_3cxga_296",Pe="_emptyStateHint_3cxga_303",$e="_privatePill_3cxga_309",ke="_gameActionsSection_3cxga_322",De="_gameCard_3cxga_329",c={lobbyScreen:he,withAds:xe,versionInfo:ge,legalLinks:fe,legalLink:_e,legalDivider:je,gameListTitle:Ne,searchContainer:ve,gameListWrapper:be,userDisconnectedGame:Ce,userInGame:ye,gameListInfo:Se,gameListId:we,disconnectedBadge:Ie,inGameBadge:Ae,gameListPlayers:Le,emptyStateIcon:Be,emptyStateMessage:Ge,emptyStateHint:Pe,privatePill:$e,gameActionsSection:ke,gameCard:De},Ee="_pill_q09di_1",Oe="_pulse_q09di_23",Me="_text_q09di_49",B={pill:Ee,pulse:Oe,text:Me},Te=()=>{const{socket:n,isConnected:i}=W(),[r,t]=_.useState(null);return _.useEffect(()=>{if(!n||!i)return;n.emit("getOnlinePlayerCount",a=>{t(a)});const x=a=>t(a);return n.on("onlinePlayerCountUpdate",x),()=>{n.off("onlinePlayerCountUpdate",x)}},[n,i]),r===null?null:e.jsxs("div",{className:B.pill,children:[e.jsx("span",{className:B.pulse}),e.jsxs("span",{className:B.text,children:[r," online"]})]})},We=({className:n="",width:i="1em",height:r="1em",...t})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`feather feather-lock ${n}`,width:i,height:r,...t,children:[e.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),e.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]});function Ue({game:n,onJoin:i,userId:r}){const t=n.settings?.customName||`Game ${n.id}`,x=n.disconnectedPlayers?.some(h=>h.userId===r),a=n.allPlayers?.some(h=>h.userId===r&&!h.disconnected);let p="Join";x?p="Reconnect":a&&(p="Continue");let f=`panel ${c.gameCard}`;return x?f+=` ${c.userDisconnectedGame}`:a&&(f+=` ${c.userInGame}`),e.jsxs("div",{className:f,children:[" ",e.jsxs("div",{className:c.gameListInfo,style:{flex:1},children:[e.jsxs("div",{className:c.gameListId,children:[" ",t,n.settings?.isPrivate&&e.jsxs("span",{className:c.privatePill,title:"Private Game",children:[e.jsx(We,{width:"0.9em",height:"0.9em",style:{marginRight:"4px",verticalAlign:"middle"}}),"Private"]}),x&&e.jsx("span",{className:c.disconnectedBadge,title:"You're disconnected from this game",children:"âš ï¸ Reconnect"}),a&&e.jsx("span",{className:c.inGameBadge,title:"You're in this game",children:"You're In"})]}),e.jsxs("div",{className:c.gameListPlayers,children:[" ",n.playerCount," ",n.playerCount===1?"player":"players"]})]}),e.jsx("button",{type:"button",className:"btn btn-primary",style:{padding:"0.4rem 1rem",fontSize:"0.9rem",minWidth:"80px",maxWidth:"100px",flexShrink:0},onClick:()=>i(n.id),disabled:!r,"data-gamepad-focusable":"true",children:p})]})}const ze="_gameSettingItem_tzwbj_1",He="_settingDescription_tzwbj_13",Re="_settingControls_tzwbj_35",qe="_textInput_tzwbj_42",Fe="_inputError_tzwbj_60",o={gameSettingItem:ze,settingDescription:He,settingControls:Re,textInput:qe,inputError:Fe},T={useCustomName:!1,customName:"",isPrivate:!1,password:"",enableAceChoice:!0,enableSecondChance:!0,numberOfBots:0,anteAmount:""},Je=({initialSettings:n=T,onSubmit:i,onClose:r})=>{const[t,x]=_.useState({...T,...n}),[a,p]=_.useState({}),f=s=>{const d={};if(s.useCustomName){const m=s.customName||"";m?m.length<4||m.length>26?d.customName="Name must be 4-26 characters.":/^[a-zA-Z0-9_-]+$/.test(m)||(d.customName="Use letters, numbers, -, or _."):d.customName="Custom name is required."}if(s.isPrivate){const m=s.password||"";m?(m.length<3||m.length>36)&&(d.password="Password must be 3-36 characters."):d.password="Password is required."}const u=s.numberOfBots;(u<0||u>16)&&(d.numberOfBots="Number of bots must be between 0 and 16.");const l=s.anteAmount;if(l!==""&&l!==null&&l!==void 0){const m=parseInt(l);(isNaN(m)||m<1||m>100)&&(d.anteAmount="Ante amount must be between 1 and 100.")}return d},h=(s,d)=>{x(u=>{const l={...u,[s]:d};return s==="useCustomName"&&!d&&(l.customName="",a.customName&&p(m=>{const b={...m};return delete b.customName,b})),s==="isPrivate"&&!d&&(l.password="",a.password&&p(m=>{const b={...m};return delete b.password,b})),l}),(s==="customName"||s==="useCustomName")&&a.customName&&p(u=>{const l={...u};return delete l.customName,l}),(s==="password"||s==="isPrivate")&&a.password&&p(u=>{const l={...u};return delete l.password,l}),s==="numberOfBots"&&a.numberOfBots&&p(u=>{const l={...u};return delete l.numberOfBots,l}),s==="anteAmount"&&a.anteAmount&&p(u=>{const l={...u};return delete l.anteAmount,l})},A=s=>{s.preventDefault();const d=f(t);if(Object.keys(d).length>0)p(d);else{p({});const u={...t,customName:t.useCustomName?t.customName:null,anteAmount:t.anteAmount===""?1:parseInt(t.anteAmount)};delete u.useCustomName,i(u)}};return e.jsx(te,{title:"Game Options",onClose:r,style:{maxWidth:600},footer:e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("button",{type:"button",onClick:r,className:"btn btn-secondary","data-gamepad-focusable":"true",children:"Cancel"}),e.jsx("button",{type:"submit",form:"gameSettingsForm",className:"btn btn-primary",disabled:Object.keys(a).length>0,"data-gamepad-focusable":"true",children:"Create Game"})]}),children:e.jsxs("form",{id:"gameSettingsForm",onSubmit:A,children:[e.jsxs("div",{className:`panel-alt ${o.gameSettingItem}`,children:[e.jsxs("div",{className:o.settingDescription,children:[e.jsx("h4",{children:"Custom Game Name"}),e.jsx("p",{children:"Set a custom name for your game lobby"})]}),e.jsxs("div",{className:o.settingControls,children:[e.jsx(I,{isChecked:t.useCustomName,onChange:s=>h("useCustomName",s.target.checked)}),t.useCustomName&&e.jsx(w,{title:"Enter Game Name",type:"text",value:t.customName||"",onChange:s=>h("customName",s.target.value),className:`${o.textInput}${a.customName?` ${o.inputError}`:""}`,placeholder:"Game Name",maxLength:26,style:{marginTop:8}}),a.customName&&e.jsx("span",{className:"errorMessage",children:a.customName})]})]}),e.jsxs("div",{className:`panel-alt ${o.gameSettingItem}`,children:[e.jsxs("div",{className:o.settingDescription,children:[e.jsx("h4",{children:"Private Game"}),e.jsx("p",{children:"Only players with the password can join"})]}),e.jsxs("div",{className:o.settingControls,children:[e.jsx(I,{isChecked:t.isPrivate,onChange:s=>h("isPrivate",s.target.checked)}),t.isPrivate&&e.jsx(w,{title:"Enter Game Password",type:"text",value:t.password||"",onChange:s=>h("password",s.target.value),className:`${o.textInput}${a.password?` ${o.inputError}`:""}`,placeholder:"Password",maxLength:36,style:{marginTop:8}}),a.password&&e.jsx("span",{className:"errorMessage",children:a.password})]})]}),e.jsxs("div",{className:`panel-alt ${o.gameSettingItem}`,children:[e.jsxs("div",{className:o.settingDescription,children:[e.jsx("h4",{children:"Number of Bots"}),e.jsx("p",{children:"Add AI players to your game (0-16)"})]}),e.jsxs("div",{className:o.settingControls,children:[e.jsx(w,{title:"Number of AI Players",type:"number",min:"0",max:"16",value:t.numberOfBots===0?"":t.numberOfBots,onChange:s=>h("numberOfBots",s.target.value===""?0:parseInt(s.target.value)||0),className:`${o.textInput} no-validation${a.numberOfBots?` ${o.inputError}`:""}`,placeholder:"0"}),a.numberOfBots&&e.jsx("span",{className:"errorMessage",children:a.numberOfBots})]})]}),e.jsxs("div",{className:`panel-alt ${o.gameSettingItem}`,children:[e.jsxs("div",{className:o.settingDescription,children:[e.jsx("h4",{children:"Ante Amount"}),e.jsx("p",{children:"Set the ante amount for each round (1-100)"})]}),e.jsxs("div",{className:o.settingControls,children:[e.jsx(w,{title:"Ante Amount",type:"number",min:"1",max:"100",value:t.anteAmount,onChange:s=>h("anteAmount",s.target.value),className:`${o.textInput} no-validation${a.anteAmount?` ${o.inputError}`:""}`,placeholder:"1"}),a.anteAmount&&e.jsx("span",{className:"errorMessage",children:a.anteAmount})]})]}),e.jsxs("div",{className:`panel-alt ${o.gameSettingItem}`,children:[e.jsxs("div",{className:o.settingDescription,children:[e.jsx("h4",{children:"Enable Ace Choice"}),e.jsx("p",{children:"Allow players to choose high/low on Ace"})]}),e.jsx("div",{className:o.settingControls,children:e.jsx(I,{isChecked:t.enableAceChoice,onChange:s=>h("enableAceChoice",s.target.checked)})})]}),e.jsxs("div",{className:`panel-alt ${o.gameSettingItem}`,children:[e.jsxs("div",{className:o.settingDescription,children:[e.jsx("h4",{children:"Enable Second Chance"}),e.jsx("p",{children:"Allow players to ante up for a second chance"})]}),e.jsx("div",{className:o.settingControls,children:e.jsx(I,{isChecked:t.enableSecondChance,onChange:s=>h("enableSecondChance",s.target.checked)})})]})]})})},Qe="_userSection_53k67_2",Ve="_avatarContainer_53k67_12",Ye="_headerButtons_53k67_16",Xe="_logoutButton_53k67_40",S={userSection:Qe,avatarContainer:Ve,headerButtons:Ye,logoutButton:Xe},Ze="_balanceSection_1ap8t_1",Ke="_balanceLabel_1ap8t_10",es="_xpSection_1ap8t_17",ss="_xpBarContainer_1ap8t_21",ts="_xpOverlay_1ap8t_31",as="_xpLevel_1ap8t_45",ns="_xpNext_1ap8t_52",os="_xpBar_1ap8t_21",v={balanceSection:Ze,balanceLabel:Ke,xpSection:es,xpBarContainer:ss,xpOverlay:ts,xpLevel:as,xpNext:ns,xpBar:os},rs=({userId:n,balance:i})=>{const r=Q(n);return e.jsxs("div",{className:"panel-alt",style:{width:"100%",flex:2},children:[e.jsxs("div",{className:v.balanceSection,children:[e.jsx("span",{className:v.balanceLabel,children:"Balance:"}),e.jsx(ae,{amount:Number(i)||0,size:"medium"})]}),r&&e.jsx("div",{className:v.xpSection,children:e.jsxs("div",{className:v.xpBarContainer,children:[e.jsx("div",{className:v.xpBar,style:{width:r.level>=100?"100%":`${r.percentToNextLevel||0}%`}}),e.jsxs("div",{className:v.xpOverlay,children:[e.jsxs("div",{className:v.xpLevel,children:["Level ",r.level]}),e.jsx("div",{className:v.xpNext,children:r.level<100?`${r.xpToNextLevel.toLocaleString()} XP`:"MAX"})]})]})})]})},is=()=>{const{user:n,logout:i,refreshUserData:r}=U(),[t,x]=_.useState(!1);return e.jsxs("div",{style:{width:"100%"},children:[e.jsxs("div",{className:`panel ${S.userSection}`,children:[e.jsx("div",{className:S.avatarContainer,children:e.jsx(ne,{userId:n?.id,size:"medium",showName:!0,namePosition:"right"})}),e.jsx(rs,{userId:n?.id,balance:n?.balance}),e.jsxs("div",{className:S.headerButtons,children:[e.jsx("button",{type:"button",className:S.logoutButton,onClick:i,"data-gamepad-focusable":"true",children:e.jsx("span",{className:S.buttonText,children:"Logout"})}),e.jsx(oe,{"data-gamepad-focusable":"true"}),e.jsx(re,{"data-gamepad-focusable":"true"}),e.jsx(ie,{onClick:()=>x(!0),"data-gamepad-focusable":"true"}),e.jsx(ce,{"data-gamepad-focusable":"true"})]})]}),t&&e.jsx(le,{onClose:()=>{x(!1),r&&r()}})]})},gs=()=>{const{gameList:n}=V(),{user:i,logout:r}=U(),{socket:t,isConnected:x}=W(),a=Z();ee(!0);const p=K(),[f,h]=_.useState(""),[A,s]=_.useState(!1),[d,u]=_.useState(null),{shouldShowAd:l,showAd:m,hideAd:b}=me(),{showAds:z}=Y(),y=i?.id||null;_.useEffect(()=>{a.state?.fromGame&&m()},[a.state,m]),_.useEffect(()=>{pe().then(u)},[]),_.useEffect(()=>{i&&(!i.username||!i.id)&&(console.error("[Lobby] Invalid user data received:",i),r())},[i,r]);const H=g=>{!x||!i||(X.play("ui.click"),p(`/${g}`))},R=g=>{h(g.target.value)},G=g=>{if(!i?.id||!x)return;const j=N=>{t.off("gameCreated",j),N?.game?.id&&p(`/${N.game.id}`)};t.on("gameCreated",j),g?t.emit("createGame",{settings:g}):t.emit("createGame")},q=()=>G({numberOfBots:5}),F=()=>{s(!0)},J=g=>{s(!1),G(g)},L=_.useMemo(()=>{if(!n)return[];let g=n;if(f.trim()){const j=f.trim().toLowerCase();g=n.filter(N=>N.id.toLowerCase().includes(j))}return g.sort((j,N)=>{const P=j.allPlayers?.some(C=>C.userId===y),$=N.allPlayers?.some(C=>C.userId===y),k=j.disconnectedPlayers?.some(C=>C.userId===y),D=N.disconnectedPlayers?.some(C=>C.userId===y);return k&&!D?-1:!k&&D?1:P&&!$?-1:!P&&$?1:j.id.localeCompare(N.id)})},[n,f,y]);return e.jsxs("div",{className:`screen app-gradient-bg ${c.lobbyScreen} ${z?c.withAds:""}`,children:[e.jsx(se,{}),e.jsx("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginTop:"1.1em",marginBottom:"-0.6em"},children:e.jsx(Te,{})}),e.jsxs("div",{className:"card",style:{width:"100%",maxWidth:"600px",marginBottom:"2rem"},children:[e.jsx(is,{}),e.jsx("div",{className:"divider"}),e.jsxs("div",{className:c.gameActionsSection,children:[e.jsx("button",{type:"button",className:"btn btn-primary",onClick:q,disabled:!i?.username,"data-gamepad-focusable":"true",children:"Create Quick Game"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:F,disabled:!i?.username,"data-gamepad-focusable":"true",children:"Create Custom Game"})]})]}),e.jsxs("div",{className:"card",style:{width:"100%",maxWidth:"600px",minHeight:"200px"},children:[e.jsx("h2",{className:c.gameListTitle,children:"Available Games"}),e.jsx("div",{className:c.searchContainer,children:e.jsxs("div",{className:"input-with-icon",children:[e.jsx("span",{className:"input-icon left",children:"ðŸ”"}),e.jsx(w,{title:"Search Games",type:"search",className:"no-validation",placeholder:"Search games by ID",value:f,onChange:R})]})}),L&&L.length>0?e.jsx("div",{className:c.gameListWrapper,children:L.map(g=>e.jsx(Ue,{game:g,onJoin:H,userId:y},g.id))}):e.jsxs("div",{className:"panel-alt",style:{textAlign:"center",padding:"2rem",minHeight:"150px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[e.jsx("div",{className:c.emptyStateIcon,children:"ðŸƒ"}),e.jsx("p",{className:c.emptyStateMessage,children:f.trim()?"No matching games found":"No games in progress"}),e.jsx("p",{className:c.emptyStateHint,children:f.trim()?"Try a different search or create a new game":"Create a new game to get started!"})]})]}),A&&e.jsx(Je,{onSubmit:J,onClose:()=>s(!1)}),d&&e.jsxs("div",{className:c.versionInfo,children:[e.jsxs("div",{className:c.legalLinks,children:[e.jsx("button",{type:"button",onClick:()=>M(`${E}/terms`),className:c.legalLink,children:"Terms of Service"}),e.jsx("span",{className:c.legalDivider,children:"â€¢"}),e.jsx("button",{type:"button",onClick:()=>M(`${E}/privacy`),className:c.legalLink,children:"Privacy Policy"})]}),e.jsx("div",{children:d.display})]}),l&&e.jsx(de,{onClose:b}),e.jsx(ue,{hideAtWidth:1e3}),e.jsx(O,{position:"left"}),e.jsx(O,{position:"right"})]})};export{gs as default};
