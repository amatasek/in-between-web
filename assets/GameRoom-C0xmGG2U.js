import{b as e,a,s,j as t,f as n,U as r,L as i}from"./index-Cc8cSR9y.js";import{r as l,e as c,u as o}from"./vendor-D3vErxIQ.js";import{C as d,a as m,R as u,P as _,S as h,I as x,c as j,b as p,g,d as N,U as v,G as f}from"./GamepadInput-w6e6Oejg.js";import{u as b}from"./useGamepadNavigation-Tj-O-nX_.js";import"./audio-D4HOgbU8.js";import"./socket-DfKCw8Ob.js";const y="♥",C="♦",w="♣",T="♠",I="→",k="↑",A="↓",S="↻",$="✓",P="✕",{TIMERS:B}={TIMERS:{BETTING_DURATION:3e4,DECISION_DURATION:15e3}},E=l.createContext(),L=()=>{const e=l.useContext(E);if(void 0===e)throw new Error("useGameContext must be used within a GameProvider");return e},R=({children:n,gameId:r,initialGameState:i=null})=>{const{socket:c,error:o}=e(),{user:d}=a(),[m,u]=l.useState(i);l.useRef({});const _=l.useRef(null),[h,x]=l.useState(null),j=l.useCallback((()=>{x(null)}),[]);l.useEffect((()=>{o&&x(o)}),[o]),l.useEffect((()=>{if(c)return c.on("gameReconnected",(e=>{u(e.game),x(null),e.game&&e.game.id&&setTimeout((()=>{c.emit("getGameState",{gameId:e.game.id})}),500)})),c.on("gameState",(e=>{if(e&&e.id&&JSON.stringify(m)!==JSON.stringify(e)){if(e.currentPlayerId&&d?.id){const a=e.currentPlayerId===d.id,t=_.current===d.id;a&&!t&&s.play("ui.alert"),_.current=e.currentPlayerId}u(e),j()}})),c.on("gameError",(e=>{x(e)})),()=>{c.off("gameReconnected"),c.off("gameState"),c.off("gameError")}}),[c]);const p=l.useCallback((e=>{if(c&&r)try{c.emit("placeBet",{bet:e,gameId:r})}catch(a){x("Failed to place bet. Please try again.")}}),[c,r]),g=l.useCallback((()=>{if(c&&r)try{c.emit("payAnte",{gameId:r})}catch(e){x("Failed to pay ante. Please try again.")}}),[c,r]),N=l.useCallback((()=>{if(c&&r)try{c.emit("dealCards",{gameId:r})}catch(e){x("Failed to deal cards. Please try again.")}}),[c,r]),v=l.useCallback((()=>{if(c&&r)try{c.emit("revealMiddleCard",{gameId:r})}catch(e){x("Failed to reveal middle card. Please try again.")}}),[c,r]),f=l.useCallback((()=>{if(c&&r)try{c.emit("nextRound",{gameId:r})}catch(e){x("Failed to move to next round. Please try again.")}}),[c,r]),b=l.useCallback((()=>{if(c&&r)try{c.emit("ready")}catch(e){x("Failed to set player ready. Please try again.")}}),[c,r]),y=l.useCallback((()=>{if(c&&r)try{c.emit("unready")}catch(e){x("Failed to set player unready. Please try again.")}}),[c,r]),C={gameState:m,error:h,gameId:r,placeBet:p,payAnte:g,playerReady:b,playerUnready:y,dealCards:N,revealMiddleCard:v,nextRound:f,clearError:j};return t.jsx(E.Provider,{value:C,children:n})},O="_gameContainer_l6mu0_1",D="_gameScreen_l6mu0_5",F="_loadingContainer_l6mu0_31",M="_errorContainer_l6mu0_40",z="_errorText_l6mu0_50",q="_tableWrapper_l6mu0_71",G="_gameBottomSection_l6mu0_85",Y="_headerContainer_wf4qp_1",H="_header_wf4qp_1",U="_headerLeft_wf4qp_24",V="_gameTitle_wf4qp_33",W="_liveTag_wf4qp_44",J="_gameIdText_wf4qp_62",K="_gameIdLink_wf4qp_69",Q="_headerRight_wf4qp_82",X="_controlsStack_wf4qp_88",Z="_balanceDisplay_wf4qp_95",ee="_balanceLabel_wf4qp_108",ae="_controlsGroup_wf4qp_114",se=({color:e="currentColor",size:a=24})=>t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:a,height:a,viewBox:"0 0 24 24",fill:"none",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),t.jsx("polyline",{points:"16 17 21 12 16 7"}),t.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),te=({handleLeaveGame:s,onModalStateChange:n})=>{const{gameState:r,gameId:i}=L(),{socket:c}=e(),{user:o}=a(),g=c?.auth?.userId,N=g&&r?.players?r.players[g]:null,v=N?.balance??o?.balance??0,f=N?.isReady||!1,[b,y]=l.useState(!1),[C,w]=l.useState(!1),[T,I]=l.useState(!1),[k,A]=l.useState(!1),[S,$]=l.useState(!1);return l.useEffect((()=>{n&&n(b||C||T||k||S)}),[b,C,T,k,S,n]),t.jsxs("div",{className:Y,children:[t.jsxs("div",{className:H,children:[t.jsxs("div",{className:U,children:[t.jsxs("h1",{className:V,children:["In Between ",t.jsx("span",{className:W,children:"LIVE"})]}),t.jsx("p",{className:J,children:t.jsxs("span",{className:K,onClick:()=>y(!0),title:"Click to view game summary","data-gamepad-focusable":"true",tabIndex:"0",children:["Game #",i]})})]}),t.jsx("div",{className:Q,children:t.jsxs("div",{className:X,children:[t.jsxs("div",{className:Z,children:[t.jsx("span",{className:ee,children:"Balance:"}),t.jsx(d,{amount:Number(v),size:"small"})]}),t.jsxs("div",{className:ae,children:[t.jsx(m,{onModalStateChange:I,"data-gamepad-focusable":"true"}),t.jsx(u,{onModalStateChange:A,"data-gamepad-focusable":"true"}),t.jsx(_,{onModalStateChange:$,"data-gamepad-focusable":"true"}),t.jsx(h,{onClick:()=>w(!0),"data-gamepad-focusable":"true"}),t.jsx(x,{icon:t.jsx(se,{color:"white",size:20}),title:"Leave Game",onClick:s,variant:"danger",disabled:f,"data-gamepad-focusable":"true"})]})]})})]}),b&&t.jsx(j,{onClose:()=>y(!1),gameData:r}),C&&t.jsx(p,{onClose:()=>w(!1)})]})},ne={table:"_table_zbyr4_2",feltTexture:"_feltTexture_zbyr4_75",sitOutOverlay:"_sitOutOverlay_zbyr4_104"},re={cardsRow:"_cardsRow_oi1ov_1",card:"_card_oi1ov_1",dealingPhase:"_dealingPhase_oi1ov_74",revealingPhase:"_revealingPhase_oi1ov_83",cardBack:"_cardBack_oi1ov_109",redCard:"_redCard_oi1ov_119",blackCard:"_blackCard_oi1ov_123",cardCorner:"_cardCorner_oi1ov_127",bottomRight:"_bottomRight_oi1ov_136",cardValue:"_cardValue_oi1ov_144",cardSuit:"_cardSuit_oi1ov_150",cardCenter:"_cardCenter_oi1ov_155",aceCard:"_aceCard_oi1ov_212",aceIndicator:"_aceIndicator_oi1ov_216",aceHigh:"_aceHigh_oi1ov_236",aceLow:"_aceLow_oi1ov_242",indicatorContent:"_indicatorContent_oi1ov_248"},ie=()=>{const{gameState:e}=L(),[a,s]=l.useState(g());if(l.useEffect((()=>{const e=()=>{s(g())};return window.addEventListener("cardbackchange",e),()=>window.removeEventListener("cardbackchange",e)}),[]),!e)return t.jsx("div",{className:re.loading,children:"Loading game state..."});const{firstCard:n,secondCard:r,thirdCard:i,phase:c,dealer:o}=e,d={2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10",J:"J",Q:"Q",K:"K",A:"A"},m={hearts:y,diamonds:C,clubs:w,spades:T,[y]:y,[C]:C,[w]:w,[T]:T},u=(e,s)=>{if(!e)return t.jsx("div",{className:re.card,children:t.jsx("div",{className:re.cardBack,style:{backgroundImage:`url(${a})`}})},`empty-${s}`);const n=(r=e.suit)===y||r===C||"hearts"===r||"diamonds"===r;var r;const i="A"===e.value,l=e.isAceLow,c=1===s;return t.jsxs("div",{className:`${re.card} ${n?re.redCard:re.blackCard} ${i?re.aceCard:""}`,children:[i&&!c&&t.jsx("div",{className:`${re.aceIndicator} ${l?re.aceLow:re.aceHigh} ${n?re.redCard:re.blackCard}`,children:l?t.jsxs("span",{className:re.indicatorContent,children:["LOW ",A]}):t.jsxs("span",{className:re.indicatorContent,children:["HIGH ",k]})}),t.jsxs("div",{className:re.cardCorner,children:[t.jsx("div",{className:re.cardValue,children:d[e.value]}),t.jsx("div",{className:re.cardSuit,children:m[e.suit]})]}),t.jsx("div",{className:re.cardCenter,children:m[e.suit]}),t.jsxs("div",{className:`${re.cardCorner} ${re.bottomRight}`,children:[t.jsx("div",{className:re.cardValue,children:d[e.value]}),t.jsx("div",{className:re.cardSuit,children:m[e.suit]})]})]},`${e.value}-${e.suit}-${s}`)};return t.jsx("div",{className:`${re.cardsRow} ${"dealing"===c?re.dealingPhase:""} ${"revealing"===c?re.revealingPhase:""}`,children:(()=>{let e=[null,null,null];return n||r||i?(n&&(e[0]={...n}),r&&(e[2]={...r}),i&&(e[1]={...i}),e.map(((e,a)=>u(e,a)))):e.map(((e,a)=>u(e,a)))})()})},le="_potDisplay_1o95d_2",ce="_potLabel_1o95d_18",oe=()=>{const{gameState:e}=L();if(!e)return null;const{pot:a=0}=e;return t.jsxs("div",{className:le,children:[t.jsx("span",{className:ce,children:"POT"}),t.jsx(d,{amount:a,size:"large"})]})},de="_aceOverlay_1apr0_2",me="_cardGlow_1apr0_14",ue="_countdownRing_1apr0_24",_e="_countdownCircle_1apr0_34",he="_choiceButton_1apr0_43",xe="_highButton_1apr0_74",je="_lowButton_1apr0_85",pe="_timerDisplay_1apr0_96",ge="_waitingMessage_1apr0_109",Ne="_aceControlsBottom_1apr0_136",ve="_timerContainer_1apr0_150",fe="_aceButtonContainer_1apr0_158",be="_choicePrompt_1apr0_165",ye="_bottomChoiceButton_1apr0_174",Ce="_lowButtonBottom_1apr0_200",we="_highButtonBottom_1apr0_210",Te=({direction:e="up",color:a="currentColor",size:s=24})=>{const n="down"===e?"rotate(180deg)":"rotate(0deg)";return t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:a,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{transform:n,display:"inline-block",transformOrigin:"center"},children:t.jsx("path",{d:"M7 11l5-5 5 5M7 17l5-5 5 5"})})},Ie="_waitingTimer_1liyp_2",ke="_timerContent_1liyp_24",Ae="_playerName_1liyp_31",Se="_action_1liyp_37",$e="_timerBar_1liyp_43",Pe="_timerProgress_1liyp_51",Be=({playerName:e,action:a="deciding",duration:s=15e3})=>{const[n,r]=l.useState(s),i=l.useRef(Date.now());l.useEffect((()=>{i.current=Date.now(),r(s)}),[s]),l.useEffect((()=>{const e=setInterval((()=>{const a=Date.now()-i.current,t=Math.max(0,s-a);r(t),t<=0&&clearInterval(e)}),100);return()=>clearInterval(e)}),[s]);const c=(s-n)/s*100;return t.jsxs("div",{className:Ie,children:[t.jsxs("div",{className:ke,children:[t.jsx("span",{className:Ae,children:e}),t.jsxs("span",{className:Se,children:["is ",a,"..."]})]}),t.jsx("div",{className:$e,children:t.jsx("div",{className:Pe,style:{width:`${c}%`}})})]})},Ee="_countdownTimer_1r3bp_3",Le="_progressRing_1r3bp_19",Re="_progressRingBackground_1r3bp_25",Oe="_progressRingCircle_1r3bp_31",De="_timeDisplay_1r3bp_40",Fe=({duration:e=15,isActive:a=!0})=>{const[s,n]=l.useState(e),r=l.useRef(Date.now());l.useEffect((()=>{a&&(r.current=Date.now(),n(e))}),[e,a]),l.useEffect((()=>{if(!a)return;const s=setInterval((()=>{const a=Math.floor((Date.now()-r.current)/1e3),t=Math.max(0,e-a);n(t),t<=0&&clearInterval(s)}),100);return()=>clearInterval(s)}),[e,a]);const i=s/e*100,c=50,o=44*Math.PI,d=o-i/100*o;return t.jsxs("div",{className:Ee,children:[t.jsxs("svg",{className:Le,width:c,height:c,viewBox:"0 0 50 50",children:[t.jsx("circle",{className:Re,cx:25,cy:25,r:22,strokeWidth:3}),t.jsx("circle",{className:Oe,cx:25,cy:25,r:22,strokeWidth:3,strokeDasharray:`${o} ${o}`,strokeDashoffset:d,style:{stroke:(()=>{const a=s/e*100;return a>66?"var(--success)":a>33?"var(--accent)":"var(--secondary)"})()}})]}),t.jsxs("div",{className:De,children:[s,"s"]})]})},Me=({card:a,isCurrentPlayersTurn:s,bottomPosition:n=!1})=>{const{socket:r}=e(),{gameState:i}=L(),[c,o]=l.useState(null),d=e=>{null===c&&(o(e),r.emit("chooseAceValue",{isAceLow:e}))},m=i.players[i.currentPlayerId]?.name||"Current player";return n?s?t.jsxs("div",{className:Ne,children:[t.jsx("div",{className:ve,children:t.jsx(Fe,{duration:15,isActive:!0})}),t.jsxs("div",{className:fe,children:[t.jsx("span",{className:be,children:"ACE VALUE:"}),t.jsxs("button",{className:`${ye} ${Ce}`,onClick:()=>d(!0),disabled:null!==c,"data-gamepad-focusable":"true",autoFocus:!0,children:[t.jsx(Te,{direction:"down",size:16}),t.jsx("span",{children:"LOW"})]}),t.jsxs("button",{className:`${ye} ${we}`,onClick:()=>d(!1),disabled:null!==c,"data-gamepad-focusable":"true",children:[t.jsx("span",{children:"HIGH"}),t.jsx(Te,{direction:"up",size:16})]})]})]}):t.jsx(Be,{playerName:m,action:"choosing ace value",duration:B.DECISION_DURATION}):t.jsxs("div",{className:de,children:[t.jsx("div",{className:me}),s&&t.jsx("svg",{className:ue,children:t.jsx("circle",{className:_e,cx:"60",cy:"87",r:"80",style:{strokeDasharray:countdown/15*502+" 502"}})}),s?t.jsxs(t.Fragment,{children:[t.jsxs("button",{className:`${he} ${xe}`,onClick:()=>d(!1),disabled:null!==c,"data-gamepad-focusable":"true",autoFocus:!0,children:[t.jsx(Te,{direction:"up",size:20}),t.jsx("span",{children:"HIGH"})]}),t.jsxs("button",{className:`${he} ${je}`,onClick:()=>d(!0),disabled:null!==c,"data-gamepad-focusable":"true",children:[t.jsx("span",{children:"LOW"}),t.jsx(Te,{direction:"down",size:20})]}),t.jsxs("div",{className:pe,children:[countdown,"s"]})]}):t.jsxs("div",{className:ge,children:[m," is choosing..."]})]})},ze="_bettingOverlay_w101v_2",qe="_timerContainer_w101v_27",Ge="_chip_w101v_58",Ye="_foldChip_w101v_88",He="_betChip_w101v_103",Ue="_customChip_w101v_124",Ve="_chipLabel_w101v_136",We="_chipAmount_w101v_142",Je="_potButtonWrapper_w101v_148",Ke="_customInput_w101v_153",Qe="_betInput_w101v_163",Xe="_confirmButton_w101v_181",Ze="_cancelButton_w101v_182",ea="_potButton_ehifj_3",aa="_innerRing_ehifj_34",sa="_glowEffect_ehifj_43",ta="_potLabel_ehifj_55",na="_potAmount_ehifj_65",ra="_disabled_ehifj_92",ia=({amount:e,disabled:a,onClick:s,...n})=>t.jsxs("button",{className:`${ea} ${a?ra:""}`,onClick:s,disabled:a,"aria-label":`Bet the pot: ${e} chips`,"data-gamepad-focusable":"true",...n,children:[t.jsx("span",{className:ta,children:"POT"}),t.jsxs("span",{className:na,children:["$",e]}),t.jsx("div",{className:aa}),t.jsx("div",{className:sa})]}),la=({isCurrentPlayersTurn:a})=>{const{gameState:s,placeBet:n}=L(),{socket:r}=e(),[i,c]=l.useState(""),[o,d]=l.useState(!1);if(!s||!a)return t.jsx(Be,{playerName:s?.players[s.currentPlayerId]?.name||"Player",action:"betting",duration:B.BETTING_DURATION});const{pot:m,firstCard:u,secondCard:_,players:h,currentPlayerId:x}=s,j=h[x],p=j?.balance||0;Math.abs(u.numericValue-_.numericValue);const g=Math.min(m,p),N=[1,5,10,25,50].filter((e=>e<=g)),v=e=>{e>0&&e<=g&&(n(e),d(!1))},f=()=>{const e=parseInt(i);!isNaN(e)&&e>0&&e<=g&&(v(e),c(""))};return t.jsxs("div",{className:ze,children:[t.jsx("div",{className:qe,children:t.jsx(Fe,{duration:30,isActive:!0})}),t.jsx("button",{className:`${Ge} ${Ye}`,onClick:()=>{n(0)},"data-gamepad-focusable":"true",children:t.jsx("span",{className:Ve,children:"PASS"})}),N.map((e=>t.jsx("button",{className:`${Ge} ${He}`,onClick:()=>v(e),"data-gamepad-focusable":"true",children:t.jsxs("span",{className:We,children:["$",e]})},e))),g===m&&t.jsx("div",{className:Je,children:t.jsx(ia,{onClick:()=>v(m),disabled:!1,amount:m})}),o?t.jsxs("div",{className:Ke,children:[t.jsx("input",{type:"number",value:i,onChange:e=>c(e.target.value),onKeyPress:e=>"Enter"===e.key&&f(),placeholder:`1-${g}`,min:"1",max:g,autoFocus:!0,className:Qe}),t.jsx("button",{onClick:f,className:Xe,"data-gamepad-focusable":"true",children:$}),t.jsx("button",{onClick:()=>{d(!1),c("")},className:Ze,"data-gamepad-focusable":"true",children:P})]}):t.jsx("button",{className:`${Ge} ${Ue}`,onClick:()=>d(!0),"data-gamepad-focusable":"true",children:t.jsx("span",{className:Ve,children:"CUSTOM"})})]})},ca="_secondChanceOverlay_1ae57_2",oa="_bridge_1ae57_13",da="_bridgeLine_1ae57_20",ma="_matchBadge_1ae57_57",ua="_matchText_1ae57_69",_a="_choiceContainer_1ae57_78",ha="_timer_1ae57_87",xa="_buttons_1ae57_106",ja="_choiceButton_1ae57_112",pa="_anteButton_1ae57_139",ga="_passButton_1ae57_151",Na="_buttonIcon_1ae57_162",va="_buttonText_1ae57_168",fa="_buttonAmount_1ae57_174",ba="_waitingContainer_1ae57_180",ya="_waitingMessage_1ae57_187",Ca="_secondChanceBottom_1ae57_229",wa="_timerContainer_1ae57_243",Ta="_bottomButtonContainer_1ae57_251",Ia="_choicePrompt_1ae57_258",ka="_bottomChoiceButton_1ae57_267",Aa="_anteButtonBottom_1ae57_293",Sa="_passButtonBottom_1ae57_302",$a=({firstCard:a,secondCard:s,isCurrentPlayersTurn:n,bottomPosition:r=!1,indicatorOnly:i=!1})=>{const{gameState:c}=L(),{socket:o}=e(),[m,u]=l.useState(!1),[_,h]=l.useState(null),{anteAmount:x=1,players:j,currentPlayerId:p}=c,g=j[p],N=g?.name||"Player",v=e=>{o&&null===_&&(u(!0),h(e),o.emit("secondChance",{anteAgain:e}))};return a&&s&&(a.numericValue,s.numericValue),i?null:r?n?t.jsxs("div",{className:Ca,children:[t.jsx("div",{className:wa,children:t.jsx(Fe,{duration:15,isActive:!0})}),t.jsxs("div",{className:Ta,children:[t.jsx("span",{className:Ia,children:"SECOND CHANCE:"}),t.jsxs("button",{className:`${ka} ${Aa}`,onClick:()=>v(!0),disabled:m||null!==_,"data-gamepad-focusable":"true",autoFocus:!0,children:[t.jsx("span",{className:Na,children:S}),t.jsx("span",{children:"ANTE AGAIN"}),t.jsx(d,{amount:x,size:"small"})]}),t.jsxs("button",{className:`${ka} ${Sa}`,onClick:()=>v(!1),disabled:m||null!==_,"data-gamepad-focusable":"true",children:[t.jsx("span",{children:"PASS"}),t.jsx("span",{className:Na,children:I})]})]})]}):t.jsx(Be,{playerName:N,action:"deciding on second chance",duration:B.DECISION_DURATION}):t.jsxs("div",{className:ca,children:[t.jsxs("div",{className:oa,children:[t.jsx("div",{className:da}),t.jsx("div",{className:ma,children:t.jsx("span",{className:ua,children:"MATCH!"})})]}),n?t.jsxs("div",{className:_a,children:[t.jsxs("div",{className:ha,children:[countdown,"s"]}),t.jsxs("div",{className:xa,children:[t.jsxs("button",{className:`${ja} ${pa}`,onClick:()=>v(!0),disabled:m||null!==_,"data-gamepad-focusable":"true",autoFocus:!0,children:[t.jsx("span",{className:Na,children:S}),t.jsx("span",{className:va,children:"ANTE AGAIN"}),t.jsx("span",{className:fa,children:t.jsx(d,{amount:x,size:"small"})})]}),t.jsxs("button",{className:`${ja} ${ga}`,onClick:()=>v(!1),disabled:m||null!==_,"data-gamepad-focusable":"true",children:[t.jsx("span",{className:va,children:"PASS"}),t.jsx("span",{className:Na,children:I})]})]})]}):t.jsx("div",{className:ba,children:t.jsxs("div",{className:ya,children:[N," is deciding..."]})})]})},Pa="_resultsContainer_1x4ww_2",Ba="_messageArea_1x4ww_11",Ea="_resultBar_1x4ww_22",La="_playerName_1x4ww_49",Ra="_resultText_1x4ww_54",Oa="_winBar_1x4ww_61",Da="_winAmount_1x4ww_65",Fa="_lossBar_1x4ww_74",Ma="_lossAmount_1x4ww_78",za="_penaltyBar_1x4ww_87",qa="_penaltyText_1x4ww_91",Ga="_penaltyAmount_1x4ww_97",Ya="_animationContainer_1x4ww_107",Ha="_cautionTapeContainer_1x4ww_115",Ua="_cautionTape_1x4ww_115",Va="_rainContainer_1g3ns_2",Wa="_fallingItem_1g3ns_10",Ja="_emoji_1g3ns_17",Ka="_confetti_1g3ns_24",Qa=({type:e="emoji",items:a=[],count:s=10,animationDuration:n=2.5,className:r=""})=>t.jsx("div",{className:`${Va} ${r}`,children:[...Array(s)].map(((r,i)=>(r=>{const i=r/s*n+.3*(Math.random()-.5),l=100*Math.random();switch(e){case"coin":return t.jsx("div",{className:Wa,style:{left:`${l}%`,animationDelay:`${i}s`,"--animation-duration":`${n}s`},children:t.jsx(N,{size:"large"})},r);case"confetti":const e=a.length>0?a:["#ffd700","#ffed4e","#fff","#ff6b6b","#4CAF50"];return t.jsx("div",{className:`${Wa} ${Ka}`,style:{left:`${l}%`,animationDelay:`${i}s`,"--animation-duration":1.2*n+"s",backgroundColor:e[Math.floor(Math.random()*e.length)]}},r);default:const s=a.length>0?a:["🎉"];return t.jsx("div",{className:Wa,style:{left:`${l}%`,animationDelay:`${i}s`,"--animation-duration":`${n}s`},children:t.jsx("span",{className:Ja,children:s[Math.floor(Math.random()*s.length)]})},r)}})(i)))}),Xa=({result:e,players:a})=>{const[s,n]=l.useState(!0);if(l.useEffect((()=>{n(!0);const e=setTimeout((()=>n(!1)),3e3);return()=>clearTimeout(e)}),[e]),!e)return null;const r=a[e.playerId]?.name||"Player",i=e.outcome;if("win"===i){const a=e.winnings||0,s=Math.min(a/500,1),n=Math.floor(10+40*s),i=Math.floor(5+20*s);return t.jsxs("div",{className:Pa,children:[t.jsxs("div",{className:Ya,children:[t.jsx(Qa,{type:"confetti",count:n,animationDuration:3,items:["#ffd700","#ffed4e","#fff","#ff6b6b","#4CAF50"]}),t.jsx(Qa,{type:"coin",count:i,animationDuration:2})]}),t.jsx("div",{className:Ba,children:t.jsxs("div",{className:`panel ${Ea} ${Oa}`,children:[t.jsx("span",{className:La,children:r}),t.jsx("span",{className:Ra,children:"WINS"}),e.winnings&&e.winnings>0&&t.jsx("span",{className:Da,children:t.jsx(d,{amount:e.winnings,size:"small"})})]})})]})}if("lose"===i){const a=e.betAmount||0,s=Math.min(a/500,1),n=Math.floor(8+22*s);let i;return i=a<50?["😢","😔","😕","👎","📉","💔"]:a<200?["😭","😩","🤦","💸","📉","😤","😣"]:["🤡","💩","😂","🤣","🗑️","💀","☠️","🪦","⚰️"],t.jsxs("div",{className:Pa,children:[t.jsx("div",{className:Ya,children:t.jsx(Qa,{type:"emoji",items:i,count:n,animationDuration:2.5})}),t.jsx("div",{className:Ba,children:t.jsxs("div",{className:`panel ${Ea} ${Fa}`,children:[t.jsx("span",{className:La,children:r}),t.jsx("span",{className:Ra,children:"LOST"}),e.betAmount&&e.betAmount>0&&t.jsx("span",{className:Ma,children:t.jsx(d,{amount:e.betAmount,size:"small"})})]})})]})}const c=(e.betAmount||0)*(e.isTripleAceTie?3:2),o=e.isTripleAceTie?15:8,m=e.isTripleAceTie?["💀","☠️","⚠️","🚨","⛔","💥","🔥","😱","🎰","💸"]:["⚠️","🚨","⛔","🔴","❌","💥","🎯","🎲"];return t.jsxs("div",{className:Pa,children:[t.jsxs("div",{className:Ha,children:[t.jsxs("div",{className:Ua,children:[t.jsx("span",{children:e.isTripleAceTie?"TRIPLE PENALTY":"PENALTY"}),t.jsx("span",{children:e.isTripleAceTie?"TRIPLE PENALTY":"PENALTY"}),t.jsx("span",{children:e.isTripleAceTie?"TRIPLE PENALTY":"PENALTY"})]}),t.jsxs("div",{className:Ua,children:[t.jsx("span",{children:e.isTripleAceTie?"TRIPLE PENALTY":"PENALTY"}),t.jsx("span",{children:e.isTripleAceTie?"TRIPLE PENALTY":"PENALTY"}),t.jsx("span",{children:e.isTripleAceTie?"TRIPLE PENALTY":"PENALTY"})]})]}),t.jsx("div",{className:Ya,children:t.jsx(Qa,{type:"emoji",items:m,count:o,animationDuration:e.isTripleAceTie?2:3})}),t.jsx("div",{className:Ba,children:t.jsxs("div",{className:`panel ${Ea} ${za}`,children:[t.jsx("span",{className:La,children:r}),t.jsx("span",{className:Ra,children:e.isTripleAceTie?"TRIPLE TIE":"TIE"}),t.jsxs("span",{className:qa,children:[e.isTripleAceTie?"3x":"2x"," PENALTY"]}),t.jsx("span",{className:Ga,children:t.jsx(d,{amount:c,size:"small"})})]})})]})},Za="_anteControls_68v5e_4",es="_anteButton_68v5e_27",as="_backOutButton_68v5e_27",ss="_sitOutHalfWidth_68v5e_27",ts="_shimmerBorder_68v5e_110",ns="_buttonInfo_68v5e_125",rs="_buttonLabel_68v5e_132",is="_buttonAmount_68v5e_143",ls="_notEnoughChipsText_68v5e_154",cs="_toggleLabel_b88gt_2",os="_toggleInput_b88gt_9",ds="_toggleSlider_b88gt_15",ms="_toggleText_b88gt_64",us="_loading_b88gt_86",_s=()=>{const{preferences:a,toggleAutoAnte:s,loading:r}=n(),{gameState:i,playerReady:l}=L(),{socket:c}=e();return r?t.jsx("div",{className:us,children:"Loading preferences..."}):t.jsxs("label",{className:cs,children:[t.jsx("input",{type:"checkbox",checked:a.autoAnte,onChange:async()=>{const e=!a.autoAnte,t=await s();if(e&&t&&l){let e=null;if(c&&c.auth?.userId&&i?.players){const a=Object.keys(i.players);for(const s of a)if(i.players[s].userId===c.auth.userId){e=i.players[s];break}}const a=e?.isReady;a||l()}},className:os,"data-gamepad-focusable":"true"}),t.jsx("span",{className:ds}),t.jsx("span",{className:ms,children:"Auto-Ante"})]})},hs=()=>{const{gameState:s,playerReady:n,playerUnready:r}=L(),{socket:i}=e(),{user:l}=a();if(!s)return null;const{players:c,anteAmount:o,phase:m}=s;if("waiting"!==m)return null;let u=null;if(i&&i.auth?.userId&&c){const e=Object.keys(c);for(const a of e)if(c[a].userId===i.auth.userId){u=c[a];break}}else if(l&&c){const e=Object.keys(c);for(const a of e)if(c[a].userId===l.id){u=c[a];break}}const _=Number(u?.balance||0),h=u?.isReady,x=_>=o;return t.jsxs("div",{className:Za,children:[h?t.jsxs("button",{className:as,onClick:()=>{"function"==typeof r&&r()},"aria-label":"Back out","data-gamepad-focusable":"true",children:[t.jsx("div",{className:ts}),t.jsx("div",{className:ns,children:t.jsx("span",{className:rs,children:"BACK OUT"})})]}):t.jsxs(t.Fragment,{children:[t.jsx(_s,{}),t.jsxs("button",{className:es,onClick:n,disabled:!x,"aria-label":"Ante up","data-gamepad-focusable":"true",autoFocus:!0,children:[t.jsx("div",{className:ts}),t.jsxs("div",{className:ns,children:[t.jsx("span",{className:rs,children:"ANTE"}),t.jsx("span",{className:is,children:t.jsx(d,{amount:o})})]})]}),t.jsxs("button",{className:`${as} ${ss}`,onClick:()=>{i&&s&&l&&i.emit("sitOut",{gameId:s.id,userId:i.auth?.userId||l.id})},disabled:u?.isSittingOut,title:u?.isSittingOut?"You are currently sitting out":"Sit out next round","aria-label":"Sit Out","data-gamepad-focusable":"true",children:[t.jsx("div",{className:ts}),t.jsx("div",{className:ns,children:t.jsx("span",{className:rs,children:"SIT OUT"})})]})]}),!h&&!x&&t.jsx("p",{className:ls,children:"Not enough coins"})]})},xs="_imBackOverlay_1wm7i_3",js="_container_1wm7i_11",ps="_sittingOutText_1wm7i_21",gs="_imBackButton_1wm7i_30",Ns="_buttonText_1wm7i_48",vs="_helpText_1wm7i_66",fs=({onClick:e})=>t.jsx("div",{className:xs,children:t.jsxs("div",{className:js,children:[t.jsx("h3",{className:ps,children:"You are sitting out"}),t.jsx("button",{className:gs,onClick:e,"data-gamepad-focusable":"true",autoFocus:!0,children:t.jsx("span",{className:Ns,children:"I'M BACK!"})}),t.jsx("p",{className:vs,children:"Click to rejoin the game"})]})}),bs=()=>{const{gameState:s}=L(),{socket:n}=e(),{user:r}=a();if(!s)return null;const{phase:i,currentPlayerId:l,players:c,waitingForAceDecision:o,waitingForSecondChance:d,firstCard:m,secondCard:u,result:_}=s,h=r?.id,x=c&&h?c[h]:null,j=h===l,p=x?.isSittingOut||!1;return t.jsxs("div",{className:ne.table,children:[t.jsx("div",{className:ne.feltTexture}),t.jsx(oe,{}),t.jsx(ie,{}),o&&t.jsx("div",{className:ne.aceGlowEffect}),d&&t.jsx($a,{firstCard:m,secondCard:u,isCurrentPlayersTurn:j,indicatorOnly:!0}),!p&&t.jsxs(t.Fragment,{children:["betting"===i&&!o&&!d&&t.jsx(la,{isCurrentPlayersTurn:j}),o&&t.jsx(Me,{card:m,isCurrentPlayersTurn:j,bottomPosition:!0}),d&&t.jsx($a,{firstCard:m,secondCard:u,isCurrentPlayersTurn:j,bottomPosition:!0})]}),"results"===i&&_&&!p&&t.jsx(Xa,{result:_,players:c}),"waiting"===i&&!p&&t.jsx(hs,{}),p&&t.jsx("div",{className:ne.sitOutOverlay,children:t.jsx(fs,{onClick:()=>{n&&s.id&&n.emit("imBack",{gameId:s.id})}})})]})},ys="_playersContainer_16b1x_1",Cs="_playersTitle_16b1x_23",ws="_playersList_16b1x_47",Ts="_currentPlayerGlow_16b1x_57",Is="_currentUser_16b1x_71",ks="_playerInfo_16b1x_75",As="_playerStatus_16b1x_83",Ss="_disconnectedIndicator_16b1x_90",$s="_playerBalanceContainer_16b1x_97",Ps="_playerBalance_16b1x_97",Bs="_balanceIncrease_16b1x_116",Es="_balanceDecrease_16b1x_120",Ls="_readyIndicator_16b1x_150",Rs="_ready_16b1x_150",Os="_notReady_16b1x_161",Ds="_sittingOut_16b1x_165",Fs="_emptyPlayerList_16b1x_180",Ms=()=>{const{gameState:a}=L(),{socket:s}=e(),n=l.useContext(r);if(l.useEffect((()=>{if(a?.players&&n){const e=Object.values(a.players).map((e=>e.userId)).filter(Boolean);e.length>0&&n.prefetchUsers(e)}}),[a?.players,n]),!a||!a.players)return t.jsx("div",{className:Fs,children:t.jsx("p",{children:"Waiting for game data..."})});const{players:i,currentPlayerId:c,gameTransactions:o=[]}=a,d=s?.auth?.userId,m=a.totals||{};return i&&0!==Object.keys(i).length?t.jsxs("div",{className:ys,children:[t.jsx("h3",{className:Cs,children:"Scoreboard"}),t.jsx("div",{className:ws,children:a.seats.filter((e=>null!==e&&i[e])).map((e=>{const a=i[e],s=e===c,n=a.userId===d;return a.disconnected,t.jsxs("div",{className:`\n                  ${s?"panel":"panel-alt"}\n                  ${s?Ts:""}\n                  ${n?Is:""}\n                `,style:{padding:"0.35rem 0.75rem",gap:"0.5rem",flexDirection:"row",fontSize:"0.9rem",alignItems:"center",justifyContent:"space-between"},children:[t.jsxs("div",{className:ks,children:[t.jsx(v,{userId:a.userId,size:"small",showName:!0,namePosition:"right"}),t.jsx("span",{className:As,children:a.disconnected&&t.jsx("span",{className:Ss,title:"Player disconnected",children:"⚠️ Disconnected"})})]}),t.jsxs("div",{className:$s,children:[t.jsx(zs,{balance:m[e]||0}),t.jsx("div",{className:`\n                    ${Ls} \n                    ${a.isSittingOut?Ds:a.isReady?Rs:Os}\n                  `,title:a.isSittingOut?"Sitting Out":a.isReady?"Ready":"Not Ready"})]})]},e)}))})]}):t.jsx("div",{className:Fs,children:t.jsx("p",{children:"Waiting for players to join..."})})},zs=({balance:e})=>{const[a,s]=l.useState(e),[n,r]=l.useState(""),i=l.useRef(null);return l.useEffect((()=>{if(e!==a){r(e>a?Bs:Es),i.current&&clearTimeout(i.current),i.current=setTimeout((()=>{r("")}),1e3),s(e)}return()=>{i.current&&clearTimeout(i.current)}}),[e]),t.jsx("span",{className:`${Ps} ${n}`,children:t.jsx(d,{amount:e})})},qs="_gameLogContainer_16qz1_1",Gs="_gameLogHeader_16qz1_16",Ys="_expandIcon_16qz1_30",Hs="_gameLogEntries_16qz1_54",Us="_logEntry_16qz1_64",Vs="_logTime_16qz1_89",Ws="_logMessage_16qz1_96",Js="_emptyLog_16qz1_101",Ks="_showMoreButton_16qz1_109",Qs=()=>{const{gameState:e}=L(),[a,s]=l.useState(!1),[n,r]=l.useState(10);if(!e||!e.gameLog)return null;const i=e.gameLog||[],c=a?[]:i.slice(0,n);return t.jsxs("div",{className:qs,children:[t.jsxs("h3",{className:Gs,onClick:()=>{s(!a),a&&r(10)},children:["Game Log",t.jsx("span",{className:Ys,children:a?"▶":"▼"})]}),!a&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:Hs,children:0===i.length?t.jsx("div",{className:Js,children:"No game events yet"}):c.map(((e,a)=>{return t.jsxs("div",{className:Us,children:[t.jsx("span",{className:Vs,children:(s=e.timestamp,new Date(s).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"}))}),t.jsx("span",{className:Ws,children:e.message})]},a);var s}))}),i.length>n&&t.jsxs("div",{className:Ks,onClick:()=>{r((e=>e+10))},children:["Show ",Math.min(10,i.length-n)," more",i.length-n>10&&` (${i.length-n} remaining)`]})]})]})},Xs="_emojiReactions_1y1z5_1",Zs="_toggleButton_1y1z5_8",et="_emojiPanel_1y1z5_35",at="_emojiGrid_1y1z5_60",st="_emojiButton_1y1z5_66",tt=()=>{const[s,n]=l.useState(!1),{socket:r}=e(),{gameState:i}=L(),{user:c}=a();return t.jsxs("div",{className:Xs,children:[t.jsx("button",{className:Zs,onClick:()=>{n(!s)},"data-gamepad-focusable":"true","aria-label":"Toggle emoji reactions",children:"😊"}),s&&t.jsx("div",{className:et,children:t.jsx("div",{className:at,children:[{emoji:"🔥",name:"Fire",color:"#FF6B35"},{emoji:"😄",name:"Happy",color:"#FFD93D"},{emoji:"💩",name:"Poop",color:"#8B4513"},{emoji:"😎",name:"Cool",color:"#4A5568"},{emoji:"🤯",name:"Mind Blown",color:"#FFA500"},{emoji:"😈",name:"Devilish",color:"#9333EA"},{emoji:"😬",name:"Worried",color:"#FCD34D"},{emoji:"👏",name:"Applause",color:"#FBBF24"},{emoji:"😭",name:"Crying",color:"#3B82F6"},{emoji:"🤡",name:"Clown",color:"#EF4444"},{emoji:"💪",name:"Strong",color:"#F59E0B"},{emoji:"😅",name:"Nervous",color:"#60A5FA"},{emoji:"🎉",name:"Celebration",color:"#A855F7"},{emoji:"🤔",name:"Thinking",color:"#6B7280"},{emoji:"🙈",name:"See No Evil",color:"#A0522D"},{emoji:"😤",name:"Confident",color:"#DC2626"}].map(((e,a)=>t.jsx("button",{className:st,onClick:()=>(e=>{r&&i&&c&&(r.emit("emojiReaction",{gameId:i.id,emoji:e.emoji,color:e.color,playerName:c.username}),n(!1))})(e),"data-gamepad-focusable":"true",title:e.name,style:{"--emoji-color":e.color},children:e.emoji},a)))})})]})},nt=({onReturnToLobby:s})=>{const[n,r]=l.useState(!1),{gameState:i,error:c,clearError:o}=L();b(!0),l.useEffect((()=>{if(c){const e=setTimeout((()=>{o()}),1e4);return()=>clearTimeout(e)}}),[c,o]);const{socket:d}=e(),{user:m}=a();if(!i)return t.jsx("div",{className:F,children:t.jsx("p",{children:"Loading game state..."})});i.phase;const u=m?.id;return i.players&&u&&i.players[u],t.jsxs("div",{className:`screen ${O}`,children:[t.jsxs("div",{className:`${D} mobile-scale-content`,children:[t.jsx(te,{handleLeaveGame:()=>{s&&s()},onModalStateChange:r}),c&&t.jsx("div",{className:M,children:t.jsx("p",{className:z,children:c})}),t.jsx("div",{className:q,children:t.jsx(bs,{})}),t.jsxs("div",{className:G,children:[t.jsx(Ms,{}),t.jsx(Qs,{})]})]}),!n&&t.jsx(tt,{})]})},rt="_modalOverlay_jrbqi_1",it="_modalContent_jrbqi_14",lt="_passwordInput_jrbqi_34",ct="_modalActions_jrbqi_52",ot="_modalButton_jrbqi_58",dt="_cancelButton_jrbqi_69",mt="_submitButton_jrbqi_78";function ut({isOpen:e,onClose:a,onSubmit:s,gameId:n}){const[r,i]=l.useState("");if(!e)return null;return t.jsx("div",{className:rt,children:t.jsxs("div",{className:it,children:[t.jsx("h2",{children:"Password Required"}),t.jsxs("p",{children:["Please enter the password for game ",t.jsx("strong",{children:n||""}),":"]}),t.jsxs("form",{onSubmit:e=>{e.preventDefault(),s(r),i("")},children:[t.jsx(f,{title:"Enter Game Password",type:"password",value:r,onChange:e=>i(e.target.value),className:lt,autoFocus:!0,required:!0}),t.jsxs("div",{className:ct,children:[t.jsx("button",{type:"button",onClick:()=>{i(""),a()},className:`${ot} ${dt}`,"data-gamepad-focusable":"true",children:"Cancel"}),t.jsx("button",{type:"submit",className:`${ot} ${mt}`,"data-gamepad-focusable":"true",children:"Join Game"})]})]})]})})}const _t=()=>{const{gameId:a}=c(),n=o(),{socket:r,isConnected:d}=e(),[m,u]=l.useState(!0),[_,h]=l.useState(null),[x,j]=l.useState(!1),p=l.useRef(!1),g=l.useCallback((()=>{r&&d&&a&&(s.play("ui.leave"),r.emit("leaveGame",{gameId:a}),n("/"))}),[r,d,a,n]),N=l.useCallback((e=>{j(!1),r&&a&&e&&(h(null),r.emit("joinGame",{gameId:a,password:e}),u(!0))}),[r,a]),v=l.useCallback((()=>{j(!1),n("/")}),[n]);l.useEffect((()=>{h(null),j(!1),u(!0)}),[a]),l.useEffect((()=>{if(!r)return;const e=e=>{e&&e.game&&e.game.id===a&&(s.play("ui.join"),u(!1),h(null),j(!1))},t=e=>{const a=e.message||"An unknown error occurred";"Password required"===a?(j(!0),u(!1),h(null)):"Invalid password"===a?(h("Invalid password."),j(!0),u(!1)):"Game not found"===a?n("/"):"Game is full"===a?(h(a),u(!1),j(!1),setTimeout((()=>n("/")),3e3)):(h(a),u(!1),j(!1))};return r.on("gameJoined",e),r.on("error",t),()=>{r.off("gameJoined",e),r.off("error",t)}}),[r,a,n]),l.useEffect((()=>{r&&a&&!p.current&&(p.current=!0,u(!0),h(null),j(!1),r.emit("joinGame",{gameId:a}))}),[r,a]);const f=()=>{const{gameState:s}=L(),{socket:n}=e();return l.useEffect((()=>{const e=e=>{const a=n?.auth?.userId,t=a&&s?.players?s.players[a]:null;if(t?.isReady||!1)return e.preventDefault(),e.returnValue="You have money in the pot! Are you sure you want to leave?",e.returnValue};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}}),[s,n]),t.jsxs(t.Fragment,{children:[t.jsx(ut,{isOpen:x,onClose:v,onSubmit:N,gameId:a}),m&&t.jsx(i,{message:`Joining game ${a}...`}),_&&!m&&!x&&t.jsxs("div",{className:"error-container",style:{padding:"20px",color:"red",textAlign:"center"},children:[t.jsx("h2",{children:"An error occurred"}),t.jsx("p",{children:_}),t.jsx("button",{onClick:()=>window.location.reload(),children:"Refresh Page"})]}),!m&&!_&&s&&t.jsx(nt,{onReturnToLobby:g})]})};return t.jsx(R,{gameId:a,children:t.jsx(f,{})})};export{_t as default};
