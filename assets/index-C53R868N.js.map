{"version":3,"file":"index-C53R868N.js","sources":["../../node_modules/react-dom/client.js","../../node_modules/howler/dist/howler.js","../../src/services/SoundService.js","../../src/components/common/BaseModal.jsx","../../src/components/VirtualKeyboard.jsx","../../src/contexts/VirtualKeyboardContext.jsx","../../src/hooks/useVirtualKeyboard.js","../../src/components/GamepadTextField.jsx","../../src/components/auth/AuthForm.jsx","../../node_modules/engine.io-parser/build/esm/commons.js","../../node_modules/engine.io-parser/build/esm/encodePacket.browser.js","../../node_modules/engine.io-parser/build/esm/contrib/base64-arraybuffer.js","../../node_modules/engine.io-parser/build/esm/decodePacket.browser.js","../../node_modules/engine.io-parser/build/esm/index.js","../../node_modules/@socket.io/component-emitter/lib/esm/index.js","../../node_modules/engine.io-client/build/esm/globals.js","../../node_modules/engine.io-client/build/esm/util.js","../../node_modules/engine.io-client/build/esm/transport.js","../../node_modules/engine.io-client/build/esm/contrib/parseqs.js","../../node_modules/engine.io-client/build/esm/transports/polling.js","../../node_modules/engine.io-client/build/esm/contrib/has-cors.js","../../node_modules/engine.io-client/build/esm/transports/polling-xhr.js","../../node_modules/engine.io-client/build/esm/transports/websocket.js","../../node_modules/engine.io-client/build/esm/transports/index.js","../../node_modules/engine.io-client/build/esm/transports/webtransport.js","../../node_modules/engine.io-client/build/esm/contrib/parseuri.js","../../node_modules/engine.io-client/build/esm/socket.js","../../node_modules/socket.io-parser/build/esm/is-binary.js","../../node_modules/socket.io-parser/build/esm/binary.js","../../node_modules/socket.io-parser/build/esm/index.js","../../node_modules/socket.io-client/build/esm/on.js","../../node_modules/socket.io-client/build/esm/socket.js","../../node_modules/socket.io-client/build/esm/contrib/backo2.js","../../node_modules/socket.io-client/build/esm/manager.js","../../node_modules/socket.io-client/build/esm/index.js","../../node_modules/socket.io-client/build/esm/url.js","../../src/config.js","../../src/contexts/SocketContext.jsx","../../src/components/common/CoinIcon.jsx","../../src/contexts/AuthContext.jsx","../../src/hooks/useGamepadNavigation.js","../../src/components/common/AppHeader.jsx","../../src/components/auth/AuthPage.jsx","../../src/contexts/LobbyContext.jsx","../../src/contexts/PreferencesContext.jsx","../../src/components/common/OnlinePlayerCount.jsx","../../src/components/common/CurrencyAmount.jsx","../../src/components/icons/GearIcon.jsx","../../src/components/ToggleSwitch.jsx","../../src/components/FileUpload.jsx","../../src/components/TitlesSelector.jsx","../../src/components/PreferencesModal.jsx","../../src/components/common/IconButton.jsx","../../src/components/common/PreferencesButton.jsx","../../src/components/icons/BarChartIcon.jsx","../../src/components/icons/DownloadIcon.jsx","../../src/components/common/TransactionDownloadButton.jsx","../../src/components/GameStats.jsx","../../src/components/GameSummaryModal.jsx","../../src/contexts/UserDataContext.jsx","../../src/components/UserAvatar.jsx","../../src/components/Leaderboard.jsx","../../src/components/PlayerStatsModal.jsx","../../src/components/common/PlayerStatsButton.jsx","../../src/components/icons/StoreIcon.jsx","../../src/components/StoreButton.jsx","../../src/components/ProgressInfo.jsx","../../src/components/GamepadInput.jsx","../../src/components/GameSettingsModal.jsx","../../src/services/StoreService.js","../../src/components/StoreModal.jsx","../../src/components/icons/LockIcon.jsx","../../src/components/GameCard.jsx","../../src/components/icons/QuestionIcon.jsx","../../src/constants.js","../../src/components/GameRulesModal.jsx","../../src/components/common/RulesButton.jsx","../../src/components/Lobby.jsx","../../src/contexts/GameContext.jsx","../../src/components/icons/ExitIcon.jsx","../../src/components/common/LeaveButton.jsx","../../src/components/GameHeader.jsx","../../src/components/icons/ArrowIcon.jsx","../../src/components/CardDisplay.jsx","../../src/components/PotButton.jsx","../../src/components/BettingPanel.jsx","../../src/components/PlayerList.jsx","../../src/components/PotDisplay.jsx","../../src/components/DeckDisplay.jsx","../../src/components/AutoAnteToggle.jsx","../../src/components/AnteControls.jsx","../../src/components/ResultsPanel.jsx","../../src/components/AceChoicePanel.jsx","../../src/components/SecondChancePanel.jsx","../../src/components/GameLog.jsx","../../src/components/EmojiReactions.jsx","../../src/components/GameScreen.jsx","../../src/components/common/LoadingScreen.jsx","../../src/components/common/PasswordPromptModal.jsx","../../src/components/GameRoom.jsx","../../src/router.jsx","../../src/components/Toast.jsx","../../src/contexts/ToastContext.jsx","../../src/App.jsx","../../src/main.jsx"],"sourcesContent":["'use strict';\n\nvar m = require('react-dom');\nif (process.env.NODE_ENV === 'production') {\n  exports.createRoot = m.createRoot;\n  exports.hydrateRoot = m.hydrateRoot;\n} else {\n  var i = m.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;\n  exports.createRoot = function(c, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.createRoot(c, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n  exports.hydrateRoot = function(c, h, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.hydrateRoot(c, h, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n}\n","/*!\n *  howler.js v2.2.4\n *  howlerjs.com\n *\n *  (c) 2013-2020, James Simpson of GoldFire Studios\n *  goldfirestudios.com\n *\n *  MIT License\n */\n\n(function() {\n\n  'use strict';\n\n  /** Global Methods **/\n  /***************************************************************************/\n\n  /**\n   * Create the global controller. All contained methods and properties apply\n   * to all sounds that are currently playing or will be in the future.\n   */\n  var HowlerGlobal = function() {\n    this.init();\n  };\n  HowlerGlobal.prototype = {\n    /**\n     * Initialize the global Howler object.\n     * @return {Howler}\n     */\n    init: function() {\n      var self = this || Howler;\n\n      // Create a global ID counter.\n      self._counter = 1000;\n\n      // Pool of unlocked HTML5 Audio objects.\n      self._html5AudioPool = [];\n      self.html5PoolSize = 10;\n\n      // Internal properties.\n      self._codecs = {};\n      self._howls = [];\n      self._muted = false;\n      self._volume = 1;\n      self._canPlayEvent = 'canplaythrough';\n      self._navigator = (typeof window !== 'undefined' && window.navigator) ? window.navigator : null;\n\n      // Public properties.\n      self.masterGain = null;\n      self.noAudio = false;\n      self.usingWebAudio = true;\n      self.autoSuspend = true;\n      self.ctx = null;\n\n      // Set to false to disable the auto audio unlocker.\n      self.autoUnlock = true;\n\n      // Setup the various state values for global tracking.\n      self._setup();\n\n      return self;\n    },\n\n    /**\n     * Get/set the global volume for all sounds.\n     * @param  {Float} vol Volume from 0.0 to 1.0.\n     * @return {Howler/Float}     Returns self or current volume.\n     */\n    volume: function(vol) {\n      var self = this || Howler;\n      vol = parseFloat(vol);\n\n      // If we don't have an AudioContext created yet, run the setup.\n      if (!self.ctx) {\n        setupAudioContext();\n      }\n\n      if (typeof vol !== 'undefined' && vol >= 0 && vol <= 1) {\n        self._volume = vol;\n\n        // Don't update any of the nodes if we are muted.\n        if (self._muted) {\n          return self;\n        }\n\n        // When using Web Audio, we just need to adjust the master gain.\n        if (self.usingWebAudio) {\n          self.masterGain.gain.setValueAtTime(vol, Howler.ctx.currentTime);\n        }\n\n        // Loop through and change volume for all HTML5 audio nodes.\n        for (var i=0; i<self._howls.length; i++) {\n          if (!self._howls[i]._webAudio) {\n            // Get all of the sounds in this Howl group.\n            var ids = self._howls[i]._getSoundIds();\n\n            // Loop through all sounds and change the volumes.\n            for (var j=0; j<ids.length; j++) {\n              var sound = self._howls[i]._soundById(ids[j]);\n\n              if (sound && sound._node) {\n                sound._node.volume = sound._volume * vol;\n              }\n            }\n          }\n        }\n\n        return self;\n      }\n\n      return self._volume;\n    },\n\n    /**\n     * Handle muting and unmuting globally.\n     * @param  {Boolean} muted Is muted or not.\n     */\n    mute: function(muted) {\n      var self = this || Howler;\n\n      // If we don't have an AudioContext created yet, run the setup.\n      if (!self.ctx) {\n        setupAudioContext();\n      }\n\n      self._muted = muted;\n\n      // With Web Audio, we just need to mute the master gain.\n      if (self.usingWebAudio) {\n        self.masterGain.gain.setValueAtTime(muted ? 0 : self._volume, Howler.ctx.currentTime);\n      }\n\n      // Loop through and mute all HTML5 Audio nodes.\n      for (var i=0; i<self._howls.length; i++) {\n        if (!self._howls[i]._webAudio) {\n          // Get all of the sounds in this Howl group.\n          var ids = self._howls[i]._getSoundIds();\n\n          // Loop through all sounds and mark the audio node as muted.\n          for (var j=0; j<ids.length; j++) {\n            var sound = self._howls[i]._soundById(ids[j]);\n\n            if (sound && sound._node) {\n              sound._node.muted = (muted) ? true : sound._muted;\n            }\n          }\n        }\n      }\n\n      return self;\n    },\n\n    /**\n     * Handle stopping all sounds globally.\n     */\n    stop: function() {\n      var self = this || Howler;\n\n      // Loop through all Howls and stop them.\n      for (var i=0; i<self._howls.length; i++) {\n        self._howls[i].stop();\n      }\n\n      return self;\n    },\n\n    /**\n     * Unload and destroy all currently loaded Howl objects.\n     * @return {Howler}\n     */\n    unload: function() {\n      var self = this || Howler;\n\n      for (var i=self._howls.length-1; i>=0; i--) {\n        self._howls[i].unload();\n      }\n\n      // Create a new AudioContext to make sure it is fully reset.\n      if (self.usingWebAudio && self.ctx && typeof self.ctx.close !== 'undefined') {\n        self.ctx.close();\n        self.ctx = null;\n        setupAudioContext();\n      }\n\n      return self;\n    },\n\n    /**\n     * Check for codec support of specific extension.\n     * @param  {String} ext Audio file extention.\n     * @return {Boolean}\n     */\n    codecs: function(ext) {\n      return (this || Howler)._codecs[ext.replace(/^x-/, '')];\n    },\n\n    /**\n     * Setup various state values for global tracking.\n     * @return {Howler}\n     */\n    _setup: function() {\n      var self = this || Howler;\n\n      // Keeps track of the suspend/resume state of the AudioContext.\n      self.state = self.ctx ? self.ctx.state || 'suspended' : 'suspended';\n\n      // Automatically begin the 30-second suspend process\n      self._autoSuspend();\n\n      // Check if audio is available.\n      if (!self.usingWebAudio) {\n        // No audio is available on this system if noAudio is set to true.\n        if (typeof Audio !== 'undefined') {\n          try {\n            var test = new Audio();\n\n            // Check if the canplaythrough event is available.\n            if (typeof test.oncanplaythrough === 'undefined') {\n              self._canPlayEvent = 'canplay';\n            }\n          } catch(e) {\n            self.noAudio = true;\n          }\n        } else {\n          self.noAudio = true;\n        }\n      }\n\n      // Test to make sure audio isn't disabled in Internet Explorer.\n      try {\n        var test = new Audio();\n        if (test.muted) {\n          self.noAudio = true;\n        }\n      } catch (e) {}\n\n      // Check for supported codecs.\n      if (!self.noAudio) {\n        self._setupCodecs();\n      }\n\n      return self;\n    },\n\n    /**\n     * Check for browser support for various codecs and cache the results.\n     * @return {Howler}\n     */\n    _setupCodecs: function() {\n      var self = this || Howler;\n      var audioTest = null;\n\n      // Must wrap in a try/catch because IE11 in server mode throws an error.\n      try {\n        audioTest = (typeof Audio !== 'undefined') ? new Audio() : null;\n      } catch (err) {\n        return self;\n      }\n\n      if (!audioTest || typeof audioTest.canPlayType !== 'function') {\n        return self;\n      }\n\n      var mpegTest = audioTest.canPlayType('audio/mpeg;').replace(/^no$/, '');\n\n      // Opera version <33 has mixed MP3 support, so we need to check for and block it.\n      var ua = self._navigator ? self._navigator.userAgent : '';\n      var checkOpera = ua.match(/OPR\\/(\\d+)/g);\n      var isOldOpera = (checkOpera && parseInt(checkOpera[0].split('/')[1], 10) < 33);\n      var checkSafari = ua.indexOf('Safari') !== -1 && ua.indexOf('Chrome') === -1;\n      var safariVersion = ua.match(/Version\\/(.*?) /);\n      var isOldSafari = (checkSafari && safariVersion && parseInt(safariVersion[1], 10) < 15);\n\n      self._codecs = {\n        mp3: !!(!isOldOpera && (mpegTest || audioTest.canPlayType('audio/mp3;').replace(/^no$/, ''))),\n        mpeg: !!mpegTest,\n        opus: !!audioTest.canPlayType('audio/ogg; codecs=\"opus\"').replace(/^no$/, ''),\n        ogg: !!audioTest.canPlayType('audio/ogg; codecs=\"vorbis\"').replace(/^no$/, ''),\n        oga: !!audioTest.canPlayType('audio/ogg; codecs=\"vorbis\"').replace(/^no$/, ''),\n        wav: !!(audioTest.canPlayType('audio/wav; codecs=\"1\"') || audioTest.canPlayType('audio/wav')).replace(/^no$/, ''),\n        aac: !!audioTest.canPlayType('audio/aac;').replace(/^no$/, ''),\n        caf: !!audioTest.canPlayType('audio/x-caf;').replace(/^no$/, ''),\n        m4a: !!(audioTest.canPlayType('audio/x-m4a;') || audioTest.canPlayType('audio/m4a;') || audioTest.canPlayType('audio/aac;')).replace(/^no$/, ''),\n        m4b: !!(audioTest.canPlayType('audio/x-m4b;') || audioTest.canPlayType('audio/m4b;') || audioTest.canPlayType('audio/aac;')).replace(/^no$/, ''),\n        mp4: !!(audioTest.canPlayType('audio/x-mp4;') || audioTest.canPlayType('audio/mp4;') || audioTest.canPlayType('audio/aac;')).replace(/^no$/, ''),\n        weba: !!(!isOldSafari && audioTest.canPlayType('audio/webm; codecs=\"vorbis\"').replace(/^no$/, '')),\n        webm: !!(!isOldSafari && audioTest.canPlayType('audio/webm; codecs=\"vorbis\"').replace(/^no$/, '')),\n        dolby: !!audioTest.canPlayType('audio/mp4; codecs=\"ec-3\"').replace(/^no$/, ''),\n        flac: !!(audioTest.canPlayType('audio/x-flac;') || audioTest.canPlayType('audio/flac;')).replace(/^no$/, '')\n      };\n\n      return self;\n    },\n\n    /**\n     * Some browsers/devices will only allow audio to be played after a user interaction.\n     * Attempt to automatically unlock audio on the first user interaction.\n     * Concept from: http://paulbakaus.com/tutorials/html5/web-audio-on-ios/\n     * @return {Howler}\n     */\n    _unlockAudio: function() {\n      var self = this || Howler;\n\n      // Only run this if Web Audio is supported and it hasn't already been unlocked.\n      if (self._audioUnlocked || !self.ctx) {\n        return;\n      }\n\n      self._audioUnlocked = false;\n      self.autoUnlock = false;\n\n      // Some mobile devices/platforms have distortion issues when opening/closing tabs and/or web views.\n      // Bugs in the browser (especially Mobile Safari) can cause the sampleRate to change from 44100 to 48000.\n      // By calling Howler.unload(), we create a new AudioContext with the correct sampleRate.\n      if (!self._mobileUnloaded && self.ctx.sampleRate !== 44100) {\n        self._mobileUnloaded = true;\n        self.unload();\n      }\n\n      // Scratch buffer for enabling iOS to dispose of web audio buffers correctly, as per:\n      // http://stackoverflow.com/questions/24119684\n      self._scratchBuffer = self.ctx.createBuffer(1, 1, 22050);\n\n      // Call this method on touch start to create and play a buffer,\n      // then check if the audio actually played to determine if\n      // audio has now been unlocked on iOS, Android, etc.\n      var unlock = function(e) {\n        // Create a pool of unlocked HTML5 Audio objects that can\n        // be used for playing sounds without user interaction. HTML5\n        // Audio objects must be individually unlocked, as opposed\n        // to the WebAudio API which only needs a single activation.\n        // This must occur before WebAudio setup or the source.onended\n        // event will not fire.\n        while (self._html5AudioPool.length < self.html5PoolSize) {\n          try {\n            var audioNode = new Audio();\n\n            // Mark this Audio object as unlocked to ensure it can get returned\n            // to the unlocked pool when released.\n            audioNode._unlocked = true;\n\n            // Add the audio node to the pool.\n            self._releaseHtml5Audio(audioNode);\n          } catch (e) {\n            self.noAudio = true;\n            break;\n          }\n        }\n\n        // Loop through any assigned audio nodes and unlock them.\n        for (var i=0; i<self._howls.length; i++) {\n          if (!self._howls[i]._webAudio) {\n            // Get all of the sounds in this Howl group.\n            var ids = self._howls[i]._getSoundIds();\n\n            // Loop through all sounds and unlock the audio nodes.\n            for (var j=0; j<ids.length; j++) {\n              var sound = self._howls[i]._soundById(ids[j]);\n\n              if (sound && sound._node && !sound._node._unlocked) {\n                sound._node._unlocked = true;\n                sound._node.load();\n              }\n            }\n          }\n        }\n\n        // Fix Android can not play in suspend state.\n        self._autoResume();\n\n        // Create an empty buffer.\n        var source = self.ctx.createBufferSource();\n        source.buffer = self._scratchBuffer;\n        source.connect(self.ctx.destination);\n\n        // Play the empty buffer.\n        if (typeof source.start === 'undefined') {\n          source.noteOn(0);\n        } else {\n          source.start(0);\n        }\n\n        // Calling resume() on a stack initiated by user gesture is what actually unlocks the audio on Android Chrome >= 55.\n        if (typeof self.ctx.resume === 'function') {\n          self.ctx.resume();\n        }\n\n        // Setup a timeout to check that we are unlocked on the next event loop.\n        source.onended = function() {\n          source.disconnect(0);\n\n          // Update the unlocked state and prevent this check from happening again.\n          self._audioUnlocked = true;\n\n          // Remove the touch start listener.\n          document.removeEventListener('touchstart', unlock, true);\n          document.removeEventListener('touchend', unlock, true);\n          document.removeEventListener('click', unlock, true);\n          document.removeEventListener('keydown', unlock, true);\n\n          // Let all sounds know that audio has been unlocked.\n          for (var i=0; i<self._howls.length; i++) {\n            self._howls[i]._emit('unlock');\n          }\n        };\n      };\n\n      // Setup a touch start listener to attempt an unlock in.\n      document.addEventListener('touchstart', unlock, true);\n      document.addEventListener('touchend', unlock, true);\n      document.addEventListener('click', unlock, true);\n      document.addEventListener('keydown', unlock, true);\n\n      return self;\n    },\n\n    /**\n     * Get an unlocked HTML5 Audio object from the pool. If none are left,\n     * return a new Audio object and throw a warning.\n     * @return {Audio} HTML5 Audio object.\n     */\n    _obtainHtml5Audio: function() {\n      var self = this || Howler;\n\n      // Return the next object from the pool if one exists.\n      if (self._html5AudioPool.length) {\n        return self._html5AudioPool.pop();\n      }\n\n      //.Check if the audio is locked and throw a warning.\n      var testPlay = new Audio().play();\n      if (testPlay && typeof Promise !== 'undefined' && (testPlay instanceof Promise || typeof testPlay.then === 'function')) {\n        testPlay.catch(function() {\n          console.warn('HTML5 Audio pool exhausted, returning potentially locked audio object.');\n        });\n      }\n\n      return new Audio();\n    },\n\n    /**\n     * Return an activated HTML5 Audio object to the pool.\n     * @return {Howler}\n     */\n    _releaseHtml5Audio: function(audio) {\n      var self = this || Howler;\n\n      // Don't add audio to the pool if we don't know if it has been unlocked.\n      if (audio._unlocked) {\n        self._html5AudioPool.push(audio);\n      }\n\n      return self;\n    },\n\n    /**\n     * Automatically suspend the Web Audio AudioContext after no sound has played for 30 seconds.\n     * This saves processing/energy and fixes various browser-specific bugs with audio getting stuck.\n     * @return {Howler}\n     */\n    _autoSuspend: function() {\n      var self = this;\n\n      if (!self.autoSuspend || !self.ctx || typeof self.ctx.suspend === 'undefined' || !Howler.usingWebAudio) {\n        return;\n      }\n\n      // Check if any sounds are playing.\n      for (var i=0; i<self._howls.length; i++) {\n        if (self._howls[i]._webAudio) {\n          for (var j=0; j<self._howls[i]._sounds.length; j++) {\n            if (!self._howls[i]._sounds[j]._paused) {\n              return self;\n            }\n          }\n        }\n      }\n\n      if (self._suspendTimer) {\n        clearTimeout(self._suspendTimer);\n      }\n\n      // If no sound has played after 30 seconds, suspend the context.\n      self._suspendTimer = setTimeout(function() {\n        if (!self.autoSuspend) {\n          return;\n        }\n\n        self._suspendTimer = null;\n        self.state = 'suspending';\n\n        // Handle updating the state of the audio context after suspending.\n        var handleSuspension = function() {\n          self.state = 'suspended';\n\n          if (self._resumeAfterSuspend) {\n            delete self._resumeAfterSuspend;\n            self._autoResume();\n          }\n        };\n\n        // Either the state gets suspended or it is interrupted.\n        // Either way, we need to update the state to suspended.\n        self.ctx.suspend().then(handleSuspension, handleSuspension);\n      }, 30000);\n\n      return self;\n    },\n\n    /**\n     * Automatically resume the Web Audio AudioContext when a new sound is played.\n     * @return {Howler}\n     */\n    _autoResume: function() {\n      var self = this;\n\n      if (!self.ctx || typeof self.ctx.resume === 'undefined' || !Howler.usingWebAudio) {\n        return;\n      }\n\n      if (self.state === 'running' && self.ctx.state !== 'interrupted' && self._suspendTimer) {\n        clearTimeout(self._suspendTimer);\n        self._suspendTimer = null;\n      } else if (self.state === 'suspended' || self.state === 'running' && self.ctx.state === 'interrupted') {\n        self.ctx.resume().then(function() {\n          self.state = 'running';\n\n          // Emit to all Howls that the audio has resumed.\n          for (var i=0; i<self._howls.length; i++) {\n            self._howls[i]._emit('resume');\n          }\n        });\n\n        if (self._suspendTimer) {\n          clearTimeout(self._suspendTimer);\n          self._suspendTimer = null;\n        }\n      } else if (self.state === 'suspending') {\n        self._resumeAfterSuspend = true;\n      }\n\n      return self;\n    }\n  };\n\n  // Setup the global audio controller.\n  var Howler = new HowlerGlobal();\n\n  /** Group Methods **/\n  /***************************************************************************/\n\n  /**\n   * Create an audio group controller.\n   * @param {Object} o Passed in properties for this group.\n   */\n  var Howl = function(o) {\n    var self = this;\n\n    // Throw an error if no source is provided.\n    if (!o.src || o.src.length === 0) {\n      console.error('An array of source files must be passed with any new Howl.');\n      return;\n    }\n\n    self.init(o);\n  };\n  Howl.prototype = {\n    /**\n     * Initialize a new Howl group object.\n     * @param  {Object} o Passed in properties for this group.\n     * @return {Howl}\n     */\n    init: function(o) {\n      var self = this;\n\n      // If we don't have an AudioContext created yet, run the setup.\n      if (!Howler.ctx) {\n        setupAudioContext();\n      }\n\n      // Setup user-defined default properties.\n      self._autoplay = o.autoplay || false;\n      self._format = (typeof o.format !== 'string') ? o.format : [o.format];\n      self._html5 = o.html5 || false;\n      self._muted = o.mute || false;\n      self._loop = o.loop || false;\n      self._pool = o.pool || 5;\n      self._preload = (typeof o.preload === 'boolean' || o.preload === 'metadata') ? o.preload : true;\n      self._rate = o.rate || 1;\n      self._sprite = o.sprite || {};\n      self._src = (typeof o.src !== 'string') ? o.src : [o.src];\n      self._volume = o.volume !== undefined ? o.volume : 1;\n      self._xhr = {\n        method: o.xhr && o.xhr.method ? o.xhr.method : 'GET',\n        headers: o.xhr && o.xhr.headers ? o.xhr.headers : null,\n        withCredentials: o.xhr && o.xhr.withCredentials ? o.xhr.withCredentials : false,\n      };\n\n      // Setup all other default properties.\n      self._duration = 0;\n      self._state = 'unloaded';\n      self._sounds = [];\n      self._endTimers = {};\n      self._queue = [];\n      self._playLock = false;\n\n      // Setup event listeners.\n      self._onend = o.onend ? [{fn: o.onend}] : [];\n      self._onfade = o.onfade ? [{fn: o.onfade}] : [];\n      self._onload = o.onload ? [{fn: o.onload}] : [];\n      self._onloaderror = o.onloaderror ? [{fn: o.onloaderror}] : [];\n      self._onplayerror = o.onplayerror ? [{fn: o.onplayerror}] : [];\n      self._onpause = o.onpause ? [{fn: o.onpause}] : [];\n      self._onplay = o.onplay ? [{fn: o.onplay}] : [];\n      self._onstop = o.onstop ? [{fn: o.onstop}] : [];\n      self._onmute = o.onmute ? [{fn: o.onmute}] : [];\n      self._onvolume = o.onvolume ? [{fn: o.onvolume}] : [];\n      self._onrate = o.onrate ? [{fn: o.onrate}] : [];\n      self._onseek = o.onseek ? [{fn: o.onseek}] : [];\n      self._onunlock = o.onunlock ? [{fn: o.onunlock}] : [];\n      self._onresume = [];\n\n      // Web Audio or HTML5 Audio?\n      self._webAudio = Howler.usingWebAudio && !self._html5;\n\n      // Automatically try to enable audio.\n      if (typeof Howler.ctx !== 'undefined' && Howler.ctx && Howler.autoUnlock) {\n        Howler._unlockAudio();\n      }\n\n      // Keep track of this Howl group in the global controller.\n      Howler._howls.push(self);\n\n      // If they selected autoplay, add a play event to the load queue.\n      if (self._autoplay) {\n        self._queue.push({\n          event: 'play',\n          action: function() {\n            self.play();\n          }\n        });\n      }\n\n      // Load the source file unless otherwise specified.\n      if (self._preload && self._preload !== 'none') {\n        self.load();\n      }\n\n      return self;\n    },\n\n    /**\n     * Load the audio file.\n     * @return {Howler}\n     */\n    load: function() {\n      var self = this;\n      var url = null;\n\n      // If no audio is available, quit immediately.\n      if (Howler.noAudio) {\n        self._emit('loaderror', null, 'No audio support.');\n        return;\n      }\n\n      // Make sure our source is in an array.\n      if (typeof self._src === 'string') {\n        self._src = [self._src];\n      }\n\n      // Loop through the sources and pick the first one that is compatible.\n      for (var i=0; i<self._src.length; i++) {\n        var ext, str;\n\n        if (self._format && self._format[i]) {\n          // If an extension was specified, use that instead.\n          ext = self._format[i];\n        } else {\n          // Make sure the source is a string.\n          str = self._src[i];\n          if (typeof str !== 'string') {\n            self._emit('loaderror', null, 'Non-string found in selected audio sources - ignoring.');\n            continue;\n          }\n\n          // Extract the file extension from the URL or base64 data URI.\n          ext = /^data:audio\\/([^;,]+);/i.exec(str);\n          if (!ext) {\n            ext = /\\.([^.]+)$/.exec(str.split('?', 1)[0]);\n          }\n\n          if (ext) {\n            ext = ext[1].toLowerCase();\n          }\n        }\n\n        // Log a warning if no extension was found.\n        if (!ext) {\n          console.warn('No file extension was found. Consider using the \"format\" property or specify an extension.');\n        }\n\n        // Check if this extension is available.\n        if (ext && Howler.codecs(ext)) {\n          url = self._src[i];\n          break;\n        }\n      }\n\n      if (!url) {\n        self._emit('loaderror', null, 'No codec support for selected audio sources.');\n        return;\n      }\n\n      self._src = url;\n      self._state = 'loading';\n\n      // If the hosting page is HTTPS and the source isn't,\n      // drop down to HTML5 Audio to avoid Mixed Content errors.\n      if (window.location.protocol === 'https:' && url.slice(0, 5) === 'http:') {\n        self._html5 = true;\n        self._webAudio = false;\n      }\n\n      // Create a new sound object and add it to the pool.\n      new Sound(self);\n\n      // Load and decode the audio data for playback.\n      if (self._webAudio) {\n        loadBuffer(self);\n      }\n\n      return self;\n    },\n\n    /**\n     * Play a sound or resume previous playback.\n     * @param  {String/Number} sprite   Sprite name for sprite playback or sound id to continue previous.\n     * @param  {Boolean} internal Internal Use: true prevents event firing.\n     * @return {Number}          Sound ID.\n     */\n    play: function(sprite, internal) {\n      var self = this;\n      var id = null;\n\n      // Determine if a sprite, sound id or nothing was passed\n      if (typeof sprite === 'number') {\n        id = sprite;\n        sprite = null;\n      } else if (typeof sprite === 'string' && self._state === 'loaded' && !self._sprite[sprite]) {\n        // If the passed sprite doesn't exist, do nothing.\n        return null;\n      } else if (typeof sprite === 'undefined') {\n        // Use the default sound sprite (plays the full audio length).\n        sprite = '__default';\n\n        // Check if there is a single paused sound that isn't ended.\n        // If there is, play that sound. If not, continue as usual.\n        if (!self._playLock) {\n          var num = 0;\n          for (var i=0; i<self._sounds.length; i++) {\n            if (self._sounds[i]._paused && !self._sounds[i]._ended) {\n              num++;\n              id = self._sounds[i]._id;\n            }\n          }\n\n          if (num === 1) {\n            sprite = null;\n          } else {\n            id = null;\n          }\n        }\n      }\n\n      // Get the selected node, or get one from the pool.\n      var sound = id ? self._soundById(id) : self._inactiveSound();\n\n      // If the sound doesn't exist, do nothing.\n      if (!sound) {\n        return null;\n      }\n\n      // Select the sprite definition.\n      if (id && !sprite) {\n        sprite = sound._sprite || '__default';\n      }\n\n      // If the sound hasn't loaded, we must wait to get the audio's duration.\n      // We also need to wait to make sure we don't run into race conditions with\n      // the order of function calls.\n      if (self._state !== 'loaded') {\n        // Set the sprite value on this sound.\n        sound._sprite = sprite;\n\n        // Mark this sound as not ended in case another sound is played before this one loads.\n        sound._ended = false;\n\n        // Add the sound to the queue to be played on load.\n        var soundId = sound._id;\n        self._queue.push({\n          event: 'play',\n          action: function() {\n            self.play(soundId);\n          }\n        });\n\n        return soundId;\n      }\n\n      // Don't play the sound if an id was passed and it is already playing.\n      if (id && !sound._paused) {\n        // Trigger the play event, in order to keep iterating through queue.\n        if (!internal) {\n          self._loadQueue('play');\n        }\n\n        return sound._id;\n      }\n\n      // Make sure the AudioContext isn't suspended, and resume it if it is.\n      if (self._webAudio) {\n        Howler._autoResume();\n      }\n\n      // Determine how long to play for and where to start playing.\n      var seek = Math.max(0, sound._seek > 0 ? sound._seek : self._sprite[sprite][0] / 1000);\n      var duration = Math.max(0, ((self._sprite[sprite][0] + self._sprite[sprite][1]) / 1000) - seek);\n      var timeout = (duration * 1000) / Math.abs(sound._rate);\n      var start = self._sprite[sprite][0] / 1000;\n      var stop = (self._sprite[sprite][0] + self._sprite[sprite][1]) / 1000;\n      sound._sprite = sprite;\n\n      // Mark the sound as ended instantly so that this async playback\n      // doesn't get grabbed by another call to play while this one waits to start.\n      sound._ended = false;\n\n      // Update the parameters of the sound.\n      var setParams = function() {\n        sound._paused = false;\n        sound._seek = seek;\n        sound._start = start;\n        sound._stop = stop;\n        sound._loop = !!(sound._loop || self._sprite[sprite][2]);\n      };\n\n      // End the sound instantly if seek is at the end.\n      if (seek >= stop) {\n        self._ended(sound);\n        return;\n      }\n\n      // Begin the actual playback.\n      var node = sound._node;\n      if (self._webAudio) {\n        // Fire this when the sound is ready to play to begin Web Audio playback.\n        var playWebAudio = function() {\n          self._playLock = false;\n          setParams();\n          self._refreshBuffer(sound);\n\n          // Setup the playback params.\n          var vol = (sound._muted || self._muted) ? 0 : sound._volume;\n          node.gain.setValueAtTime(vol, Howler.ctx.currentTime);\n          sound._playStart = Howler.ctx.currentTime;\n\n          // Play the sound using the supported method.\n          if (typeof node.bufferSource.start === 'undefined') {\n            sound._loop ? node.bufferSource.noteGrainOn(0, seek, 86400) : node.bufferSource.noteGrainOn(0, seek, duration);\n          } else {\n            sound._loop ? node.bufferSource.start(0, seek, 86400) : node.bufferSource.start(0, seek, duration);\n          }\n\n          // Start a new timer if none is present.\n          if (timeout !== Infinity) {\n            self._endTimers[sound._id] = setTimeout(self._ended.bind(self, sound), timeout);\n          }\n\n          if (!internal) {\n            setTimeout(function() {\n              self._emit('play', sound._id);\n              self._loadQueue();\n            }, 0);\n          }\n        };\n\n        if (Howler.state === 'running' && Howler.ctx.state !== 'interrupted') {\n          playWebAudio();\n        } else {\n          self._playLock = true;\n\n          // Wait for the audio context to resume before playing.\n          self.once('resume', playWebAudio);\n\n          // Cancel the end timer.\n          self._clearTimer(sound._id);\n        }\n      } else {\n        // Fire this when the sound is ready to play to begin HTML5 Audio playback.\n        var playHtml5 = function() {\n          node.currentTime = seek;\n          node.muted = sound._muted || self._muted || Howler._muted || node.muted;\n          node.volume = sound._volume * Howler.volume();\n          node.playbackRate = sound._rate;\n\n          // Some browsers will throw an error if this is called without user interaction.\n          try {\n            var play = node.play();\n\n            // Support older browsers that don't support promises, and thus don't have this issue.\n            if (play && typeof Promise !== 'undefined' && (play instanceof Promise || typeof play.then === 'function')) {\n              // Implements a lock to prevent DOMException: The play() request was interrupted by a call to pause().\n              self._playLock = true;\n\n              // Set param values immediately.\n              setParams();\n\n              // Releases the lock and executes queued actions.\n              play\n                .then(function() {\n                  self._playLock = false;\n                  node._unlocked = true;\n                  if (!internal) {\n                    self._emit('play', sound._id);\n                  } else {\n                    self._loadQueue();\n                  }\n                })\n                .catch(function() {\n                  self._playLock = false;\n                  self._emit('playerror', sound._id, 'Playback was unable to start. This is most commonly an issue ' +\n                    'on mobile devices and Chrome where playback was not within a user interaction.');\n\n                  // Reset the ended and paused values.\n                  sound._ended = true;\n                  sound._paused = true;\n                });\n            } else if (!internal) {\n              self._playLock = false;\n              setParams();\n              self._emit('play', sound._id);\n            }\n\n            // Setting rate before playing won't work in IE, so we set it again here.\n            node.playbackRate = sound._rate;\n\n            // If the node is still paused, then we can assume there was a playback issue.\n            if (node.paused) {\n              self._emit('playerror', sound._id, 'Playback was unable to start. This is most commonly an issue ' +\n                'on mobile devices and Chrome where playback was not within a user interaction.');\n              return;\n            }\n\n            // Setup the end timer on sprites or listen for the ended event.\n            if (sprite !== '__default' || sound._loop) {\n              self._endTimers[sound._id] = setTimeout(self._ended.bind(self, sound), timeout);\n            } else {\n              self._endTimers[sound._id] = function() {\n                // Fire ended on this audio node.\n                self._ended(sound);\n\n                // Clear this listener.\n                node.removeEventListener('ended', self._endTimers[sound._id], false);\n              };\n              node.addEventListener('ended', self._endTimers[sound._id], false);\n            }\n          } catch (err) {\n            self._emit('playerror', sound._id, err);\n          }\n        };\n\n        // If this is streaming audio, make sure the src is set and load again.\n        if (node.src === 'data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA') {\n          node.src = self._src;\n          node.load();\n        }\n\n        // Play immediately if ready, or wait for the 'canplaythrough'e vent.\n        var loadedNoReadyState = (window && window.ejecta) || (!node.readyState && Howler._navigator.isCocoonJS);\n        if (node.readyState >= 3 || loadedNoReadyState) {\n          playHtml5();\n        } else {\n          self._playLock = true;\n          self._state = 'loading';\n\n          var listener = function() {\n            self._state = 'loaded';\n            \n            // Begin playback.\n            playHtml5();\n\n            // Clear this listener.\n            node.removeEventListener(Howler._canPlayEvent, listener, false);\n          };\n          node.addEventListener(Howler._canPlayEvent, listener, false);\n\n          // Cancel the end timer.\n          self._clearTimer(sound._id);\n        }\n      }\n\n      return sound._id;\n    },\n\n    /**\n     * Pause playback and save current position.\n     * @param  {Number} id The sound ID (empty to pause all in group).\n     * @return {Howl}\n     */\n    pause: function(id) {\n      var self = this;\n\n      // If the sound hasn't loaded or a play() promise is pending, add it to the load queue to pause when capable.\n      if (self._state !== 'loaded' || self._playLock) {\n        self._queue.push({\n          event: 'pause',\n          action: function() {\n            self.pause(id);\n          }\n        });\n\n        return self;\n      }\n\n      // If no id is passed, get all ID's to be paused.\n      var ids = self._getSoundIds(id);\n\n      for (var i=0; i<ids.length; i++) {\n        // Clear the end timer.\n        self._clearTimer(ids[i]);\n\n        // Get the sound.\n        var sound = self._soundById(ids[i]);\n\n        if (sound && !sound._paused) {\n          // Reset the seek position.\n          sound._seek = self.seek(ids[i]);\n          sound._rateSeek = 0;\n          sound._paused = true;\n\n          // Stop currently running fades.\n          self._stopFade(ids[i]);\n\n          if (sound._node) {\n            if (self._webAudio) {\n              // Make sure the sound has been created.\n              if (!sound._node.bufferSource) {\n                continue;\n              }\n\n              if (typeof sound._node.bufferSource.stop === 'undefined') {\n                sound._node.bufferSource.noteOff(0);\n              } else {\n                sound._node.bufferSource.stop(0);\n              }\n\n              // Clean up the buffer source.\n              self._cleanBuffer(sound._node);\n            } else if (!isNaN(sound._node.duration) || sound._node.duration === Infinity) {\n              sound._node.pause();\n            }\n          }\n        }\n\n        // Fire the pause event, unless `true` is passed as the 2nd argument.\n        if (!arguments[1]) {\n          self._emit('pause', sound ? sound._id : null);\n        }\n      }\n\n      return self;\n    },\n\n    /**\n     * Stop playback and reset to start.\n     * @param  {Number} id The sound ID (empty to stop all in group).\n     * @param  {Boolean} internal Internal Use: true prevents event firing.\n     * @return {Howl}\n     */\n    stop: function(id, internal) {\n      var self = this;\n\n      // If the sound hasn't loaded, add it to the load queue to stop when capable.\n      if (self._state !== 'loaded' || self._playLock) {\n        self._queue.push({\n          event: 'stop',\n          action: function() {\n            self.stop(id);\n          }\n        });\n\n        return self;\n      }\n\n      // If no id is passed, get all ID's to be stopped.\n      var ids = self._getSoundIds(id);\n\n      for (var i=0; i<ids.length; i++) {\n        // Clear the end timer.\n        self._clearTimer(ids[i]);\n\n        // Get the sound.\n        var sound = self._soundById(ids[i]);\n\n        if (sound) {\n          // Reset the seek position.\n          sound._seek = sound._start || 0;\n          sound._rateSeek = 0;\n          sound._paused = true;\n          sound._ended = true;\n\n          // Stop currently running fades.\n          self._stopFade(ids[i]);\n\n          if (sound._node) {\n            if (self._webAudio) {\n              // Make sure the sound's AudioBufferSourceNode has been created.\n              if (sound._node.bufferSource) {\n                if (typeof sound._node.bufferSource.stop === 'undefined') {\n                  sound._node.bufferSource.noteOff(0);\n                } else {\n                  sound._node.bufferSource.stop(0);\n                }\n\n                // Clean up the buffer source.\n                self._cleanBuffer(sound._node);\n              }\n            } else if (!isNaN(sound._node.duration) || sound._node.duration === Infinity) {\n              sound._node.currentTime = sound._start || 0;\n              sound._node.pause();\n\n              // If this is a live stream, stop download once the audio is stopped.\n              if (sound._node.duration === Infinity) {\n                self._clearSound(sound._node);\n              }\n            }\n          }\n\n          if (!internal) {\n            self._emit('stop', sound._id);\n          }\n        }\n      }\n\n      return self;\n    },\n\n    /**\n     * Mute/unmute a single sound or all sounds in this Howl group.\n     * @param  {Boolean} muted Set to true to mute and false to unmute.\n     * @param  {Number} id    The sound ID to update (omit to mute/unmute all).\n     * @return {Howl}\n     */\n    mute: function(muted, id) {\n      var self = this;\n\n      // If the sound hasn't loaded, add it to the load queue to mute when capable.\n      if (self._state !== 'loaded'|| self._playLock) {\n        self._queue.push({\n          event: 'mute',\n          action: function() {\n            self.mute(muted, id);\n          }\n        });\n\n        return self;\n      }\n\n      // If applying mute/unmute to all sounds, update the group's value.\n      if (typeof id === 'undefined') {\n        if (typeof muted === 'boolean') {\n          self._muted = muted;\n        } else {\n          return self._muted;\n        }\n      }\n\n      // If no id is passed, get all ID's to be muted.\n      var ids = self._getSoundIds(id);\n\n      for (var i=0; i<ids.length; i++) {\n        // Get the sound.\n        var sound = self._soundById(ids[i]);\n\n        if (sound) {\n          sound._muted = muted;\n\n          // Cancel active fade and set the volume to the end value.\n          if (sound._interval) {\n            self._stopFade(sound._id);\n          }\n\n          if (self._webAudio && sound._node) {\n            sound._node.gain.setValueAtTime(muted ? 0 : sound._volume, Howler.ctx.currentTime);\n          } else if (sound._node) {\n            sound._node.muted = Howler._muted ? true : muted;\n          }\n\n          self._emit('mute', sound._id);\n        }\n      }\n\n      return self;\n    },\n\n    /**\n     * Get/set the volume of this sound or of the Howl group. This method can optionally take 0, 1 or 2 arguments.\n     *   volume() -> Returns the group's volume value.\n     *   volume(id) -> Returns the sound id's current volume.\n     *   volume(vol) -> Sets the volume of all sounds in this Howl group.\n     *   volume(vol, id) -> Sets the volume of passed sound id.\n     * @return {Howl/Number} Returns self or current volume.\n     */\n    volume: function() {\n      var self = this;\n      var args = arguments;\n      var vol, id;\n\n      // Determine the values based on arguments.\n      if (args.length === 0) {\n        // Return the value of the groups' volume.\n        return self._volume;\n      } else if (args.length === 1 || args.length === 2 && typeof args[1] === 'undefined') {\n        // First check if this is an ID, and if not, assume it is a new volume.\n        var ids = self._getSoundIds();\n        var index = ids.indexOf(args[0]);\n        if (index >= 0) {\n          id = parseInt(args[0], 10);\n        } else {\n          vol = parseFloat(args[0]);\n        }\n      } else if (args.length >= 2) {\n        vol = parseFloat(args[0]);\n        id = parseInt(args[1], 10);\n      }\n\n      // Update the volume or return the current volume.\n      var sound;\n      if (typeof vol !== 'undefined' && vol >= 0 && vol <= 1) {\n        // If the sound hasn't loaded, add it to the load queue to change volume when capable.\n        if (self._state !== 'loaded'|| self._playLock) {\n          self._queue.push({\n            event: 'volume',\n            action: function() {\n              self.volume.apply(self, args);\n            }\n          });\n\n          return self;\n        }\n\n        // Set the group volume.\n        if (typeof id === 'undefined') {\n          self._volume = vol;\n        }\n\n        // Update one or all volumes.\n        id = self._getSoundIds(id);\n        for (var i=0; i<id.length; i++) {\n          // Get the sound.\n          sound = self._soundById(id[i]);\n\n          if (sound) {\n            sound._volume = vol;\n\n            // Stop currently running fades.\n            if (!args[2]) {\n              self._stopFade(id[i]);\n            }\n\n            if (self._webAudio && sound._node && !sound._muted) {\n              sound._node.gain.setValueAtTime(vol, Howler.ctx.currentTime);\n            } else if (sound._node && !sound._muted) {\n              sound._node.volume = vol * Howler.volume();\n            }\n\n            self._emit('volume', sound._id);\n          }\n        }\n      } else {\n        sound = id ? self._soundById(id) : self._sounds[0];\n        return sound ? sound._volume : 0;\n      }\n\n      return self;\n    },\n\n    /**\n     * Fade a currently playing sound between two volumes (if no id is passed, all sounds will fade).\n     * @param  {Number} from The value to fade from (0.0 to 1.0).\n     * @param  {Number} to   The volume to fade to (0.0 to 1.0).\n     * @param  {Number} len  Time in milliseconds to fade.\n     * @param  {Number} id   The sound id (omit to fade all sounds).\n     * @return {Howl}\n     */\n    fade: function(from, to, len, id) {\n      var self = this;\n\n      // If the sound hasn't loaded, add it to the load queue to fade when capable.\n      if (self._state !== 'loaded' || self._playLock) {\n        self._queue.push({\n          event: 'fade',\n          action: function() {\n            self.fade(from, to, len, id);\n          }\n        });\n\n        return self;\n      }\n\n      // Make sure the to/from/len values are numbers.\n      from = Math.min(Math.max(0, parseFloat(from)), 1);\n      to = Math.min(Math.max(0, parseFloat(to)), 1);\n      len = parseFloat(len);\n\n      // Set the volume to the start position.\n      self.volume(from, id);\n\n      // Fade the volume of one or all sounds.\n      var ids = self._getSoundIds(id);\n      for (var i=0; i<ids.length; i++) {\n        // Get the sound.\n        var sound = self._soundById(ids[i]);\n\n        // Create a linear fade or fall back to timeouts with HTML5 Audio.\n        if (sound) {\n          // Stop the previous fade if no sprite is being used (otherwise, volume handles this).\n          if (!id) {\n            self._stopFade(ids[i]);\n          }\n\n          // If we are using Web Audio, let the native methods do the actual fade.\n          if (self._webAudio && !sound._muted) {\n            var currentTime = Howler.ctx.currentTime;\n            var end = currentTime + (len / 1000);\n            sound._volume = from;\n            sound._node.gain.setValueAtTime(from, currentTime);\n            sound._node.gain.linearRampToValueAtTime(to, end);\n          }\n\n          self._startFadeInterval(sound, from, to, len, ids[i], typeof id === 'undefined');\n        }\n      }\n\n      return self;\n    },\n\n    /**\n     * Starts the internal interval to fade a sound.\n     * @param  {Object} sound Reference to sound to fade.\n     * @param  {Number} from The value to fade from (0.0 to 1.0).\n     * @param  {Number} to   The volume to fade to (0.0 to 1.0).\n     * @param  {Number} len  Time in milliseconds to fade.\n     * @param  {Number} id   The sound id to fade.\n     * @param  {Boolean} isGroup   If true, set the volume on the group.\n     */\n    _startFadeInterval: function(sound, from, to, len, id, isGroup) {\n      var self = this;\n      var vol = from;\n      var diff = to - from;\n      var steps = Math.abs(diff / 0.01);\n      var stepLen = Math.max(4, (steps > 0) ? len / steps : len);\n      var lastTick = Date.now();\n\n      // Store the value being faded to.\n      sound._fadeTo = to;\n\n      // Update the volume value on each interval tick.\n      sound._interval = setInterval(function() {\n        // Update the volume based on the time since the last tick.\n        var tick = (Date.now() - lastTick) / len;\n        lastTick = Date.now();\n        vol += diff * tick;\n\n        // Round to within 2 decimal points.\n        vol = Math.round(vol * 100) / 100;\n\n        // Make sure the volume is in the right bounds.\n        if (diff < 0) {\n          vol = Math.max(to, vol);\n        } else {\n          vol = Math.min(to, vol);\n        }\n\n        // Change the volume.\n        if (self._webAudio) {\n          sound._volume = vol;\n        } else {\n          self.volume(vol, sound._id, true);\n        }\n\n        // Set the group's volume.\n        if (isGroup) {\n          self._volume = vol;\n        }\n\n        // When the fade is complete, stop it and fire event.\n        if ((to < from && vol <= to) || (to > from && vol >= to)) {\n          clearInterval(sound._interval);\n          sound._interval = null;\n          sound._fadeTo = null;\n          self.volume(to, sound._id);\n          self._emit('fade', sound._id);\n        }\n      }, stepLen);\n    },\n\n    /**\n     * Internal method that stops the currently playing fade when\n     * a new fade starts, volume is changed or the sound is stopped.\n     * @param  {Number} id The sound id.\n     * @return {Howl}\n     */\n    _stopFade: function(id) {\n      var self = this;\n      var sound = self._soundById(id);\n\n      if (sound && sound._interval) {\n        if (self._webAudio) {\n          sound._node.gain.cancelScheduledValues(Howler.ctx.currentTime);\n        }\n\n        clearInterval(sound._interval);\n        sound._interval = null;\n        self.volume(sound._fadeTo, id);\n        sound._fadeTo = null;\n        self._emit('fade', id);\n      }\n\n      return self;\n    },\n\n    /**\n     * Get/set the loop parameter on a sound. This method can optionally take 0, 1 or 2 arguments.\n     *   loop() -> Returns the group's loop value.\n     *   loop(id) -> Returns the sound id's loop value.\n     *   loop(loop) -> Sets the loop value for all sounds in this Howl group.\n     *   loop(loop, id) -> Sets the loop value of passed sound id.\n     * @return {Howl/Boolean} Returns self or current loop value.\n     */\n    loop: function() {\n      var self = this;\n      var args = arguments;\n      var loop, id, sound;\n\n      // Determine the values for loop and id.\n      if (args.length === 0) {\n        // Return the grou's loop value.\n        return self._loop;\n      } else if (args.length === 1) {\n        if (typeof args[0] === 'boolean') {\n          loop = args[0];\n          self._loop = loop;\n        } else {\n          // Return this sound's loop value.\n          sound = self._soundById(parseInt(args[0], 10));\n          return sound ? sound._loop : false;\n        }\n      } else if (args.length === 2) {\n        loop = args[0];\n        id = parseInt(args[1], 10);\n      }\n\n      // If no id is passed, get all ID's to be looped.\n      var ids = self._getSoundIds(id);\n      for (var i=0; i<ids.length; i++) {\n        sound = self._soundById(ids[i]);\n\n        if (sound) {\n          sound._loop = loop;\n          if (self._webAudio && sound._node && sound._node.bufferSource) {\n            sound._node.bufferSource.loop = loop;\n            if (loop) {\n              sound._node.bufferSource.loopStart = sound._start || 0;\n              sound._node.bufferSource.loopEnd = sound._stop;\n\n              // If playing, restart playback to ensure looping updates.\n              if (self.playing(ids[i])) {\n                self.pause(ids[i], true);\n                self.play(ids[i], true);\n              }\n            }\n          }\n        }\n      }\n\n      return self;\n    },\n\n    /**\n     * Get/set the playback rate of a sound. This method can optionally take 0, 1 or 2 arguments.\n     *   rate() -> Returns the first sound node's current playback rate.\n     *   rate(id) -> Returns the sound id's current playback rate.\n     *   rate(rate) -> Sets the playback rate of all sounds in this Howl group.\n     *   rate(rate, id) -> Sets the playback rate of passed sound id.\n     * @return {Howl/Number} Returns self or the current playback rate.\n     */\n    rate: function() {\n      var self = this;\n      var args = arguments;\n      var rate, id;\n\n      // Determine the values based on arguments.\n      if (args.length === 0) {\n        // We will simply return the current rate of the first node.\n        id = self._sounds[0]._id;\n      } else if (args.length === 1) {\n        // First check if this is an ID, and if not, assume it is a new rate value.\n        var ids = self._getSoundIds();\n        var index = ids.indexOf(args[0]);\n        if (index >= 0) {\n          id = parseInt(args[0], 10);\n        } else {\n          rate = parseFloat(args[0]);\n        }\n      } else if (args.length === 2) {\n        rate = parseFloat(args[0]);\n        id = parseInt(args[1], 10);\n      }\n\n      // Update the playback rate or return the current value.\n      var sound;\n      if (typeof rate === 'number') {\n        // If the sound hasn't loaded, add it to the load queue to change playback rate when capable.\n        if (self._state !== 'loaded' || self._playLock) {\n          self._queue.push({\n            event: 'rate',\n            action: function() {\n              self.rate.apply(self, args);\n            }\n          });\n\n          return self;\n        }\n\n        // Set the group rate.\n        if (typeof id === 'undefined') {\n          self._rate = rate;\n        }\n\n        // Update one or all volumes.\n        id = self._getSoundIds(id);\n        for (var i=0; i<id.length; i++) {\n          // Get the sound.\n          sound = self._soundById(id[i]);\n\n          if (sound) {\n            // Keep track of our position when the rate changed and update the playback\n            // start position so we can properly adjust the seek position for time elapsed.\n            if (self.playing(id[i])) {\n              sound._rateSeek = self.seek(id[i]);\n              sound._playStart = self._webAudio ? Howler.ctx.currentTime : sound._playStart;\n            }\n            sound._rate = rate;\n\n            // Change the playback rate.\n            if (self._webAudio && sound._node && sound._node.bufferSource) {\n              sound._node.bufferSource.playbackRate.setValueAtTime(rate, Howler.ctx.currentTime);\n            } else if (sound._node) {\n              sound._node.playbackRate = rate;\n            }\n\n            // Reset the timers.\n            var seek = self.seek(id[i]);\n            var duration = ((self._sprite[sound._sprite][0] + self._sprite[sound._sprite][1]) / 1000) - seek;\n            var timeout = (duration * 1000) / Math.abs(sound._rate);\n\n            // Start a new end timer if sound is already playing.\n            if (self._endTimers[id[i]] || !sound._paused) {\n              self._clearTimer(id[i]);\n              self._endTimers[id[i]] = setTimeout(self._ended.bind(self, sound), timeout);\n            }\n\n            self._emit('rate', sound._id);\n          }\n        }\n      } else {\n        sound = self._soundById(id);\n        return sound ? sound._rate : self._rate;\n      }\n\n      return self;\n    },\n\n    /**\n     * Get/set the seek position of a sound. This method can optionally take 0, 1 or 2 arguments.\n     *   seek() -> Returns the first sound node's current seek position.\n     *   seek(id) -> Returns the sound id's current seek position.\n     *   seek(seek) -> Sets the seek position of the first sound node.\n     *   seek(seek, id) -> Sets the seek position of passed sound id.\n     * @return {Howl/Number} Returns self or the current seek position.\n     */\n    seek: function() {\n      var self = this;\n      var args = arguments;\n      var seek, id;\n\n      // Determine the values based on arguments.\n      if (args.length === 0) {\n        // We will simply return the current position of the first node.\n        if (self._sounds.length) {\n          id = self._sounds[0]._id;\n        }\n      } else if (args.length === 1) {\n        // First check if this is an ID, and if not, assume it is a new seek position.\n        var ids = self._getSoundIds();\n        var index = ids.indexOf(args[0]);\n        if (index >= 0) {\n          id = parseInt(args[0], 10);\n        } else if (self._sounds.length) {\n          id = self._sounds[0]._id;\n          seek = parseFloat(args[0]);\n        }\n      } else if (args.length === 2) {\n        seek = parseFloat(args[0]);\n        id = parseInt(args[1], 10);\n      }\n\n      // If there is no ID, bail out.\n      if (typeof id === 'undefined') {\n        return 0;\n      }\n\n      // If the sound hasn't loaded, add it to the load queue to seek when capable.\n      if (typeof seek === 'number' && (self._state !== 'loaded' || self._playLock)) {\n        self._queue.push({\n          event: 'seek',\n          action: function() {\n            self.seek.apply(self, args);\n          }\n        });\n\n        return self;\n      }\n\n      // Get the sound.\n      var sound = self._soundById(id);\n\n      if (sound) {\n        if (typeof seek === 'number' && seek >= 0) {\n          // Pause the sound and update position for restarting playback.\n          var playing = self.playing(id);\n          if (playing) {\n            self.pause(id, true);\n          }\n\n          // Move the position of the track and cancel timer.\n          sound._seek = seek;\n          sound._ended = false;\n          self._clearTimer(id);\n\n          // Update the seek position for HTML5 Audio.\n          if (!self._webAudio && sound._node && !isNaN(sound._node.duration)) {\n            sound._node.currentTime = seek;\n          }\n\n          // Seek and emit when ready.\n          var seekAndEmit = function() {\n            // Restart the playback if the sound was playing.\n            if (playing) {\n              self.play(id, true);\n            }\n\n            self._emit('seek', id);\n          };\n\n          // Wait for the play lock to be unset before emitting (HTML5 Audio).\n          if (playing && !self._webAudio) {\n            var emitSeek = function() {\n              if (!self._playLock) {\n                seekAndEmit();\n              } else {\n                setTimeout(emitSeek, 0);\n              }\n            };\n            setTimeout(emitSeek, 0);\n          } else {\n            seekAndEmit();\n          }\n        } else {\n          if (self._webAudio) {\n            var realTime = self.playing(id) ? Howler.ctx.currentTime - sound._playStart : 0;\n            var rateSeek = sound._rateSeek ? sound._rateSeek - sound._seek : 0;\n            return sound._seek + (rateSeek + realTime * Math.abs(sound._rate));\n          } else {\n            return sound._node.currentTime;\n          }\n        }\n      }\n\n      return self;\n    },\n\n    /**\n     * Check if a specific sound is currently playing or not (if id is provided), or check if at least one of the sounds in the group is playing or not.\n     * @param  {Number}  id The sound id to check. If none is passed, the whole sound group is checked.\n     * @return {Boolean} True if playing and false if not.\n     */\n    playing: function(id) {\n      var self = this;\n\n      // Check the passed sound ID (if any).\n      if (typeof id === 'number') {\n        var sound = self._soundById(id);\n        return sound ? !sound._paused : false;\n      }\n\n      // Otherwise, loop through all sounds and check if any are playing.\n      for (var i=0; i<self._sounds.length; i++) {\n        if (!self._sounds[i]._paused) {\n          return true;\n        }\n      }\n\n      return false;\n    },\n\n    /**\n     * Get the duration of this sound. Passing a sound id will return the sprite duration.\n     * @param  {Number} id The sound id to check. If none is passed, return full source duration.\n     * @return {Number} Audio duration in seconds.\n     */\n    duration: function(id) {\n      var self = this;\n      var duration = self._duration;\n\n      // If we pass an ID, get the sound and return the sprite length.\n      var sound = self._soundById(id);\n      if (sound) {\n        duration = self._sprite[sound._sprite][1] / 1000;\n      }\n\n      return duration;\n    },\n\n    /**\n     * Returns the current loaded state of this Howl.\n     * @return {String} 'unloaded', 'loading', 'loaded'\n     */\n    state: function() {\n      return this._state;\n    },\n\n    /**\n     * Unload and destroy the current Howl object.\n     * This will immediately stop all sound instances attached to this group.\n     */\n    unload: function() {\n      var self = this;\n\n      // Stop playing any active sounds.\n      var sounds = self._sounds;\n      for (var i=0; i<sounds.length; i++) {\n        // Stop the sound if it is currently playing.\n        if (!sounds[i]._paused) {\n          self.stop(sounds[i]._id);\n        }\n\n        // Remove the source or disconnect.\n        if (!self._webAudio) {\n          // Set the source to 0-second silence to stop any downloading (except in IE).\n          self._clearSound(sounds[i]._node);\n\n          // Remove any event listeners.\n          sounds[i]._node.removeEventListener('error', sounds[i]._errorFn, false);\n          sounds[i]._node.removeEventListener(Howler._canPlayEvent, sounds[i]._loadFn, false);\n          sounds[i]._node.removeEventListener('ended', sounds[i]._endFn, false);\n\n          // Release the Audio object back to the pool.\n          Howler._releaseHtml5Audio(sounds[i]._node);\n        }\n\n        // Empty out all of the nodes.\n        delete sounds[i]._node;\n\n        // Make sure all timers are cleared out.\n        self._clearTimer(sounds[i]._id);\n      }\n\n      // Remove the references in the global Howler object.\n      var index = Howler._howls.indexOf(self);\n      if (index >= 0) {\n        Howler._howls.splice(index, 1);\n      }\n\n      // Delete this sound from the cache (if no other Howl is using it).\n      var remCache = true;\n      for (i=0; i<Howler._howls.length; i++) {\n        if (Howler._howls[i]._src === self._src || self._src.indexOf(Howler._howls[i]._src) >= 0) {\n          remCache = false;\n          break;\n        }\n      }\n\n      if (cache && remCache) {\n        delete cache[self._src];\n      }\n\n      // Clear global errors.\n      Howler.noAudio = false;\n\n      // Clear out `self`.\n      self._state = 'unloaded';\n      self._sounds = [];\n      self = null;\n\n      return null;\n    },\n\n    /**\n     * Listen to a custom event.\n     * @param  {String}   event Event name.\n     * @param  {Function} fn    Listener to call.\n     * @param  {Number}   id    (optional) Only listen to events for this sound.\n     * @param  {Number}   once  (INTERNAL) Marks event to fire only once.\n     * @return {Howl}\n     */\n    on: function(event, fn, id, once) {\n      var self = this;\n      var events = self['_on' + event];\n\n      if (typeof fn === 'function') {\n        events.push(once ? {id: id, fn: fn, once: once} : {id: id, fn: fn});\n      }\n\n      return self;\n    },\n\n    /**\n     * Remove a custom event. Call without parameters to remove all events.\n     * @param  {String}   event Event name.\n     * @param  {Function} fn    Listener to remove. Leave empty to remove all.\n     * @param  {Number}   id    (optional) Only remove events for this sound.\n     * @return {Howl}\n     */\n    off: function(event, fn, id) {\n      var self = this;\n      var events = self['_on' + event];\n      var i = 0;\n\n      // Allow passing just an event and ID.\n      if (typeof fn === 'number') {\n        id = fn;\n        fn = null;\n      }\n\n      if (fn || id) {\n        // Loop through event store and remove the passed function.\n        for (i=0; i<events.length; i++) {\n          var isId = (id === events[i].id);\n          if (fn === events[i].fn && isId || !fn && isId) {\n            events.splice(i, 1);\n            break;\n          }\n        }\n      } else if (event) {\n        // Clear out all events of this type.\n        self['_on' + event] = [];\n      } else {\n        // Clear out all events of every type.\n        var keys = Object.keys(self);\n        for (i=0; i<keys.length; i++) {\n          if ((keys[i].indexOf('_on') === 0) && Array.isArray(self[keys[i]])) {\n            self[keys[i]] = [];\n          }\n        }\n      }\n\n      return self;\n    },\n\n    /**\n     * Listen to a custom event and remove it once fired.\n     * @param  {String}   event Event name.\n     * @param  {Function} fn    Listener to call.\n     * @param  {Number}   id    (optional) Only listen to events for this sound.\n     * @return {Howl}\n     */\n    once: function(event, fn, id) {\n      var self = this;\n\n      // Setup the event listener.\n      self.on(event, fn, id, 1);\n\n      return self;\n    },\n\n    /**\n     * Emit all events of a specific type and pass the sound id.\n     * @param  {String} event Event name.\n     * @param  {Number} id    Sound ID.\n     * @param  {Number} msg   Message to go with event.\n     * @return {Howl}\n     */\n    _emit: function(event, id, msg) {\n      var self = this;\n      var events = self['_on' + event];\n\n      // Loop through event store and fire all functions.\n      for (var i=events.length-1; i>=0; i--) {\n        // Only fire the listener if the correct ID is used.\n        if (!events[i].id || events[i].id === id || event === 'load') {\n          setTimeout(function(fn) {\n            fn.call(this, id, msg);\n          }.bind(self, events[i].fn), 0);\n\n          // If this event was setup with `once`, remove it.\n          if (events[i].once) {\n            self.off(event, events[i].fn, events[i].id);\n          }\n        }\n      }\n\n      // Pass the event type into load queue so that it can continue stepping.\n      self._loadQueue(event);\n\n      return self;\n    },\n\n    /**\n     * Queue of actions initiated before the sound has loaded.\n     * These will be called in sequence, with the next only firing\n     * after the previous has finished executing (even if async like play).\n     * @return {Howl}\n     */\n    _loadQueue: function(event) {\n      var self = this;\n\n      if (self._queue.length > 0) {\n        var task = self._queue[0];\n\n        // Remove this task if a matching event was passed.\n        if (task.event === event) {\n          self._queue.shift();\n          self._loadQueue();\n        }\n\n        // Run the task if no event type is passed.\n        if (!event) {\n          task.action();\n        }\n      }\n\n      return self;\n    },\n\n    /**\n     * Fired when playback ends at the end of the duration.\n     * @param  {Sound} sound The sound object to work with.\n     * @return {Howl}\n     */\n    _ended: function(sound) {\n      var self = this;\n      var sprite = sound._sprite;\n\n      // If we are using IE and there was network latency we may be clipping\n      // audio before it completes playing. Lets check the node to make sure it\n      // believes it has completed, before ending the playback.\n      if (!self._webAudio && sound._node && !sound._node.paused && !sound._node.ended && sound._node.currentTime < sound._stop) {\n        setTimeout(self._ended.bind(self, sound), 100);\n        return self;\n      }\n\n      // Should this sound loop?\n      var loop = !!(sound._loop || self._sprite[sprite][2]);\n\n      // Fire the ended event.\n      self._emit('end', sound._id);\n\n      // Restart the playback for HTML5 Audio loop.\n      if (!self._webAudio && loop) {\n        self.stop(sound._id, true).play(sound._id);\n      }\n\n      // Restart this timer if on a Web Audio loop.\n      if (self._webAudio && loop) {\n        self._emit('play', sound._id);\n        sound._seek = sound._start || 0;\n        sound._rateSeek = 0;\n        sound._playStart = Howler.ctx.currentTime;\n\n        var timeout = ((sound._stop - sound._start) * 1000) / Math.abs(sound._rate);\n        self._endTimers[sound._id] = setTimeout(self._ended.bind(self, sound), timeout);\n      }\n\n      // Mark the node as paused.\n      if (self._webAudio && !loop) {\n        sound._paused = true;\n        sound._ended = true;\n        sound._seek = sound._start || 0;\n        sound._rateSeek = 0;\n        self._clearTimer(sound._id);\n\n        // Clean up the buffer source.\n        self._cleanBuffer(sound._node);\n\n        // Attempt to auto-suspend AudioContext if no sounds are still playing.\n        Howler._autoSuspend();\n      }\n\n      // When using a sprite, end the track.\n      if (!self._webAudio && !loop) {\n        self.stop(sound._id, true);\n      }\n\n      return self;\n    },\n\n    /**\n     * Clear the end timer for a sound playback.\n     * @param  {Number} id The sound ID.\n     * @return {Howl}\n     */\n    _clearTimer: function(id) {\n      var self = this;\n\n      if (self._endTimers[id]) {\n        // Clear the timeout or remove the ended listener.\n        if (typeof self._endTimers[id] !== 'function') {\n          clearTimeout(self._endTimers[id]);\n        } else {\n          var sound = self._soundById(id);\n          if (sound && sound._node) {\n            sound._node.removeEventListener('ended', self._endTimers[id], false);\n          }\n        }\n\n        delete self._endTimers[id];\n      }\n\n      return self;\n    },\n\n    /**\n     * Return the sound identified by this ID, or return null.\n     * @param  {Number} id Sound ID\n     * @return {Object}    Sound object or null.\n     */\n    _soundById: function(id) {\n      var self = this;\n\n      // Loop through all sounds and find the one with this ID.\n      for (var i=0; i<self._sounds.length; i++) {\n        if (id === self._sounds[i]._id) {\n          return self._sounds[i];\n        }\n      }\n\n      return null;\n    },\n\n    /**\n     * Return an inactive sound from the pool or create a new one.\n     * @return {Sound} Sound playback object.\n     */\n    _inactiveSound: function() {\n      var self = this;\n\n      self._drain();\n\n      // Find the first inactive node to recycle.\n      for (var i=0; i<self._sounds.length; i++) {\n        if (self._sounds[i]._ended) {\n          return self._sounds[i].reset();\n        }\n      }\n\n      // If no inactive node was found, create a new one.\n      return new Sound(self);\n    },\n\n    /**\n     * Drain excess inactive sounds from the pool.\n     */\n    _drain: function() {\n      var self = this;\n      var limit = self._pool;\n      var cnt = 0;\n      var i = 0;\n\n      // If there are less sounds than the max pool size, we are done.\n      if (self._sounds.length < limit) {\n        return;\n      }\n\n      // Count the number of inactive sounds.\n      for (i=0; i<self._sounds.length; i++) {\n        if (self._sounds[i]._ended) {\n          cnt++;\n        }\n      }\n\n      // Remove excess inactive sounds, going in reverse order.\n      for (i=self._sounds.length - 1; i>=0; i--) {\n        if (cnt <= limit) {\n          return;\n        }\n\n        if (self._sounds[i]._ended) {\n          // Disconnect the audio source when using Web Audio.\n          if (self._webAudio && self._sounds[i]._node) {\n            self._sounds[i]._node.disconnect(0);\n          }\n\n          // Remove sounds until we have the pool size.\n          self._sounds.splice(i, 1);\n          cnt--;\n        }\n      }\n    },\n\n    /**\n     * Get all ID's from the sounds pool.\n     * @param  {Number} id Only return one ID if one is passed.\n     * @return {Array}    Array of IDs.\n     */\n    _getSoundIds: function(id) {\n      var self = this;\n\n      if (typeof id === 'undefined') {\n        var ids = [];\n        for (var i=0; i<self._sounds.length; i++) {\n          ids.push(self._sounds[i]._id);\n        }\n\n        return ids;\n      } else {\n        return [id];\n      }\n    },\n\n    /**\n     * Load the sound back into the buffer source.\n     * @param  {Sound} sound The sound object to work with.\n     * @return {Howl}\n     */\n    _refreshBuffer: function(sound) {\n      var self = this;\n\n      // Setup the buffer source for playback.\n      sound._node.bufferSource = Howler.ctx.createBufferSource();\n      sound._node.bufferSource.buffer = cache[self._src];\n\n      // Connect to the correct node.\n      if (sound._panner) {\n        sound._node.bufferSource.connect(sound._panner);\n      } else {\n        sound._node.bufferSource.connect(sound._node);\n      }\n\n      // Setup looping and playback rate.\n      sound._node.bufferSource.loop = sound._loop;\n      if (sound._loop) {\n        sound._node.bufferSource.loopStart = sound._start || 0;\n        sound._node.bufferSource.loopEnd = sound._stop || 0;\n      }\n      sound._node.bufferSource.playbackRate.setValueAtTime(sound._rate, Howler.ctx.currentTime);\n\n      return self;\n    },\n\n    /**\n     * Prevent memory leaks by cleaning up the buffer source after playback.\n     * @param  {Object} node Sound's audio node containing the buffer source.\n     * @return {Howl}\n     */\n    _cleanBuffer: function(node) {\n      var self = this;\n      var isIOS = Howler._navigator && Howler._navigator.vendor.indexOf('Apple') >= 0;\n\n      if (!node.bufferSource) {\n        return self;\n      }\n\n      if (Howler._scratchBuffer && node.bufferSource) {\n        node.bufferSource.onended = null;\n        node.bufferSource.disconnect(0);\n        if (isIOS) {\n          try { node.bufferSource.buffer = Howler._scratchBuffer; } catch(e) {}\n        }\n      }\n      node.bufferSource = null;\n\n      return self;\n    },\n\n    /**\n     * Set the source to a 0-second silence to stop any downloading (except in IE).\n     * @param  {Object} node Audio node to clear.\n     */\n    _clearSound: function(node) {\n      var checkIE = /MSIE |Trident\\//.test(Howler._navigator && Howler._navigator.userAgent);\n      if (!checkIE) {\n        node.src = 'data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA';\n      }\n    }\n  };\n\n  /** Single Sound Methods **/\n  /***************************************************************************/\n\n  /**\n   * Setup the sound object, which each node attached to a Howl group is contained in.\n   * @param {Object} howl The Howl parent group.\n   */\n  var Sound = function(howl) {\n    this._parent = howl;\n    this.init();\n  };\n  Sound.prototype = {\n    /**\n     * Initialize a new Sound object.\n     * @return {Sound}\n     */\n    init: function() {\n      var self = this;\n      var parent = self._parent;\n\n      // Setup the default parameters.\n      self._muted = parent._muted;\n      self._loop = parent._loop;\n      self._volume = parent._volume;\n      self._rate = parent._rate;\n      self._seek = 0;\n      self._paused = true;\n      self._ended = true;\n      self._sprite = '__default';\n\n      // Generate a unique ID for this sound.\n      self._id = ++Howler._counter;\n\n      // Add itself to the parent's pool.\n      parent._sounds.push(self);\n\n      // Create the new node.\n      self.create();\n\n      return self;\n    },\n\n    /**\n     * Create and setup a new sound object, whether HTML5 Audio or Web Audio.\n     * @return {Sound}\n     */\n    create: function() {\n      var self = this;\n      var parent = self._parent;\n      var volume = (Howler._muted || self._muted || self._parent._muted) ? 0 : self._volume;\n\n      if (parent._webAudio) {\n        // Create the gain node for controlling volume (the source will connect to this).\n        self._node = (typeof Howler.ctx.createGain === 'undefined') ? Howler.ctx.createGainNode() : Howler.ctx.createGain();\n        self._node.gain.setValueAtTime(volume, Howler.ctx.currentTime);\n        self._node.paused = true;\n        self._node.connect(Howler.masterGain);\n      } else if (!Howler.noAudio) {\n        // Get an unlocked Audio object from the pool.\n        self._node = Howler._obtainHtml5Audio();\n\n        // Listen for errors (http://dev.w3.org/html5/spec-author-view/spec.html#mediaerror).\n        self._errorFn = self._errorListener.bind(self);\n        self._node.addEventListener('error', self._errorFn, false);\n\n        // Listen for 'canplaythrough' event to let us know the sound is ready.\n        self._loadFn = self._loadListener.bind(self);\n        self._node.addEventListener(Howler._canPlayEvent, self._loadFn, false);\n\n        // Listen for the 'ended' event on the sound to account for edge-case where\n        // a finite sound has a duration of Infinity.\n        self._endFn = self._endListener.bind(self);\n        self._node.addEventListener('ended', self._endFn, false);\n\n        // Setup the new audio node.\n        self._node.src = parent._src;\n        self._node.preload = parent._preload === true ? 'auto' : parent._preload;\n        self._node.volume = volume * Howler.volume();\n\n        // Begin loading the source.\n        self._node.load();\n      }\n\n      return self;\n    },\n\n    /**\n     * Reset the parameters of this sound to the original state (for recycle).\n     * @return {Sound}\n     */\n    reset: function() {\n      var self = this;\n      var parent = self._parent;\n\n      // Reset all of the parameters of this sound.\n      self._muted = parent._muted;\n      self._loop = parent._loop;\n      self._volume = parent._volume;\n      self._rate = parent._rate;\n      self._seek = 0;\n      self._rateSeek = 0;\n      self._paused = true;\n      self._ended = true;\n      self._sprite = '__default';\n\n      // Generate a new ID so that it isn't confused with the previous sound.\n      self._id = ++Howler._counter;\n\n      return self;\n    },\n\n    /**\n     * HTML5 Audio error listener callback.\n     */\n    _errorListener: function() {\n      var self = this;\n\n      // Fire an error event and pass back the code.\n      self._parent._emit('loaderror', self._id, self._node.error ? self._node.error.code : 0);\n\n      // Clear the event listener.\n      self._node.removeEventListener('error', self._errorFn, false);\n    },\n\n    /**\n     * HTML5 Audio canplaythrough listener callback.\n     */\n    _loadListener: function() {\n      var self = this;\n      var parent = self._parent;\n\n      // Round up the duration to account for the lower precision in HTML5 Audio.\n      parent._duration = Math.ceil(self._node.duration * 10) / 10;\n\n      // Setup a sprite if none is defined.\n      if (Object.keys(parent._sprite).length === 0) {\n        parent._sprite = {__default: [0, parent._duration * 1000]};\n      }\n\n      if (parent._state !== 'loaded') {\n        parent._state = 'loaded';\n        parent._emit('load');\n        parent._loadQueue();\n      }\n\n      // Clear the event listener.\n      self._node.removeEventListener(Howler._canPlayEvent, self._loadFn, false);\n    },\n\n    /**\n     * HTML5 Audio ended listener callback.\n     */\n    _endListener: function() {\n      var self = this;\n      var parent = self._parent;\n\n      // Only handle the `ended`` event if the duration is Infinity.\n      if (parent._duration === Infinity) {\n        // Update the parent duration to match the real audio duration.\n        // Round up the duration to account for the lower precision in HTML5 Audio.\n        parent._duration = Math.ceil(self._node.duration * 10) / 10;\n\n        // Update the sprite that corresponds to the real duration.\n        if (parent._sprite.__default[1] === Infinity) {\n          parent._sprite.__default[1] = parent._duration * 1000;\n        }\n\n        // Run the regular ended method.\n        parent._ended(self);\n      }\n\n      // Clear the event listener since the duration is now correct.\n      self._node.removeEventListener('ended', self._endFn, false);\n    }\n  };\n\n  /** Helper Methods **/\n  /***************************************************************************/\n\n  var cache = {};\n\n  /**\n   * Buffer a sound from URL, Data URI or cache and decode to audio source (Web Audio API).\n   * @param  {Howl} self\n   */\n  var loadBuffer = function(self) {\n    var url = self._src;\n\n    // Check if the buffer has already been cached and use it instead.\n    if (cache[url]) {\n      // Set the duration from the cache.\n      self._duration = cache[url].duration;\n\n      // Load the sound into this Howl.\n      loadSound(self);\n\n      return;\n    }\n\n    if (/^data:[^;]+;base64,/.test(url)) {\n      // Decode the base64 data URI without XHR, since some browsers don't support it.\n      var data = atob(url.split(',')[1]);\n      var dataView = new Uint8Array(data.length);\n      for (var i=0; i<data.length; ++i) {\n        dataView[i] = data.charCodeAt(i);\n      }\n\n      decodeAudioData(dataView.buffer, self);\n    } else {\n      // Load the buffer from the URL.\n      var xhr = new XMLHttpRequest();\n      xhr.open(self._xhr.method, url, true);\n      xhr.withCredentials = self._xhr.withCredentials;\n      xhr.responseType = 'arraybuffer';\n\n      // Apply any custom headers to the request.\n      if (self._xhr.headers) {\n        Object.keys(self._xhr.headers).forEach(function(key) {\n          xhr.setRequestHeader(key, self._xhr.headers[key]);\n        });\n      }\n\n      xhr.onload = function() {\n        // Make sure we get a successful response back.\n        var code = (xhr.status + '')[0];\n        if (code !== '0' && code !== '2' && code !== '3') {\n          self._emit('loaderror', null, 'Failed loading audio file with status: ' + xhr.status + '.');\n          return;\n        }\n\n        decodeAudioData(xhr.response, self);\n      };\n      xhr.onerror = function() {\n        // If there is an error, switch to HTML5 Audio.\n        if (self._webAudio) {\n          self._html5 = true;\n          self._webAudio = false;\n          self._sounds = [];\n          delete cache[url];\n          self.load();\n        }\n      };\n      safeXhrSend(xhr);\n    }\n  };\n\n  /**\n   * Send the XHR request wrapped in a try/catch.\n   * @param  {Object} xhr XHR to send.\n   */\n  var safeXhrSend = function(xhr) {\n    try {\n      xhr.send();\n    } catch (e) {\n      xhr.onerror();\n    }\n  };\n\n  /**\n   * Decode audio data from an array buffer.\n   * @param  {ArrayBuffer} arraybuffer The audio data.\n   * @param  {Howl}        self\n   */\n  var decodeAudioData = function(arraybuffer, self) {\n    // Fire a load error if something broke.\n    var error = function() {\n      self._emit('loaderror', null, 'Decoding audio data failed.');\n    };\n\n    // Load the sound on success.\n    var success = function(buffer) {\n      if (buffer && self._sounds.length > 0) {\n        cache[self._src] = buffer;\n        loadSound(self, buffer);\n      } else {\n        error();\n      }\n    };\n\n    // Decode the buffer into an audio source.\n    if (typeof Promise !== 'undefined' && Howler.ctx.decodeAudioData.length === 1) {\n      Howler.ctx.decodeAudioData(arraybuffer).then(success).catch(error);\n    } else {\n      Howler.ctx.decodeAudioData(arraybuffer, success, error);\n    }\n  }\n\n  /**\n   * Sound is now loaded, so finish setting everything up and fire the loaded event.\n   * @param  {Howl} self\n   * @param  {Object} buffer The decoded buffer sound source.\n   */\n  var loadSound = function(self, buffer) {\n    // Set the duration.\n    if (buffer && !self._duration) {\n      self._duration = buffer.duration;\n    }\n\n    // Setup a sprite if none is defined.\n    if (Object.keys(self._sprite).length === 0) {\n      self._sprite = {__default: [0, self._duration * 1000]};\n    }\n\n    // Fire the loaded event.\n    if (self._state !== 'loaded') {\n      self._state = 'loaded';\n      self._emit('load');\n      self._loadQueue();\n    }\n  };\n\n  /**\n   * Setup the audio context when available, or switch to HTML5 Audio mode.\n   */\n  var setupAudioContext = function() {\n    // If we have already detected that Web Audio isn't supported, don't run this step again.\n    if (!Howler.usingWebAudio) {\n      return;\n    }\n\n    // Check if we are using Web Audio and setup the AudioContext if we are.\n    try {\n      if (typeof AudioContext !== 'undefined') {\n        Howler.ctx = new AudioContext();\n      } else if (typeof webkitAudioContext !== 'undefined') {\n        Howler.ctx = new webkitAudioContext();\n      } else {\n        Howler.usingWebAudio = false;\n      }\n    } catch(e) {\n      Howler.usingWebAudio = false;\n    }\n\n    // If the audio context creation still failed, set using web audio to false.\n    if (!Howler.ctx) {\n      Howler.usingWebAudio = false;\n    }\n\n    // Check if a webview is being used on iOS8 or earlier (rather than the browser).\n    // If it is, disable Web Audio as it causes crashing.\n    var iOS = (/iP(hone|od|ad)/.test(Howler._navigator && Howler._navigator.platform));\n    var appVersion = Howler._navigator && Howler._navigator.appVersion.match(/OS (\\d+)_(\\d+)_?(\\d+)?/);\n    var version = appVersion ? parseInt(appVersion[1], 10) : null;\n    if (iOS && version && version < 9) {\n      var safari = /safari/.test(Howler._navigator && Howler._navigator.userAgent.toLowerCase());\n      if (Howler._navigator && !safari) {\n        Howler.usingWebAudio = false;\n      }\n    }\n\n    // Create and expose the master GainNode when using Web Audio (useful for plugins or advanced usage).\n    if (Howler.usingWebAudio) {\n      Howler.masterGain = (typeof Howler.ctx.createGain === 'undefined') ? Howler.ctx.createGainNode() : Howler.ctx.createGain();\n      Howler.masterGain.gain.setValueAtTime(Howler._muted ? 0 : Howler._volume, Howler.ctx.currentTime);\n      Howler.masterGain.connect(Howler.ctx.destination);\n    }\n\n    // Re-run the setup on Howler.\n    Howler._setup();\n  };\n\n  // Add support for AMD (Asynchronous Module Definition) libraries such as require.js.\n  if (typeof define === 'function' && define.amd) {\n    define([], function() {\n      return {\n        Howler: Howler,\n        Howl: Howl\n      };\n    });\n  }\n\n  // Add support for CommonJS libraries such as browserify.\n  if (typeof exports !== 'undefined') {\n    exports.Howler = Howler;\n    exports.Howl = Howl;\n  }\n\n  // Add to global in Node.js (for testing, etc).\n  if (typeof global !== 'undefined') {\n    global.HowlerGlobal = HowlerGlobal;\n    global.Howler = Howler;\n    global.Howl = Howl;\n    global.Sound = Sound;\n  } else if (typeof window !== 'undefined') {  // Define globally in case AMD is not available or unused.\n    window.HowlerGlobal = HowlerGlobal;\n    window.Howler = Howler;\n    window.Howl = Howl;\n    window.Sound = Sound;\n  }\n})();\n\n\n/*!\n *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.\n *  \n *  howler.js v2.2.4\n *  howlerjs.com\n *\n *  (c) 2013-2020, James Simpson of GoldFire Studios\n *  goldfirestudios.com\n *\n *  MIT License\n */\n\n(function() {\n\n  'use strict';\n\n  // Setup default properties.\n  HowlerGlobal.prototype._pos = [0, 0, 0];\n  HowlerGlobal.prototype._orientation = [0, 0, -1, 0, 1, 0];\n\n  /** Global Methods **/\n  /***************************************************************************/\n\n  /**\n   * Helper method to update the stereo panning position of all current Howls.\n   * Future Howls will not use this value unless explicitly set.\n   * @param  {Number} pan A value of -1.0 is all the way left and 1.0 is all the way right.\n   * @return {Howler/Number}     Self or current stereo panning value.\n   */\n  HowlerGlobal.prototype.stereo = function(pan) {\n    var self = this;\n\n    // Stop right here if not using Web Audio.\n    if (!self.ctx || !self.ctx.listener) {\n      return self;\n    }\n\n    // Loop through all Howls and update their stereo panning.\n    for (var i=self._howls.length-1; i>=0; i--) {\n      self._howls[i].stereo(pan);\n    }\n\n    return self;\n  };\n\n  /**\n   * Get/set the position of the listener in 3D cartesian space. Sounds using\n   * 3D position will be relative to the listener's position.\n   * @param  {Number} x The x-position of the listener.\n   * @param  {Number} y The y-position of the listener.\n   * @param  {Number} z The z-position of the listener.\n   * @return {Howler/Array}   Self or current listener position.\n   */\n  HowlerGlobal.prototype.pos = function(x, y, z) {\n    var self = this;\n\n    // Stop right here if not using Web Audio.\n    if (!self.ctx || !self.ctx.listener) {\n      return self;\n    }\n\n    // Set the defaults for optional 'y' & 'z'.\n    y = (typeof y !== 'number') ? self._pos[1] : y;\n    z = (typeof z !== 'number') ? self._pos[2] : z;\n\n    if (typeof x === 'number') {\n      self._pos = [x, y, z];\n\n      if (typeof self.ctx.listener.positionX !== 'undefined') {\n        self.ctx.listener.positionX.setTargetAtTime(self._pos[0], Howler.ctx.currentTime, 0.1);\n        self.ctx.listener.positionY.setTargetAtTime(self._pos[1], Howler.ctx.currentTime, 0.1);\n        self.ctx.listener.positionZ.setTargetAtTime(self._pos[2], Howler.ctx.currentTime, 0.1);\n      } else {\n        self.ctx.listener.setPosition(self._pos[0], self._pos[1], self._pos[2]);\n      }\n    } else {\n      return self._pos;\n    }\n\n    return self;\n  };\n\n  /**\n   * Get/set the direction the listener is pointing in the 3D cartesian space.\n   * A front and up vector must be provided. The front is the direction the\n   * face of the listener is pointing, and up is the direction the top of the\n   * listener is pointing. Thus, these values are expected to be at right angles\n   * from each other.\n   * @param  {Number} x   The x-orientation of the listener.\n   * @param  {Number} y   The y-orientation of the listener.\n   * @param  {Number} z   The z-orientation of the listener.\n   * @param  {Number} xUp The x-orientation of the top of the listener.\n   * @param  {Number} yUp The y-orientation of the top of the listener.\n   * @param  {Number} zUp The z-orientation of the top of the listener.\n   * @return {Howler/Array}     Returns self or the current orientation vectors.\n   */\n  HowlerGlobal.prototype.orientation = function(x, y, z, xUp, yUp, zUp) {\n    var self = this;\n\n    // Stop right here if not using Web Audio.\n    if (!self.ctx || !self.ctx.listener) {\n      return self;\n    }\n\n    // Set the defaults for optional 'y' & 'z'.\n    var or = self._orientation;\n    y = (typeof y !== 'number') ? or[1] : y;\n    z = (typeof z !== 'number') ? or[2] : z;\n    xUp = (typeof xUp !== 'number') ? or[3] : xUp;\n    yUp = (typeof yUp !== 'number') ? or[4] : yUp;\n    zUp = (typeof zUp !== 'number') ? or[5] : zUp;\n\n    if (typeof x === 'number') {\n      self._orientation = [x, y, z, xUp, yUp, zUp];\n\n      if (typeof self.ctx.listener.forwardX !== 'undefined') {\n        self.ctx.listener.forwardX.setTargetAtTime(x, Howler.ctx.currentTime, 0.1);\n        self.ctx.listener.forwardY.setTargetAtTime(y, Howler.ctx.currentTime, 0.1);\n        self.ctx.listener.forwardZ.setTargetAtTime(z, Howler.ctx.currentTime, 0.1);\n        self.ctx.listener.upX.setTargetAtTime(xUp, Howler.ctx.currentTime, 0.1);\n        self.ctx.listener.upY.setTargetAtTime(yUp, Howler.ctx.currentTime, 0.1);\n        self.ctx.listener.upZ.setTargetAtTime(zUp, Howler.ctx.currentTime, 0.1);\n      } else {\n        self.ctx.listener.setOrientation(x, y, z, xUp, yUp, zUp);\n      }\n    } else {\n      return or;\n    }\n\n    return self;\n  };\n\n  /** Group Methods **/\n  /***************************************************************************/\n\n  /**\n   * Add new properties to the core init.\n   * @param  {Function} _super Core init method.\n   * @return {Howl}\n   */\n  Howl.prototype.init = (function(_super) {\n    return function(o) {\n      var self = this;\n\n      // Setup user-defined default properties.\n      self._orientation = o.orientation || [1, 0, 0];\n      self._stereo = o.stereo || null;\n      self._pos = o.pos || null;\n      self._pannerAttr = {\n        coneInnerAngle: typeof o.coneInnerAngle !== 'undefined' ? o.coneInnerAngle : 360,\n        coneOuterAngle: typeof o.coneOuterAngle !== 'undefined' ? o.coneOuterAngle : 360,\n        coneOuterGain: typeof o.coneOuterGain !== 'undefined' ? o.coneOuterGain : 0,\n        distanceModel: typeof o.distanceModel !== 'undefined' ? o.distanceModel : 'inverse',\n        maxDistance: typeof o.maxDistance !== 'undefined' ? o.maxDistance : 10000,\n        panningModel: typeof o.panningModel !== 'undefined' ? o.panningModel : 'HRTF',\n        refDistance: typeof o.refDistance !== 'undefined' ? o.refDistance : 1,\n        rolloffFactor: typeof o.rolloffFactor !== 'undefined' ? o.rolloffFactor : 1\n      };\n\n      // Setup event listeners.\n      self._onstereo = o.onstereo ? [{fn: o.onstereo}] : [];\n      self._onpos = o.onpos ? [{fn: o.onpos}] : [];\n      self._onorientation = o.onorientation ? [{fn: o.onorientation}] : [];\n\n      // Complete initilization with howler.js core's init function.\n      return _super.call(this, o);\n    };\n  })(Howl.prototype.init);\n\n  /**\n   * Get/set the stereo panning of the audio source for this sound or all in the group.\n   * @param  {Number} pan  A value of -1.0 is all the way left and 1.0 is all the way right.\n   * @param  {Number} id (optional) The sound ID. If none is passed, all in group will be updated.\n   * @return {Howl/Number}    Returns self or the current stereo panning value.\n   */\n  Howl.prototype.stereo = function(pan, id) {\n    var self = this;\n\n    // Stop right here if not using Web Audio.\n    if (!self._webAudio) {\n      return self;\n    }\n\n    // If the sound hasn't loaded, add it to the load queue to change stereo pan when capable.\n    if (self._state !== 'loaded') {\n      self._queue.push({\n        event: 'stereo',\n        action: function() {\n          self.stereo(pan, id);\n        }\n      });\n\n      return self;\n    }\n\n    // Check for PannerStereoNode support and fallback to PannerNode if it doesn't exist.\n    var pannerType = (typeof Howler.ctx.createStereoPanner === 'undefined') ? 'spatial' : 'stereo';\n\n    // Setup the group's stereo panning if no ID is passed.\n    if (typeof id === 'undefined') {\n      // Return the group's stereo panning if no parameters are passed.\n      if (typeof pan === 'number') {\n        self._stereo = pan;\n        self._pos = [pan, 0, 0];\n      } else {\n        return self._stereo;\n      }\n    }\n\n    // Change the streo panning of one or all sounds in group.\n    var ids = self._getSoundIds(id);\n    for (var i=0; i<ids.length; i++) {\n      // Get the sound.\n      var sound = self._soundById(ids[i]);\n\n      if (sound) {\n        if (typeof pan === 'number') {\n          sound._stereo = pan;\n          sound._pos = [pan, 0, 0];\n\n          if (sound._node) {\n            // If we are falling back, make sure the panningModel is equalpower.\n            sound._pannerAttr.panningModel = 'equalpower';\n\n            // Check if there is a panner setup and create a new one if not.\n            if (!sound._panner || !sound._panner.pan) {\n              setupPanner(sound, pannerType);\n            }\n\n            if (pannerType === 'spatial') {\n              if (typeof sound._panner.positionX !== 'undefined') {\n                sound._panner.positionX.setValueAtTime(pan, Howler.ctx.currentTime);\n                sound._panner.positionY.setValueAtTime(0, Howler.ctx.currentTime);\n                sound._panner.positionZ.setValueAtTime(0, Howler.ctx.currentTime);\n              } else {\n                sound._panner.setPosition(pan, 0, 0);\n              }\n            } else {\n              sound._panner.pan.setValueAtTime(pan, Howler.ctx.currentTime);\n            }\n          }\n\n          self._emit('stereo', sound._id);\n        } else {\n          return sound._stereo;\n        }\n      }\n    }\n\n    return self;\n  };\n\n  /**\n   * Get/set the 3D spatial position of the audio source for this sound or group relative to the global listener.\n   * @param  {Number} x  The x-position of the audio source.\n   * @param  {Number} y  The y-position of the audio source.\n   * @param  {Number} z  The z-position of the audio source.\n   * @param  {Number} id (optional) The sound ID. If none is passed, all in group will be updated.\n   * @return {Howl/Array}    Returns self or the current 3D spatial position: [x, y, z].\n   */\n  Howl.prototype.pos = function(x, y, z, id) {\n    var self = this;\n\n    // Stop right here if not using Web Audio.\n    if (!self._webAudio) {\n      return self;\n    }\n\n    // If the sound hasn't loaded, add it to the load queue to change position when capable.\n    if (self._state !== 'loaded') {\n      self._queue.push({\n        event: 'pos',\n        action: function() {\n          self.pos(x, y, z, id);\n        }\n      });\n\n      return self;\n    }\n\n    // Set the defaults for optional 'y' & 'z'.\n    y = (typeof y !== 'number') ? 0 : y;\n    z = (typeof z !== 'number') ? -0.5 : z;\n\n    // Setup the group's spatial position if no ID is passed.\n    if (typeof id === 'undefined') {\n      // Return the group's spatial position if no parameters are passed.\n      if (typeof x === 'number') {\n        self._pos = [x, y, z];\n      } else {\n        return self._pos;\n      }\n    }\n\n    // Change the spatial position of one or all sounds in group.\n    var ids = self._getSoundIds(id);\n    for (var i=0; i<ids.length; i++) {\n      // Get the sound.\n      var sound = self._soundById(ids[i]);\n\n      if (sound) {\n        if (typeof x === 'number') {\n          sound._pos = [x, y, z];\n\n          if (sound._node) {\n            // Check if there is a panner setup and create a new one if not.\n            if (!sound._panner || sound._panner.pan) {\n              setupPanner(sound, 'spatial');\n            }\n\n            if (typeof sound._panner.positionX !== 'undefined') {\n              sound._panner.positionX.setValueAtTime(x, Howler.ctx.currentTime);\n              sound._panner.positionY.setValueAtTime(y, Howler.ctx.currentTime);\n              sound._panner.positionZ.setValueAtTime(z, Howler.ctx.currentTime);\n            } else {\n              sound._panner.setPosition(x, y, z);\n            }\n          }\n\n          self._emit('pos', sound._id);\n        } else {\n          return sound._pos;\n        }\n      }\n    }\n\n    return self;\n  };\n\n  /**\n   * Get/set the direction the audio source is pointing in the 3D cartesian coordinate\n   * space. Depending on how direction the sound is, based on the `cone` attributes,\n   * a sound pointing away from the listener can be quiet or silent.\n   * @param  {Number} x  The x-orientation of the source.\n   * @param  {Number} y  The y-orientation of the source.\n   * @param  {Number} z  The z-orientation of the source.\n   * @param  {Number} id (optional) The sound ID. If none is passed, all in group will be updated.\n   * @return {Howl/Array}    Returns self or the current 3D spatial orientation: [x, y, z].\n   */\n  Howl.prototype.orientation = function(x, y, z, id) {\n    var self = this;\n\n    // Stop right here if not using Web Audio.\n    if (!self._webAudio) {\n      return self;\n    }\n\n    // If the sound hasn't loaded, add it to the load queue to change orientation when capable.\n    if (self._state !== 'loaded') {\n      self._queue.push({\n        event: 'orientation',\n        action: function() {\n          self.orientation(x, y, z, id);\n        }\n      });\n\n      return self;\n    }\n\n    // Set the defaults for optional 'y' & 'z'.\n    y = (typeof y !== 'number') ? self._orientation[1] : y;\n    z = (typeof z !== 'number') ? self._orientation[2] : z;\n\n    // Setup the group's spatial orientation if no ID is passed.\n    if (typeof id === 'undefined') {\n      // Return the group's spatial orientation if no parameters are passed.\n      if (typeof x === 'number') {\n        self._orientation = [x, y, z];\n      } else {\n        return self._orientation;\n      }\n    }\n\n    // Change the spatial orientation of one or all sounds in group.\n    var ids = self._getSoundIds(id);\n    for (var i=0; i<ids.length; i++) {\n      // Get the sound.\n      var sound = self._soundById(ids[i]);\n\n      if (sound) {\n        if (typeof x === 'number') {\n          sound._orientation = [x, y, z];\n\n          if (sound._node) {\n            // Check if there is a panner setup and create a new one if not.\n            if (!sound._panner) {\n              // Make sure we have a position to setup the node with.\n              if (!sound._pos) {\n                sound._pos = self._pos || [0, 0, -0.5];\n              }\n\n              setupPanner(sound, 'spatial');\n            }\n\n            if (typeof sound._panner.orientationX !== 'undefined') {\n              sound._panner.orientationX.setValueAtTime(x, Howler.ctx.currentTime);\n              sound._panner.orientationY.setValueAtTime(y, Howler.ctx.currentTime);\n              sound._panner.orientationZ.setValueAtTime(z, Howler.ctx.currentTime);\n            } else {\n              sound._panner.setOrientation(x, y, z);\n            }\n          }\n\n          self._emit('orientation', sound._id);\n        } else {\n          return sound._orientation;\n        }\n      }\n    }\n\n    return self;\n  };\n\n  /**\n   * Get/set the panner node's attributes for a sound or group of sounds.\n   * This method can optionall take 0, 1 or 2 arguments.\n   *   pannerAttr() -> Returns the group's values.\n   *   pannerAttr(id) -> Returns the sound id's values.\n   *   pannerAttr(o) -> Set's the values of all sounds in this Howl group.\n   *   pannerAttr(o, id) -> Set's the values of passed sound id.\n   *\n   *   Attributes:\n   *     coneInnerAngle - (360 by default) A parameter for directional audio sources, this is an angle, in degrees,\n   *                      inside of which there will be no volume reduction.\n   *     coneOuterAngle - (360 by default) A parameter for directional audio sources, this is an angle, in degrees,\n   *                      outside of which the volume will be reduced to a constant value of `coneOuterGain`.\n   *     coneOuterGain - (0 by default) A parameter for directional audio sources, this is the gain outside of the\n   *                     `coneOuterAngle`. It is a linear value in the range `[0, 1]`.\n   *     distanceModel - ('inverse' by default) Determines algorithm used to reduce volume as audio moves away from\n   *                     listener. Can be `linear`, `inverse` or `exponential.\n   *     maxDistance - (10000 by default) The maximum distance between source and listener, after which the volume\n   *                   will not be reduced any further.\n   *     refDistance - (1 by default) A reference distance for reducing volume as source moves further from the listener.\n   *                   This is simply a variable of the distance model and has a different effect depending on which model\n   *                   is used and the scale of your coordinates. Generally, volume will be equal to 1 at this distance.\n   *     rolloffFactor - (1 by default) How quickly the volume reduces as source moves from listener. This is simply a\n   *                     variable of the distance model and can be in the range of `[0, 1]` with `linear` and `[0, ]`\n   *                     with `inverse` and `exponential`.\n   *     panningModel - ('HRTF' by default) Determines which spatialization algorithm is used to position audio.\n   *                     Can be `HRTF` or `equalpower`.\n   *\n   * @return {Howl/Object} Returns self or current panner attributes.\n   */\n  Howl.prototype.pannerAttr = function() {\n    var self = this;\n    var args = arguments;\n    var o, id, sound;\n\n    // Stop right here if not using Web Audio.\n    if (!self._webAudio) {\n      return self;\n    }\n\n    // Determine the values based on arguments.\n    if (args.length === 0) {\n      // Return the group's panner attribute values.\n      return self._pannerAttr;\n    } else if (args.length === 1) {\n      if (typeof args[0] === 'object') {\n        o = args[0];\n\n        // Set the grou's panner attribute values.\n        if (typeof id === 'undefined') {\n          if (!o.pannerAttr) {\n            o.pannerAttr = {\n              coneInnerAngle: o.coneInnerAngle,\n              coneOuterAngle: o.coneOuterAngle,\n              coneOuterGain: o.coneOuterGain,\n              distanceModel: o.distanceModel,\n              maxDistance: o.maxDistance,\n              refDistance: o.refDistance,\n              rolloffFactor: o.rolloffFactor,\n              panningModel: o.panningModel\n            };\n          }\n\n          self._pannerAttr = {\n            coneInnerAngle: typeof o.pannerAttr.coneInnerAngle !== 'undefined' ? o.pannerAttr.coneInnerAngle : self._coneInnerAngle,\n            coneOuterAngle: typeof o.pannerAttr.coneOuterAngle !== 'undefined' ? o.pannerAttr.coneOuterAngle : self._coneOuterAngle,\n            coneOuterGain: typeof o.pannerAttr.coneOuterGain !== 'undefined' ? o.pannerAttr.coneOuterGain : self._coneOuterGain,\n            distanceModel: typeof o.pannerAttr.distanceModel !== 'undefined' ? o.pannerAttr.distanceModel : self._distanceModel,\n            maxDistance: typeof o.pannerAttr.maxDistance !== 'undefined' ? o.pannerAttr.maxDistance : self._maxDistance,\n            refDistance: typeof o.pannerAttr.refDistance !== 'undefined' ? o.pannerAttr.refDistance : self._refDistance,\n            rolloffFactor: typeof o.pannerAttr.rolloffFactor !== 'undefined' ? o.pannerAttr.rolloffFactor : self._rolloffFactor,\n            panningModel: typeof o.pannerAttr.panningModel !== 'undefined' ? o.pannerAttr.panningModel : self._panningModel\n          };\n        }\n      } else {\n        // Return this sound's panner attribute values.\n        sound = self._soundById(parseInt(args[0], 10));\n        return sound ? sound._pannerAttr : self._pannerAttr;\n      }\n    } else if (args.length === 2) {\n      o = args[0];\n      id = parseInt(args[1], 10);\n    }\n\n    // Update the values of the specified sounds.\n    var ids = self._getSoundIds(id);\n    for (var i=0; i<ids.length; i++) {\n      sound = self._soundById(ids[i]);\n\n      if (sound) {\n        // Merge the new values into the sound.\n        var pa = sound._pannerAttr;\n        pa = {\n          coneInnerAngle: typeof o.coneInnerAngle !== 'undefined' ? o.coneInnerAngle : pa.coneInnerAngle,\n          coneOuterAngle: typeof o.coneOuterAngle !== 'undefined' ? o.coneOuterAngle : pa.coneOuterAngle,\n          coneOuterGain: typeof o.coneOuterGain !== 'undefined' ? o.coneOuterGain : pa.coneOuterGain,\n          distanceModel: typeof o.distanceModel !== 'undefined' ? o.distanceModel : pa.distanceModel,\n          maxDistance: typeof o.maxDistance !== 'undefined' ? o.maxDistance : pa.maxDistance,\n          refDistance: typeof o.refDistance !== 'undefined' ? o.refDistance : pa.refDistance,\n          rolloffFactor: typeof o.rolloffFactor !== 'undefined' ? o.rolloffFactor : pa.rolloffFactor,\n          panningModel: typeof o.panningModel !== 'undefined' ? o.panningModel : pa.panningModel\n        };\n\n        // Create a new panner node if one doesn't already exist.\n        var panner = sound._panner;\n        if (!panner) {\n          // Make sure we have a position to setup the node with.\n          if (!sound._pos) {\n            sound._pos = self._pos || [0, 0, -0.5];\n          }\n\n          // Create a new panner node.\n          setupPanner(sound, 'spatial');\n          panner = sound._panner\n        }\n\n        // Update the panner values or create a new panner if none exists.\n        panner.coneInnerAngle = pa.coneInnerAngle;\n        panner.coneOuterAngle = pa.coneOuterAngle;\n        panner.coneOuterGain = pa.coneOuterGain;\n        panner.distanceModel = pa.distanceModel;\n        panner.maxDistance = pa.maxDistance;\n        panner.refDistance = pa.refDistance;\n        panner.rolloffFactor = pa.rolloffFactor;\n        panner.panningModel = pa.panningModel;\n      }\n    }\n\n    return self;\n  };\n\n  /** Single Sound Methods **/\n  /***************************************************************************/\n\n  /**\n   * Add new properties to the core Sound init.\n   * @param  {Function} _super Core Sound init method.\n   * @return {Sound}\n   */\n  Sound.prototype.init = (function(_super) {\n    return function() {\n      var self = this;\n      var parent = self._parent;\n\n      // Setup user-defined default properties.\n      self._orientation = parent._orientation;\n      self._stereo = parent._stereo;\n      self._pos = parent._pos;\n      self._pannerAttr = parent._pannerAttr;\n\n      // Complete initilization with howler.js core Sound's init function.\n      _super.call(this);\n\n      // If a stereo or position was specified, set it up.\n      if (self._stereo) {\n        parent.stereo(self._stereo);\n      } else if (self._pos) {\n        parent.pos(self._pos[0], self._pos[1], self._pos[2], self._id);\n      }\n    };\n  })(Sound.prototype.init);\n\n  /**\n   * Override the Sound.reset method to clean up properties from the spatial plugin.\n   * @param  {Function} _super Sound reset method.\n   * @return {Sound}\n   */\n  Sound.prototype.reset = (function(_super) {\n    return function() {\n      var self = this;\n      var parent = self._parent;\n\n      // Reset all spatial plugin properties on this sound.\n      self._orientation = parent._orientation;\n      self._stereo = parent._stereo;\n      self._pos = parent._pos;\n      self._pannerAttr = parent._pannerAttr;\n\n      // If a stereo or position was specified, set it up.\n      if (self._stereo) {\n        parent.stereo(self._stereo);\n      } else if (self._pos) {\n        parent.pos(self._pos[0], self._pos[1], self._pos[2], self._id);\n      } else if (self._panner) {\n        // Disconnect the panner.\n        self._panner.disconnect(0);\n        self._panner = undefined;\n        parent._refreshBuffer(self);\n      }\n\n      // Complete resetting of the sound.\n      return _super.call(this);\n    };\n  })(Sound.prototype.reset);\n\n  /** Helper Methods **/\n  /***************************************************************************/\n\n  /**\n   * Create a new panner node and save it on the sound.\n   * @param  {Sound} sound Specific sound to setup panning on.\n   * @param {String} type Type of panner to create: 'stereo' or 'spatial'.\n   */\n  var setupPanner = function(sound, type) {\n    type = type || 'spatial';\n\n    // Create the new panner node.\n    if (type === 'spatial') {\n      sound._panner = Howler.ctx.createPanner();\n      sound._panner.coneInnerAngle = sound._pannerAttr.coneInnerAngle;\n      sound._panner.coneOuterAngle = sound._pannerAttr.coneOuterAngle;\n      sound._panner.coneOuterGain = sound._pannerAttr.coneOuterGain;\n      sound._panner.distanceModel = sound._pannerAttr.distanceModel;\n      sound._panner.maxDistance = sound._pannerAttr.maxDistance;\n      sound._panner.refDistance = sound._pannerAttr.refDistance;\n      sound._panner.rolloffFactor = sound._pannerAttr.rolloffFactor;\n      sound._panner.panningModel = sound._pannerAttr.panningModel;\n\n      if (typeof sound._panner.positionX !== 'undefined') {\n        sound._panner.positionX.setValueAtTime(sound._pos[0], Howler.ctx.currentTime);\n        sound._panner.positionY.setValueAtTime(sound._pos[1], Howler.ctx.currentTime);\n        sound._panner.positionZ.setValueAtTime(sound._pos[2], Howler.ctx.currentTime);\n      } else {\n        sound._panner.setPosition(sound._pos[0], sound._pos[1], sound._pos[2]);\n      }\n\n      if (typeof sound._panner.orientationX !== 'undefined') {\n        sound._panner.orientationX.setValueAtTime(sound._orientation[0], Howler.ctx.currentTime);\n        sound._panner.orientationY.setValueAtTime(sound._orientation[1], Howler.ctx.currentTime);\n        sound._panner.orientationZ.setValueAtTime(sound._orientation[2], Howler.ctx.currentTime);\n      } else {\n        sound._panner.setOrientation(sound._orientation[0], sound._orientation[1], sound._orientation[2]);\n      }\n    } else {\n      sound._panner = Howler.ctx.createStereoPanner();\n      sound._panner.pan.setValueAtTime(sound._stereo, Howler.ctx.currentTime);\n    }\n\n    sound._panner.connect(sound._node);\n\n    // Update the connections.\n    if (!sound._paused) {\n      sound._parent.pause(sound._id, true).play(sound._id, true);\n    }\n  };\n})();\n","import { Howl } from 'howler';\n\n/**\n * Sound Service for managing game audio\n * Uses Howler.js for cross-browser audio playback\n */\nclass SoundService {\n  constructor() {\n    this.sounds = {};\n    this.muted = false; // Default state, will be updated from preferences\n    this.initialized = false;\n    this.categories = ['ui']; // Only load UI sounds for now\n    this.lastPlayedTime = {}; // Track when each sound was last played for debouncing\n    this.debounceTime = 500; // Debounce time in milliseconds (half a second)\n    this.audioUnlocked = false; // Track if audio has been unlocked for mobile\n    \n    // Get API URL from environment or use localhost as fallback\n    this.API_URL = import.meta.env.VITE_API_URL || 'http://localhost:3001';\n    \n    // Only initialize in browser environment\n    if (typeof window !== 'undefined') {\n      // Initialize on next tick to avoid SSR issues\n      setTimeout(() => {\n        this.initialize();\n        this._setupMobileAudioUnlock();\n      }, 0);\n    }\n  }\n\n  /**\n   * Initialize the sound service and load all sound categories\n   */\n  initialize() {\n    if (this.initialized) return;\n    \n    // Load only the UI category for now\n    this.loadCategory('ui');\n    \n    // Mark as initialized since we're loading asynchronously\n    this.initialized = true;\n  }\n  \n  /**\n   * Load sounds for a specific category\n   * @param {string} category - Sound category to load\n   */\n  loadCategory(category) {\n    // Skip if already loaded\n    if (this.sounds[category]) return;\n    \n    // Define sprites for each category\n    const sprites = {};\n    \n    // UI category sprites\n    if (category === 'ui') {\n      // Match the exact timing from ui-sounds.json\n      sprites.join = [0, 500]; \n      sprites.leave = [500, 1000];\n      sprites.alert = [1500, 1500]; \n    }\n    \n    // Create the Howl instance with the sprites\n    this.sounds[category] = new Howl({\n      src: [\n        `${this.API_URL}/assets/audio/${category}-sounds.mp3`,\n        `${this.API_URL}/assets/audio/${category}-sounds.webm`\n      ],\n      sprite: sprites,\n      preload: true,\n      // Use HTML5 Audio on mobile for better compatibility\n      html5: this._isMobileDevice(),\n      format: ['mp3', 'webm'],\n      pool: 10 // Increase the pool size to avoid exhaustion\n    });\n  }\n\n  /**\n   * Play a sound effect\n   * @param {string} sound - Sound name (format: category.name or just name for UI category)\n   * @param {number} [volume=1] - Volume level (0-1)\n   * @returns {number|undefined} Sound ID if played, undefined if not\n   */\n  play(sound, volume = 1) {\n    // Skip if muted\n    if (this.muted) return;\n    \n    // Initialize if not already done\n    if (!this.initialized) this.initialize();\n    \n    let category, soundName;\n    if (sound.includes('.')) {\n      [category, soundName] = sound.split('.');\n    } else {\n      category = 'ui';\n      soundName = sound;\n    }\n    \n    if (!this.sounds[category]) {\n      // Try to load the category if it's not loaded yet\n      this.loadCategory(category);\n      return;\n    }\n    \n    // Create a unique key for this sound\n    const soundKey = `${category}.${soundName}`;\n    \n    // Check if this sound was played recently (debounce)\n    const now = Date.now();\n    const lastPlayed = this.lastPlayedTime[soundKey] || 0;\n    if (now - lastPlayed < this.debounceTime) {\n      return;\n    }\n    \n    // Update the last played time\n    this.lastPlayedTime[soundKey] = now;\n    \n    // Set volume and play the sound\n    this.sounds[category].volume(volume);\n    return this.sounds[category].play(soundName);\n  }\n\n  /**\n   * Set muted state\n   * @param {boolean} muted - Whether sound should be muted\n   */\n  setMuted(muted) {\n    this.muted = muted;\n    \n    // Update all sound instances\n    Object.values(this.sounds).forEach(sound => {\n      if (sound && sound.mute) {\n        sound.mute(muted);\n      }\n    });\n  }\n  \n  /**\n   * Sync with user preferences\n   * @param {Object} preferences - User preferences object\n   */\n  syncWithPreferences(preferences) {\n    if (preferences && typeof preferences.muted !== 'undefined') {\n      this.setMuted(preferences.muted);\n    }\n  }\n  \n  /**\n   * Setup audio unlock for mobile devices\n   * @private\n   */\n  _setupMobileAudioUnlock() {\n    if (typeof window === 'undefined' || !this._isMobileDevice()) return;\n    \n    const unlockAudio = () => {\n      if (this.audioUnlocked) return;\n      \n      // Play a silent sound to unlock audio on mobile\n      const silence = new Audio();\n      silence.src = 'data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4LjI5LjEwMAAAAAAAAAAAAAAA//tQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAACAAABIgD///////////////////////////////////////////8AAAA8TEFNRTMuMTAwAQAAAAAAAAAAABSAJAJAQgAAgAAAAiIkfC3/////////////////////';  \n      silence.load();\n      silence.play().then(() => {\n        this.audioUnlocked = true;\n        document.body.removeEventListener('touchstart', unlockAudio);\n        document.body.removeEventListener('touchend', unlockAudio);\n        document.body.removeEventListener('click', unlockAudio);\n      }).catch(e => {\n        // Silent failure - we'll try again on next user interaction\n      });\n    };\n    \n    // Add event listeners to unlock audio on user interaction\n    document.body.addEventListener('touchstart', unlockAudio, false);\n    document.body.addEventListener('touchend', unlockAudio, false);\n    document.body.addEventListener('click', unlockAudio, false);\n  }\n  \n  /**\n   * Check if current device is mobile\n   * @private\n   * @returns {boolean} True if mobile device\n   */\n  _isMobileDevice() {\n    if (typeof navigator === 'undefined') return false;\n    \n    return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) ||\n      (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1); // iPad detection\n  }\n\n}\n\n// Create a singleton instance\nconst soundService = new SoundService();\n\nexport default soundService;\n","import React from 'react';\nimport { createPortal } from 'react-dom';\nimport styles from './BaseModal.module.css';\n\n// BaseModal: Shared modal structure for all app modals\nexport default function BaseModal({ title, onClose, children, footer, className = '', overlayStyle, ...props }) {\n  const modalContent = (\n    <div className={styles.overlay} style={overlayStyle} onClick={onClose}>\n      <div\n        className={`${styles.modal} ${className}`}\n        onClick={e => e.stopPropagation()}\n        {...props}\n      >\n        {title && (\n          <div className={styles.header}>\n            <h2>{title}</h2>\n            <button\n              className={styles.closeButton}\n              onClick={onClose}\n              aria-label=\"Close\"\n              type=\"button\"\n              data-gamepad-focusable=\"true\"\n            >\n              \n            </button>\n          </div>\n        )}\n        <div className={styles.content}>{children}</div>\n        {footer && <div className={styles.footer}>{footer}</div>}\n      </div>\n    </div>\n  );\n\n  // Render modal using portal to document.body to avoid transform context issues\n  return createPortal(modalContent, document.body);\n}\n","import React, { useState, useEffect, useCallback } from 'react';\nimport BaseModal from './common/BaseModal';\nimport { useVirtualKeyboardContext } from '../contexts/VirtualKeyboardContext';\nimport styles from './VirtualKeyboard.module.css';\n\nconst VirtualKeyboard = ({ \n  isVisible, \n  onClose, \n  onEnter,\n  inputType = 'text',\n  initialValue = ''\n}) => {\n  const { keyboardTitle } = useVirtualKeyboardContext();\n  const [currentLayout, setCurrentLayout] = useState('lowercase');\n  const [tempInput, setTempInput] = useState('');\n\n  // Initialize temp input with current value when keyboard opens\n  useEffect(() => {\n    if (isVisible) {\n      // For number inputs, don't use initial value if it's \"0\"\n      if (inputType === 'number') {\n        setTempInput(initialValue && initialValue !== '0' ? initialValue : '');\n      } else {\n        setTempInput(initialValue || '');\n      }\n    } else {\n      setTempInput('');\n    }\n  }, [isVisible, initialValue, inputType]);\n  \n  // Define keyboard layouts\n  const layouts = {\n    lowercase: [\n      ['1', '2', '3', '4', '5', '6', '7', '8', '9', '0'],\n      ['q', 'w', 'e', 'r', 't', 'y', 'u', 'i', 'o', 'p'],\n      ['a', 's', 'd', 'f', 'g', 'h', 'j', 'k', 'l'],\n      ['shift', 'z', 'x', 'c', 'v', 'b', 'n', 'm', 'backspace'],\n      ['space', 'enter']\n    ],\n    uppercase: [\n      ['1', '2', '3', '4', '5', '6', '7', '8', '9', '0'],\n      ['Q', 'W', 'E', 'R', 'T', 'Y', 'U', 'I', 'O', 'P'],\n      ['A', 'S', 'D', 'F', 'G', 'H', 'J', 'K', 'L'],\n      ['shift', 'Z', 'X', 'C', 'V', 'B', 'N', 'M', 'backspace'],\n      ['space', 'enter']\n    ],\n    numbers: [\n      ['1', '2', '3'],\n      ['4', '5', '6'],\n      ['7', '8', '9'],\n      ['0', 'backspace'],\n      ['enter']\n    ]\n  };\n\n  // Use number layout for number inputs\n  const activeLayout = inputType === 'number' ? 'numbers' : currentLayout;\n  const keys = layouts[activeLayout];\n\n  const handleKeyPress = useCallback((key) => {\n    switch (key) {\n      case 'shift':\n        setCurrentLayout(prev => prev === 'lowercase' ? 'uppercase' : 'lowercase');\n        break;\n      case 'backspace':\n        setTempInput(prev => prev.slice(0, -1));\n        break;\n      case 'enter':\n        onEnter?.(tempInput);\n        break;\n      case 'space':\n        setTempInput(prev => prev + ' ');\n        break;\n      default:\n        setTempInput(prev => prev + key);\n        break;\n    }\n  }, [onEnter, tempInput]);\n\n  const getKeyDisplayText = (key) => {\n    switch (key) {\n      case 'shift':\n        return currentLayout === 'lowercase' ? '' : '';\n      case 'backspace':\n        return '';\n      case 'space':\n        return 'Space';\n      case 'enter':\n        return '';\n      default:\n        return key;\n    }\n  };\n\n  const getKeyClass = (key) => {\n    let className = styles.key;\n    \n    if (['shift', 'backspace', 'space', 'enter'].includes(key)) {\n      className += ` ${styles.specialKey}`;\n    }\n    \n    if (key === 'space') {\n      className += ` ${styles.spaceKey}`;\n    }\n    \n    if (key === 'shift' && currentLayout === 'uppercase') {\n      className += ` ${styles.activeShift}`;\n    }\n    \n    return className;\n  };\n\n  // Handle ESC key to close keyboard (BaseModal handles body scroll)\n  useEffect(() => {\n    if (isVisible) {\n      const handleKeyDown = (e) => {\n        if (e.key === 'Escape') {\n          e.preventDefault();\n          onClose?.();\n        }\n      };\n      \n      document.addEventListener('keydown', handleKeyDown);\n      return () => {\n        document.removeEventListener('keydown', handleKeyDown);\n      };\n    }\n  }, [isVisible, onClose]);\n\n  if (!isVisible) return null;\n\n  return (\n    <BaseModal\n      title={keyboardTitle || (inputType === 'number' ? 'Number Pad' : 'Virtual Keyboard')}\n      onClose={onClose}\n      className={styles.keyboardModal}\n      overlayStyle={{ zIndex: 1300 }}\n    >\n      <div className={styles.inputDisplay}>\n        <input\n          type={inputType === 'password' ? 'password' : 'text'}\n          value={tempInput}\n          className={styles.tempInput}\n          readOnly\n          placeholder=\"Type below...\"\n        />\n      </div>\n      <div className={styles.keyboardGrid}>\n        {keys.map((row, rowIndex) => (\n          <div key={rowIndex} className={styles.keyRow}>\n            {row.map((key, keyIndex) => (\n              <button\n                key={`${rowIndex}-${keyIndex}`}\n                className={getKeyClass(key)}\n                onClick={() => handleKeyPress(key)}\n                data-gamepad-focusable=\"true\"\n                aria-label={key === 'backspace' ? 'Backspace' : \n                           key === 'enter' ? 'Enter' : \n                           key === 'space' ? 'Space' : \n                           key === 'shift' ? 'Shift' : key}\n              >\n                {getKeyDisplayText(key)}\n              </button>\n            ))}\n          </div>\n        ))}\n      </div>\n    </BaseModal>\n  );\n};\n\nexport default VirtualKeyboard;","import React, { createContext, useContext } from 'react';\nimport { useVirtualKeyboard } from '../hooks/useVirtualKeyboard';\nimport VirtualKeyboard from '../components/VirtualKeyboard';\n\nconst VirtualKeyboardContext = createContext();\n\nexport const useVirtualKeyboardContext = () => {\n  const context = useContext(VirtualKeyboardContext);\n  if (!context) {\n    throw new Error('useVirtualKeyboardContext must be used within a VirtualKeyboardProvider');\n  }\n  return context;\n};\n\nexport const VirtualKeyboardProvider = ({ children }) => {\n  const keyboardState = useVirtualKeyboard();\n  const { isVisible, inputType, hideKeyboard, handleEnter, getCurrentInputValue } = keyboardState;\n\n  return (\n    <VirtualKeyboardContext.Provider value={keyboardState}>\n      {children}\n      {isVisible && (\n        <VirtualKeyboard\n          isVisible={isVisible}\n          inputType={inputType}\n          initialValue={getCurrentInputValue()}\n          onClose={hideKeyboard}\n          onEnter={handleEnter}\n        />\n      )}\n    </VirtualKeyboardContext.Provider>\n  );\n};","import { useState, useCallback, useEffect } from 'react';\n\n/**\n * Hook to manage virtual keyboard state and integration with input elements\n * Automatically detects gamepad usage and shows virtual keyboard for controller users\n */\nexport const useVirtualKeyboard = () => {\n  const [isVisible, setIsVisible] = useState(false);\n  const [currentInput, setCurrentInput] = useState(null);\n  const [inputType, setInputType] = useState('text');\n  const [keyboardTitle, setKeyboardTitle] = useState('');\n  const [isGamepadActive, setIsGamepadActive] = useState(false);\n\n  // Detect if gamepad navigation is active (integrate with existing system)\n  useEffect(() => {\n    const checkGamepadNavigation = () => {\n      const connected = document.body.classList.contains('gamepad-navigation-active');\n      setIsGamepadActive(connected);\n    };\n    \n    // Check initially\n    checkGamepadNavigation();\n    \n    // Create observer to watch for gamepad navigation class changes\n    const observer = new MutationObserver(checkGamepadNavigation);\n    observer.observe(document.body, {\n      attributes: true,\n      attributeFilter: ['class']\n    });\n    \n    return () => observer.disconnect();\n  }, []);\n\n  const showKeyboard = useCallback((inputElement, type = 'text', title = '') => {\n    if (!inputElement) return;\n    \n    setCurrentInput(inputElement);\n    setInputType(type);\n    setKeyboardTitle(title);\n    setIsVisible(true);\n    \n    // Blur the input to prevent mobile keyboard from appearing\n    inputElement.blur();\n  }, []);\n\n  const hideKeyboard = useCallback(() => {\n    setIsVisible(false);\n    setCurrentInput(null);\n    setInputType('text');\n    setKeyboardTitle('');\n  }, []);\n\n\n  const handleEnter = useCallback((finalValue) => {\n    if (!currentInput) return;\n    \n    // For React/MUI compatibility, we need to set the value and trigger events in a specific way\n    const nativeInputValueSetter = Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype, 'value').set;\n    nativeInputValueSetter.call(currentInput, finalValue || '');\n    \n    // Create and dispatch input event that React will recognize\n    const inputEvent = new Event('input', { bubbles: true });\n    currentInput.dispatchEvent(inputEvent);\n    \n    // Also dispatch change event\n    const changeEvent = new Event('change', { bubbles: true });\n    currentInput.dispatchEvent(changeEvent);\n    \n    // Just close the keyboard - don't submit forms or trigger enter behavior\n    hideKeyboard();\n  }, [currentInput, hideKeyboard]);\n\n  // Enhanced input wrapper that automatically shows keyboard for gamepad users\n  const enhanceInput = useCallback((inputElement, type = 'text', title = '') => {\n    if (!inputElement) return;\n    \n    // For Material-UI TextField, find the actual input element\n    let actualInput = inputElement;\n    if (inputElement.querySelector && inputElement.querySelector('input')) {\n      actualInput = inputElement.querySelector('input');\n    }\n    \n    const handleClick = (e) => {\n      // Show virtual keyboard on click if gamepad is connected\n      // AND if the gamepad navigation is currently active (showing focus indicators)\n      // This prevents autoFocus from opening the keyboard\n      if (isGamepadActive && document.body.classList.contains('gamepad-navigation-active')) {\n        e.preventDefault();\n        showKeyboard(actualInput, type, title);\n      }\n    };\n    \n    // Add event listeners to the actual input element\n    actualInput.addEventListener('click', handleClick);\n    \n    // Return cleanup function\n    return () => {\n      actualInput.removeEventListener('click', handleClick);\n    };\n  }, [isGamepadActive, showKeyboard]);\n\n  // Get current input value for initializing the virtual keyboard\n  const getCurrentInputValue = useCallback(() => {\n    return currentInput?.value || '';\n  }, [currentInput]);\n\n  return {\n    isVisible,\n    inputType,\n    keyboardTitle,\n    currentInput,\n    isGamepadActive,\n    showKeyboard,\n    hideKeyboard,\n    handleEnter,\n    enhanceInput,\n    getCurrentInputValue\n  };\n};","import React, { useRef, useEffect } from 'react';\nimport { TextField } from '@mui/material';\nimport { useVirtualKeyboardContext } from '../contexts/VirtualKeyboardContext';\n\n/**\n * Enhanced Material-UI TextField that automatically shows virtual keyboard for gamepad users\n * Drop-in replacement for Material-UI TextField\n */\nconst GamepadTextField = ({ \n  type = 'text',\n  title = '',\n  inputProps = {},\n  ...props \n}) => {\n  const textFieldRef = useRef(null);\n  const { enhanceInput } = useVirtualKeyboardContext();\n  \n  useEffect(() => {\n    if (textFieldRef.current) {\n      const cleanup = enhanceInput(textFieldRef.current, type, title);\n      return cleanup;\n    }\n  }, [enhanceInput, type, title]);\n  \n  return (\n    <TextField\n      ref={textFieldRef}\n      type={type}\n      inputProps={{\n        ...inputProps,\n        'data-gamepad-focusable': 'true'\n      }}\n      {...props}\n    />\n  );\n};\n\nexport default GamepadTextField;","import React, { useState } from 'react';\nimport {\n  Box,\n  Button,\n  Typography,\n  Paper,\n  Alert,\n  useMediaQuery,\n} from '@mui/material';\nimport GamepadTextField from '../GamepadTextField';\nimport styles from './AuthForm.module.css';\n\nconst AuthForm = ({ onSubmit, mode }) => {\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const [error, setError] = useState('');\n  const isMobile = useMediaQuery('(max-width:600px)');\n  const isSmallMobile = useMediaQuery('(max-width:400px)');\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setError('');\n    \n    try {\n      await onSubmit(username, password);\n    } catch (err) {\n      setError(err.message);\n    }\n  };\n\n  return (\n    <Paper className={styles.authForm} elevation={0}>\n      <Typography variant=\"h5\" component=\"h2\" gutterBottom sx={{ color: 'var(--info)', fontWeight: 600 }}>\n        {mode === 'login' ? 'Welcome Back' : 'Create Account'}\n      </Typography>\n      \n      {error && (\n        <Alert severity=\"error\" sx={{ mb: 2, backgroundColor: 'rgba(231, 76, 60, 0.2)', color: 'var(--text-primary)' }}>\n          {error}\n        </Alert>\n      )}\n\n      <form onSubmit={handleSubmit}>\n        <GamepadTextField\n          title=\"Enter Username\"\n          label=\"Username\"\n          variant=\"outlined\"\n          fullWidth\n          margin=\"normal\"\n          value={username}\n          onChange={(e) => setUsername(e.target.value)}\n          required\n          size={isSmallMobile ? \"small\" : \"medium\"}\n          inputProps={{ minLength: 3 }}\n          sx={{\n            '& .MuiOutlinedInput-root': {\n              '& fieldset': {\n                borderColor: 'var(--info-light)',\n              },\n              '&:hover fieldset': {\n                borderColor: 'var(--info)',\n              },\n              '&.Mui-focused fieldset': {\n                borderColor: 'var(--info)',\n              },\n              backgroundColor: 'rgba(255, 255, 255, 0.1)',\n            },\n            '& .MuiInputLabel-root': {\n              color: 'var(--info-light)',\n              fontSize: isSmallMobile ? '0.9rem' : '1rem',\n            },\n            '& .MuiOutlinedInput-input': {\n              color: 'var(--text-dark)',\n              fontWeight: 500,\n              backgroundColor: 'rgba(255, 255, 255, 0.85)',\n              padding: isSmallMobile ? '12px 14px' : '16.5px 14px',\n            },\n            '& .MuiInputLabel-root.Mui-focused': {\n              color: 'var(--info)',\n            },\n            marginBottom: isSmallMobile ? '0.5rem' : '1rem',\n          }}\n        />\n        \n        <GamepadTextField\n          title=\"Enter Password\"\n          label=\"Password\"\n          type=\"password\"\n          variant=\"outlined\"\n          fullWidth\n          margin=\"normal\"\n          value={password}\n          onChange={(e) => setPassword(e.target.value)}\n          required\n          size={isSmallMobile ? \"small\" : \"medium\"}\n          inputProps={{ minLength: 6 }}\n          sx={{\n            '& .MuiOutlinedInput-root': {\n              '& fieldset': {\n                borderColor: 'var(--info-light)',\n              },\n              '&:hover fieldset': {\n                borderColor: 'var(--info)',\n              },\n              '&.Mui-focused fieldset': {\n                borderColor: 'var(--info)',\n              },\n              backgroundColor: 'rgba(255, 255, 255, 0.1)',\n            },\n            '& .MuiInputLabel-root': {\n              color: 'var(--info-light)',\n              fontSize: isSmallMobile ? '0.9rem' : '1rem',\n            },\n            '& .MuiOutlinedInput-input': {\n              color: 'var(--text-dark)',\n              fontWeight: 500,\n              backgroundColor: 'rgba(255, 255, 255, 0.85)',\n              padding: isSmallMobile ? '12px 14px' : '16.5px 14px',\n            },\n            '& .MuiInputLabel-root.Mui-focused': {\n              color: 'var(--info)',\n            },\n            marginBottom: isSmallMobile ? '0.5rem' : '1rem',\n          }}\n        />\n\n        <Button\n          type=\"submit\"\n          variant=\"contained\"\n          fullWidth\n          size=\"large\"\n          className={styles.submitButton}\n          data-gamepad-focusable=\"true\"\n          sx={{\n            mt: isSmallMobile ? 2 : 3,\n            background: 'linear-gradient(to right, var(--info), var(--success))',\n            textTransform: 'none',\n            fontWeight: 'bold',\n            letterSpacing: '0.5px',\n            padding: isSmallMobile ? '10px' : '12px',\n            fontSize: isSmallMobile ? '0.9rem' : '1rem',\n            '&:hover': {\n              background: 'linear-gradient(to right, var(--info-dark), var(--success-dark))',\n              boxShadow: 'var(--shadow-lg)',\n              transform: 'translateY(-2px)'\n            }\n          }}\n        >\n          {mode === 'login' ? 'Sign In' : 'Create Account'}\n        </Button>\n      </form>\n    </Paper>\n  );\n};\n\nexport default AuthForm;\n","const PACKET_TYPES = Object.create(null); // no Map = no polyfill\nPACKET_TYPES[\"open\"] = \"0\";\nPACKET_TYPES[\"close\"] = \"1\";\nPACKET_TYPES[\"ping\"] = \"2\";\nPACKET_TYPES[\"pong\"] = \"3\";\nPACKET_TYPES[\"message\"] = \"4\";\nPACKET_TYPES[\"upgrade\"] = \"5\";\nPACKET_TYPES[\"noop\"] = \"6\";\nconst PACKET_TYPES_REVERSE = Object.create(null);\nObject.keys(PACKET_TYPES).forEach((key) => {\n    PACKET_TYPES_REVERSE[PACKET_TYPES[key]] = key;\n});\nconst ERROR_PACKET = { type: \"error\", data: \"parser error\" };\nexport { PACKET_TYPES, PACKET_TYPES_REVERSE, ERROR_PACKET };\n","import { PACKET_TYPES } from \"./commons.js\";\nconst withNativeBlob = typeof Blob === \"function\" ||\n    (typeof Blob !== \"undefined\" &&\n        Object.prototype.toString.call(Blob) === \"[object BlobConstructor]\");\nconst withNativeArrayBuffer = typeof ArrayBuffer === \"function\";\n// ArrayBuffer.isView method is not defined in IE10\nconst isView = (obj) => {\n    return typeof ArrayBuffer.isView === \"function\"\n        ? ArrayBuffer.isView(obj)\n        : obj && obj.buffer instanceof ArrayBuffer;\n};\nconst encodePacket = ({ type, data }, supportsBinary, callback) => {\n    if (withNativeBlob && data instanceof Blob) {\n        if (supportsBinary) {\n            return callback(data);\n        }\n        else {\n            return encodeBlobAsBase64(data, callback);\n        }\n    }\n    else if (withNativeArrayBuffer &&\n        (data instanceof ArrayBuffer || isView(data))) {\n        if (supportsBinary) {\n            return callback(data);\n        }\n        else {\n            return encodeBlobAsBase64(new Blob([data]), callback);\n        }\n    }\n    // plain string\n    return callback(PACKET_TYPES[type] + (data || \"\"));\n};\nconst encodeBlobAsBase64 = (data, callback) => {\n    const fileReader = new FileReader();\n    fileReader.onload = function () {\n        const content = fileReader.result.split(\",\")[1];\n        callback(\"b\" + (content || \"\"));\n    };\n    return fileReader.readAsDataURL(data);\n};\nfunction toArray(data) {\n    if (data instanceof Uint8Array) {\n        return data;\n    }\n    else if (data instanceof ArrayBuffer) {\n        return new Uint8Array(data);\n    }\n    else {\n        return new Uint8Array(data.buffer, data.byteOffset, data.byteLength);\n    }\n}\nlet TEXT_ENCODER;\nexport function encodePacketToBinary(packet, callback) {\n    if (withNativeBlob && packet.data instanceof Blob) {\n        return packet.data.arrayBuffer().then(toArray).then(callback);\n    }\n    else if (withNativeArrayBuffer &&\n        (packet.data instanceof ArrayBuffer || isView(packet.data))) {\n        return callback(toArray(packet.data));\n    }\n    encodePacket(packet, false, (encoded) => {\n        if (!TEXT_ENCODER) {\n            TEXT_ENCODER = new TextEncoder();\n        }\n        callback(TEXT_ENCODER.encode(encoded));\n    });\n}\nexport { encodePacket };\n","// imported from https://github.com/socketio/base64-arraybuffer\nconst chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n// Use a lookup table to find the index.\nconst lookup = typeof Uint8Array === 'undefined' ? [] : new Uint8Array(256);\nfor (let i = 0; i < chars.length; i++) {\n    lookup[chars.charCodeAt(i)] = i;\n}\nexport const encode = (arraybuffer) => {\n    let bytes = new Uint8Array(arraybuffer), i, len = bytes.length, base64 = '';\n    for (i = 0; i < len; i += 3) {\n        base64 += chars[bytes[i] >> 2];\n        base64 += chars[((bytes[i] & 3) << 4) | (bytes[i + 1] >> 4)];\n        base64 += chars[((bytes[i + 1] & 15) << 2) | (bytes[i + 2] >> 6)];\n        base64 += chars[bytes[i + 2] & 63];\n    }\n    if (len % 3 === 2) {\n        base64 = base64.substring(0, base64.length - 1) + '=';\n    }\n    else if (len % 3 === 1) {\n        base64 = base64.substring(0, base64.length - 2) + '==';\n    }\n    return base64;\n};\nexport const decode = (base64) => {\n    let bufferLength = base64.length * 0.75, len = base64.length, i, p = 0, encoded1, encoded2, encoded3, encoded4;\n    if (base64[base64.length - 1] === '=') {\n        bufferLength--;\n        if (base64[base64.length - 2] === '=') {\n            bufferLength--;\n        }\n    }\n    const arraybuffer = new ArrayBuffer(bufferLength), bytes = new Uint8Array(arraybuffer);\n    for (i = 0; i < len; i += 4) {\n        encoded1 = lookup[base64.charCodeAt(i)];\n        encoded2 = lookup[base64.charCodeAt(i + 1)];\n        encoded3 = lookup[base64.charCodeAt(i + 2)];\n        encoded4 = lookup[base64.charCodeAt(i + 3)];\n        bytes[p++] = (encoded1 << 2) | (encoded2 >> 4);\n        bytes[p++] = ((encoded2 & 15) << 4) | (encoded3 >> 2);\n        bytes[p++] = ((encoded3 & 3) << 6) | (encoded4 & 63);\n    }\n    return arraybuffer;\n};\n","import { ERROR_PACKET, PACKET_TYPES_REVERSE, } from \"./commons.js\";\nimport { decode } from \"./contrib/base64-arraybuffer.js\";\nconst withNativeArrayBuffer = typeof ArrayBuffer === \"function\";\nexport const decodePacket = (encodedPacket, binaryType) => {\n    if (typeof encodedPacket !== \"string\") {\n        return {\n            type: \"message\",\n            data: mapBinary(encodedPacket, binaryType),\n        };\n    }\n    const type = encodedPacket.charAt(0);\n    if (type === \"b\") {\n        return {\n            type: \"message\",\n            data: decodeBase64Packet(encodedPacket.substring(1), binaryType),\n        };\n    }\n    const packetType = PACKET_TYPES_REVERSE[type];\n    if (!packetType) {\n        return ERROR_PACKET;\n    }\n    return encodedPacket.length > 1\n        ? {\n            type: PACKET_TYPES_REVERSE[type],\n            data: encodedPacket.substring(1),\n        }\n        : {\n            type: PACKET_TYPES_REVERSE[type],\n        };\n};\nconst decodeBase64Packet = (data, binaryType) => {\n    if (withNativeArrayBuffer) {\n        const decoded = decode(data);\n        return mapBinary(decoded, binaryType);\n    }\n    else {\n        return { base64: true, data }; // fallback for old browsers\n    }\n};\nconst mapBinary = (data, binaryType) => {\n    switch (binaryType) {\n        case \"blob\":\n            if (data instanceof Blob) {\n                // from WebSocket + binaryType \"blob\"\n                return data;\n            }\n            else {\n                // from HTTP long-polling or WebTransport\n                return new Blob([data]);\n            }\n        case \"arraybuffer\":\n        default:\n            if (data instanceof ArrayBuffer) {\n                // from HTTP long-polling (base64) or WebSocket + binaryType \"arraybuffer\"\n                return data;\n            }\n            else {\n                // from WebTransport (Uint8Array)\n                return data.buffer;\n            }\n    }\n};\n","import { encodePacket, encodePacketToBinary } from \"./encodePacket.js\";\nimport { decodePacket } from \"./decodePacket.js\";\nimport { ERROR_PACKET, } from \"./commons.js\";\nconst SEPARATOR = String.fromCharCode(30); // see https://en.wikipedia.org/wiki/Delimiter#ASCII_delimited_text\nconst encodePayload = (packets, callback) => {\n    // some packets may be added to the array while encoding, so the initial length must be saved\n    const length = packets.length;\n    const encodedPackets = new Array(length);\n    let count = 0;\n    packets.forEach((packet, i) => {\n        // force base64 encoding for binary packets\n        encodePacket(packet, false, (encodedPacket) => {\n            encodedPackets[i] = encodedPacket;\n            if (++count === length) {\n                callback(encodedPackets.join(SEPARATOR));\n            }\n        });\n    });\n};\nconst decodePayload = (encodedPayload, binaryType) => {\n    const encodedPackets = encodedPayload.split(SEPARATOR);\n    const packets = [];\n    for (let i = 0; i < encodedPackets.length; i++) {\n        const decodedPacket = decodePacket(encodedPackets[i], binaryType);\n        packets.push(decodedPacket);\n        if (decodedPacket.type === \"error\") {\n            break;\n        }\n    }\n    return packets;\n};\nexport function createPacketEncoderStream() {\n    return new TransformStream({\n        transform(packet, controller) {\n            encodePacketToBinary(packet, (encodedPacket) => {\n                const payloadLength = encodedPacket.length;\n                let header;\n                // inspired by the WebSocket format: https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API/Writing_WebSocket_servers#decoding_payload_length\n                if (payloadLength < 126) {\n                    header = new Uint8Array(1);\n                    new DataView(header.buffer).setUint8(0, payloadLength);\n                }\n                else if (payloadLength < 65536) {\n                    header = new Uint8Array(3);\n                    const view = new DataView(header.buffer);\n                    view.setUint8(0, 126);\n                    view.setUint16(1, payloadLength);\n                }\n                else {\n                    header = new Uint8Array(9);\n                    const view = new DataView(header.buffer);\n                    view.setUint8(0, 127);\n                    view.setBigUint64(1, BigInt(payloadLength));\n                }\n                // first bit indicates whether the payload is plain text (0) or binary (1)\n                if (packet.data && typeof packet.data !== \"string\") {\n                    header[0] |= 0x80;\n                }\n                controller.enqueue(header);\n                controller.enqueue(encodedPacket);\n            });\n        },\n    });\n}\nlet TEXT_DECODER;\nfunction totalLength(chunks) {\n    return chunks.reduce((acc, chunk) => acc + chunk.length, 0);\n}\nfunction concatChunks(chunks, size) {\n    if (chunks[0].length === size) {\n        return chunks.shift();\n    }\n    const buffer = new Uint8Array(size);\n    let j = 0;\n    for (let i = 0; i < size; i++) {\n        buffer[i] = chunks[0][j++];\n        if (j === chunks[0].length) {\n            chunks.shift();\n            j = 0;\n        }\n    }\n    if (chunks.length && j < chunks[0].length) {\n        chunks[0] = chunks[0].slice(j);\n    }\n    return buffer;\n}\nexport function createPacketDecoderStream(maxPayload, binaryType) {\n    if (!TEXT_DECODER) {\n        TEXT_DECODER = new TextDecoder();\n    }\n    const chunks = [];\n    let state = 0 /* State.READ_HEADER */;\n    let expectedLength = -1;\n    let isBinary = false;\n    return new TransformStream({\n        transform(chunk, controller) {\n            chunks.push(chunk);\n            while (true) {\n                if (state === 0 /* State.READ_HEADER */) {\n                    if (totalLength(chunks) < 1) {\n                        break;\n                    }\n                    const header = concatChunks(chunks, 1);\n                    isBinary = (header[0] & 0x80) === 0x80;\n                    expectedLength = header[0] & 0x7f;\n                    if (expectedLength < 126) {\n                        state = 3 /* State.READ_PAYLOAD */;\n                    }\n                    else if (expectedLength === 126) {\n                        state = 1 /* State.READ_EXTENDED_LENGTH_16 */;\n                    }\n                    else {\n                        state = 2 /* State.READ_EXTENDED_LENGTH_64 */;\n                    }\n                }\n                else if (state === 1 /* State.READ_EXTENDED_LENGTH_16 */) {\n                    if (totalLength(chunks) < 2) {\n                        break;\n                    }\n                    const headerArray = concatChunks(chunks, 2);\n                    expectedLength = new DataView(headerArray.buffer, headerArray.byteOffset, headerArray.length).getUint16(0);\n                    state = 3 /* State.READ_PAYLOAD */;\n                }\n                else if (state === 2 /* State.READ_EXTENDED_LENGTH_64 */) {\n                    if (totalLength(chunks) < 8) {\n                        break;\n                    }\n                    const headerArray = concatChunks(chunks, 8);\n                    const view = new DataView(headerArray.buffer, headerArray.byteOffset, headerArray.length);\n                    const n = view.getUint32(0);\n                    if (n > Math.pow(2, 53 - 32) - 1) {\n                        // the maximum safe integer in JavaScript is 2^53 - 1\n                        controller.enqueue(ERROR_PACKET);\n                        break;\n                    }\n                    expectedLength = n * Math.pow(2, 32) + view.getUint32(4);\n                    state = 3 /* State.READ_PAYLOAD */;\n                }\n                else {\n                    if (totalLength(chunks) < expectedLength) {\n                        break;\n                    }\n                    const data = concatChunks(chunks, expectedLength);\n                    controller.enqueue(decodePacket(isBinary ? data : TEXT_DECODER.decode(data), binaryType));\n                    state = 0 /* State.READ_HEADER */;\n                }\n                if (expectedLength === 0 || expectedLength > maxPayload) {\n                    controller.enqueue(ERROR_PACKET);\n                    break;\n                }\n            }\n        },\n    });\n}\nexport const protocol = 4;\nexport { encodePacket, encodePayload, decodePacket, decodePayload, };\n","/**\n * Initialize a new `Emitter`.\n *\n * @api public\n */\n\nexport function Emitter(obj) {\n  if (obj) return mixin(obj);\n}\n\n/**\n * Mixin the emitter properties.\n *\n * @param {Object} obj\n * @return {Object}\n * @api private\n */\n\nfunction mixin(obj) {\n  for (var key in Emitter.prototype) {\n    obj[key] = Emitter.prototype[key];\n  }\n  return obj;\n}\n\n/**\n * Listen on the given `event` with `fn`.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.on =\nEmitter.prototype.addEventListener = function(event, fn){\n  this._callbacks = this._callbacks || {};\n  (this._callbacks['$' + event] = this._callbacks['$' + event] || [])\n    .push(fn);\n  return this;\n};\n\n/**\n * Adds an `event` listener that will be invoked a single\n * time then automatically removed.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.once = function(event, fn){\n  function on() {\n    this.off(event, on);\n    fn.apply(this, arguments);\n  }\n\n  on.fn = fn;\n  this.on(event, on);\n  return this;\n};\n\n/**\n * Remove the given callback for `event` or all\n * registered callbacks.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.off =\nEmitter.prototype.removeListener =\nEmitter.prototype.removeAllListeners =\nEmitter.prototype.removeEventListener = function(event, fn){\n  this._callbacks = this._callbacks || {};\n\n  // all\n  if (0 == arguments.length) {\n    this._callbacks = {};\n    return this;\n  }\n\n  // specific event\n  var callbacks = this._callbacks['$' + event];\n  if (!callbacks) return this;\n\n  // remove all handlers\n  if (1 == arguments.length) {\n    delete this._callbacks['$' + event];\n    return this;\n  }\n\n  // remove specific handler\n  var cb;\n  for (var i = 0; i < callbacks.length; i++) {\n    cb = callbacks[i];\n    if (cb === fn || cb.fn === fn) {\n      callbacks.splice(i, 1);\n      break;\n    }\n  }\n\n  // Remove event specific arrays for event types that no\n  // one is subscribed for to avoid memory leak.\n  if (callbacks.length === 0) {\n    delete this._callbacks['$' + event];\n  }\n\n  return this;\n};\n\n/**\n * Emit `event` with the given args.\n *\n * @param {String} event\n * @param {Mixed} ...\n * @return {Emitter}\n */\n\nEmitter.prototype.emit = function(event){\n  this._callbacks = this._callbacks || {};\n\n  var args = new Array(arguments.length - 1)\n    , callbacks = this._callbacks['$' + event];\n\n  for (var i = 1; i < arguments.length; i++) {\n    args[i - 1] = arguments[i];\n  }\n\n  if (callbacks) {\n    callbacks = callbacks.slice(0);\n    for (var i = 0, len = callbacks.length; i < len; ++i) {\n      callbacks[i].apply(this, args);\n    }\n  }\n\n  return this;\n};\n\n// alias used for reserved events (protected method)\nEmitter.prototype.emitReserved = Emitter.prototype.emit;\n\n/**\n * Return array of callbacks for `event`.\n *\n * @param {String} event\n * @return {Array}\n * @api public\n */\n\nEmitter.prototype.listeners = function(event){\n  this._callbacks = this._callbacks || {};\n  return this._callbacks['$' + event] || [];\n};\n\n/**\n * Check if this emitter has `event` handlers.\n *\n * @param {String} event\n * @return {Boolean}\n * @api public\n */\n\nEmitter.prototype.hasListeners = function(event){\n  return !! this.listeners(event).length;\n};\n","export const nextTick = (() => {\n    const isPromiseAvailable = typeof Promise === \"function\" && typeof Promise.resolve === \"function\";\n    if (isPromiseAvailable) {\n        return (cb) => Promise.resolve().then(cb);\n    }\n    else {\n        return (cb, setTimeoutFn) => setTimeoutFn(cb, 0);\n    }\n})();\nexport const globalThisShim = (() => {\n    if (typeof self !== \"undefined\") {\n        return self;\n    }\n    else if (typeof window !== \"undefined\") {\n        return window;\n    }\n    else {\n        return Function(\"return this\")();\n    }\n})();\nexport const defaultBinaryType = \"arraybuffer\";\nexport function createCookieJar() { }\n","import { globalThisShim as globalThis } from \"./globals.node.js\";\nexport function pick(obj, ...attr) {\n    return attr.reduce((acc, k) => {\n        if (obj.hasOwnProperty(k)) {\n            acc[k] = obj[k];\n        }\n        return acc;\n    }, {});\n}\n// Keep a reference to the real timeout functions so they can be used when overridden\nconst NATIVE_SET_TIMEOUT = globalThis.setTimeout;\nconst NATIVE_CLEAR_TIMEOUT = globalThis.clearTimeout;\nexport function installTimerFunctions(obj, opts) {\n    if (opts.useNativeTimers) {\n        obj.setTimeoutFn = NATIVE_SET_TIMEOUT.bind(globalThis);\n        obj.clearTimeoutFn = NATIVE_CLEAR_TIMEOUT.bind(globalThis);\n    }\n    else {\n        obj.setTimeoutFn = globalThis.setTimeout.bind(globalThis);\n        obj.clearTimeoutFn = globalThis.clearTimeout.bind(globalThis);\n    }\n}\n// base64 encoded buffers are about 33% bigger (https://en.wikipedia.org/wiki/Base64)\nconst BASE64_OVERHEAD = 1.33;\n// we could also have used `new Blob([obj]).size`, but it isn't supported in IE9\nexport function byteLength(obj) {\n    if (typeof obj === \"string\") {\n        return utf8Length(obj);\n    }\n    // arraybuffer or blob\n    return Math.ceil((obj.byteLength || obj.size) * BASE64_OVERHEAD);\n}\nfunction utf8Length(str) {\n    let c = 0, length = 0;\n    for (let i = 0, l = str.length; i < l; i++) {\n        c = str.charCodeAt(i);\n        if (c < 0x80) {\n            length += 1;\n        }\n        else if (c < 0x800) {\n            length += 2;\n        }\n        else if (c < 0xd800 || c >= 0xe000) {\n            length += 3;\n        }\n        else {\n            i++;\n            length += 4;\n        }\n    }\n    return length;\n}\n/**\n * Generates a random 8-characters string.\n */\nexport function randomString() {\n    return (Date.now().toString(36).substring(3) +\n        Math.random().toString(36).substring(2, 5));\n}\n","import { decodePacket } from \"engine.io-parser\";\nimport { Emitter } from \"@socket.io/component-emitter\";\nimport { installTimerFunctions } from \"./util.js\";\nimport { encode } from \"./contrib/parseqs.js\";\nexport class TransportError extends Error {\n    constructor(reason, description, context) {\n        super(reason);\n        this.description = description;\n        this.context = context;\n        this.type = \"TransportError\";\n    }\n}\nexport class Transport extends Emitter {\n    /**\n     * Transport abstract constructor.\n     *\n     * @param {Object} opts - options\n     * @protected\n     */\n    constructor(opts) {\n        super();\n        this.writable = false;\n        installTimerFunctions(this, opts);\n        this.opts = opts;\n        this.query = opts.query;\n        this.socket = opts.socket;\n        this.supportsBinary = !opts.forceBase64;\n    }\n    /**\n     * Emits an error.\n     *\n     * @param {String} reason\n     * @param description\n     * @param context - the error context\n     * @return {Transport} for chaining\n     * @protected\n     */\n    onError(reason, description, context) {\n        super.emitReserved(\"error\", new TransportError(reason, description, context));\n        return this;\n    }\n    /**\n     * Opens the transport.\n     */\n    open() {\n        this.readyState = \"opening\";\n        this.doOpen();\n        return this;\n    }\n    /**\n     * Closes the transport.\n     */\n    close() {\n        if (this.readyState === \"opening\" || this.readyState === \"open\") {\n            this.doClose();\n            this.onClose();\n        }\n        return this;\n    }\n    /**\n     * Sends multiple packets.\n     *\n     * @param {Array} packets\n     */\n    send(packets) {\n        if (this.readyState === \"open\") {\n            this.write(packets);\n        }\n        else {\n            // this might happen if the transport was silently closed in the beforeunload event handler\n        }\n    }\n    /**\n     * Called upon open\n     *\n     * @protected\n     */\n    onOpen() {\n        this.readyState = \"open\";\n        this.writable = true;\n        super.emitReserved(\"open\");\n    }\n    /**\n     * Called with data.\n     *\n     * @param {String} data\n     * @protected\n     */\n    onData(data) {\n        const packet = decodePacket(data, this.socket.binaryType);\n        this.onPacket(packet);\n    }\n    /**\n     * Called with a decoded packet.\n     *\n     * @protected\n     */\n    onPacket(packet) {\n        super.emitReserved(\"packet\", packet);\n    }\n    /**\n     * Called upon close.\n     *\n     * @protected\n     */\n    onClose(details) {\n        this.readyState = \"closed\";\n        super.emitReserved(\"close\", details);\n    }\n    /**\n     * Pauses the transport, in order not to lose packets during an upgrade.\n     *\n     * @param onPause\n     */\n    pause(onPause) { }\n    createUri(schema, query = {}) {\n        return (schema +\n            \"://\" +\n            this._hostname() +\n            this._port() +\n            this.opts.path +\n            this._query(query));\n    }\n    _hostname() {\n        const hostname = this.opts.hostname;\n        return hostname.indexOf(\":\") === -1 ? hostname : \"[\" + hostname + \"]\";\n    }\n    _port() {\n        if (this.opts.port &&\n            ((this.opts.secure && Number(this.opts.port !== 443)) ||\n                (!this.opts.secure && Number(this.opts.port) !== 80))) {\n            return \":\" + this.opts.port;\n        }\n        else {\n            return \"\";\n        }\n    }\n    _query(query) {\n        const encodedQuery = encode(query);\n        return encodedQuery.length ? \"?\" + encodedQuery : \"\";\n    }\n}\n","// imported from https://github.com/galkn/querystring\n/**\n * Compiles a querystring\n * Returns string representation of the object\n *\n * @param {Object}\n * @api private\n */\nexport function encode(obj) {\n    let str = '';\n    for (let i in obj) {\n        if (obj.hasOwnProperty(i)) {\n            if (str.length)\n                str += '&';\n            str += encodeURIComponent(i) + '=' + encodeURIComponent(obj[i]);\n        }\n    }\n    return str;\n}\n/**\n * Parses a simple querystring into an object\n *\n * @param {String} qs\n * @api private\n */\nexport function decode(qs) {\n    let qry = {};\n    let pairs = qs.split('&');\n    for (let i = 0, l = pairs.length; i < l; i++) {\n        let pair = pairs[i].split('=');\n        qry[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1]);\n    }\n    return qry;\n}\n","import { Transport } from \"../transport.js\";\nimport { randomString } from \"../util.js\";\nimport { encodePayload, decodePayload } from \"engine.io-parser\";\nexport class Polling extends Transport {\n    constructor() {\n        super(...arguments);\n        this._polling = false;\n    }\n    get name() {\n        return \"polling\";\n    }\n    /**\n     * Opens the socket (triggers polling). We write a PING message to determine\n     * when the transport is open.\n     *\n     * @protected\n     */\n    doOpen() {\n        this._poll();\n    }\n    /**\n     * Pauses polling.\n     *\n     * @param {Function} onPause - callback upon buffers are flushed and transport is paused\n     * @package\n     */\n    pause(onPause) {\n        this.readyState = \"pausing\";\n        const pause = () => {\n            this.readyState = \"paused\";\n            onPause();\n        };\n        if (this._polling || !this.writable) {\n            let total = 0;\n            if (this._polling) {\n                total++;\n                this.once(\"pollComplete\", function () {\n                    --total || pause();\n                });\n            }\n            if (!this.writable) {\n                total++;\n                this.once(\"drain\", function () {\n                    --total || pause();\n                });\n            }\n        }\n        else {\n            pause();\n        }\n    }\n    /**\n     * Starts polling cycle.\n     *\n     * @private\n     */\n    _poll() {\n        this._polling = true;\n        this.doPoll();\n        this.emitReserved(\"poll\");\n    }\n    /**\n     * Overloads onData to detect payloads.\n     *\n     * @protected\n     */\n    onData(data) {\n        const callback = (packet) => {\n            // if its the first message we consider the transport open\n            if (\"opening\" === this.readyState && packet.type === \"open\") {\n                this.onOpen();\n            }\n            // if its a close packet, we close the ongoing requests\n            if (\"close\" === packet.type) {\n                this.onClose({ description: \"transport closed by the server\" });\n                return false;\n            }\n            // otherwise bypass onData and handle the message\n            this.onPacket(packet);\n        };\n        // decode payload\n        decodePayload(data, this.socket.binaryType).forEach(callback);\n        // if an event did not trigger closing\n        if (\"closed\" !== this.readyState) {\n            // if we got data we're not polling\n            this._polling = false;\n            this.emitReserved(\"pollComplete\");\n            if (\"open\" === this.readyState) {\n                this._poll();\n            }\n            else {\n            }\n        }\n    }\n    /**\n     * For polling, send a close packet.\n     *\n     * @protected\n     */\n    doClose() {\n        const close = () => {\n            this.write([{ type: \"close\" }]);\n        };\n        if (\"open\" === this.readyState) {\n            close();\n        }\n        else {\n            // in case we're trying to close while\n            // handshaking is in progress (GH-164)\n            this.once(\"open\", close);\n        }\n    }\n    /**\n     * Writes a packets payload.\n     *\n     * @param {Array} packets - data packets\n     * @protected\n     */\n    write(packets) {\n        this.writable = false;\n        encodePayload(packets, (data) => {\n            this.doWrite(data, () => {\n                this.writable = true;\n                this.emitReserved(\"drain\");\n            });\n        });\n    }\n    /**\n     * Generates uri for connection.\n     *\n     * @private\n     */\n    uri() {\n        const schema = this.opts.secure ? \"https\" : \"http\";\n        const query = this.query || {};\n        // cache busting is forced\n        if (false !== this.opts.timestampRequests) {\n            query[this.opts.timestampParam] = randomString();\n        }\n        if (!this.supportsBinary && !query.sid) {\n            query.b64 = 1;\n        }\n        return this.createUri(schema, query);\n    }\n}\n","// imported from https://github.com/component/has-cors\nlet value = false;\ntry {\n    value = typeof XMLHttpRequest !== 'undefined' &&\n        'withCredentials' in new XMLHttpRequest();\n}\ncatch (err) {\n    // if XMLHttp support is disabled in IE then it will throw\n    // when trying to create\n}\nexport const hasCORS = value;\n","import { Polling } from \"./polling.js\";\nimport { Emitter } from \"@socket.io/component-emitter\";\nimport { installTimerFunctions, pick } from \"../util.js\";\nimport { globalThisShim as globalThis } from \"../globals.node.js\";\nimport { hasCORS } from \"../contrib/has-cors.js\";\nfunction empty() { }\nexport class BaseXHR extends Polling {\n    /**\n     * XHR Polling constructor.\n     *\n     * @param {Object} opts\n     * @package\n     */\n    constructor(opts) {\n        super(opts);\n        if (typeof location !== \"undefined\") {\n            const isSSL = \"https:\" === location.protocol;\n            let port = location.port;\n            // some user agents have empty `location.port`\n            if (!port) {\n                port = isSSL ? \"443\" : \"80\";\n            }\n            this.xd =\n                (typeof location !== \"undefined\" &&\n                    opts.hostname !== location.hostname) ||\n                    port !== opts.port;\n        }\n    }\n    /**\n     * Sends data.\n     *\n     * @param {String} data to send.\n     * @param {Function} called upon flush.\n     * @private\n     */\n    doWrite(data, fn) {\n        const req = this.request({\n            method: \"POST\",\n            data: data,\n        });\n        req.on(\"success\", fn);\n        req.on(\"error\", (xhrStatus, context) => {\n            this.onError(\"xhr post error\", xhrStatus, context);\n        });\n    }\n    /**\n     * Starts a poll cycle.\n     *\n     * @private\n     */\n    doPoll() {\n        const req = this.request();\n        req.on(\"data\", this.onData.bind(this));\n        req.on(\"error\", (xhrStatus, context) => {\n            this.onError(\"xhr poll error\", xhrStatus, context);\n        });\n        this.pollXhr = req;\n    }\n}\nexport class Request extends Emitter {\n    /**\n     * Request constructor\n     *\n     * @param {Object} options\n     * @package\n     */\n    constructor(createRequest, uri, opts) {\n        super();\n        this.createRequest = createRequest;\n        installTimerFunctions(this, opts);\n        this._opts = opts;\n        this._method = opts.method || \"GET\";\n        this._uri = uri;\n        this._data = undefined !== opts.data ? opts.data : null;\n        this._create();\n    }\n    /**\n     * Creates the XHR object and sends the request.\n     *\n     * @private\n     */\n    _create() {\n        var _a;\n        const opts = pick(this._opts, \"agent\", \"pfx\", \"key\", \"passphrase\", \"cert\", \"ca\", \"ciphers\", \"rejectUnauthorized\", \"autoUnref\");\n        opts.xdomain = !!this._opts.xd;\n        const xhr = (this._xhr = this.createRequest(opts));\n        try {\n            xhr.open(this._method, this._uri, true);\n            try {\n                if (this._opts.extraHeaders) {\n                    // @ts-ignore\n                    xhr.setDisableHeaderCheck && xhr.setDisableHeaderCheck(true);\n                    for (let i in this._opts.extraHeaders) {\n                        if (this._opts.extraHeaders.hasOwnProperty(i)) {\n                            xhr.setRequestHeader(i, this._opts.extraHeaders[i]);\n                        }\n                    }\n                }\n            }\n            catch (e) { }\n            if (\"POST\" === this._method) {\n                try {\n                    xhr.setRequestHeader(\"Content-type\", \"text/plain;charset=UTF-8\");\n                }\n                catch (e) { }\n            }\n            try {\n                xhr.setRequestHeader(\"Accept\", \"*/*\");\n            }\n            catch (e) { }\n            (_a = this._opts.cookieJar) === null || _a === void 0 ? void 0 : _a.addCookies(xhr);\n            // ie6 check\n            if (\"withCredentials\" in xhr) {\n                xhr.withCredentials = this._opts.withCredentials;\n            }\n            if (this._opts.requestTimeout) {\n                xhr.timeout = this._opts.requestTimeout;\n            }\n            xhr.onreadystatechange = () => {\n                var _a;\n                if (xhr.readyState === 3) {\n                    (_a = this._opts.cookieJar) === null || _a === void 0 ? void 0 : _a.parseCookies(\n                    // @ts-ignore\n                    xhr.getResponseHeader(\"set-cookie\"));\n                }\n                if (4 !== xhr.readyState)\n                    return;\n                if (200 === xhr.status || 1223 === xhr.status) {\n                    this._onLoad();\n                }\n                else {\n                    // make sure the `error` event handler that's user-set\n                    // does not throw in the same tick and gets caught here\n                    this.setTimeoutFn(() => {\n                        this._onError(typeof xhr.status === \"number\" ? xhr.status : 0);\n                    }, 0);\n                }\n            };\n            xhr.send(this._data);\n        }\n        catch (e) {\n            // Need to defer since .create() is called directly from the constructor\n            // and thus the 'error' event can only be only bound *after* this exception\n            // occurs.  Therefore, also, we cannot throw here at all.\n            this.setTimeoutFn(() => {\n                this._onError(e);\n            }, 0);\n            return;\n        }\n        if (typeof document !== \"undefined\") {\n            this._index = Request.requestsCount++;\n            Request.requests[this._index] = this;\n        }\n    }\n    /**\n     * Called upon error.\n     *\n     * @private\n     */\n    _onError(err) {\n        this.emitReserved(\"error\", err, this._xhr);\n        this._cleanup(true);\n    }\n    /**\n     * Cleans up house.\n     *\n     * @private\n     */\n    _cleanup(fromError) {\n        if (\"undefined\" === typeof this._xhr || null === this._xhr) {\n            return;\n        }\n        this._xhr.onreadystatechange = empty;\n        if (fromError) {\n            try {\n                this._xhr.abort();\n            }\n            catch (e) { }\n        }\n        if (typeof document !== \"undefined\") {\n            delete Request.requests[this._index];\n        }\n        this._xhr = null;\n    }\n    /**\n     * Called upon load.\n     *\n     * @private\n     */\n    _onLoad() {\n        const data = this._xhr.responseText;\n        if (data !== null) {\n            this.emitReserved(\"data\", data);\n            this.emitReserved(\"success\");\n            this._cleanup();\n        }\n    }\n    /**\n     * Aborts the request.\n     *\n     * @package\n     */\n    abort() {\n        this._cleanup();\n    }\n}\nRequest.requestsCount = 0;\nRequest.requests = {};\n/**\n * Aborts pending requests when unloading the window. This is needed to prevent\n * memory leaks (e.g. when using IE) and to ensure that no spurious error is\n * emitted.\n */\nif (typeof document !== \"undefined\") {\n    // @ts-ignore\n    if (typeof attachEvent === \"function\") {\n        // @ts-ignore\n        attachEvent(\"onunload\", unloadHandler);\n    }\n    else if (typeof addEventListener === \"function\") {\n        const terminationEvent = \"onpagehide\" in globalThis ? \"pagehide\" : \"unload\";\n        addEventListener(terminationEvent, unloadHandler, false);\n    }\n}\nfunction unloadHandler() {\n    for (let i in Request.requests) {\n        if (Request.requests.hasOwnProperty(i)) {\n            Request.requests[i].abort();\n        }\n    }\n}\nconst hasXHR2 = (function () {\n    const xhr = newRequest({\n        xdomain: false,\n    });\n    return xhr && xhr.responseType !== null;\n})();\n/**\n * HTTP long-polling based on the built-in `XMLHttpRequest` object.\n *\n * Usage: browser\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest\n */\nexport class XHR extends BaseXHR {\n    constructor(opts) {\n        super(opts);\n        const forceBase64 = opts && opts.forceBase64;\n        this.supportsBinary = hasXHR2 && !forceBase64;\n    }\n    request(opts = {}) {\n        Object.assign(opts, { xd: this.xd }, this.opts);\n        return new Request(newRequest, this.uri(), opts);\n    }\n}\nfunction newRequest(opts) {\n    const xdomain = opts.xdomain;\n    // XMLHttpRequest can be disabled on IE\n    try {\n        if (\"undefined\" !== typeof XMLHttpRequest && (!xdomain || hasCORS)) {\n            return new XMLHttpRequest();\n        }\n    }\n    catch (e) { }\n    if (!xdomain) {\n        try {\n            return new globalThis[[\"Active\"].concat(\"Object\").join(\"X\")](\"Microsoft.XMLHTTP\");\n        }\n        catch (e) { }\n    }\n}\n","import { Transport } from \"../transport.js\";\nimport { pick, randomString } from \"../util.js\";\nimport { encodePacket } from \"engine.io-parser\";\nimport { globalThisShim as globalThis, nextTick } from \"../globals.node.js\";\n// detect ReactNative environment\nconst isReactNative = typeof navigator !== \"undefined\" &&\n    typeof navigator.product === \"string\" &&\n    navigator.product.toLowerCase() === \"reactnative\";\nexport class BaseWS extends Transport {\n    get name() {\n        return \"websocket\";\n    }\n    doOpen() {\n        const uri = this.uri();\n        const protocols = this.opts.protocols;\n        // React Native only supports the 'headers' option, and will print a warning if anything else is passed\n        const opts = isReactNative\n            ? {}\n            : pick(this.opts, \"agent\", \"perMessageDeflate\", \"pfx\", \"key\", \"passphrase\", \"cert\", \"ca\", \"ciphers\", \"rejectUnauthorized\", \"localAddress\", \"protocolVersion\", \"origin\", \"maxPayload\", \"family\", \"checkServerIdentity\");\n        if (this.opts.extraHeaders) {\n            opts.headers = this.opts.extraHeaders;\n        }\n        try {\n            this.ws = this.createSocket(uri, protocols, opts);\n        }\n        catch (err) {\n            return this.emitReserved(\"error\", err);\n        }\n        this.ws.binaryType = this.socket.binaryType;\n        this.addEventListeners();\n    }\n    /**\n     * Adds event listeners to the socket\n     *\n     * @private\n     */\n    addEventListeners() {\n        this.ws.onopen = () => {\n            if (this.opts.autoUnref) {\n                this.ws._socket.unref();\n            }\n            this.onOpen();\n        };\n        this.ws.onclose = (closeEvent) => this.onClose({\n            description: \"websocket connection closed\",\n            context: closeEvent,\n        });\n        this.ws.onmessage = (ev) => this.onData(ev.data);\n        this.ws.onerror = (e) => this.onError(\"websocket error\", e);\n    }\n    write(packets) {\n        this.writable = false;\n        // encodePacket efficient as it uses WS framing\n        // no need for encodePayload\n        for (let i = 0; i < packets.length; i++) {\n            const packet = packets[i];\n            const lastPacket = i === packets.length - 1;\n            encodePacket(packet, this.supportsBinary, (data) => {\n                // Sometimes the websocket has already been closed but the browser didn't\n                // have a chance of informing us about it yet, in that case send will\n                // throw an error\n                try {\n                    this.doWrite(packet, data);\n                }\n                catch (e) {\n                }\n                if (lastPacket) {\n                    // fake drain\n                    // defer to next tick to allow Socket to clear writeBuffer\n                    nextTick(() => {\n                        this.writable = true;\n                        this.emitReserved(\"drain\");\n                    }, this.setTimeoutFn);\n                }\n            });\n        }\n    }\n    doClose() {\n        if (typeof this.ws !== \"undefined\") {\n            this.ws.onerror = () => { };\n            this.ws.close();\n            this.ws = null;\n        }\n    }\n    /**\n     * Generates uri for connection.\n     *\n     * @private\n     */\n    uri() {\n        const schema = this.opts.secure ? \"wss\" : \"ws\";\n        const query = this.query || {};\n        // append timestamp to URI\n        if (this.opts.timestampRequests) {\n            query[this.opts.timestampParam] = randomString();\n        }\n        // communicate binary support capabilities\n        if (!this.supportsBinary) {\n            query.b64 = 1;\n        }\n        return this.createUri(schema, query);\n    }\n}\nconst WebSocketCtor = globalThis.WebSocket || globalThis.MozWebSocket;\n/**\n * WebSocket transport based on the built-in `WebSocket` object.\n *\n * Usage: browser, Node.js (since v21), Deno, Bun\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/WebSocket\n * @see https://caniuse.com/mdn-api_websocket\n * @see https://nodejs.org/api/globals.html#websocket\n */\nexport class WS extends BaseWS {\n    createSocket(uri, protocols, opts) {\n        return !isReactNative\n            ? protocols\n                ? new WebSocketCtor(uri, protocols)\n                : new WebSocketCtor(uri)\n            : new WebSocketCtor(uri, protocols, opts);\n    }\n    doWrite(_packet, data) {\n        this.ws.send(data);\n    }\n}\n","import { XHR } from \"./polling-xhr.node.js\";\nimport { WS } from \"./websocket.node.js\";\nimport { WT } from \"./webtransport.js\";\nexport const transports = {\n    websocket: WS,\n    webtransport: WT,\n    polling: XHR,\n};\n","import { Transport } from \"../transport.js\";\nimport { nextTick } from \"../globals.node.js\";\nimport { createPacketDecoderStream, createPacketEncoderStream, } from \"engine.io-parser\";\n/**\n * WebTransport transport based on the built-in `WebTransport` object.\n *\n * Usage: browser, Node.js (with the `@fails-components/webtransport` package)\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/WebTransport\n * @see https://caniuse.com/webtransport\n */\nexport class WT extends Transport {\n    get name() {\n        return \"webtransport\";\n    }\n    doOpen() {\n        try {\n            // @ts-ignore\n            this._transport = new WebTransport(this.createUri(\"https\"), this.opts.transportOptions[this.name]);\n        }\n        catch (err) {\n            return this.emitReserved(\"error\", err);\n        }\n        this._transport.closed\n            .then(() => {\n            this.onClose();\n        })\n            .catch((err) => {\n            this.onError(\"webtransport error\", err);\n        });\n        // note: we could have used async/await, but that would require some additional polyfills\n        this._transport.ready.then(() => {\n            this._transport.createBidirectionalStream().then((stream) => {\n                const decoderStream = createPacketDecoderStream(Number.MAX_SAFE_INTEGER, this.socket.binaryType);\n                const reader = stream.readable.pipeThrough(decoderStream).getReader();\n                const encoderStream = createPacketEncoderStream();\n                encoderStream.readable.pipeTo(stream.writable);\n                this._writer = encoderStream.writable.getWriter();\n                const read = () => {\n                    reader\n                        .read()\n                        .then(({ done, value }) => {\n                        if (done) {\n                            return;\n                        }\n                        this.onPacket(value);\n                        read();\n                    })\n                        .catch((err) => {\n                    });\n                };\n                read();\n                const packet = { type: \"open\" };\n                if (this.query.sid) {\n                    packet.data = `{\"sid\":\"${this.query.sid}\"}`;\n                }\n                this._writer.write(packet).then(() => this.onOpen());\n            });\n        });\n    }\n    write(packets) {\n        this.writable = false;\n        for (let i = 0; i < packets.length; i++) {\n            const packet = packets[i];\n            const lastPacket = i === packets.length - 1;\n            this._writer.write(packet).then(() => {\n                if (lastPacket) {\n                    nextTick(() => {\n                        this.writable = true;\n                        this.emitReserved(\"drain\");\n                    }, this.setTimeoutFn);\n                }\n            });\n        }\n    }\n    doClose() {\n        var _a;\n        (_a = this._transport) === null || _a === void 0 ? void 0 : _a.close();\n    }\n}\n","// imported from https://github.com/galkn/parseuri\n/**\n * Parses a URI\n *\n * Note: we could also have used the built-in URL object, but it isn't supported on all platforms.\n *\n * See:\n * - https://developer.mozilla.org/en-US/docs/Web/API/URL\n * - https://caniuse.com/url\n * - https://www.rfc-editor.org/rfc/rfc3986#appendix-B\n *\n * History of the parse() method:\n * - first commit: https://github.com/socketio/socket.io-client/commit/4ee1d5d94b3906a9c052b459f1a818b15f38f91c\n * - export into its own module: https://github.com/socketio/engine.io-client/commit/de2c561e4564efeb78f1bdb1ba39ef81b2822cb3\n * - reimport: https://github.com/socketio/engine.io-client/commit/df32277c3f6d622eec5ed09f493cae3f3391d242\n *\n * @author Steven Levithan <stevenlevithan.com> (MIT license)\n * @api private\n */\nconst re = /^(?:(?![^:@\\/?#]+:[^:@\\/]*@)(http|https|ws|wss):\\/\\/)?((?:(([^:@\\/?#]*)(?::([^:@\\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\\/?#]*)(?::(\\d*))?)(((\\/(?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/;\nconst parts = [\n    'source', 'protocol', 'authority', 'userInfo', 'user', 'password', 'host', 'port', 'relative', 'path', 'directory', 'file', 'query', 'anchor'\n];\nexport function parse(str) {\n    if (str.length > 8000) {\n        throw \"URI too long\";\n    }\n    const src = str, b = str.indexOf('['), e = str.indexOf(']');\n    if (b != -1 && e != -1) {\n        str = str.substring(0, b) + str.substring(b, e).replace(/:/g, ';') + str.substring(e, str.length);\n    }\n    let m = re.exec(str || ''), uri = {}, i = 14;\n    while (i--) {\n        uri[parts[i]] = m[i] || '';\n    }\n    if (b != -1 && e != -1) {\n        uri.source = src;\n        uri.host = uri.host.substring(1, uri.host.length - 1).replace(/;/g, ':');\n        uri.authority = uri.authority.replace('[', '').replace(']', '').replace(/;/g, ':');\n        uri.ipv6uri = true;\n    }\n    uri.pathNames = pathNames(uri, uri['path']);\n    uri.queryKey = queryKey(uri, uri['query']);\n    return uri;\n}\nfunction pathNames(obj, path) {\n    const regx = /\\/{2,9}/g, names = path.replace(regx, \"/\").split(\"/\");\n    if (path.slice(0, 1) == '/' || path.length === 0) {\n        names.splice(0, 1);\n    }\n    if (path.slice(-1) == '/') {\n        names.splice(names.length - 1, 1);\n    }\n    return names;\n}\nfunction queryKey(uri, query) {\n    const data = {};\n    query.replace(/(?:^|&)([^&=]*)=?([^&]*)/g, function ($0, $1, $2) {\n        if ($1) {\n            data[$1] = $2;\n        }\n    });\n    return data;\n}\n","import { transports as DEFAULT_TRANSPORTS } from \"./transports/index.js\";\nimport { installTimerFunctions, byteLength } from \"./util.js\";\nimport { decode } from \"./contrib/parseqs.js\";\nimport { parse } from \"./contrib/parseuri.js\";\nimport { Emitter } from \"@socket.io/component-emitter\";\nimport { protocol } from \"engine.io-parser\";\nimport { createCookieJar, defaultBinaryType, nextTick, } from \"./globals.node.js\";\nconst withEventListeners = typeof addEventListener === \"function\" &&\n    typeof removeEventListener === \"function\";\nconst OFFLINE_EVENT_LISTENERS = [];\nif (withEventListeners) {\n    // within a ServiceWorker, any event handler for the 'offline' event must be added on the initial evaluation of the\n    // script, so we create one single event listener here which will forward the event to the socket instances\n    addEventListener(\"offline\", () => {\n        OFFLINE_EVENT_LISTENERS.forEach((listener) => listener());\n    }, false);\n}\n/**\n * This class provides a WebSocket-like interface to connect to an Engine.IO server. The connection will be established\n * with one of the available low-level transports, like HTTP long-polling, WebSocket or WebTransport.\n *\n * This class comes without upgrade mechanism, which means that it will keep the first low-level transport that\n * successfully establishes the connection.\n *\n * In order to allow tree-shaking, there are no transports included, that's why the `transports` option is mandatory.\n *\n * @example\n * import { SocketWithoutUpgrade, WebSocket } from \"engine.io-client\";\n *\n * const socket = new SocketWithoutUpgrade({\n *   transports: [WebSocket]\n * });\n *\n * socket.on(\"open\", () => {\n *   socket.send(\"hello\");\n * });\n *\n * @see SocketWithUpgrade\n * @see Socket\n */\nexport class SocketWithoutUpgrade extends Emitter {\n    /**\n     * Socket constructor.\n     *\n     * @param {String|Object} uri - uri or options\n     * @param {Object} opts - options\n     */\n    constructor(uri, opts) {\n        super();\n        this.binaryType = defaultBinaryType;\n        this.writeBuffer = [];\n        this._prevBufferLen = 0;\n        this._pingInterval = -1;\n        this._pingTimeout = -1;\n        this._maxPayload = -1;\n        /**\n         * The expiration timestamp of the {@link _pingTimeoutTimer} object is tracked, in case the timer is throttled and the\n         * callback is not fired on time. This can happen for example when a laptop is suspended or when a phone is locked.\n         */\n        this._pingTimeoutTime = Infinity;\n        if (uri && \"object\" === typeof uri) {\n            opts = uri;\n            uri = null;\n        }\n        if (uri) {\n            const parsedUri = parse(uri);\n            opts.hostname = parsedUri.host;\n            opts.secure =\n                parsedUri.protocol === \"https\" || parsedUri.protocol === \"wss\";\n            opts.port = parsedUri.port;\n            if (parsedUri.query)\n                opts.query = parsedUri.query;\n        }\n        else if (opts.host) {\n            opts.hostname = parse(opts.host).host;\n        }\n        installTimerFunctions(this, opts);\n        this.secure =\n            null != opts.secure\n                ? opts.secure\n                : typeof location !== \"undefined\" && \"https:\" === location.protocol;\n        if (opts.hostname && !opts.port) {\n            // if no port is specified manually, use the protocol default\n            opts.port = this.secure ? \"443\" : \"80\";\n        }\n        this.hostname =\n            opts.hostname ||\n                (typeof location !== \"undefined\" ? location.hostname : \"localhost\");\n        this.port =\n            opts.port ||\n                (typeof location !== \"undefined\" && location.port\n                    ? location.port\n                    : this.secure\n                        ? \"443\"\n                        : \"80\");\n        this.transports = [];\n        this._transportsByName = {};\n        opts.transports.forEach((t) => {\n            const transportName = t.prototype.name;\n            this.transports.push(transportName);\n            this._transportsByName[transportName] = t;\n        });\n        this.opts = Object.assign({\n            path: \"/engine.io\",\n            agent: false,\n            withCredentials: false,\n            upgrade: true,\n            timestampParam: \"t\",\n            rememberUpgrade: false,\n            addTrailingSlash: true,\n            rejectUnauthorized: true,\n            perMessageDeflate: {\n                threshold: 1024,\n            },\n            transportOptions: {},\n            closeOnBeforeunload: false,\n        }, opts);\n        this.opts.path =\n            this.opts.path.replace(/\\/$/, \"\") +\n                (this.opts.addTrailingSlash ? \"/\" : \"\");\n        if (typeof this.opts.query === \"string\") {\n            this.opts.query = decode(this.opts.query);\n        }\n        if (withEventListeners) {\n            if (this.opts.closeOnBeforeunload) {\n                // Firefox closes the connection when the \"beforeunload\" event is emitted but not Chrome. This event listener\n                // ensures every browser behaves the same (no \"disconnect\" event at the Socket.IO level when the page is\n                // closed/reloaded)\n                this._beforeunloadEventListener = () => {\n                    if (this.transport) {\n                        // silently close the transport\n                        this.transport.removeAllListeners();\n                        this.transport.close();\n                    }\n                };\n                addEventListener(\"beforeunload\", this._beforeunloadEventListener, false);\n            }\n            if (this.hostname !== \"localhost\") {\n                this._offlineEventListener = () => {\n                    this._onClose(\"transport close\", {\n                        description: \"network connection lost\",\n                    });\n                };\n                OFFLINE_EVENT_LISTENERS.push(this._offlineEventListener);\n            }\n        }\n        if (this.opts.withCredentials) {\n            this._cookieJar = createCookieJar();\n        }\n        this._open();\n    }\n    /**\n     * Creates transport of the given type.\n     *\n     * @param {String} name - transport name\n     * @return {Transport}\n     * @private\n     */\n    createTransport(name) {\n        const query = Object.assign({}, this.opts.query);\n        // append engine.io protocol identifier\n        query.EIO = protocol;\n        // transport name\n        query.transport = name;\n        // session id if we already have one\n        if (this.id)\n            query.sid = this.id;\n        const opts = Object.assign({}, this.opts, {\n            query,\n            socket: this,\n            hostname: this.hostname,\n            secure: this.secure,\n            port: this.port,\n        }, this.opts.transportOptions[name]);\n        return new this._transportsByName[name](opts);\n    }\n    /**\n     * Initializes transport to use and starts probe.\n     *\n     * @private\n     */\n    _open() {\n        if (this.transports.length === 0) {\n            // Emit error on next tick so it can be listened to\n            this.setTimeoutFn(() => {\n                this.emitReserved(\"error\", \"No transports available\");\n            }, 0);\n            return;\n        }\n        const transportName = this.opts.rememberUpgrade &&\n            SocketWithoutUpgrade.priorWebsocketSuccess &&\n            this.transports.indexOf(\"websocket\") !== -1\n            ? \"websocket\"\n            : this.transports[0];\n        this.readyState = \"opening\";\n        const transport = this.createTransport(transportName);\n        transport.open();\n        this.setTransport(transport);\n    }\n    /**\n     * Sets the current transport. Disables the existing one (if any).\n     *\n     * @private\n     */\n    setTransport(transport) {\n        if (this.transport) {\n            this.transport.removeAllListeners();\n        }\n        // set up transport\n        this.transport = transport;\n        // set up transport listeners\n        transport\n            .on(\"drain\", this._onDrain.bind(this))\n            .on(\"packet\", this._onPacket.bind(this))\n            .on(\"error\", this._onError.bind(this))\n            .on(\"close\", (reason) => this._onClose(\"transport close\", reason));\n    }\n    /**\n     * Called when connection is deemed open.\n     *\n     * @private\n     */\n    onOpen() {\n        this.readyState = \"open\";\n        SocketWithoutUpgrade.priorWebsocketSuccess =\n            \"websocket\" === this.transport.name;\n        this.emitReserved(\"open\");\n        this.flush();\n    }\n    /**\n     * Handles a packet.\n     *\n     * @private\n     */\n    _onPacket(packet) {\n        if (\"opening\" === this.readyState ||\n            \"open\" === this.readyState ||\n            \"closing\" === this.readyState) {\n            this.emitReserved(\"packet\", packet);\n            // Socket is live - any packet counts\n            this.emitReserved(\"heartbeat\");\n            switch (packet.type) {\n                case \"open\":\n                    this.onHandshake(JSON.parse(packet.data));\n                    break;\n                case \"ping\":\n                    this._sendPacket(\"pong\");\n                    this.emitReserved(\"ping\");\n                    this.emitReserved(\"pong\");\n                    this._resetPingTimeout();\n                    break;\n                case \"error\":\n                    const err = new Error(\"server error\");\n                    // @ts-ignore\n                    err.code = packet.data;\n                    this._onError(err);\n                    break;\n                case \"message\":\n                    this.emitReserved(\"data\", packet.data);\n                    this.emitReserved(\"message\", packet.data);\n                    break;\n            }\n        }\n        else {\n        }\n    }\n    /**\n     * Called upon handshake completion.\n     *\n     * @param {Object} data - handshake obj\n     * @private\n     */\n    onHandshake(data) {\n        this.emitReserved(\"handshake\", data);\n        this.id = data.sid;\n        this.transport.query.sid = data.sid;\n        this._pingInterval = data.pingInterval;\n        this._pingTimeout = data.pingTimeout;\n        this._maxPayload = data.maxPayload;\n        this.onOpen();\n        // In case open handler closes socket\n        if (\"closed\" === this.readyState)\n            return;\n        this._resetPingTimeout();\n    }\n    /**\n     * Sets and resets ping timeout timer based on server pings.\n     *\n     * @private\n     */\n    _resetPingTimeout() {\n        this.clearTimeoutFn(this._pingTimeoutTimer);\n        const delay = this._pingInterval + this._pingTimeout;\n        this._pingTimeoutTime = Date.now() + delay;\n        this._pingTimeoutTimer = this.setTimeoutFn(() => {\n            this._onClose(\"ping timeout\");\n        }, delay);\n        if (this.opts.autoUnref) {\n            this._pingTimeoutTimer.unref();\n        }\n    }\n    /**\n     * Called on `drain` event\n     *\n     * @private\n     */\n    _onDrain() {\n        this.writeBuffer.splice(0, this._prevBufferLen);\n        // setting prevBufferLen = 0 is very important\n        // for example, when upgrading, upgrade packet is sent over,\n        // and a nonzero prevBufferLen could cause problems on `drain`\n        this._prevBufferLen = 0;\n        if (0 === this.writeBuffer.length) {\n            this.emitReserved(\"drain\");\n        }\n        else {\n            this.flush();\n        }\n    }\n    /**\n     * Flush write buffers.\n     *\n     * @private\n     */\n    flush() {\n        if (\"closed\" !== this.readyState &&\n            this.transport.writable &&\n            !this.upgrading &&\n            this.writeBuffer.length) {\n            const packets = this._getWritablePackets();\n            this.transport.send(packets);\n            // keep track of current length of writeBuffer\n            // splice writeBuffer and callbackBuffer on `drain`\n            this._prevBufferLen = packets.length;\n            this.emitReserved(\"flush\");\n        }\n    }\n    /**\n     * Ensure the encoded size of the writeBuffer is below the maxPayload value sent by the server (only for HTTP\n     * long-polling)\n     *\n     * @private\n     */\n    _getWritablePackets() {\n        const shouldCheckPayloadSize = this._maxPayload &&\n            this.transport.name === \"polling\" &&\n            this.writeBuffer.length > 1;\n        if (!shouldCheckPayloadSize) {\n            return this.writeBuffer;\n        }\n        let payloadSize = 1; // first packet type\n        for (let i = 0; i < this.writeBuffer.length; i++) {\n            const data = this.writeBuffer[i].data;\n            if (data) {\n                payloadSize += byteLength(data);\n            }\n            if (i > 0 && payloadSize > this._maxPayload) {\n                return this.writeBuffer.slice(0, i);\n            }\n            payloadSize += 2; // separator + packet type\n        }\n        return this.writeBuffer;\n    }\n    /**\n     * Checks whether the heartbeat timer has expired but the socket has not yet been notified.\n     *\n     * Note: this method is private for now because it does not really fit the WebSocket API, but if we put it in the\n     * `write()` method then the message would not be buffered by the Socket.IO client.\n     *\n     * @return {boolean}\n     * @private\n     */\n    /* private */ _hasPingExpired() {\n        if (!this._pingTimeoutTime)\n            return true;\n        const hasExpired = Date.now() > this._pingTimeoutTime;\n        if (hasExpired) {\n            this._pingTimeoutTime = 0;\n            nextTick(() => {\n                this._onClose(\"ping timeout\");\n            }, this.setTimeoutFn);\n        }\n        return hasExpired;\n    }\n    /**\n     * Sends a message.\n     *\n     * @param {String} msg - message.\n     * @param {Object} options.\n     * @param {Function} fn - callback function.\n     * @return {Socket} for chaining.\n     */\n    write(msg, options, fn) {\n        this._sendPacket(\"message\", msg, options, fn);\n        return this;\n    }\n    /**\n     * Sends a message. Alias of {@link Socket#write}.\n     *\n     * @param {String} msg - message.\n     * @param {Object} options.\n     * @param {Function} fn - callback function.\n     * @return {Socket} for chaining.\n     */\n    send(msg, options, fn) {\n        this._sendPacket(\"message\", msg, options, fn);\n        return this;\n    }\n    /**\n     * Sends a packet.\n     *\n     * @param {String} type: packet type.\n     * @param {String} data.\n     * @param {Object} options.\n     * @param {Function} fn - callback function.\n     * @private\n     */\n    _sendPacket(type, data, options, fn) {\n        if (\"function\" === typeof data) {\n            fn = data;\n            data = undefined;\n        }\n        if (\"function\" === typeof options) {\n            fn = options;\n            options = null;\n        }\n        if (\"closing\" === this.readyState || \"closed\" === this.readyState) {\n            return;\n        }\n        options = options || {};\n        options.compress = false !== options.compress;\n        const packet = {\n            type: type,\n            data: data,\n            options: options,\n        };\n        this.emitReserved(\"packetCreate\", packet);\n        this.writeBuffer.push(packet);\n        if (fn)\n            this.once(\"flush\", fn);\n        this.flush();\n    }\n    /**\n     * Closes the connection.\n     */\n    close() {\n        const close = () => {\n            this._onClose(\"forced close\");\n            this.transport.close();\n        };\n        const cleanupAndClose = () => {\n            this.off(\"upgrade\", cleanupAndClose);\n            this.off(\"upgradeError\", cleanupAndClose);\n            close();\n        };\n        const waitForUpgrade = () => {\n            // wait for upgrade to finish since we can't send packets while pausing a transport\n            this.once(\"upgrade\", cleanupAndClose);\n            this.once(\"upgradeError\", cleanupAndClose);\n        };\n        if (\"opening\" === this.readyState || \"open\" === this.readyState) {\n            this.readyState = \"closing\";\n            if (this.writeBuffer.length) {\n                this.once(\"drain\", () => {\n                    if (this.upgrading) {\n                        waitForUpgrade();\n                    }\n                    else {\n                        close();\n                    }\n                });\n            }\n            else if (this.upgrading) {\n                waitForUpgrade();\n            }\n            else {\n                close();\n            }\n        }\n        return this;\n    }\n    /**\n     * Called upon transport error\n     *\n     * @private\n     */\n    _onError(err) {\n        SocketWithoutUpgrade.priorWebsocketSuccess = false;\n        if (this.opts.tryAllTransports &&\n            this.transports.length > 1 &&\n            this.readyState === \"opening\") {\n            this.transports.shift();\n            return this._open();\n        }\n        this.emitReserved(\"error\", err);\n        this._onClose(\"transport error\", err);\n    }\n    /**\n     * Called upon transport close.\n     *\n     * @private\n     */\n    _onClose(reason, description) {\n        if (\"opening\" === this.readyState ||\n            \"open\" === this.readyState ||\n            \"closing\" === this.readyState) {\n            // clear timers\n            this.clearTimeoutFn(this._pingTimeoutTimer);\n            // stop event from firing again for transport\n            this.transport.removeAllListeners(\"close\");\n            // ensure transport won't stay open\n            this.transport.close();\n            // ignore further transport communication\n            this.transport.removeAllListeners();\n            if (withEventListeners) {\n                if (this._beforeunloadEventListener) {\n                    removeEventListener(\"beforeunload\", this._beforeunloadEventListener, false);\n                }\n                if (this._offlineEventListener) {\n                    const i = OFFLINE_EVENT_LISTENERS.indexOf(this._offlineEventListener);\n                    if (i !== -1) {\n                        OFFLINE_EVENT_LISTENERS.splice(i, 1);\n                    }\n                }\n            }\n            // set ready state\n            this.readyState = \"closed\";\n            // clear session id\n            this.id = null;\n            // emit close event\n            this.emitReserved(\"close\", reason, description);\n            // clean buffers after, so users can still\n            // grab the buffers on `close` event\n            this.writeBuffer = [];\n            this._prevBufferLen = 0;\n        }\n    }\n}\nSocketWithoutUpgrade.protocol = protocol;\n/**\n * This class provides a WebSocket-like interface to connect to an Engine.IO server. The connection will be established\n * with one of the available low-level transports, like HTTP long-polling, WebSocket or WebTransport.\n *\n * This class comes with an upgrade mechanism, which means that once the connection is established with the first\n * low-level transport, it will try to upgrade to a better transport.\n *\n * In order to allow tree-shaking, there are no transports included, that's why the `transports` option is mandatory.\n *\n * @example\n * import { SocketWithUpgrade, WebSocket } from \"engine.io-client\";\n *\n * const socket = new SocketWithUpgrade({\n *   transports: [WebSocket]\n * });\n *\n * socket.on(\"open\", () => {\n *   socket.send(\"hello\");\n * });\n *\n * @see SocketWithoutUpgrade\n * @see Socket\n */\nexport class SocketWithUpgrade extends SocketWithoutUpgrade {\n    constructor() {\n        super(...arguments);\n        this._upgrades = [];\n    }\n    onOpen() {\n        super.onOpen();\n        if (\"open\" === this.readyState && this.opts.upgrade) {\n            for (let i = 0; i < this._upgrades.length; i++) {\n                this._probe(this._upgrades[i]);\n            }\n        }\n    }\n    /**\n     * Probes a transport.\n     *\n     * @param {String} name - transport name\n     * @private\n     */\n    _probe(name) {\n        let transport = this.createTransport(name);\n        let failed = false;\n        SocketWithoutUpgrade.priorWebsocketSuccess = false;\n        const onTransportOpen = () => {\n            if (failed)\n                return;\n            transport.send([{ type: \"ping\", data: \"probe\" }]);\n            transport.once(\"packet\", (msg) => {\n                if (failed)\n                    return;\n                if (\"pong\" === msg.type && \"probe\" === msg.data) {\n                    this.upgrading = true;\n                    this.emitReserved(\"upgrading\", transport);\n                    if (!transport)\n                        return;\n                    SocketWithoutUpgrade.priorWebsocketSuccess =\n                        \"websocket\" === transport.name;\n                    this.transport.pause(() => {\n                        if (failed)\n                            return;\n                        if (\"closed\" === this.readyState)\n                            return;\n                        cleanup();\n                        this.setTransport(transport);\n                        transport.send([{ type: \"upgrade\" }]);\n                        this.emitReserved(\"upgrade\", transport);\n                        transport = null;\n                        this.upgrading = false;\n                        this.flush();\n                    });\n                }\n                else {\n                    const err = new Error(\"probe error\");\n                    // @ts-ignore\n                    err.transport = transport.name;\n                    this.emitReserved(\"upgradeError\", err);\n                }\n            });\n        };\n        function freezeTransport() {\n            if (failed)\n                return;\n            // Any callback called by transport should be ignored since now\n            failed = true;\n            cleanup();\n            transport.close();\n            transport = null;\n        }\n        // Handle any error that happens while probing\n        const onerror = (err) => {\n            const error = new Error(\"probe error: \" + err);\n            // @ts-ignore\n            error.transport = transport.name;\n            freezeTransport();\n            this.emitReserved(\"upgradeError\", error);\n        };\n        function onTransportClose() {\n            onerror(\"transport closed\");\n        }\n        // When the socket is closed while we're probing\n        function onclose() {\n            onerror(\"socket closed\");\n        }\n        // When the socket is upgraded while we're probing\n        function onupgrade(to) {\n            if (transport && to.name !== transport.name) {\n                freezeTransport();\n            }\n        }\n        // Remove all listeners on the transport and on self\n        const cleanup = () => {\n            transport.removeListener(\"open\", onTransportOpen);\n            transport.removeListener(\"error\", onerror);\n            transport.removeListener(\"close\", onTransportClose);\n            this.off(\"close\", onclose);\n            this.off(\"upgrading\", onupgrade);\n        };\n        transport.once(\"open\", onTransportOpen);\n        transport.once(\"error\", onerror);\n        transport.once(\"close\", onTransportClose);\n        this.once(\"close\", onclose);\n        this.once(\"upgrading\", onupgrade);\n        if (this._upgrades.indexOf(\"webtransport\") !== -1 &&\n            name !== \"webtransport\") {\n            // favor WebTransport\n            this.setTimeoutFn(() => {\n                if (!failed) {\n                    transport.open();\n                }\n            }, 200);\n        }\n        else {\n            transport.open();\n        }\n    }\n    onHandshake(data) {\n        this._upgrades = this._filterUpgrades(data.upgrades);\n        super.onHandshake(data);\n    }\n    /**\n     * Filters upgrades, returning only those matching client transports.\n     *\n     * @param {Array} upgrades - server upgrades\n     * @private\n     */\n    _filterUpgrades(upgrades) {\n        const filteredUpgrades = [];\n        for (let i = 0; i < upgrades.length; i++) {\n            if (~this.transports.indexOf(upgrades[i]))\n                filteredUpgrades.push(upgrades[i]);\n        }\n        return filteredUpgrades;\n    }\n}\n/**\n * This class provides a WebSocket-like interface to connect to an Engine.IO server. The connection will be established\n * with one of the available low-level transports, like HTTP long-polling, WebSocket or WebTransport.\n *\n * This class comes with an upgrade mechanism, which means that once the connection is established with the first\n * low-level transport, it will try to upgrade to a better transport.\n *\n * @example\n * import { Socket } from \"engine.io-client\";\n *\n * const socket = new Socket();\n *\n * socket.on(\"open\", () => {\n *   socket.send(\"hello\");\n * });\n *\n * @see SocketWithoutUpgrade\n * @see SocketWithUpgrade\n */\nexport class Socket extends SocketWithUpgrade {\n    constructor(uri, opts = {}) {\n        const o = typeof uri === \"object\" ? uri : opts;\n        if (!o.transports ||\n            (o.transports && typeof o.transports[0] === \"string\")) {\n            o.transports = (o.transports || [\"polling\", \"websocket\", \"webtransport\"])\n                .map((transportName) => DEFAULT_TRANSPORTS[transportName])\n                .filter((t) => !!t);\n        }\n        super(uri, o);\n    }\n}\n","const withNativeArrayBuffer = typeof ArrayBuffer === \"function\";\nconst isView = (obj) => {\n    return typeof ArrayBuffer.isView === \"function\"\n        ? ArrayBuffer.isView(obj)\n        : obj.buffer instanceof ArrayBuffer;\n};\nconst toString = Object.prototype.toString;\nconst withNativeBlob = typeof Blob === \"function\" ||\n    (typeof Blob !== \"undefined\" &&\n        toString.call(Blob) === \"[object BlobConstructor]\");\nconst withNativeFile = typeof File === \"function\" ||\n    (typeof File !== \"undefined\" &&\n        toString.call(File) === \"[object FileConstructor]\");\n/**\n * Returns true if obj is a Buffer, an ArrayBuffer, a Blob or a File.\n *\n * @private\n */\nexport function isBinary(obj) {\n    return ((withNativeArrayBuffer && (obj instanceof ArrayBuffer || isView(obj))) ||\n        (withNativeBlob && obj instanceof Blob) ||\n        (withNativeFile && obj instanceof File));\n}\nexport function hasBinary(obj, toJSON) {\n    if (!obj || typeof obj !== \"object\") {\n        return false;\n    }\n    if (Array.isArray(obj)) {\n        for (let i = 0, l = obj.length; i < l; i++) {\n            if (hasBinary(obj[i])) {\n                return true;\n            }\n        }\n        return false;\n    }\n    if (isBinary(obj)) {\n        return true;\n    }\n    if (obj.toJSON &&\n        typeof obj.toJSON === \"function\" &&\n        arguments.length === 1) {\n        return hasBinary(obj.toJSON(), true);\n    }\n    for (const key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key) && hasBinary(obj[key])) {\n            return true;\n        }\n    }\n    return false;\n}\n","import { isBinary } from \"./is-binary.js\";\n/**\n * Replaces every Buffer | ArrayBuffer | Blob | File in packet with a numbered placeholder.\n *\n * @param {Object} packet - socket.io event packet\n * @return {Object} with deconstructed packet and list of buffers\n * @public\n */\nexport function deconstructPacket(packet) {\n    const buffers = [];\n    const packetData = packet.data;\n    const pack = packet;\n    pack.data = _deconstructPacket(packetData, buffers);\n    pack.attachments = buffers.length; // number of binary 'attachments'\n    return { packet: pack, buffers: buffers };\n}\nfunction _deconstructPacket(data, buffers) {\n    if (!data)\n        return data;\n    if (isBinary(data)) {\n        const placeholder = { _placeholder: true, num: buffers.length };\n        buffers.push(data);\n        return placeholder;\n    }\n    else if (Array.isArray(data)) {\n        const newData = new Array(data.length);\n        for (let i = 0; i < data.length; i++) {\n            newData[i] = _deconstructPacket(data[i], buffers);\n        }\n        return newData;\n    }\n    else if (typeof data === \"object\" && !(data instanceof Date)) {\n        const newData = {};\n        for (const key in data) {\n            if (Object.prototype.hasOwnProperty.call(data, key)) {\n                newData[key] = _deconstructPacket(data[key], buffers);\n            }\n        }\n        return newData;\n    }\n    return data;\n}\n/**\n * Reconstructs a binary packet from its placeholder packet and buffers\n *\n * @param {Object} packet - event packet with placeholders\n * @param {Array} buffers - binary buffers to put in placeholder positions\n * @return {Object} reconstructed packet\n * @public\n */\nexport function reconstructPacket(packet, buffers) {\n    packet.data = _reconstructPacket(packet.data, buffers);\n    delete packet.attachments; // no longer useful\n    return packet;\n}\nfunction _reconstructPacket(data, buffers) {\n    if (!data)\n        return data;\n    if (data && data._placeholder === true) {\n        const isIndexValid = typeof data.num === \"number\" &&\n            data.num >= 0 &&\n            data.num < buffers.length;\n        if (isIndexValid) {\n            return buffers[data.num]; // appropriate buffer (should be natural order anyway)\n        }\n        else {\n            throw new Error(\"illegal attachments\");\n        }\n    }\n    else if (Array.isArray(data)) {\n        for (let i = 0; i < data.length; i++) {\n            data[i] = _reconstructPacket(data[i], buffers);\n        }\n    }\n    else if (typeof data === \"object\") {\n        for (const key in data) {\n            if (Object.prototype.hasOwnProperty.call(data, key)) {\n                data[key] = _reconstructPacket(data[key], buffers);\n            }\n        }\n    }\n    return data;\n}\n","import { Emitter } from \"@socket.io/component-emitter\";\nimport { deconstructPacket, reconstructPacket } from \"./binary.js\";\nimport { isBinary, hasBinary } from \"./is-binary.js\";\n/**\n * These strings must not be used as event names, as they have a special meaning.\n */\nconst RESERVED_EVENTS = [\n    \"connect\",\n    \"connect_error\",\n    \"disconnect\",\n    \"disconnecting\",\n    \"newListener\",\n    \"removeListener\", // used by the Node.js EventEmitter\n];\n/**\n * Protocol version.\n *\n * @public\n */\nexport const protocol = 5;\nexport var PacketType;\n(function (PacketType) {\n    PacketType[PacketType[\"CONNECT\"] = 0] = \"CONNECT\";\n    PacketType[PacketType[\"DISCONNECT\"] = 1] = \"DISCONNECT\";\n    PacketType[PacketType[\"EVENT\"] = 2] = \"EVENT\";\n    PacketType[PacketType[\"ACK\"] = 3] = \"ACK\";\n    PacketType[PacketType[\"CONNECT_ERROR\"] = 4] = \"CONNECT_ERROR\";\n    PacketType[PacketType[\"BINARY_EVENT\"] = 5] = \"BINARY_EVENT\";\n    PacketType[PacketType[\"BINARY_ACK\"] = 6] = \"BINARY_ACK\";\n})(PacketType || (PacketType = {}));\n/**\n * A socket.io Encoder instance\n */\nexport class Encoder {\n    /**\n     * Encoder constructor\n     *\n     * @param {function} replacer - custom replacer to pass down to JSON.parse\n     */\n    constructor(replacer) {\n        this.replacer = replacer;\n    }\n    /**\n     * Encode a packet as a single string if non-binary, or as a\n     * buffer sequence, depending on packet type.\n     *\n     * @param {Object} obj - packet object\n     */\n    encode(obj) {\n        if (obj.type === PacketType.EVENT || obj.type === PacketType.ACK) {\n            if (hasBinary(obj)) {\n                return this.encodeAsBinary({\n                    type: obj.type === PacketType.EVENT\n                        ? PacketType.BINARY_EVENT\n                        : PacketType.BINARY_ACK,\n                    nsp: obj.nsp,\n                    data: obj.data,\n                    id: obj.id,\n                });\n            }\n        }\n        return [this.encodeAsString(obj)];\n    }\n    /**\n     * Encode packet as string.\n     */\n    encodeAsString(obj) {\n        // first is type\n        let str = \"\" + obj.type;\n        // attachments if we have them\n        if (obj.type === PacketType.BINARY_EVENT ||\n            obj.type === PacketType.BINARY_ACK) {\n            str += obj.attachments + \"-\";\n        }\n        // if we have a namespace other than `/`\n        // we append it followed by a comma `,`\n        if (obj.nsp && \"/\" !== obj.nsp) {\n            str += obj.nsp + \",\";\n        }\n        // immediately followed by the id\n        if (null != obj.id) {\n            str += obj.id;\n        }\n        // json data\n        if (null != obj.data) {\n            str += JSON.stringify(obj.data, this.replacer);\n        }\n        return str;\n    }\n    /**\n     * Encode packet as 'buffer sequence' by removing blobs, and\n     * deconstructing packet into object with placeholders and\n     * a list of buffers.\n     */\n    encodeAsBinary(obj) {\n        const deconstruction = deconstructPacket(obj);\n        const pack = this.encodeAsString(deconstruction.packet);\n        const buffers = deconstruction.buffers;\n        buffers.unshift(pack); // add packet info to beginning of data list\n        return buffers; // write all the buffers\n    }\n}\n// see https://stackoverflow.com/questions/8511281/check-if-a-value-is-an-object-in-javascript\nfunction isObject(value) {\n    return Object.prototype.toString.call(value) === \"[object Object]\";\n}\n/**\n * A socket.io Decoder instance\n *\n * @return {Object} decoder\n */\nexport class Decoder extends Emitter {\n    /**\n     * Decoder constructor\n     *\n     * @param {function} reviver - custom reviver to pass down to JSON.stringify\n     */\n    constructor(reviver) {\n        super();\n        this.reviver = reviver;\n    }\n    /**\n     * Decodes an encoded packet string into packet JSON.\n     *\n     * @param {String} obj - encoded packet\n     */\n    add(obj) {\n        let packet;\n        if (typeof obj === \"string\") {\n            if (this.reconstructor) {\n                throw new Error(\"got plaintext data when reconstructing a packet\");\n            }\n            packet = this.decodeString(obj);\n            const isBinaryEvent = packet.type === PacketType.BINARY_EVENT;\n            if (isBinaryEvent || packet.type === PacketType.BINARY_ACK) {\n                packet.type = isBinaryEvent ? PacketType.EVENT : PacketType.ACK;\n                // binary packet's json\n                this.reconstructor = new BinaryReconstructor(packet);\n                // no attachments, labeled binary but no binary data to follow\n                if (packet.attachments === 0) {\n                    super.emitReserved(\"decoded\", packet);\n                }\n            }\n            else {\n                // non-binary full packet\n                super.emitReserved(\"decoded\", packet);\n            }\n        }\n        else if (isBinary(obj) || obj.base64) {\n            // raw binary data\n            if (!this.reconstructor) {\n                throw new Error(\"got binary data when not reconstructing a packet\");\n            }\n            else {\n                packet = this.reconstructor.takeBinaryData(obj);\n                if (packet) {\n                    // received final buffer\n                    this.reconstructor = null;\n                    super.emitReserved(\"decoded\", packet);\n                }\n            }\n        }\n        else {\n            throw new Error(\"Unknown type: \" + obj);\n        }\n    }\n    /**\n     * Decode a packet String (JSON data)\n     *\n     * @param {String} str\n     * @return {Object} packet\n     */\n    decodeString(str) {\n        let i = 0;\n        // look up type\n        const p = {\n            type: Number(str.charAt(0)),\n        };\n        if (PacketType[p.type] === undefined) {\n            throw new Error(\"unknown packet type \" + p.type);\n        }\n        // look up attachments if type binary\n        if (p.type === PacketType.BINARY_EVENT ||\n            p.type === PacketType.BINARY_ACK) {\n            const start = i + 1;\n            while (str.charAt(++i) !== \"-\" && i != str.length) { }\n            const buf = str.substring(start, i);\n            if (buf != Number(buf) || str.charAt(i) !== \"-\") {\n                throw new Error(\"Illegal attachments\");\n            }\n            p.attachments = Number(buf);\n        }\n        // look up namespace (if any)\n        if (\"/\" === str.charAt(i + 1)) {\n            const start = i + 1;\n            while (++i) {\n                const c = str.charAt(i);\n                if (\",\" === c)\n                    break;\n                if (i === str.length)\n                    break;\n            }\n            p.nsp = str.substring(start, i);\n        }\n        else {\n            p.nsp = \"/\";\n        }\n        // look up id\n        const next = str.charAt(i + 1);\n        if (\"\" !== next && Number(next) == next) {\n            const start = i + 1;\n            while (++i) {\n                const c = str.charAt(i);\n                if (null == c || Number(c) != c) {\n                    --i;\n                    break;\n                }\n                if (i === str.length)\n                    break;\n            }\n            p.id = Number(str.substring(start, i + 1));\n        }\n        // look up json data\n        if (str.charAt(++i)) {\n            const payload = this.tryParse(str.substr(i));\n            if (Decoder.isPayloadValid(p.type, payload)) {\n                p.data = payload;\n            }\n            else {\n                throw new Error(\"invalid payload\");\n            }\n        }\n        return p;\n    }\n    tryParse(str) {\n        try {\n            return JSON.parse(str, this.reviver);\n        }\n        catch (e) {\n            return false;\n        }\n    }\n    static isPayloadValid(type, payload) {\n        switch (type) {\n            case PacketType.CONNECT:\n                return isObject(payload);\n            case PacketType.DISCONNECT:\n                return payload === undefined;\n            case PacketType.CONNECT_ERROR:\n                return typeof payload === \"string\" || isObject(payload);\n            case PacketType.EVENT:\n            case PacketType.BINARY_EVENT:\n                return (Array.isArray(payload) &&\n                    (typeof payload[0] === \"number\" ||\n                        (typeof payload[0] === \"string\" &&\n                            RESERVED_EVENTS.indexOf(payload[0]) === -1)));\n            case PacketType.ACK:\n            case PacketType.BINARY_ACK:\n                return Array.isArray(payload);\n        }\n    }\n    /**\n     * Deallocates a parser's resources\n     */\n    destroy() {\n        if (this.reconstructor) {\n            this.reconstructor.finishedReconstruction();\n            this.reconstructor = null;\n        }\n    }\n}\n/**\n * A manager of a binary event's 'buffer sequence'. Should\n * be constructed whenever a packet of type BINARY_EVENT is\n * decoded.\n *\n * @param {Object} packet\n * @return {BinaryReconstructor} initialized reconstructor\n */\nclass BinaryReconstructor {\n    constructor(packet) {\n        this.packet = packet;\n        this.buffers = [];\n        this.reconPack = packet;\n    }\n    /**\n     * Method to be called when binary data received from connection\n     * after a BINARY_EVENT packet.\n     *\n     * @param {Buffer | ArrayBuffer} binData - the raw binary data received\n     * @return {null | Object} returns null if more binary data is expected or\n     *   a reconstructed packet object if all buffers have been received.\n     */\n    takeBinaryData(binData) {\n        this.buffers.push(binData);\n        if (this.buffers.length === this.reconPack.attachments) {\n            // done with buffer list\n            const packet = reconstructPacket(this.reconPack, this.buffers);\n            this.finishedReconstruction();\n            return packet;\n        }\n        return null;\n    }\n    /**\n     * Cleans up binary packet reconstruction variables.\n     */\n    finishedReconstruction() {\n        this.reconPack = null;\n        this.buffers = [];\n    }\n}\n","export function on(obj, ev, fn) {\n    obj.on(ev, fn);\n    return function subDestroy() {\n        obj.off(ev, fn);\n    };\n}\n","import { PacketType } from \"socket.io-parser\";\nimport { on } from \"./on.js\";\nimport { Emitter, } from \"@socket.io/component-emitter\";\n/**\n * Internal events.\n * These events can't be emitted by the user.\n */\nconst RESERVED_EVENTS = Object.freeze({\n    connect: 1,\n    connect_error: 1,\n    disconnect: 1,\n    disconnecting: 1,\n    // EventEmitter reserved events: https://nodejs.org/api/events.html#events_event_newlistener\n    newListener: 1,\n    removeListener: 1,\n});\n/**\n * A Socket is the fundamental class for interacting with the server.\n *\n * A Socket belongs to a certain Namespace (by default /) and uses an underlying {@link Manager} to communicate.\n *\n * @example\n * const socket = io();\n *\n * socket.on(\"connect\", () => {\n *   console.log(\"connected\");\n * });\n *\n * // send an event to the server\n * socket.emit(\"foo\", \"bar\");\n *\n * socket.on(\"foobar\", () => {\n *   // an event was received from the server\n * });\n *\n * // upon disconnection\n * socket.on(\"disconnect\", (reason) => {\n *   console.log(`disconnected due to ${reason}`);\n * });\n */\nexport class Socket extends Emitter {\n    /**\n     * `Socket` constructor.\n     */\n    constructor(io, nsp, opts) {\n        super();\n        /**\n         * Whether the socket is currently connected to the server.\n         *\n         * @example\n         * const socket = io();\n         *\n         * socket.on(\"connect\", () => {\n         *   console.log(socket.connected); // true\n         * });\n         *\n         * socket.on(\"disconnect\", () => {\n         *   console.log(socket.connected); // false\n         * });\n         */\n        this.connected = false;\n        /**\n         * Whether the connection state was recovered after a temporary disconnection. In that case, any missed packets will\n         * be transmitted by the server.\n         */\n        this.recovered = false;\n        /**\n         * Buffer for packets received before the CONNECT packet\n         */\n        this.receiveBuffer = [];\n        /**\n         * Buffer for packets that will be sent once the socket is connected\n         */\n        this.sendBuffer = [];\n        /**\n         * The queue of packets to be sent with retry in case of failure.\n         *\n         * Packets are sent one by one, each waiting for the server acknowledgement, in order to guarantee the delivery order.\n         * @private\n         */\n        this._queue = [];\n        /**\n         * A sequence to generate the ID of the {@link QueuedPacket}.\n         * @private\n         */\n        this._queueSeq = 0;\n        this.ids = 0;\n        /**\n         * A map containing acknowledgement handlers.\n         *\n         * The `withError` attribute is used to differentiate handlers that accept an error as first argument:\n         *\n         * - `socket.emit(\"test\", (err, value) => { ... })` with `ackTimeout` option\n         * - `socket.timeout(5000).emit(\"test\", (err, value) => { ... })`\n         * - `const value = await socket.emitWithAck(\"test\")`\n         *\n         * From those that don't:\n         *\n         * - `socket.emit(\"test\", (value) => { ... });`\n         *\n         * In the first case, the handlers will be called with an error when:\n         *\n         * - the timeout is reached\n         * - the socket gets disconnected\n         *\n         * In the second case, the handlers will be simply discarded upon disconnection, since the client will never receive\n         * an acknowledgement from the server.\n         *\n         * @private\n         */\n        this.acks = {};\n        this.flags = {};\n        this.io = io;\n        this.nsp = nsp;\n        if (opts && opts.auth) {\n            this.auth = opts.auth;\n        }\n        this._opts = Object.assign({}, opts);\n        if (this.io._autoConnect)\n            this.open();\n    }\n    /**\n     * Whether the socket is currently disconnected\n     *\n     * @example\n     * const socket = io();\n     *\n     * socket.on(\"connect\", () => {\n     *   console.log(socket.disconnected); // false\n     * });\n     *\n     * socket.on(\"disconnect\", () => {\n     *   console.log(socket.disconnected); // true\n     * });\n     */\n    get disconnected() {\n        return !this.connected;\n    }\n    /**\n     * Subscribe to open, close and packet events\n     *\n     * @private\n     */\n    subEvents() {\n        if (this.subs)\n            return;\n        const io = this.io;\n        this.subs = [\n            on(io, \"open\", this.onopen.bind(this)),\n            on(io, \"packet\", this.onpacket.bind(this)),\n            on(io, \"error\", this.onerror.bind(this)),\n            on(io, \"close\", this.onclose.bind(this)),\n        ];\n    }\n    /**\n     * Whether the Socket will try to reconnect when its Manager connects or reconnects.\n     *\n     * @example\n     * const socket = io();\n     *\n     * console.log(socket.active); // true\n     *\n     * socket.on(\"disconnect\", (reason) => {\n     *   if (reason === \"io server disconnect\") {\n     *     // the disconnection was initiated by the server, you need to manually reconnect\n     *     console.log(socket.active); // false\n     *   }\n     *   // else the socket will automatically try to reconnect\n     *   console.log(socket.active); // true\n     * });\n     */\n    get active() {\n        return !!this.subs;\n    }\n    /**\n     * \"Opens\" the socket.\n     *\n     * @example\n     * const socket = io({\n     *   autoConnect: false\n     * });\n     *\n     * socket.connect();\n     */\n    connect() {\n        if (this.connected)\n            return this;\n        this.subEvents();\n        if (!this.io[\"_reconnecting\"])\n            this.io.open(); // ensure open\n        if (\"open\" === this.io._readyState)\n            this.onopen();\n        return this;\n    }\n    /**\n     * Alias for {@link connect()}.\n     */\n    open() {\n        return this.connect();\n    }\n    /**\n     * Sends a `message` event.\n     *\n     * This method mimics the WebSocket.send() method.\n     *\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/WebSocket/send\n     *\n     * @example\n     * socket.send(\"hello\");\n     *\n     * // this is equivalent to\n     * socket.emit(\"message\", \"hello\");\n     *\n     * @return self\n     */\n    send(...args) {\n        args.unshift(\"message\");\n        this.emit.apply(this, args);\n        return this;\n    }\n    /**\n     * Override `emit`.\n     * If the event is in `events`, it's emitted normally.\n     *\n     * @example\n     * socket.emit(\"hello\", \"world\");\n     *\n     * // all serializable datastructures are supported (no need to call JSON.stringify)\n     * socket.emit(\"hello\", 1, \"2\", { 3: [\"4\"], 5: Uint8Array.from([6]) });\n     *\n     * // with an acknowledgement from the server\n     * socket.emit(\"hello\", \"world\", (val) => {\n     *   // ...\n     * });\n     *\n     * @return self\n     */\n    emit(ev, ...args) {\n        var _a, _b, _c;\n        if (RESERVED_EVENTS.hasOwnProperty(ev)) {\n            throw new Error('\"' + ev.toString() + '\" is a reserved event name');\n        }\n        args.unshift(ev);\n        if (this._opts.retries && !this.flags.fromQueue && !this.flags.volatile) {\n            this._addToQueue(args);\n            return this;\n        }\n        const packet = {\n            type: PacketType.EVENT,\n            data: args,\n        };\n        packet.options = {};\n        packet.options.compress = this.flags.compress !== false;\n        // event ack callback\n        if (\"function\" === typeof args[args.length - 1]) {\n            const id = this.ids++;\n            const ack = args.pop();\n            this._registerAckCallback(id, ack);\n            packet.id = id;\n        }\n        const isTransportWritable = (_b = (_a = this.io.engine) === null || _a === void 0 ? void 0 : _a.transport) === null || _b === void 0 ? void 0 : _b.writable;\n        const isConnected = this.connected && !((_c = this.io.engine) === null || _c === void 0 ? void 0 : _c._hasPingExpired());\n        const discardPacket = this.flags.volatile && !isTransportWritable;\n        if (discardPacket) {\n        }\n        else if (isConnected) {\n            this.notifyOutgoingListeners(packet);\n            this.packet(packet);\n        }\n        else {\n            this.sendBuffer.push(packet);\n        }\n        this.flags = {};\n        return this;\n    }\n    /**\n     * @private\n     */\n    _registerAckCallback(id, ack) {\n        var _a;\n        const timeout = (_a = this.flags.timeout) !== null && _a !== void 0 ? _a : this._opts.ackTimeout;\n        if (timeout === undefined) {\n            this.acks[id] = ack;\n            return;\n        }\n        // @ts-ignore\n        const timer = this.io.setTimeoutFn(() => {\n            delete this.acks[id];\n            for (let i = 0; i < this.sendBuffer.length; i++) {\n                if (this.sendBuffer[i].id === id) {\n                    this.sendBuffer.splice(i, 1);\n                }\n            }\n            ack.call(this, new Error(\"operation has timed out\"));\n        }, timeout);\n        const fn = (...args) => {\n            // @ts-ignore\n            this.io.clearTimeoutFn(timer);\n            ack.apply(this, args);\n        };\n        fn.withError = true;\n        this.acks[id] = fn;\n    }\n    /**\n     * Emits an event and waits for an acknowledgement\n     *\n     * @example\n     * // without timeout\n     * const response = await socket.emitWithAck(\"hello\", \"world\");\n     *\n     * // with a specific timeout\n     * try {\n     *   const response = await socket.timeout(1000).emitWithAck(\"hello\", \"world\");\n     * } catch (err) {\n     *   // the server did not acknowledge the event in the given delay\n     * }\n     *\n     * @return a Promise that will be fulfilled when the server acknowledges the event\n     */\n    emitWithAck(ev, ...args) {\n        return new Promise((resolve, reject) => {\n            const fn = (arg1, arg2) => {\n                return arg1 ? reject(arg1) : resolve(arg2);\n            };\n            fn.withError = true;\n            args.push(fn);\n            this.emit(ev, ...args);\n        });\n    }\n    /**\n     * Add the packet to the queue.\n     * @param args\n     * @private\n     */\n    _addToQueue(args) {\n        let ack;\n        if (typeof args[args.length - 1] === \"function\") {\n            ack = args.pop();\n        }\n        const packet = {\n            id: this._queueSeq++,\n            tryCount: 0,\n            pending: false,\n            args,\n            flags: Object.assign({ fromQueue: true }, this.flags),\n        };\n        args.push((err, ...responseArgs) => {\n            if (packet !== this._queue[0]) {\n                // the packet has already been acknowledged\n                return;\n            }\n            const hasError = err !== null;\n            if (hasError) {\n                if (packet.tryCount > this._opts.retries) {\n                    this._queue.shift();\n                    if (ack) {\n                        ack(err);\n                    }\n                }\n            }\n            else {\n                this._queue.shift();\n                if (ack) {\n                    ack(null, ...responseArgs);\n                }\n            }\n            packet.pending = false;\n            return this._drainQueue();\n        });\n        this._queue.push(packet);\n        this._drainQueue();\n    }\n    /**\n     * Send the first packet of the queue, and wait for an acknowledgement from the server.\n     * @param force - whether to resend a packet that has not been acknowledged yet\n     *\n     * @private\n     */\n    _drainQueue(force = false) {\n        if (!this.connected || this._queue.length === 0) {\n            return;\n        }\n        const packet = this._queue[0];\n        if (packet.pending && !force) {\n            return;\n        }\n        packet.pending = true;\n        packet.tryCount++;\n        this.flags = packet.flags;\n        this.emit.apply(this, packet.args);\n    }\n    /**\n     * Sends a packet.\n     *\n     * @param packet\n     * @private\n     */\n    packet(packet) {\n        packet.nsp = this.nsp;\n        this.io._packet(packet);\n    }\n    /**\n     * Called upon engine `open`.\n     *\n     * @private\n     */\n    onopen() {\n        if (typeof this.auth == \"function\") {\n            this.auth((data) => {\n                this._sendConnectPacket(data);\n            });\n        }\n        else {\n            this._sendConnectPacket(this.auth);\n        }\n    }\n    /**\n     * Sends a CONNECT packet to initiate the Socket.IO session.\n     *\n     * @param data\n     * @private\n     */\n    _sendConnectPacket(data) {\n        this.packet({\n            type: PacketType.CONNECT,\n            data: this._pid\n                ? Object.assign({ pid: this._pid, offset: this._lastOffset }, data)\n                : data,\n        });\n    }\n    /**\n     * Called upon engine or manager `error`.\n     *\n     * @param err\n     * @private\n     */\n    onerror(err) {\n        if (!this.connected) {\n            this.emitReserved(\"connect_error\", err);\n        }\n    }\n    /**\n     * Called upon engine `close`.\n     *\n     * @param reason\n     * @param description\n     * @private\n     */\n    onclose(reason, description) {\n        this.connected = false;\n        delete this.id;\n        this.emitReserved(\"disconnect\", reason, description);\n        this._clearAcks();\n    }\n    /**\n     * Clears the acknowledgement handlers upon disconnection, since the client will never receive an acknowledgement from\n     * the server.\n     *\n     * @private\n     */\n    _clearAcks() {\n        Object.keys(this.acks).forEach((id) => {\n            const isBuffered = this.sendBuffer.some((packet) => String(packet.id) === id);\n            if (!isBuffered) {\n                // note: handlers that do not accept an error as first argument are ignored here\n                const ack = this.acks[id];\n                delete this.acks[id];\n                if (ack.withError) {\n                    ack.call(this, new Error(\"socket has been disconnected\"));\n                }\n            }\n        });\n    }\n    /**\n     * Called with socket packet.\n     *\n     * @param packet\n     * @private\n     */\n    onpacket(packet) {\n        const sameNamespace = packet.nsp === this.nsp;\n        if (!sameNamespace)\n            return;\n        switch (packet.type) {\n            case PacketType.CONNECT:\n                if (packet.data && packet.data.sid) {\n                    this.onconnect(packet.data.sid, packet.data.pid);\n                }\n                else {\n                    this.emitReserved(\"connect_error\", new Error(\"It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)\"));\n                }\n                break;\n            case PacketType.EVENT:\n            case PacketType.BINARY_EVENT:\n                this.onevent(packet);\n                break;\n            case PacketType.ACK:\n            case PacketType.BINARY_ACK:\n                this.onack(packet);\n                break;\n            case PacketType.DISCONNECT:\n                this.ondisconnect();\n                break;\n            case PacketType.CONNECT_ERROR:\n                this.destroy();\n                const err = new Error(packet.data.message);\n                // @ts-ignore\n                err.data = packet.data.data;\n                this.emitReserved(\"connect_error\", err);\n                break;\n        }\n    }\n    /**\n     * Called upon a server event.\n     *\n     * @param packet\n     * @private\n     */\n    onevent(packet) {\n        const args = packet.data || [];\n        if (null != packet.id) {\n            args.push(this.ack(packet.id));\n        }\n        if (this.connected) {\n            this.emitEvent(args);\n        }\n        else {\n            this.receiveBuffer.push(Object.freeze(args));\n        }\n    }\n    emitEvent(args) {\n        if (this._anyListeners && this._anyListeners.length) {\n            const listeners = this._anyListeners.slice();\n            for (const listener of listeners) {\n                listener.apply(this, args);\n            }\n        }\n        super.emit.apply(this, args);\n        if (this._pid && args.length && typeof args[args.length - 1] === \"string\") {\n            this._lastOffset = args[args.length - 1];\n        }\n    }\n    /**\n     * Produces an ack callback to emit with an event.\n     *\n     * @private\n     */\n    ack(id) {\n        const self = this;\n        let sent = false;\n        return function (...args) {\n            // prevent double callbacks\n            if (sent)\n                return;\n            sent = true;\n            self.packet({\n                type: PacketType.ACK,\n                id: id,\n                data: args,\n            });\n        };\n    }\n    /**\n     * Called upon a server acknowledgement.\n     *\n     * @param packet\n     * @private\n     */\n    onack(packet) {\n        const ack = this.acks[packet.id];\n        if (typeof ack !== \"function\") {\n            return;\n        }\n        delete this.acks[packet.id];\n        // @ts-ignore FIXME ack is incorrectly inferred as 'never'\n        if (ack.withError) {\n            packet.data.unshift(null);\n        }\n        // @ts-ignore\n        ack.apply(this, packet.data);\n    }\n    /**\n     * Called upon server connect.\n     *\n     * @private\n     */\n    onconnect(id, pid) {\n        this.id = id;\n        this.recovered = pid && this._pid === pid;\n        this._pid = pid; // defined only if connection state recovery is enabled\n        this.connected = true;\n        this.emitBuffered();\n        this.emitReserved(\"connect\");\n        this._drainQueue(true);\n    }\n    /**\n     * Emit buffered events (received and emitted).\n     *\n     * @private\n     */\n    emitBuffered() {\n        this.receiveBuffer.forEach((args) => this.emitEvent(args));\n        this.receiveBuffer = [];\n        this.sendBuffer.forEach((packet) => {\n            this.notifyOutgoingListeners(packet);\n            this.packet(packet);\n        });\n        this.sendBuffer = [];\n    }\n    /**\n     * Called upon server disconnect.\n     *\n     * @private\n     */\n    ondisconnect() {\n        this.destroy();\n        this.onclose(\"io server disconnect\");\n    }\n    /**\n     * Called upon forced client/server side disconnections,\n     * this method ensures the manager stops tracking us and\n     * that reconnections don't get triggered for this.\n     *\n     * @private\n     */\n    destroy() {\n        if (this.subs) {\n            // clean subscriptions to avoid reconnections\n            this.subs.forEach((subDestroy) => subDestroy());\n            this.subs = undefined;\n        }\n        this.io[\"_destroy\"](this);\n    }\n    /**\n     * Disconnects the socket manually. In that case, the socket will not try to reconnect.\n     *\n     * If this is the last active Socket instance of the {@link Manager}, the low-level connection will be closed.\n     *\n     * @example\n     * const socket = io();\n     *\n     * socket.on(\"disconnect\", (reason) => {\n     *   // console.log(reason); prints \"io client disconnect\"\n     * });\n     *\n     * socket.disconnect();\n     *\n     * @return self\n     */\n    disconnect() {\n        if (this.connected) {\n            this.packet({ type: PacketType.DISCONNECT });\n        }\n        // remove socket from pool\n        this.destroy();\n        if (this.connected) {\n            // fire events\n            this.onclose(\"io client disconnect\");\n        }\n        return this;\n    }\n    /**\n     * Alias for {@link disconnect()}.\n     *\n     * @return self\n     */\n    close() {\n        return this.disconnect();\n    }\n    /**\n     * Sets the compress flag.\n     *\n     * @example\n     * socket.compress(false).emit(\"hello\");\n     *\n     * @param compress - if `true`, compresses the sending data\n     * @return self\n     */\n    compress(compress) {\n        this.flags.compress = compress;\n        return this;\n    }\n    /**\n     * Sets a modifier for a subsequent event emission that the event message will be dropped when this socket is not\n     * ready to send messages.\n     *\n     * @example\n     * socket.volatile.emit(\"hello\"); // the server may or may not receive it\n     *\n     * @returns self\n     */\n    get volatile() {\n        this.flags.volatile = true;\n        return this;\n    }\n    /**\n     * Sets a modifier for a subsequent event emission that the callback will be called with an error when the\n     * given number of milliseconds have elapsed without an acknowledgement from the server:\n     *\n     * @example\n     * socket.timeout(5000).emit(\"my-event\", (err) => {\n     *   if (err) {\n     *     // the server did not acknowledge the event in the given delay\n     *   }\n     * });\n     *\n     * @returns self\n     */\n    timeout(timeout) {\n        this.flags.timeout = timeout;\n        return this;\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback.\n     *\n     * @example\n     * socket.onAny((event, ...args) => {\n     *   console.log(`got ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    onAny(listener) {\n        this._anyListeners = this._anyListeners || [];\n        this._anyListeners.push(listener);\n        return this;\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback. The listener is added to the beginning of the listeners array.\n     *\n     * @example\n     * socket.prependAny((event, ...args) => {\n     *   console.log(`got event ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    prependAny(listener) {\n        this._anyListeners = this._anyListeners || [];\n        this._anyListeners.unshift(listener);\n        return this;\n    }\n    /**\n     * Removes the listener that will be fired when any event is emitted.\n     *\n     * @example\n     * const catchAllListener = (event, ...args) => {\n     *   console.log(`got event ${event}`);\n     * }\n     *\n     * socket.onAny(catchAllListener);\n     *\n     * // remove a specific listener\n     * socket.offAny(catchAllListener);\n     *\n     * // or remove all listeners\n     * socket.offAny();\n     *\n     * @param listener\n     */\n    offAny(listener) {\n        if (!this._anyListeners) {\n            return this;\n        }\n        if (listener) {\n            const listeners = this._anyListeners;\n            for (let i = 0; i < listeners.length; i++) {\n                if (listener === listeners[i]) {\n                    listeners.splice(i, 1);\n                    return this;\n                }\n            }\n        }\n        else {\n            this._anyListeners = [];\n        }\n        return this;\n    }\n    /**\n     * Returns an array of listeners that are listening for any event that is specified. This array can be manipulated,\n     * e.g. to remove listeners.\n     */\n    listenersAny() {\n        return this._anyListeners || [];\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback.\n     *\n     * Note: acknowledgements sent to the server are not included.\n     *\n     * @example\n     * socket.onAnyOutgoing((event, ...args) => {\n     *   console.log(`sent event ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    onAnyOutgoing(listener) {\n        this._anyOutgoingListeners = this._anyOutgoingListeners || [];\n        this._anyOutgoingListeners.push(listener);\n        return this;\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback. The listener is added to the beginning of the listeners array.\n     *\n     * Note: acknowledgements sent to the server are not included.\n     *\n     * @example\n     * socket.prependAnyOutgoing((event, ...args) => {\n     *   console.log(`sent event ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    prependAnyOutgoing(listener) {\n        this._anyOutgoingListeners = this._anyOutgoingListeners || [];\n        this._anyOutgoingListeners.unshift(listener);\n        return this;\n    }\n    /**\n     * Removes the listener that will be fired when any event is emitted.\n     *\n     * @example\n     * const catchAllListener = (event, ...args) => {\n     *   console.log(`sent event ${event}`);\n     * }\n     *\n     * socket.onAnyOutgoing(catchAllListener);\n     *\n     * // remove a specific listener\n     * socket.offAnyOutgoing(catchAllListener);\n     *\n     * // or remove all listeners\n     * socket.offAnyOutgoing();\n     *\n     * @param [listener] - the catch-all listener (optional)\n     */\n    offAnyOutgoing(listener) {\n        if (!this._anyOutgoingListeners) {\n            return this;\n        }\n        if (listener) {\n            const listeners = this._anyOutgoingListeners;\n            for (let i = 0; i < listeners.length; i++) {\n                if (listener === listeners[i]) {\n                    listeners.splice(i, 1);\n                    return this;\n                }\n            }\n        }\n        else {\n            this._anyOutgoingListeners = [];\n        }\n        return this;\n    }\n    /**\n     * Returns an array of listeners that are listening for any event that is specified. This array can be manipulated,\n     * e.g. to remove listeners.\n     */\n    listenersAnyOutgoing() {\n        return this._anyOutgoingListeners || [];\n    }\n    /**\n     * Notify the listeners for each packet sent\n     *\n     * @param packet\n     *\n     * @private\n     */\n    notifyOutgoingListeners(packet) {\n        if (this._anyOutgoingListeners && this._anyOutgoingListeners.length) {\n            const listeners = this._anyOutgoingListeners.slice();\n            for (const listener of listeners) {\n                listener.apply(this, packet.data);\n            }\n        }\n    }\n}\n","/**\n * Initialize backoff timer with `opts`.\n *\n * - `min` initial timeout in milliseconds [100]\n * - `max` max timeout [10000]\n * - `jitter` [0]\n * - `factor` [2]\n *\n * @param {Object} opts\n * @api public\n */\nexport function Backoff(opts) {\n    opts = opts || {};\n    this.ms = opts.min || 100;\n    this.max = opts.max || 10000;\n    this.factor = opts.factor || 2;\n    this.jitter = opts.jitter > 0 && opts.jitter <= 1 ? opts.jitter : 0;\n    this.attempts = 0;\n}\n/**\n * Return the backoff duration.\n *\n * @return {Number}\n * @api public\n */\nBackoff.prototype.duration = function () {\n    var ms = this.ms * Math.pow(this.factor, this.attempts++);\n    if (this.jitter) {\n        var rand = Math.random();\n        var deviation = Math.floor(rand * this.jitter * ms);\n        ms = (Math.floor(rand * 10) & 1) == 0 ? ms - deviation : ms + deviation;\n    }\n    return Math.min(ms, this.max) | 0;\n};\n/**\n * Reset the number of attempts.\n *\n * @api public\n */\nBackoff.prototype.reset = function () {\n    this.attempts = 0;\n};\n/**\n * Set the minimum duration\n *\n * @api public\n */\nBackoff.prototype.setMin = function (min) {\n    this.ms = min;\n};\n/**\n * Set the maximum duration\n *\n * @api public\n */\nBackoff.prototype.setMax = function (max) {\n    this.max = max;\n};\n/**\n * Set the jitter\n *\n * @api public\n */\nBackoff.prototype.setJitter = function (jitter) {\n    this.jitter = jitter;\n};\n","import { Socket as Engine, installTimerFunctions, nextTick, } from \"engine.io-client\";\nimport { Socket } from \"./socket.js\";\nimport * as parser from \"socket.io-parser\";\nimport { on } from \"./on.js\";\nimport { Backoff } from \"./contrib/backo2.js\";\nimport { Emitter, } from \"@socket.io/component-emitter\";\nexport class Manager extends Emitter {\n    constructor(uri, opts) {\n        var _a;\n        super();\n        this.nsps = {};\n        this.subs = [];\n        if (uri && \"object\" === typeof uri) {\n            opts = uri;\n            uri = undefined;\n        }\n        opts = opts || {};\n        opts.path = opts.path || \"/socket.io\";\n        this.opts = opts;\n        installTimerFunctions(this, opts);\n        this.reconnection(opts.reconnection !== false);\n        this.reconnectionAttempts(opts.reconnectionAttempts || Infinity);\n        this.reconnectionDelay(opts.reconnectionDelay || 1000);\n        this.reconnectionDelayMax(opts.reconnectionDelayMax || 5000);\n        this.randomizationFactor((_a = opts.randomizationFactor) !== null && _a !== void 0 ? _a : 0.5);\n        this.backoff = new Backoff({\n            min: this.reconnectionDelay(),\n            max: this.reconnectionDelayMax(),\n            jitter: this.randomizationFactor(),\n        });\n        this.timeout(null == opts.timeout ? 20000 : opts.timeout);\n        this._readyState = \"closed\";\n        this.uri = uri;\n        const _parser = opts.parser || parser;\n        this.encoder = new _parser.Encoder();\n        this.decoder = new _parser.Decoder();\n        this._autoConnect = opts.autoConnect !== false;\n        if (this._autoConnect)\n            this.open();\n    }\n    reconnection(v) {\n        if (!arguments.length)\n            return this._reconnection;\n        this._reconnection = !!v;\n        if (!v) {\n            this.skipReconnect = true;\n        }\n        return this;\n    }\n    reconnectionAttempts(v) {\n        if (v === undefined)\n            return this._reconnectionAttempts;\n        this._reconnectionAttempts = v;\n        return this;\n    }\n    reconnectionDelay(v) {\n        var _a;\n        if (v === undefined)\n            return this._reconnectionDelay;\n        this._reconnectionDelay = v;\n        (_a = this.backoff) === null || _a === void 0 ? void 0 : _a.setMin(v);\n        return this;\n    }\n    randomizationFactor(v) {\n        var _a;\n        if (v === undefined)\n            return this._randomizationFactor;\n        this._randomizationFactor = v;\n        (_a = this.backoff) === null || _a === void 0 ? void 0 : _a.setJitter(v);\n        return this;\n    }\n    reconnectionDelayMax(v) {\n        var _a;\n        if (v === undefined)\n            return this._reconnectionDelayMax;\n        this._reconnectionDelayMax = v;\n        (_a = this.backoff) === null || _a === void 0 ? void 0 : _a.setMax(v);\n        return this;\n    }\n    timeout(v) {\n        if (!arguments.length)\n            return this._timeout;\n        this._timeout = v;\n        return this;\n    }\n    /**\n     * Starts trying to reconnect if reconnection is enabled and we have not\n     * started reconnecting yet\n     *\n     * @private\n     */\n    maybeReconnectOnOpen() {\n        // Only try to reconnect if it's the first time we're connecting\n        if (!this._reconnecting &&\n            this._reconnection &&\n            this.backoff.attempts === 0) {\n            // keeps reconnection from firing twice for the same reconnection loop\n            this.reconnect();\n        }\n    }\n    /**\n     * Sets the current transport `socket`.\n     *\n     * @param {Function} fn - optional, callback\n     * @return self\n     * @public\n     */\n    open(fn) {\n        if (~this._readyState.indexOf(\"open\"))\n            return this;\n        this.engine = new Engine(this.uri, this.opts);\n        const socket = this.engine;\n        const self = this;\n        this._readyState = \"opening\";\n        this.skipReconnect = false;\n        // emit `open`\n        const openSubDestroy = on(socket, \"open\", function () {\n            self.onopen();\n            fn && fn();\n        });\n        const onError = (err) => {\n            this.cleanup();\n            this._readyState = \"closed\";\n            this.emitReserved(\"error\", err);\n            if (fn) {\n                fn(err);\n            }\n            else {\n                // Only do this if there is no fn to handle the error\n                this.maybeReconnectOnOpen();\n            }\n        };\n        // emit `error`\n        const errorSub = on(socket, \"error\", onError);\n        if (false !== this._timeout) {\n            const timeout = this._timeout;\n            // set timer\n            const timer = this.setTimeoutFn(() => {\n                openSubDestroy();\n                onError(new Error(\"timeout\"));\n                socket.close();\n            }, timeout);\n            if (this.opts.autoUnref) {\n                timer.unref();\n            }\n            this.subs.push(() => {\n                this.clearTimeoutFn(timer);\n            });\n        }\n        this.subs.push(openSubDestroy);\n        this.subs.push(errorSub);\n        return this;\n    }\n    /**\n     * Alias for open()\n     *\n     * @return self\n     * @public\n     */\n    connect(fn) {\n        return this.open(fn);\n    }\n    /**\n     * Called upon transport open.\n     *\n     * @private\n     */\n    onopen() {\n        // clear old subs\n        this.cleanup();\n        // mark as open\n        this._readyState = \"open\";\n        this.emitReserved(\"open\");\n        // add new subs\n        const socket = this.engine;\n        this.subs.push(on(socket, \"ping\", this.onping.bind(this)), on(socket, \"data\", this.ondata.bind(this)), on(socket, \"error\", this.onerror.bind(this)), on(socket, \"close\", this.onclose.bind(this)), \n        // @ts-ignore\n        on(this.decoder, \"decoded\", this.ondecoded.bind(this)));\n    }\n    /**\n     * Called upon a ping.\n     *\n     * @private\n     */\n    onping() {\n        this.emitReserved(\"ping\");\n    }\n    /**\n     * Called with data.\n     *\n     * @private\n     */\n    ondata(data) {\n        try {\n            this.decoder.add(data);\n        }\n        catch (e) {\n            this.onclose(\"parse error\", e);\n        }\n    }\n    /**\n     * Called when parser fully decodes a packet.\n     *\n     * @private\n     */\n    ondecoded(packet) {\n        // the nextTick call prevents an exception in a user-provided event listener from triggering a disconnection due to a \"parse error\"\n        nextTick(() => {\n            this.emitReserved(\"packet\", packet);\n        }, this.setTimeoutFn);\n    }\n    /**\n     * Called upon socket error.\n     *\n     * @private\n     */\n    onerror(err) {\n        this.emitReserved(\"error\", err);\n    }\n    /**\n     * Creates a new socket for the given `nsp`.\n     *\n     * @return {Socket}\n     * @public\n     */\n    socket(nsp, opts) {\n        let socket = this.nsps[nsp];\n        if (!socket) {\n            socket = new Socket(this, nsp, opts);\n            this.nsps[nsp] = socket;\n        }\n        else if (this._autoConnect && !socket.active) {\n            socket.connect();\n        }\n        return socket;\n    }\n    /**\n     * Called upon a socket close.\n     *\n     * @param socket\n     * @private\n     */\n    _destroy(socket) {\n        const nsps = Object.keys(this.nsps);\n        for (const nsp of nsps) {\n            const socket = this.nsps[nsp];\n            if (socket.active) {\n                return;\n            }\n        }\n        this._close();\n    }\n    /**\n     * Writes a packet.\n     *\n     * @param packet\n     * @private\n     */\n    _packet(packet) {\n        const encodedPackets = this.encoder.encode(packet);\n        for (let i = 0; i < encodedPackets.length; i++) {\n            this.engine.write(encodedPackets[i], packet.options);\n        }\n    }\n    /**\n     * Clean up transport subscriptions and packet buffer.\n     *\n     * @private\n     */\n    cleanup() {\n        this.subs.forEach((subDestroy) => subDestroy());\n        this.subs.length = 0;\n        this.decoder.destroy();\n    }\n    /**\n     * Close the current socket.\n     *\n     * @private\n     */\n    _close() {\n        this.skipReconnect = true;\n        this._reconnecting = false;\n        this.onclose(\"forced close\");\n    }\n    /**\n     * Alias for close()\n     *\n     * @private\n     */\n    disconnect() {\n        return this._close();\n    }\n    /**\n     * Called when:\n     *\n     * - the low-level engine is closed\n     * - the parser encountered a badly formatted packet\n     * - all sockets are disconnected\n     *\n     * @private\n     */\n    onclose(reason, description) {\n        var _a;\n        this.cleanup();\n        (_a = this.engine) === null || _a === void 0 ? void 0 : _a.close();\n        this.backoff.reset();\n        this._readyState = \"closed\";\n        this.emitReserved(\"close\", reason, description);\n        if (this._reconnection && !this.skipReconnect) {\n            this.reconnect();\n        }\n    }\n    /**\n     * Attempt a reconnection.\n     *\n     * @private\n     */\n    reconnect() {\n        if (this._reconnecting || this.skipReconnect)\n            return this;\n        const self = this;\n        if (this.backoff.attempts >= this._reconnectionAttempts) {\n            this.backoff.reset();\n            this.emitReserved(\"reconnect_failed\");\n            this._reconnecting = false;\n        }\n        else {\n            const delay = this.backoff.duration();\n            this._reconnecting = true;\n            const timer = this.setTimeoutFn(() => {\n                if (self.skipReconnect)\n                    return;\n                this.emitReserved(\"reconnect_attempt\", self.backoff.attempts);\n                // check again for the case socket closed in above events\n                if (self.skipReconnect)\n                    return;\n                self.open((err) => {\n                    if (err) {\n                        self._reconnecting = false;\n                        self.reconnect();\n                        this.emitReserved(\"reconnect_error\", err);\n                    }\n                    else {\n                        self.onreconnect();\n                    }\n                });\n            }, delay);\n            if (this.opts.autoUnref) {\n                timer.unref();\n            }\n            this.subs.push(() => {\n                this.clearTimeoutFn(timer);\n            });\n        }\n    }\n    /**\n     * Called upon successful reconnect.\n     *\n     * @private\n     */\n    onreconnect() {\n        const attempt = this.backoff.attempts;\n        this._reconnecting = false;\n        this.backoff.reset();\n        this.emitReserved(\"reconnect\", attempt);\n    }\n}\n","import { url } from \"./url.js\";\nimport { Manager } from \"./manager.js\";\nimport { Socket } from \"./socket.js\";\n/**\n * Managers cache.\n */\nconst cache = {};\nfunction lookup(uri, opts) {\n    if (typeof uri === \"object\") {\n        opts = uri;\n        uri = undefined;\n    }\n    opts = opts || {};\n    const parsed = url(uri, opts.path || \"/socket.io\");\n    const source = parsed.source;\n    const id = parsed.id;\n    const path = parsed.path;\n    const sameNamespace = cache[id] && path in cache[id][\"nsps\"];\n    const newConnection = opts.forceNew ||\n        opts[\"force new connection\"] ||\n        false === opts.multiplex ||\n        sameNamespace;\n    let io;\n    if (newConnection) {\n        io = new Manager(source, opts);\n    }\n    else {\n        if (!cache[id]) {\n            cache[id] = new Manager(source, opts);\n        }\n        io = cache[id];\n    }\n    if (parsed.query && !opts.query) {\n        opts.query = parsed.queryKey;\n    }\n    return io.socket(parsed.path, opts);\n}\n// so that \"lookup\" can be used both as a function (e.g. `io(...)`) and as a\n// namespace (e.g. `io.connect(...)`), for backward compatibility\nObject.assign(lookup, {\n    Manager,\n    Socket,\n    io: lookup,\n    connect: lookup,\n});\n/**\n * Protocol version.\n *\n * @public\n */\nexport { protocol } from \"socket.io-parser\";\n/**\n * Expose constructors for standalone build.\n *\n * @public\n */\nexport { Manager, Socket, lookup as io, lookup as connect, lookup as default, };\nexport { Fetch, NodeXHR, XHR, NodeWebSocket, WebSocket, WebTransport, } from \"engine.io-client\";\n","import { parse } from \"engine.io-client\";\n/**\n * URL parser.\n *\n * @param uri - url\n * @param path - the request path of the connection\n * @param loc - An object meant to mimic window.location.\n *        Defaults to window.location.\n * @public\n */\nexport function url(uri, path = \"\", loc) {\n    let obj = uri;\n    // default to window.location\n    loc = loc || (typeof location !== \"undefined\" && location);\n    if (null == uri)\n        uri = loc.protocol + \"//\" + loc.host;\n    // relative path support\n    if (typeof uri === \"string\") {\n        if (\"/\" === uri.charAt(0)) {\n            if (\"/\" === uri.charAt(1)) {\n                uri = loc.protocol + uri;\n            }\n            else {\n                uri = loc.host + uri;\n            }\n        }\n        if (!/^(https?|wss?):\\/\\//.test(uri)) {\n            if (\"undefined\" !== typeof loc) {\n                uri = loc.protocol + \"//\" + uri;\n            }\n            else {\n                uri = \"https://\" + uri;\n            }\n        }\n        // parse\n        obj = parse(uri);\n    }\n    // make sure we treat `localhost:80` and `localhost` equally\n    if (!obj.port) {\n        if (/^(http|ws)$/.test(obj.protocol)) {\n            obj.port = \"80\";\n        }\n        else if (/^(http|ws)s$/.test(obj.protocol)) {\n            obj.port = \"443\";\n        }\n    }\n    obj.path = obj.path || \"/\";\n    const ipv6 = obj.host.indexOf(\":\") !== -1;\n    const host = ipv6 ? \"[\" + obj.host + \"]\" : obj.host;\n    // define unique id\n    obj.id = obj.protocol + \"://\" + host + \":\" + obj.port + path;\n    // define href\n    obj.href =\n        obj.protocol +\n            \"://\" +\n            host +\n            (loc && loc.port === obj.port ? \"\" : \":\" + obj.port);\n    return obj;\n}\n","// API and Socket configuration\nconst API_URL = import.meta.env.VITE_API_URL || 'http://localhost:3001';\nconst SOCKET_URL = import.meta.env.VITE_SOCKET_URL || 'http://localhost:3001';\n\nexport {\n  API_URL,\n  SOCKET_URL\n};\n","import React, { createContext, useState, useEffect, useContext } from 'react';\nimport { io } from 'socket.io-client';\nimport { SOCKET_URL } from '../config';\nimport { useAuth } from './AuthContext';\n\nconst SocketContext = createContext();\n\nexport const useSocket = () => useContext(SocketContext);\n\nexport const SocketProvider = ({ children }) => {\n  const { token } = useAuth();\n  const [socket, setSocket] = useState(null);\n  const [isConnected, setIsConnected] = useState(false);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    if (typeof window === 'undefined') {\n      return;\n    }\n    if (!token) {\n      if (socket) {\n        socket.disconnect();\n        setSocket(null);\n        setIsConnected(false);\n        setError(null);\n      }\n      return;\n    }\n\n    const newSocket = io(SOCKET_URL, {\n      auth: { token },\n      reconnection: true,\n      reconnectionAttempts: 5,\n      reconnectionDelay: 1000,\n      transports: ['websocket', 'polling'],\n      timeout: 10000\n    });\n\n    setSocket(newSocket);\n\n    newSocket.on('connect', () => {\n      setError(null);\n    });\n    \n    newSocket.on('authenticated', (userData) => {\n      newSocket.auth = {\n        userId: userData.userId,\n        username: userData.username\n      };\n      \n      setIsConnected(true);\n      \n      newSocket.emit('getGameList');\n    });\n\n    newSocket.on('connect_error', (error) => {\n      setError('Failed to connect to game server: ' + error.message);\n      setIsConnected(false);\n    });\n\n    newSocket.on('disconnect', () => {\n      setIsConnected(false);\n    });\n\n    newSocket.on('error', (err) => {\n      setError(err.message || 'Unknown socket error');\n    });\n\n    const socketEvents = [\n      'connect',\n      'authenticated',\n      'disconnect',\n      'connect_error',\n      'error',\n      'transport'\n    ];\n\n    return () => {\n      if (newSocket) {\n        socketEvents.forEach(event => newSocket.off(event));\n        newSocket.disconnect();\n        setSocket(null);\n        setIsConnected(false);\n        setError(null);\n      }\n    };\n\n  }, [token]);\n\n  const value = {\n    socket,\n    isConnected,\n    error,\n    setError\n  };\n\n  return (\n    <SocketContext.Provider value={value}>\n      {children}\n    </SocketContext.Provider>\n  );\n};\n","import React, { useMemo } from 'react';\nimport styles from './CoinIcon.module.css';\n\n/**\n * A reusable coin icon component to replace dollar signs\n * @param {Object} props - Component props\n * @param {string} [props.size='small'] - Size of the coin icon ('small', 'medium', 'large')\n * @param {string} [props.className] - Additional CSS class to apply\n */\nconst CoinIcon = ({ size = 'small', className = '' }) => {\n  const sizeMap = {\n    small: 15,\n    medium: 19,\n    large: 24\n  };\n  \n  const pixelSize = sizeMap[size] || sizeMap.small;\n  \n  // Generate unique IDs for gradients to prevent conflicts\n  const gradientId = useMemo(() => `goldGradient-${Math.random().toString(36).substr(2, 9)}`, []);\n  const shineId = useMemo(() => `goldShine-${Math.random().toString(36).substr(2, 9)}`, []);\n  \n  return (\n    <span className={`${styles.coinIcon} ${styles[size]} ${className}`}>\n      <svg \n        width={pixelSize} \n        height={pixelSize} \n        viewBox=\"0 0 24 24\" \n        fill=\"none\" \n        xmlns=\"http://www.w3.org/2000/svg\"\n      >\n        {/* Diamond shape with golden gradient */}\n        <defs>\n          <linearGradient id={gradientId} x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\n            <stop offset=\"0%\" stopColor=\"#FFD700\" />\n            <stop offset=\"50%\" stopColor=\"#FFA500\" />\n            <stop offset=\"100%\" stopColor=\"#FF8C00\" />\n          </linearGradient>\n          <linearGradient id={shineId} x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\n            <stop offset=\"0%\" stopColor=\"#FFED4E\" />\n            <stop offset=\"100%\" stopColor=\"#FFD700\" />\n          </linearGradient>\n        </defs>\n        \n        {/* Main diamond shape */}\n        <path \n          d=\"M12 2L22 12L12 22L2 12L12 2Z\" \n          fill={`url(#${gradientId})`}\n          stroke=\"#D4AF37\"\n          strokeWidth=\"0.5\"\n        />\n        \n        {/* Inner shine effect */}\n        <path \n          d=\"M12 5L18 12L12 18L6 12L12 5Z\" \n          fill={`url(#${shineId})`}\n          opacity=\"0.6\"\n        />\n        \n        {/* Top highlight */}\n        <path \n          d=\"M12 2L16 6L12 8L8 6L12 2Z\" \n          fill=\"#FFFACD\"\n          opacity=\"0.7\"\n        />\n      </svg>\n    </span>\n  );\n};\n\nexport default CoinIcon;\n","import React, { createContext, useState, useContext, useEffect, useCallback } from 'react';\nimport { useSocket } from './SocketContext.jsx';\nimport WelcomePopup from '../components/common/WelcomePopup';\nimport { API_URL } from '../config';\n\nconst AuthContext = createContext(null);\n\nexport const AuthProvider = ({ children }) => {\n  const [user, setUser] = useState(null);\n  const [token, setToken] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [showWelcomePopup, setShowWelcomePopup] = useState(false);\n  \n  // Get socket from socket context to listen for balance updates\n  const socketData = useSocket();\n  const socket = socketData?.socket;\n\n  // Listen for balance updates from the server\n  useEffect(() => {\n    if (socket && user) {\n      // Listen for balance updates\n      socket.on('balanceUpdated', (data) => { \n        console.log('[AuthContext] Received balanceUpdated event:', data); \n        if (data && typeof data.balance === 'number') {\n          console.log(`[AuthContext] Updating user balance from ${user?.balance} to ${data.balance}`); \n          // Update user with new balance\n          const updatedUser = {\n            ...user,\n            balance: data.balance\n          };\n          \n          // Update state\n          setUser(updatedUser);\n        } else {\n          console.warn('[AuthContext] Received invalid balance data:', data);\n        }\n      });\n      \n      // Clean up listener on unmount\n      return () => {\n        socket.off('balanceUpdated');\n      };\n    }\n  }, [socket, user]);\n\n  // Function to fetch user data from the /me endpoint\n  const fetchUserData = async (authToken) => {\n    try {\n      // Use the passed token directly\n      if (!authToken) {\n        return null;\n      }\n\n      const response = await fetch(`${API_URL}/auth/me`, {\n        method: 'GET',\n        headers: {\n          'Authorization': `Bearer ${authToken}`, // Use authToken\n          'Content-Type': 'application/json'\n        }\n      });\n      \n      if (!response.ok) {\n        throw new Error('Failed to fetch user data');\n      }\n      \n      const data = await response.json();\n      return data.user;\n    } catch (error) {\n      console.error('[Auth] Error fetching user data:', error);\n      return null;\n    }\n  };\n\n  // Single Effect for Initial Authentication Check\n  useEffect(() => {\n    const initializeAuth = async () => {\n      let currentToken = null;\n      try {\n        currentToken = localStorage.getItem('token');\n        \n        if (currentToken) {\n          setToken(currentToken); \n        }\n      } catch (error) {\n        console.error('[Auth] Error reading token from localStorage:', error);\n        localStorage.removeItem('token'); // Clear potentially corrupted token\n      }\n\n      // Now, decide whether to fetch user data based on the token found\n      if (currentToken) {\n        try {\n          const userData = await fetchUserData(currentToken); \n          if (userData) {\n            setUser(userData); \n          } else {\n            // Fetch failed or returned no data for a valid token\n            console.error('[Auth] Token valid but failed to fetch user data. Logging out.');\n            setUser(null);\n            setToken(null);\n            localStorage.removeItem('token');\n          }\n        } catch (error) {\n          console.error('[Auth] Error during user data fetch. Logging out.', error);\n          setUser(null);\n          setToken(null);\n          localStorage.removeItem('token');\n        } finally {\n          setLoading(false);\n        }\n      } else {\n        setUser(null);\n        setToken(null);\n        setLoading(false);\n      }\n    };\n\n    initializeAuth();\n  }, []); // Empty dependency array ensures it runs only once on mount\n\n  const login = async (userData, newToken) => {\n    if (!userData || !userData.username || !userData.id || typeof userData.balance !== 'number') {\n      console.error('[Auth] Invalid user data:', userData);\n      throw new Error('Invalid user data provided');\n    }\n\n    if (!newToken) {\n      console.error('[Auth] No token provided');\n      throw new Error('No authentication token provided');\n    }\n    \n    try {\n      // Set initial user data for immediate UI feedback\n      const initialUserData = {\n        username: userData.username,\n        id: userData.id,\n        balance: userData.balance\n      };\n      \n      // Store only the token in localStorage\n      setUser(initialUserData);\n      setToken(newToken);\n      localStorage.setItem('token', newToken);\n      \n      // Show welcome popup when user logs in\n      setShowWelcomePopup(true);\n      \n      // Fetch complete user data from /me endpoint\n      const completeUserData = await fetchUserData(newToken);\n      if (completeUserData) {\n        setUser(completeUserData);\n      }\n      \n    } catch (error) {\n      console.error('[Auth] Error during login:', error);\n      throw error;\n    }\n  };\n\n  const logout = useCallback(() => {\n    // Clear state\n    setUser(null);\n    setToken(null);\n    setShowWelcomePopup(false);\n    \n    // Clear localStorage\n    localStorage.removeItem('token');\n  }, []); // Empty dependency array means this function never changes\n\n  // Function to refresh user data from the /me endpoint\n  const refreshUserData = useCallback(async () => {\n    try {\n      // fetchUserData depends on the 'token' state variable\n      const userData = await fetchUserData(token);\n      if (userData) {\n        setUser(userData);\n      } else {\n        console.error('[Auth] Failed to refresh user data. Logging out.');\n        // logout is now stable thanks to useCallback above\n        logout();\n      }\n    } catch (error) { \n      console.error('[Auth] Error during manual refresh. Logging out.', error);\n      logout();\n    }\n  // Add dependencies: token and logout\n  }, [token, logout]);\n\n  if (loading) {\n    return null; // or a loading spinner\n  }\n  \n  const handleCloseWelcomePopup = () => {\n    setShowWelcomePopup(false);\n  };\n\n  return (\n    <AuthContext.Provider value={{ user, token, login, logout, refreshUserData, loading }}>\n      {children}\n      {/* {showWelcomePopup && user && (\n        <WelcomePopup \n          username={user.username} \n          balance={user.balance} \n          onClose={handleCloseWelcomePopup} \n        />\n      )} */}\n    </AuthContext.Provider>\n  );\n};\n\nexport const useAuth = () => {\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n};\n","import { useEffect, useState, useCallback, useRef } from 'react';\n\n/**\n * Custom hook for comprehensive gamepad navigation support\n * Provides 2D spatial navigation, scrollable content support, and modal awareness\n * \n * @param {boolean} isEnabled - Whether gamepad navigation is active\n * @returns {Object} Navigation state and utilities\n */\nexport const useGamepadNavigation = (isEnabled = true) => {\n  const [focusedElement, setFocusedElement] = useState(null);\n  const [navigableElements, setNavigableElements] = useState([]);\n  const [isGamepadConnected, setIsGamepadConnected] = useState(false);\n  const [showFocusIndicator, setShowFocusIndicator] = useState(false);\n  const lastNavigationTime = useRef(0);\n  const buttonStates = useRef({});\n  \n  const registerNavigableElements = useCallback(() => {\n    if (!isEnabled) return;\n    \n    // Find all focusable elements with data-gamepad-focusable attribute AND scrollable containers\n    const allElements = Array.from(\n      document.querySelectorAll('[data-gamepad-focusable=\"true\"]:not([disabled]), [data-gamepad-scrollable=\"true\"]')\n    );\n    \n    // Filter out elements that are hidden or behind modals\n    const visibleElements = allElements.filter(element => {\n      // Check if element is visible\n      const rect = element.getBoundingClientRect();\n      if (rect.width === 0 && rect.height === 0) {\n        // For hidden inputs (like auto-ante toggle), check the parent\n        const parent = element.closest('label') || element.closest('[class*=\"toggle\"]') || element.parentElement;\n        if (parent) {\n          const parentRect = parent.getBoundingClientRect();\n          if (parentRect.width === 0 || parentRect.height === 0) return false;\n        } else {\n          return false;\n        }\n      }\n      \n      // Check if element is behind a modal\n      const modals = document.querySelectorAll('[class*=\"modal\"], [class*=\"Modal\"], [role=\"dialog\"], [class*=\"overlay\"]');\n      if (modals.length > 0) {\n        // Filter to only get actual modal containers (not overlays)\n        const modalContainers = Array.from(modals).filter(modal => {\n          const className = modal.className;\n          // Look for actual modal content containers, not just overlays\n          return className.includes('modal') || className.includes('Modal') || modal.getAttribute('role') === 'dialog';\n        });\n        \n        if (modalContainers.length > 0) {\n          // Sort modals by z-index to find the topmost one\n          const sortedModals = modalContainers.sort((a, b) => {\n            let aZIndex = parseInt(window.getComputedStyle(a).zIndex) || 0;\n            let bZIndex = parseInt(window.getComputedStyle(b).zIndex) || 0;\n            \n            // If z-index is auto/0, check the parent overlay\n            if (aZIndex === 0) {\n              const aOverlay = a.parentElement;\n              if (aOverlay && aOverlay.classList.toString().includes('overlay')) {\n                aZIndex = parseInt(window.getComputedStyle(aOverlay).zIndex) || 0;\n              }\n            }\n            \n            if (bZIndex === 0) {\n              const bOverlay = b.parentElement;\n              if (bOverlay && bOverlay.classList.toString().includes('overlay')) {\n                bZIndex = parseInt(window.getComputedStyle(bOverlay).zIndex) || 0;\n              }\n            }\n            \n            return bZIndex - aZIndex; // Highest z-index first\n          });\n          \n          // Only include elements that are inside the topmost modal\n          const topmostModal = sortedModals[0];\n          return topmostModal && topmostModal.contains(element);\n        }\n      }\n      \n      return true;\n    });\n    \n    setNavigableElements(prevElements => {\n      // Only update if the elements actually changed\n      if (prevElements.length !== visibleElements.length || \n          !prevElements.every((el, i) => el === visibleElements[i])) {\n        return visibleElements;\n      }\n      return prevElements;\n    });\n  }, [isEnabled]);\n\n  const navigateDirection = useCallback((direction) => {\n    const now = Date.now();\n    if (now - lastNavigationTime.current < 150) {\n      return; // Debounce navigation calls\n    }\n    lastNavigationTime.current = now;\n    \n    if (!navigableElements.length) return;\n    \n    // Show focus indicator when navigating\n    setShowFocusIndicator(true);\n    \n    // Always check the actual focused element in the DOM first\n    const actualFocusedElement = document.activeElement;\n    let currentElement = focusedElement;\n    \n    // If the actual focused element is navigable and different from our state, sync it\n    if (actualFocusedElement && \n        actualFocusedElement.getAttribute('data-gamepad-focusable') === 'true' &&\n        navigableElements.includes(actualFocusedElement)) {\n      currentElement = actualFocusedElement;\n      setFocusedElement(actualFocusedElement);\n    }\n    \n    const currentIndex = navigableElements.findIndex(el => el === currentElement);\n    \n    // If no element is currently focused or element not found, start with first element\n    if (currentIndex === -1 || !currentElement) {\n      const firstElement = navigableElements[0];\n      setFocusedElement(firstElement);\n      firstElement.focus();\n      return;\n    }\n    \n    // Handle scrollable content before spatial navigation\n    const currentElem = navigableElements[currentIndex];\n    const isScrollable = currentElem?.getAttribute('data-gamepad-scrollable') === 'true';\n    \n    if (isScrollable && (direction === 'up' || direction === 'down')) {\n      const scrollAmount = 50;\n      const isAtTop = currentElem.scrollTop <= 0;\n      const isAtBottom = currentElem.scrollTop >= currentElem.scrollHeight - currentElem.clientHeight;\n      \n      if (direction === 'up' && !isAtTop) {\n        currentElem.scrollTop = Math.max(0, currentElem.scrollTop - scrollAmount);\n        return;\n      }\n      \n      if (direction === 'down' && !isAtBottom) {\n        currentElem.scrollTop = Math.min(\n          currentElem.scrollHeight - currentElem.clientHeight,\n          currentElem.scrollTop + scrollAmount\n        );\n        return;\n      }\n    }\n    \n    let nextElement = null;\n    \n    if (direction === 'up' || direction === 'down') {\n      // Vertical navigation with intelligent spatial detection\n      let currentRect = currentElem?.getBoundingClientRect();\n      if (!currentRect) return;\n      \n      // Handle zero-dimension elements (hidden inputs, toggles)\n      if (currentRect.width === 0 && currentRect.height === 0) {\n        const label = currentElem.closest('label');\n        const container = currentElem.closest('[class*=\"toggle\"]') || currentElem.closest('[class*=\"Toggle\"]');\n        const parent = label || container || currentElem.parentElement;\n        if (parent) {\n          currentRect = parent.getBoundingClientRect();\n        }\n      }\n      \n      const currentCenterX = currentRect.left + currentRect.width / 2;\n      \n      // Get all candidates in the target direction\n      const candidates = navigableElements\n        .map((el, index) => ({ el, index, rect: el.getBoundingClientRect() }))\n        .filter(({ el, rect, index }) => {\n          // Exclude the current element\n          if (index === currentIndex) return false;\n          \n          if (direction === 'up') {\n            return rect.bottom <= currentRect.top + 20; // More generous tolerance for upward navigation\n          } else {\n            return rect.top >= currentRect.bottom - 20; // More generous tolerance for downward navigation\n          }\n        });\n      \n      \n      if (candidates.length > 0) {\n        // Sort candidates by horizontal distance from current element\n        const sortedCandidates = candidates\n          .map(candidate => ({\n            ...candidate,\n            horizontalDistance: Math.abs(candidate.rect.left + candidate.rect.width / 2 - currentCenterX),\n            verticalDistance: direction === 'up' \n              ? currentRect.top - candidate.rect.bottom \n              : candidate.rect.top - currentRect.bottom\n          }))\n          .sort((a, b) => {\n            const horizontalDiff = a.horizontalDistance - b.horizontalDistance;\n            if (Math.abs(horizontalDiff) > 100) {\n              return horizontalDiff;\n            }\n            const verticalDiff = a.verticalDistance - b.verticalDistance;\n            if (Math.abs(verticalDiff) > 10) {\n              return verticalDiff;\n            }\n            return horizontalDiff;\n          });\n        \n        nextElement = sortedCandidates[0].el;\n      } else {\n        // No elements in target direction - find closest element in ANY direction\n        const allOtherElements = navigableElements\n          .filter((el, index) => index !== currentIndex)\n          .map((el, index) => ({ el, rect: el.getBoundingClientRect() }));\n        \n        if (allOtherElements.length > 0) {\n          // Find the element closest to where we want to go\n          const targetY = direction === 'up' ? 0 : window.innerHeight;\n          const closest = allOtherElements.reduce((best, candidate) => {\n            const candidateDistance = Math.abs(candidate.rect.top - targetY);\n            const bestDistance = Math.abs(best.rect.top - targetY);\n            return candidateDistance < bestDistance ? candidate : best;\n          });\n          nextElement = closest.el;\n        } else {\n          // Ultimate fallback - wrap around\n          if (direction === 'up') {\n            nextElement = navigableElements[navigableElements.length - 1];\n          } else {\n            nextElement = navigableElements[0];\n          }\n        }\n      }\n    } else {\n      // Horizontal navigation within rows\n      const currentRect = currentElem?.getBoundingClientRect();\n      if (!currentRect) {\n        if (direction === 'left') {\n          nextElement = currentIndex > 0 ? navigableElements[currentIndex - 1] : navigableElements[navigableElements.length - 1];\n        } else {\n          nextElement = currentIndex < navigableElements.length - 1 ? navigableElements[currentIndex + 1] : navigableElements[0];\n        }\n      } else {\n        const currentCenterY = currentRect.top + currentRect.height / 2;\n        const rowTolerance = Math.max(currentRect.height / 2, 20);\n        \n        const sameRowElements = navigableElements\n          .map((el, index) => ({ el, index, rect: el.getBoundingClientRect() }))\n          .filter(({ rect, index }) => {\n            const candidateCenterY = rect.top + rect.height / 2;\n            return Math.abs(candidateCenterY - currentCenterY) <= rowTolerance;\n          })\n          .sort((a, b) => a.rect.left - b.rect.left);\n        \n        const currentRowIndex = sameRowElements.findIndex(({ el }) => el === currentElem);\n        \n        if (currentRowIndex !== -1 && sameRowElements.length > 1) {\n          if (direction === 'left') {\n            nextElement = currentRowIndex > 0 ? sameRowElements[currentRowIndex - 1].el : null;\n          } else {\n            nextElement = currentRowIndex < sameRowElements.length - 1 ? sameRowElements[currentRowIndex + 1].el : null;\n          }\n        } else {\n          nextElement = null;\n        }\n      }\n    }\n    \n    if (nextElement) {\n      setFocusedElement(nextElement);\n      nextElement.focus();\n    }\n  }, [navigableElements, focusedElement]);\n\n  const activateElement = useCallback(() => {\n    // Check actual DOM focus first, fallback to our tracked element\n    const elementToActivate = document.activeElement?.getAttribute('data-gamepad-focusable') === 'true' \n      ? document.activeElement \n      : focusedElement;\n      \n    if (elementToActivate) {\n      // Show focus indicator when activating\n      setShowFocusIndicator(true);\n      // Simulate click on the focused element\n      elementToActivate.click();\n    }\n  }, [focusedElement]);\n\n  // Handle keyboard input for testing\n  useEffect(() => {\n    if (!isEnabled) return;\n\n    const handleKeyDown = (e) => {\n      // Check if we're in a text input field\n      const isTextInput = document.activeElement && (\n        document.activeElement.tagName === 'INPUT' || \n        document.activeElement.tagName === 'TEXTAREA'\n      );\n\n      // For text inputs, only prevent default for arrow keys (not Enter)\n      // This allows normal form submission with Enter key\n      if (isTextInput && e.key === 'Enter') {\n        // Don't prevent default, don't activate element\n        // Let the form handle the Enter key naturally\n        return;\n      }\n\n      // Prevent default behavior for navigation keys\n      if (['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'Enter', ' '].includes(e.key)) {\n        e.preventDefault();\n      }\n\n      switch (e.key) {\n        case 'ArrowUp':\n          navigateDirection('up');\n          break;\n        case 'ArrowDown':\n          navigateDirection('down');\n          break;\n        case 'ArrowLeft':\n          navigateDirection('left');\n          break;\n        case 'ArrowRight':\n          navigateDirection('right');\n          break;\n        case 'Enter':\n        case ' ': // Space bar\n          activateElement();\n          break;\n      }\n    };\n\n    document.addEventListener('keydown', handleKeyDown);\n    return () => document.removeEventListener('keydown', handleKeyDown);\n  }, [navigateDirection, activateElement, isEnabled]);\n\n  // Handle gamepad detection and input with native Gamepad API\n  useEffect(() => {\n    if (!isEnabled) return;\n\n    let animationFrame;\n\n    const checkGamepads = () => {\n      const gamepads = navigator.getGamepads();\n      let connected = false;\n\n      for (let i = 0; i < gamepads.length; i++) {\n        const gamepad = gamepads[i];\n        if (gamepad && gamepad.connected) {\n          connected = true;\n          \n          // Track button press states to avoid spamming\n          if (!buttonStates.current[i]) {\n            buttonStates.current[i] = {};\n          }\n          \n          const prevStates = buttonStates.current[i];\n          \n          // D-pad buttons (standard mapping: 12=up, 13=down, 14=left, 15=right)\n          const upPressed = gamepad.buttons[12]?.pressed;\n          const downPressed = gamepad.buttons[13]?.pressed;\n          const leftPressed = gamepad.buttons[14]?.pressed;\n          const rightPressed = gamepad.buttons[15]?.pressed;\n          const aPressed = gamepad.buttons[0]?.pressed; // A button\n\n          // Only trigger on button press (not hold)\n          if (upPressed && !prevStates.up) {\n            navigateDirection('up');\n          }\n          if (downPressed && !prevStates.down) {\n            navigateDirection('down');\n          }\n          if (leftPressed && !prevStates.left) {\n            navigateDirection('left');\n          }\n          if (rightPressed && !prevStates.right) {\n            navigateDirection('right');\n          }\n          if (aPressed && !prevStates.a) {\n            activateElement();\n          }\n\n          // Update previous states\n          prevStates.up = upPressed;\n          prevStates.down = downPressed;\n          prevStates.left = leftPressed;\n          prevStates.right = rightPressed;\n          prevStates.a = aPressed;\n\n          // Left analog stick navigation\n          const leftStickX = gamepad.axes[0] || 0;\n          const leftStickY = gamepad.axes[1] || 0;\n          const deadzone = 0.3;\n\n          if (!prevStates.stickMoved && (Math.abs(leftStickX) > deadzone || Math.abs(leftStickY) > deadzone)) {\n            if (Math.abs(leftStickX) > Math.abs(leftStickY)) {\n              if (leftStickX > deadzone) {\n                navigateDirection('right');\n              } else if (leftStickX < -deadzone) {\n                navigateDirection('left');\n              }\n            } else {\n              if (leftStickY > deadzone) {\n                navigateDirection('down');\n              } else if (leftStickY < -deadzone) {\n                navigateDirection('up');\n              }\n            }\n            prevStates.stickMoved = true;\n          } else if (Math.abs(leftStickX) <= deadzone && Math.abs(leftStickY) <= deadzone) {\n            prevStates.stickMoved = false;\n          }\n\n          // Right analog stick page scrolling\n          const rightStickX = gamepad.axes[2] || 0;\n          const rightStickY = gamepad.axes[3] || 0;\n          const scrollDeadzone = 0.2;\n          const scrollSpeed = 8;\n\n          if (Math.abs(rightStickY) > scrollDeadzone) {\n            const scrollAmount = rightStickY * scrollSpeed;\n            window.scrollBy(0, scrollAmount);\n          }\n          \n          if (Math.abs(rightStickX) > scrollDeadzone) {\n            const scrollAmount = rightStickX * scrollSpeed;\n            window.scrollBy(scrollAmount, 0);\n          }\n        }\n      }\n\n      setIsGamepadConnected(connected);\n      animationFrame = requestAnimationFrame(checkGamepads);\n    };\n\n    checkGamepads();\n\n    return () => {\n      if (animationFrame) {\n        cancelAnimationFrame(animationFrame);\n      }\n    };\n  }, [navigateDirection, activateElement, isEnabled]);\n\n  // Hide focus indicator on mouse movement\n  useEffect(() => {\n    if (!isEnabled) return;\n\n    const handleMouseMove = () => {\n      setShowFocusIndicator(false);\n    };\n\n    document.addEventListener('mousemove', handleMouseMove);\n    return () => document.removeEventListener('mousemove', handleMouseMove);\n  }, [isEnabled]);\n\n  // Add/remove CSS class to body to control focus indicator visibility\n  useEffect(() => {\n    if (showFocusIndicator) {\n      document.body.classList.add('gamepad-navigation-active');\n    } else {\n      document.body.classList.remove('gamepad-navigation-active');\n    }\n\n    // Cleanup on unmount\n    return () => {\n      document.body.classList.remove('gamepad-navigation-active');\n    };\n  }, [showFocusIndicator]);\n\n  // Handle initial focus when elements are available  \n  useEffect(() => {\n    if (navigableElements.length > 0 && !focusedElement) {\n      const firstElement = navigableElements[0];\n      setFocusedElement(firstElement);\n      // Don't focus initially - let autoFocus handle it\n      // firstElement.focus();\n    }\n  }, [navigableElements.length]); // Only depend on length, not the array itself\n  \n  // Sync focus state when elements gain focus outside of gamepad navigation\n  useEffect(() => {\n    if (!isEnabled) return;\n    \n    const handleFocusChange = (e) => {\n      // Check if the focused element is a navigable element\n      const target = e.target;\n      if (target && target.getAttribute('data-gamepad-focusable') === 'true') {\n        // Register elements first to ensure the list is up to date\n        registerNavigableElements();\n        // Small delay to let the registration complete\n        setTimeout(() => {\n          // Find the element in our navigable elements list\n          const currentNavigableElements = Array.from(\n            document.querySelectorAll('[data-gamepad-focusable=\"true\"]:not([disabled]), [data-gamepad-scrollable=\"true\"]')\n          );\n          \n          if (currentNavigableElements.includes(target)) {\n            setFocusedElement(target);\n            // Don't show focus indicator on programmatic focus (like autoFocus)\n            // Only show it when navigating with keyboard/gamepad\n            // setShowFocusIndicator(true);\n          }\n        }, 0);\n      }\n    };\n    \n    // Listen for focus events globally to catch autoFocus and programmatic focus changes\n    document.addEventListener('focus', handleFocusChange, true); // Use capture phase\n    \n    return () => {\n      document.removeEventListener('focus', handleFocusChange, true);\n    };\n  }, [isEnabled, registerNavigableElements]);\n\n  // Re-register elements when DOM changes\n  useEffect(() => {\n    if (!isEnabled) return;\n    \n    const observer = new MutationObserver(registerNavigableElements);\n    observer.observe(document.body, {\n      childList: true,\n      subtree: true,\n      attributes: true,\n      attributeFilter: ['data-gamepad-focusable', 'disabled']\n    });\n    \n    // Initial registration\n    registerNavigableElements();\n    \n    return () => observer.disconnect();\n  }, [registerNavigableElements, isEnabled]);\n\n  return {\n    focusedElement,\n    isGamepadConnected,\n    showFocusIndicator,\n    registerNavigableElements\n  };\n};","import React from 'react';\nimport styles from './AppHeader.module.css';\n\n/**\n * A shared header component for the In-Between game\n * Used across auth and lobby screens for consistent branding\n */\nconst AppHeader = () => {\n  return (\n    <div className={styles.headerContainer}>\n      <h1 className={styles.gameTitle}>\n        In Between <span className={styles.liveTag}>LIVE</span>\n      </h1>\n    </div>\n  );\n};\n\nexport default AppHeader;\n","import React, { useState } from 'react';\nimport { Box, Button, Typography } from '@mui/material';\nimport { useNavigate } from 'react-router-dom';\nimport AuthForm from './AuthForm.jsx';\nimport { useAuth } from '../../contexts/AuthContext';\nimport { useGamepadNavigation } from '../../hooks/useGamepadNavigation';\nimport styles from './AuthPage.module.css';\nimport AppHeader from '../common/AppHeader';\n\nconst AuthPage = () => {\n  const [mode, setMode] = useState('login');\n  const { login } = useAuth();\n  const navigate = useNavigate();\n  \n  // Initialize gamepad navigation\n  useGamepadNavigation(true);\n\n  const [error, setError] = useState(null);\n\n  const handleAuth = async (username, password) => {\n    if (!username || !password) {\n      setError('Username and password are required');\n      return;\n    }\n\n    setError(null);\n    // Get API URL from environment or use localhost as fallback\n    const API_URL = import.meta.env.VITE_API_URL || 'http://localhost:3001';\n    const endpoint = `${API_URL}/auth/${mode}`;\n    \n\n    try {\n      const requestBody = { username, password };\n      const response = await fetch(endpoint, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        credentials: 'include',\n        body: JSON.stringify(requestBody),\n      });\n\n      let data;\n      try {\n        data = await response.json();\n      } catch (error) {\n        console.error('[Client] Error parsing response:', error);\n        throw new Error('Invalid response from server');\n      }\n      \n      if (!response.ok) {\n        throw new Error(data.message || 'Authentication failed');\n      }\n\n      if (!data.user?.username || !data.user?.id || !data.token) {\n        console.error('[Client] Invalid response format:', {\n          hasUser: !!data.user,\n          hasUsername: !!data.user?.username,\n          hasId: !!data.user?.id,\n          hasToken: !!data.token\n        });\n        throw new Error('Invalid server response format');\n      }\n\n      try {\n        login(data.user, data.token);\n        // Navigate to the lobby after successful login\n        navigate('/');\n      } catch (error) {\n        console.error('[Client] Error in login callback:', error);\n        throw new Error('Failed to initialize user session');\n      }\n    } catch (error) {\n      console.error('[Client] Auth error:', {\n        message: error.message,\n        endpoint,\n        mode\n      });\n      setError(error.message || 'Failed to connect to server');\n    }\n\n\n  };\n\n  return (\n    <Box className={styles.authPage}>\n      <AppHeader />\n      \n      <Box className={styles.formContainer}>\n        {error && (\n          <Typography className={styles.error}>\n            {error}\n          </Typography>\n        )}\n        \n        <AuthForm mode={mode} onSubmit={handleAuth} />\n        \n        <Box textAlign=\"center\" mt={3}>\n          <Button\n            color=\"primary\"\n            onClick={() => setMode(mode === 'login' ? 'register' : 'login')}\n            data-gamepad-focusable=\"true\"\n            sx={{\n              color: '#ecf0f1',\n              textTransform: 'none',\n              fontSize: '1rem',\n              '&:hover': {\n                backgroundColor: 'rgba(255, 255, 255, 0.1)'\n              }\n            }}\n          >\n            {mode === 'login' \n              ? \"Don't have an account? Register\" \n              : \"Already have an account? Login\"}\n          </Button>\n        </Box>\n      </Box>\n    </Box>\n  );\n};\n\nexport default AuthPage;\n","import React, { createContext, useState, useEffect, useContext } from 'react';\nimport { useSocket } from './SocketContext';\n\nconst LobbyContext = createContext();\n\nexport const useLobby = () => useContext(LobbyContext);\n\nexport const LobbyProvider = ({ children }) => {\n  const { socket, isConnected } = useSocket();\n  \n  const [gameList, setGameList] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    if (!socket || !isConnected) return;\n    \n    const handleGameList = (games) => {\n      setGameList(games);\n      setLoading(false);\n    };\n    \n    const handleError = (err) => {\n      console.error('[LobbyContext] Socket error:', err.message || err);\n      setError(err.message || 'An error occurred');\n      setLoading(false);\n    };\n    \n    socket.on('gameList', handleGameList);\n    socket.on('error', handleError);\n    \n    socket.emit('getGameList');\n    \n    return () => {\n      socket.off('gameList', handleGameList);\n      socket.off('error', handleError);\n    };\n  }, [socket, isConnected]);\n  \n  const contextValue = {\n    gameList,\n    loading,\n    error,\n  };\n  \n  return (\n    <LobbyContext.Provider value={contextValue}>\n      {children}\n    </LobbyContext.Provider>\n  );\n};\n","import React, { createContext, useState, useContext, useEffect } from 'react';\nimport { useAuth } from './AuthContext.jsx';\nimport soundService from '../services/SoundService';\n\nconst PreferencesContext = createContext(null);\n\n// Helper function to format image URLs consistently across the application\nconst formatImageUrl = (url) => {\n  if (!url) return null;\n  \n  // Get API URL from environment or use localhost as fallback\n  const API_URL = import.meta.env.VITE_API_URL || 'http://localhost:3001';\n  \n  // If the URL already starts with http, use it as is\n  if (url.startsWith('http')) {\n    return url;\n  } \n  // If the URL is a relative path starting with /files/, use it as is with API_URL\n  else if (url.startsWith('/files/')) {\n    return `${API_URL}${url}`;\n  }\n  // If the URL contains /uploads/, replace it with /files/\n  else if (url.includes('/uploads/')) {\n    // Extract the type and filename from the path\n    const parts = url.split('/');\n    const filename = parts.pop();\n    const type = parts[parts.length - 1]; // images, audio, etc.\n    return `${API_URL}/files/${type}/${filename}`;\n  }\n  // Otherwise, just append the URL to the API_URL\n  else {\n    return `${API_URL}${url}`;\n  }\n};\n\n// Helper function to format preferences data with proper image URLs\nconst formatPreferencesData = (data) => {\n  if (!data) return {};\n  \n  return {\n    ...data,\n    profileImg: formatImageUrl(data.profileImg),\n    twoSecondPotGif: formatImageUrl(data.twoSecondPotGif),\n    twoSecondPotMp3: data.twoSecondPotMp3 // Audio files don't need the same formatting\n  };\n};\n\nexport const PreferencesProvider = ({ children }) => {\n  const [preferences, setPreferences] = useState({\n    profileImg: null,\n    autoAnte: false,\n    muted: false,\n    twoSecondPotGif: null,\n    twoSecondPotMp3: null,\n    selectedTitle: null\n  });\n  const [loading, setLoading] = useState(true);\n  const { user } = useAuth();\n  \n  // Define loadPreferences function with useCallback to handle dependencies properly\n  const loadPreferences = React.useCallback(async () => {\n    if (!user) {\n      setPreferences({ autoAnte: false });\n      setLoading(false);\n      return;\n    }\n    \n      \n    try {\n      setLoading(true);\n      // Get API URL from environment or use localhost as fallback\n      const API_URL = import.meta.env.VITE_API_URL || 'http://localhost:3001';\n      const token = localStorage.getItem('token');\n      \n      if (!token) {\n        console.error('[Preferences] No token available');\n        setLoading(false);\n        return;\n      }\n      \n      const response = await fetch(`${API_URL}/preferences`, {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${token}`\n        }\n      });\n      \n      if (!response.ok) {\n        throw new Error('Failed to load preferences');\n      }\n      \n      const data = await response.json();\n      \n      // Format preferences data with proper image URLs\n      const formattedData = formatPreferencesData(data);\n      \n      const finalPreferences = formattedData || { autoAnte: false, muted: false };\n      setPreferences(finalPreferences);\n      \n      // Sync sound service with loaded preferences\n      if (typeof finalPreferences.muted !== 'undefined') {\n        soundService.setMuted(finalPreferences.muted);\n      }\n    } catch (error) {\n      console.error('[Preferences] Error loading preferences:', error);\n      // Set default preferences on error\n      setPreferences({ autoAnte: false });\n    } finally {\n      setLoading(false);\n    }\n  }, [user]);\n  \n  // Load preferences from the server when the user changes or component mounts\n  useEffect(() => {\n    if (user) {\n      loadPreferences();\n    }\n  }, [user, loadPreferences]);\n  \n  // Update a preference\n  const updatePreference = async (key, value) => {\n    if (!user) {\n      console.error('[Preferences] Cannot update preferences: User not logged in');\n      return false;\n    }\n    \n    try {\n      // Get API URL from environment or use localhost as fallback\n      const API_URL = import.meta.env.VITE_API_URL || 'http://localhost:3001';\n      const token = localStorage.getItem('token');\n      \n      if (!token) {\n        console.error('[Preferences] No token available');\n        return false;\n      }\n      \n      // Optimistically update the UI\n      setPreferences(prev => ({\n        ...prev,\n        [key]: value\n      }));\n      \n      // If updating the muted preference, sync with sound service\n      if (key === 'muted') {\n        soundService.setMuted(value);\n      }\n      \n      // Send the update to the server\n      const response = await fetch(`${API_URL}/preferences/${key}`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${token}`\n        },\n        body: JSON.stringify({ value })\n      });\n      \n      if (!response.ok) {\n        throw new Error(`Failed to update ${key} preference`);\n      }\n      \n      const data = await response.json();\n      \n      // Format preferences data with proper image URLs\n      const formattedData = formatPreferencesData(data);\n      \n      // Update with the formatted server response (in case there were any changes)\n      setPreferences(formattedData);\n      return true;\n    } catch (error) {\n      console.error(`[Preferences] Error updating ${key}:`, error);\n      \n      // Revert the optimistic update on error\n      await loadPreferences();\n      return false;\n    }\n  };\n  \n  // Toggle auto-ante preference\n  const toggleAutoAnte = async () => {\n    const newValue = !preferences.autoAnte;\n    return await updatePreference('autoAnte', newValue);\n  };\n\n  // Toggle mute preference\n  const toggleMute = async () => {\n    const newValue = !preferences.muted;\n    return await updatePreference('muted', newValue);\n  };\n\n  // Update selected title (expects title string, not ID)\n  const updateSelectedTitle = async (titleString) => {\n    return await updatePreference('selectedTitle', titleString);\n  };\n\n  // Upload file for two-second-pot-gif preference\n  const uploadTwoSecondPotGif = async (file) => {\n    if (!file) {\n      console.error('[Preferences] No file provided for GIF upload');\n      return false;\n    }\n    \n    \n    try {\n      const formData = new FormData();\n      formData.append('file', file);\n      \n      // Get API URL from environment or use localhost as fallback\n      const API_URL = import.meta.env.VITE_API_URL || 'http://localhost:3001';\n      const token = localStorage.getItem('token');\n      \n      if (!token) {\n        console.error('[Preferences] No token available');\n        return false;\n      }\n      \n      \n      const response = await fetch(`${API_URL}/preferences/twoSecondPotGif`, {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${token}`\n        },\n        body: formData\n      });\n      \n      const responseText = await response.text();\n      \n      if (!response.ok) {\n        throw new Error(`Failed to upload GIF file: ${responseText}`);\n      }\n      \n      // Parse the response text as JSON\n      const data = responseText ? JSON.parse(responseText) : {};\n      \n      // Format the file URL for consistency\n      const formattedUrl = formatImageUrl(data.fileUrl);\n      \n      // Update preferences with the formatted file URL\n      setPreferences(prev => ({\n        ...prev,\n        twoSecondPotGif: formattedUrl\n      }));\n      \n      return true;\n    } catch (error) {\n      console.error('[Preferences] Error uploading GIF:', error);\n      return false;\n    }\n  };\n\n  // Upload file for two-second-pot-mp3 preference\n  const uploadTwoSecondPotMp3 = async (file) => {\n    if (!file) {\n      console.error('[Preferences] No file provided for MP3 upload');\n      return false;\n    }\n    \n    \n    try {\n      const formData = new FormData();\n      formData.append('file', file);\n      \n      // Get API URL from environment or use localhost as fallback\n      const API_URL = import.meta.env.VITE_API_URL || 'http://localhost:3001';\n      const token = localStorage.getItem('token');\n      \n      if (!token) {\n        console.error('[Preferences] No token available');\n        return false;\n      }\n      \n      \n      const response = await fetch(`${API_URL}/preferences/twoSecondPotMp3`, {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${token}`\n        },\n        body: formData\n      });\n      \n      const responseText = await response.text();\n      \n      if (!response.ok) {\n        throw new Error(`Failed to upload MP3 file: ${responseText}`);\n      }\n      \n      // Parse the response text as JSON\n      const data = responseText ? JSON.parse(responseText) : {};\n      \n      // Update preferences with the file URL\n      setPreferences(prev => ({\n        ...prev,\n        twoSecondPotMp3: data.fileUrl\n      }));\n      \n      return true;\n    } catch (error) {\n      console.error('[Preferences] Error uploading MP3:', error);\n      return false;\n    }\n  };\n  \n  // Upload file for profile image preference\n  const uploadProfileImg = async (file) => {\n    if (!file) {\n      console.error('[Preferences] No file provided for profile image upload');\n      return false;\n    }\n    \n    \n    try {\n      const formData = new FormData();\n      formData.append('file', file);\n      \n      // Get API URL from environment or use localhost as fallback\n      const API_URL = import.meta.env.VITE_API_URL || 'http://localhost:3001';\n      const token = localStorage.getItem('token');\n      \n      if (!token) {\n        console.error('[Preferences] No token available');\n        return false;\n      }\n      \n      \n      const response = await fetch(`${API_URL}/preferences/profileImg`, {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${token}`\n        },\n        body: formData\n      });\n      \n      const responseText = await response.text();\n      \n      if (!response.ok) {\n        throw new Error(`Failed to upload profile image: ${responseText}`);\n      }\n      \n      // Parse the response text as JSON\n      const data = responseText ? JSON.parse(responseText) : {};\n      \n      // Format the file URL for consistency\n      const formattedUrl = formatImageUrl(data.fileUrl);\n      \n      // Update preferences with the formatted file URL\n      setPreferences(prev => ({\n        ...prev,\n        profileImg: formattedUrl\n      }));\n      \n      return true;\n    } catch (error) {\n      console.error('[Preferences] Error uploading profile image:', error);\n      return false;\n    }\n  };\n  \n  // No test upload function needed\n  \n  return (\n    <PreferencesContext.Provider \n      value={{ \n        preferences, \n        updatePreference, \n        toggleAutoAnte,\n        toggleMute,\n        updateSelectedTitle,\n        uploadTwoSecondPotGif,\n        uploadTwoSecondPotMp3,\n        uploadProfileImg,\n        loading \n      }}\n    >\n      {children}\n    </PreferencesContext.Provider>\n  );\n};\n\nexport const usePreferences = () => {\n  const context = useContext(PreferencesContext);\n  if (!context) {\n    throw new Error('usePreferences must be used within a PreferencesProvider');\n  }\n  return context;\n};\n","import React, { useEffect, useState } from 'react';\nimport { useSocket } from '../../contexts/SocketContext';\nimport styles from './OnlinePlayerCount.module.css';\n\nconst OnlinePlayerCount = () => {\n  const { socket, isConnected } = useSocket();\n  const [count, setCount] = useState(null);\n\n  useEffect(() => {\n    if (!socket || !isConnected) return;\n    // Request the current online player count\n    socket.emit('getOnlinePlayerCount', (n) => {\n      setCount(n);\n    });\n    // Listen for real-time updates\n    const handler = (n) => setCount(n);\n    socket.on('onlinePlayerCountUpdate', handler);\n    return () => {\n      socket.off('onlinePlayerCountUpdate', handler);\n    };\n  }, [socket, isConnected]);\n\n  if (count === null) return null;\n  return (\n    <div className={styles.pill}>\n      <span className={styles.pulse} />\n      <span className={styles.text}>{count} online</span>\n    </div>\n  );\n};\n\nexport default OnlinePlayerCount;\n","import React from 'react';\nimport styles from './CurrencyAmount.module.css';\nimport CoinIcon from './CoinIcon.jsx';\n\n/**\n * A reusable component that displays currency amounts with consistent styling\n * @param {Object} props - Component props\n * @param {number} props.amount - The amount to display\n * @param {string} props.size - The size of the coin icon (small, medium, large)\n * @param {string} props.background - Optional custom background style (e.g. 'dark', 'pill')\n * @param {string} props.customClass - Optional custom CSS class to apply\n */\nconst CurrencyAmount = ({ amount, size, background, customClass }) => {\n  // Determine which CSS classes to apply\n  const containerClasses = [\n    styles.currencyAmount,\n    background === 'dark' ? styles.darkBackground : '',\n    background === 'pill' ? styles.pillBackground : '',\n    customClass || ''\n  ].filter(Boolean).join(' ');\n  \n  return (\n    <span className={containerClasses}>\n      <CoinIcon size={size} />\n      <span>{amount.toLocaleString()}</span>\n    </span>\n  );\n};\n\nexport default CurrencyAmount;\n","import React from 'react';\n\nconst GearIcon = ({ className = 'h-6 w-6', ...props }) => {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      fill=\"none\"\n      viewBox=\"0 0 24 24\"\n      strokeWidth={1.5}\n      stroke=\"currentColor\"\n      className={className}\n      {...props}\n    >\n      <path\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n        d=\"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.004.827c-.29.24-.438.613-.431.992a6.759 6.759 0 010 1.905c-.007.378.141.75.431.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.29-.24.438-.613.43-.992a6.932 6.932 0 010-1.905c.007-.378-.14-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281zM15 12a3 3 0 11-6 0 3 3 0 016 0z\"\n      />\n    </svg>\n  );\n};\n\nexport default GearIcon;\n","import React from 'react';\nimport styles from './styles/ToggleSwitch.module.css';\n\nconst ToggleSwitch = ({ isChecked, onChange, label }) => {\n  return (\n    <div className={styles.toggleContainer}>\n      <label className={styles.toggleLabel}>\n        <input\n          type=\"checkbox\"\n          checked={isChecked}\n          onChange={onChange}\n          className={styles.toggleInput}\n          data-gamepad-focusable=\"true\"\n        />\n        <span className={styles.toggleSlider}></span>\n        {label && <span className={styles.toggleText}>{label}</span>}\n      </label>\n    </div>\n  );\n};\n\nexport default ToggleSwitch;\n","import React, { useState, useRef } from 'react';\nimport styles from './styles/FileUpload.module.css';\n\nconst FileUpload = ({ \n  onUpload, \n  currentFileUrl, \n  acceptedFileTypes, \n  label,\n  previewType = 'image' // 'image', 'audio', or 'none'\n}) => {\n  const [isUploading, setIsUploading] = useState(false);\n  const [error, setError] = useState(null);\n  const fileInputRef = useRef(null);\n  \n  const handleFileChange = async (e) => {\n    const file = e.target.files[0];\n    if (!file) {\n      console.error('[FileUpload] No file selected');\n      return;\n    }\n    \n    console.log('[FileUpload] File selected:', {\n      name: file.name,\n      type: file.type,\n      size: file.size\n    });\n    \n    setError(null);\n    setIsUploading(true);\n    \n    try {\n      console.log('[FileUpload] Calling onUpload function');\n      const success = await onUpload(file);\n      console.log('[FileUpload] Upload result:', success);\n      \n      if (!success) {\n        console.error('[FileUpload] Upload failed');\n        setError('Failed to upload file. Please try again.');\n      } else {\n        console.log('[FileUpload] Upload successful');\n      }\n    } catch (err) {\n      console.error('[FileUpload] Error uploading file:', err);\n      setError('An error occurred during upload.');\n    } finally {\n      setIsUploading(false);\n    }\n  };\n  \n  const handleButtonClick = () => {\n    fileInputRef.current.click();\n  };\n  \n  const renderPreview = () => {\n    if (!currentFileUrl) return null;\n    \n    if (previewType === 'image') {\n      return (\n        <div className={styles.previewContainer}>\n          <img \n            src={currentFileUrl} \n            alt=\"Preview\" \n            className={styles.imagePreview} \n          />\n        </div>\n      );\n    } else if (previewType === 'audio') {\n      return (\n        <div className={styles.previewContainer}>\n          <audio \n            controls \n            src={currentFileUrl} \n            className={styles.audioPreview}\n          >\n            Your browser does not support the audio element.\n          </audio>\n        </div>\n      );\n    }\n    \n    return null;\n  };\n  \n  return (\n    <div className={styles.fileUploadContainer}>\n      <input\n        type=\"file\"\n        ref={fileInputRef}\n        onChange={handleFileChange}\n        accept={acceptedFileTypes}\n        className={styles.fileInput}\n      />\n      \n      {currentFileUrl && renderPreview()}\n      \n      <button \n        type=\"button\" \n        onClick={handleButtonClick}\n        className={`${styles.uploadButton} ${currentFileUrl ? styles.changeButton : ''}`}\n        disabled={isUploading}\n        data-gamepad-focusable=\"true\"\n      >\n        {isUploading ? 'Uploading...' : currentFileUrl ? `Change ${label}` : `Upload ${label}`}\n      </button>\n      \n      {error && (\n        <div className={styles.errorMessage}>\n          {error}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default FileUpload;\n","import React, { useState, useEffect } from 'react';\nimport { useAuth } from '../contexts/AuthContext';\nimport { usePreferences } from '../contexts/PreferencesContext';\nimport baseModalStyles from './common/BaseModal.module.css';\nimport { API_URL } from '../config';\n\nconst TitlesSelector = () => {\n  const { token } = useAuth();\n  const { preferences, updateSelectedTitle } = usePreferences();\n  const [titles, setTitles] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    loadTitles();\n  }, []);\n\n  const loadTitles = async () => {\n    try {\n      setLoading(true);\n      const response = await fetch(`${API_URL}/me/titles`, {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to load titles');\n      }\n\n      const userTitles = await response.json();\n      setTitles(userTitles);\n    } catch (err) {\n      setError(err.message);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleTitleSelect = async (titleString) => {\n    try {\n      await updateSelectedTitle(titleString);\n    } catch (err) {\n      setError('Failed to update title');\n    }\n  };\n\n  if (loading) {\n    return <div className={baseModalStyles.loadingMessage}>Loading titles...</div>;\n  }\n\n  if (error) {\n    return <div className={baseModalStyles.errorMessage}>{error}</div>;\n  }\n\n  if (titles.length === 0) {\n    return (\n      <div style={{ textAlign: 'center', padding: '20px', color: '#a0b9d6' }}>\n        No titles unlocked yet. Play games to earn achievements!\n      </div>\n    );\n  }\n\n  return (\n    <div style={{ \n      display: 'block',\n      width: '100%',\n      overflowX: 'auto',\n      overflowY: 'hidden',\n      whiteSpace: 'nowrap',\n      paddingBottom: '8px'\n    }}>\n        {/* No Title option */}\n        <div\n          onClick={() => handleTitleSelect('')}\n          style={{\n            display: 'inline-block',\n            width: '120px',\n            height: '36px',\n            padding: '8px',\n            margin: '0 8px 0 0',\n            borderRadius: '6px',\n            cursor: 'pointer',\n            textAlign: 'center',\n            backgroundColor: !preferences.selectedTitle ? 'rgba(100, 169, 255, 0.3)' : 'rgba(255, 255, 255, 0.08)',\n            border: !preferences.selectedTitle ? '2px solid #64a9ff' : '2px solid rgba(255, 255, 255, 0.15)',\n            verticalAlign: 'top',\n            whiteSpace: 'normal',\n            display: 'inline-flex',\n            flexDirection: 'column',\n            justifyContent: 'center'\n          }}\n        >\n          <div style={{ fontWeight: 'bold', color: '#bcdcff', fontSize: '13px' }}>\n            No Title\n          </div>\n          <div style={{ color: '#a0b9d6', fontSize: '10px', marginTop: '2px' }}>\n            Display no title\n          </div>\n        </div>\n\n        {/* Unlocked titles */}\n        {titles.map(title => (\n          <div \n            key={title.title}\n            onClick={() => handleTitleSelect(title.title)}\n            style={{\n              display: 'inline-flex',\n              flexDirection: 'column',\n              justifyContent: 'center',\n              width: '130px',\n              height: '36px',\n              padding: '8px',\n              margin: '0 8px 0 0',\n              borderRadius: '6px',\n              cursor: 'pointer',\n              textAlign: 'center',\n              backgroundColor: preferences.selectedTitle === title.title ? 'rgba(100, 169, 255, 0.3)' : 'rgba(255, 255, 255, 0.08)',\n              border: preferences.selectedTitle === title.title ? '2px solid #64a9ff' : '2px solid rgba(255, 255, 255, 0.15)',\n              verticalAlign: 'top',\n              whiteSpace: 'normal'\n            }}\n          >\n            <div style={{ fontWeight: 'bold', color: '#bcdcff', fontSize: '13px' }}>\n              {title.title}\n            </div>\n            <div style={{ color: '#a0b9d6', fontSize: '10px', marginTop: '2px' }}>\n              {title.description}\n            </div>\n          </div>\n        ))}\n\n      {titles.length === 0 && (\n        <div style={{ \n          textAlign: 'center', \n          padding: '16px', \n          color: '#a0b9d6',\n          backgroundColor: 'rgba(255, 255, 255, 0.05)',\n          borderRadius: '6px',\n          border: '1px solid rgba(255, 255, 255, 0.1)',\n          marginTop: '8px',\n          whiteSpace: 'normal'\n        }}>\n          No titles unlocked yet. Play games to earn achievements!\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default TitlesSelector;","import React from 'react';\nimport { usePreferences } from '../contexts/PreferencesContext';\nimport baseModalStyles from './common/BaseModal.module.css';\nimport BaseModal from './common/BaseModal';\nimport ToggleSwitch from './ToggleSwitch.jsx';\nimport FileUpload from './FileUpload.jsx';\nimport TitlesSelector from './TitlesSelector.jsx';\n\nconst PreferencesModal = ({ onClose }) => {\n  const { \n    preferences, \n    toggleAutoAnte,\n    toggleMute,\n    uploadTwoSecondPotGif, \n    uploadTwoSecondPotMp3, \n    uploadProfileImg,\n    loading \n  } = usePreferences();\n\n  if (loading) {\n    return (\n      <BaseModal title=\"Preferences\" onClose={onClose} style={{ maxWidth: 600, maxHeight: '25vh' }}>\n        <div className={baseModalStyles.loadingMessage}>Loading preferences...</div>\n      </BaseModal>\n    );\n  }\n\n  return (\n    <BaseModal title=\"Preferences\" onClose={onClose} style={{ maxWidth: 600, maxHeight: '80vh' }}>\n      <div className={baseModalStyles.settingsContainer}>\n        {/* Game Options Section */}\n        <div className={baseModalStyles.sectionHeader}>Game Options</div>\n\n        {/* Mute Setting */}\n        <div className={baseModalStyles.settingItem}>\n          <div className={baseModalStyles.settingDescription}>\n            <h4>Mute Sound</h4>\n            <p>Mute all game sound effects</p>\n          </div>\n          <ToggleSwitch \n            isChecked={preferences.muted}\n            onChange={toggleMute}\n          />\n        </div>\n\n        {/* Auto-Ante Setting */}\n        <div className={baseModalStyles.settingItem}>\n          <div className={baseModalStyles.settingDescription}>\n            <h4>Auto-Ante</h4>\n            <p>Automatically ante up when a new round begins</p>\n          </div>\n          <ToggleSwitch \n            isChecked={preferences.autoAnte}\n            onChange={toggleAutoAnte}\n          />\n        </div>\n\n        {/* Customization Options Section */}\n        <div className={baseModalStyles.sectionHeader}>Customization Options</div>\n\n        {/* Profile Image Setting */}\n        <div className={baseModalStyles.settingItem}>\n          <div className={baseModalStyles.settingDescription}>\n            <h4>Profile Image</h4>\n            <p>Upload a profile image to personalize your account</p>\n          </div>\n          <FileUpload\n            onUpload={uploadProfileImg}\n            currentFileUrl={preferences.profileImg}\n            acceptedFileTypes=\"image/jpeg,image/png,image/gif\"\n            label=\"Image\"\n            previewType=\"image\"\n          />\n        </div>\n\n        {/* Titles Selection */}\n        <div className={baseModalStyles.settingItem} style={{ flexDirection: 'column', alignItems: 'stretch' }}>\n          <div className={baseModalStyles.settingDescription} style={{ marginRight: 0, marginBottom: '12px' }}>\n            <h4>Title</h4>\n            <p>Choose a title to display with your name. Unlock more by playing games!</p>\n          </div>\n          <TitlesSelector />\n        </div>\n\n        {/* Two Second Pot GIF Setting */}\n        {/* <div style={{ position: 'relative' }}>\n          <div style={{\n            position: 'absolute',\n            top: '-12px',\n            left: '50%',\n            transform: 'translateX(-50%)',\n            background: '#FFD700',\n            color: '#333',\n            padding: '2px 10px',\n            borderRadius: '4px',\n            fontWeight: 'bold',\n            fontSize: '14px',\n            zIndex: 2\n          }}>\n            COMING SOON\n          </div>\n          <div className={baseModalStyles.settingItem} style={{ border: '2px dashed #FFD700', padding: '15px', borderRadius: '8px', marginTop: '12px' }}>\n            <div className={baseModalStyles.settingDescription}>\n              <h4>Two Second POT GIF</h4>\n              <p>Upload a GIF to play when you slam the POT button</p>\n            </div>\n            <FileUpload\n              onUpload={uploadTwoSecondPotGif}\n              currentFileUrl={preferences.twoSecondPotGif}\n              acceptedFileTypes=\"image/gif\"\n              label=\"GIF\"\n              previewType=\"image\"\n            />\n          </div>\n        </div>\n\n        Two Second Pot Sound Setting\n        <div style={{ position: 'relative' }}>\n          <div style={{\n            position: 'absolute',\n            top: '-12px',\n            left: '50%',\n            transform: 'translateX(-50%)',\n            background: '#FFD700',\n            color: '#333',\n            padding: '2px 10px',\n            borderRadius: '4px',\n            fontWeight: 'bold',\n            fontSize: '14px',\n            zIndex: 2\n          }}>\n            COMING SOON\n          </div>\n          <div className={baseModalStyles.settingItem} style={{ border: '2px dashed #FFD700', padding: '15px', borderRadius: '8px', marginTop: '12px' }}>\n            <div className={baseModalStyles.settingDescription}>\n              <h4>Two Second POT Sound</h4>\n              <p>Upload a sound to play when you slam the POT button</p>\n            </div>\n            <FileUpload\n              onUpload={uploadTwoSecondPotMp3}\n              currentFileUrl={preferences.twoSecondPotMp3}\n              acceptedFileTypes=\"audio/mpeg,audio/wav\"\n              label=\"Sound\"\n              previewType=\"audio\"\n            />\n          </div>\n        </div> */}\n      </div>\n    </BaseModal>\n  );\n};\n\nexport default PreferencesModal;\n","import React from 'react';\nimport styles from './styles/IconButton.module.css';\n\n/**\n * A reusable icon button component with standardized styling\n * \n * @param {Object} props Component props\n * @param {React.ReactNode} props.icon The icon to display\n * @param {string} props.title Tooltip text for the button\n * @param {function} props.onClick Click handler function\n * @param {string} props.variant Button variant ('default', 'danger', 'success')\n * @param {boolean} props.compact Whether to use compact styling\n * @param {string} props.className Additional class names\n */\nconst IconButton = ({ \n  icon, \n  title, \n  onClick, \n  variant = 'default',\n  compact = true,\n  className = '',\n  ...restProps\n}) => {\n  return (\n    <button\n      className={`${styles.iconButton} ${styles[variant]} ${className}`}\n      onClick={onClick}\n      title={title}\n      type=\"button\"\n      {...restProps}\n    >\n      {icon}\n    </button>\n  );\n};\n\nexport default IconButton;\n","import React, { useState, useEffect } from 'react';\nimport GearIcon from '../icons/GearIcon';\nimport PreferencesModal from '../PreferencesModal';\nimport IconButton from './IconButton';\n\nconst PreferencesButton = ({ onModalStateChange }) => {\n  const [isPreferencesOpen, setIsPreferencesOpen] = useState(false);\n\n  const openPreferences = () => {\n    setIsPreferencesOpen(true);\n  };\n\n  const closePreferences = () => {\n    setIsPreferencesOpen(false);\n  };\n\n  // Notify parent when modal state changes\n  useEffect(() => {\n    if (onModalStateChange) {\n      onModalStateChange(isPreferencesOpen);\n    }\n  }, [isPreferencesOpen, onModalStateChange]);\n\n  return (\n    <>\n      <IconButton\n        onClick={openPreferences}\n        icon={<GearIcon style={{ color: 'white', width: 20, height: 20 }} />}\n        aria-label=\"Open Preferences\"\n        variant=\"preferences\"\n        title=\"Preferences\"\n        data-gamepad-focusable=\"true\"\n      />\n      {/* Render the modal conditionally */}\n      {isPreferencesOpen && <PreferencesModal isOpen={isPreferencesOpen} onClose={closePreferences} />}\n    </>\n  );\n};\n\nexport default PreferencesButton;\n","import React from 'react';\n\n/**\n * Bar chart icon component for stats button\n * @param {Object} props - Component props\n * @param {string} props.color - Color of the icon (default: 'currentColor')\n * @param {number} props.size - Size of the icon in pixels (default: 24)\n */\nconst BarChartIcon = ({ color = 'currentColor', size = 24 }) => {\n  return (\n    <svg \n      xmlns=\"http://www.w3.org/2000/svg\" \n      width={size}\n      height={size}\n      viewBox=\"0 0 24 24\" \n      fill=\"none\" \n      stroke={color} \n      strokeWidth=\"2\" \n      strokeLinecap=\"round\" \n      strokeLinejoin=\"round\"\n    >\n      <line x1=\"18\" y1=\"20\" x2=\"18\" y2=\"10\"></line>\n      <line x1=\"12\" y1=\"20\" x2=\"12\" y2=\"4\"></line>\n      <line x1=\"6\" y1=\"20\" x2=\"6\" y2=\"14\"></line>\n      <line x1=\"3\" y1=\"20\" x2=\"21\" y2=\"20\"></line>\n    </svg>\n  );\n};\n\nexport default BarChartIcon;\n","import React from 'react';\n\n/**\n * Download CSV icon component for transaction log download button\n * @param {Object} props - Component props\n * @param {string} props.color - Color of the icon (default: 'currentColor')\n * @param {number} props.size - Size of the icon in pixels (default: 24)\n */\nconst DownloadIcon = ({ color = 'currentColor', size = 24 }) => {\n  return (\n    <svg \n      xmlns=\"http://www.w3.org/2000/svg\" \n      width={size} \n      height={size} \n      viewBox=\"0 0 24 24\" \n      fill=\"none\" \n      stroke={color} \n      strokeWidth=\"2\" \n      strokeLinecap=\"round\" \n      strokeLinejoin=\"round\"\n    >\n      {/* Stylized CSV download icon with document and arrow */}\n      <path d=\"M14 3v4a1 1 0 0 0 1 1h4\" />\n      <path d=\"M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z\" />\n      <path d=\"M12 15 L12 18\" />\n      <path d=\"M9.5 16.5 L12 19 L14.5 16.5\" />\n      <path d=\"M8 10 L10 10\" />\n      <path d=\"M12 10 L14 10\" />\n      <path d=\"M16 10 L16 10\" />\n    </svg>\n  );\n};\n\nexport default DownloadIcon;\n","import React from 'react';\nimport IconButton from './IconButton';\nimport DownloadIcon from '../icons/DownloadIcon';\n// Optional import - only used if gameState not provided via props\nlet useGameContext;\ntry {\n  useGameContext = require('../../contexts/GameContext').useGameContext;\n} catch (error) {\n  // Context not available - will rely on props\n  useGameContext = () => ({ gameState: null });\n}\n\n/**\n * A specialized button component for downloading game transactions as CSV\n * \n * @param {Object} props Component props\n * @param {string} props.title Custom tooltip text (optional)\n * @param {Object} props.gameState Game state object (optional, will use context if not provided)\n */\nconst TransactionDownloadButton = ({ \n  title = \"Download Transaction Log as CSV\",\n  gameState: propGameState,\n  ...restProps \n}) => {\n  // Use provided gameState or try to get from context if available\n  let contextValue;\n  try {\n    contextValue = useGameContext ? useGameContext() : { gameState: null };\n  } catch (error) {\n    // Context not available\n    contextValue = { gameState: null };\n  }\n  \n  // Handle both the original gameState format and our new gameData format\n  const gameData = propGameState || contextValue?.gameState;\n  \n  // Extract data based on structure\n  // For historical games from the API, the structure might be slightly different\n  const gameTransactions = gameData?.gameTransactions || gameData?.gameData?.gameTransactions || [];\n  const gameId = gameData?._id || gameData?.id || 'unknown';\n\n  const downloadTransactionsCSV = () => {\n    // Ensure we have transactions as an array\n    const transactions = Array.isArray(gameTransactions) ? gameTransactions : [];\n    \n    if (transactions.length === 0) return;\n    \n    // Create CSV header\n    let csvContent = \"Player,Transaction Type,Amount,Round,Timestamp\\n\";\n    \n    // Make a copy of transactions for sorting\n    const sortedTransactions = [...transactions].map(tx => ({\n      ...tx,\n      // Ensure timestamp is a Date object for sorting\n      timestamp: tx.timestamp ? new Date(tx.timestamp) : new Date()\n    }));\n    \n    // Sort all transactions by timestamp in ascending order\n    sortedTransactions.sort((a, b) => a.timestamp - b.timestamp);\n    \n    // Add sorted transaction data to CSV\n    sortedTransactions.forEach(tx => {\n      // Format date for display\n      const timestamp = tx.timestamp ? new Date(tx.timestamp).toLocaleString() : 'N/A';\n      \n      // Escape any commas in the player name\n      const playerName = tx.playerName || tx.player || 'Unknown Player';\n      const escapedName = playerName.includes(',') ? `\"${playerName}\"` : playerName;\n      \n      // Use the transactionType field if available, otherwise derive it from reason\n      let transactionType = tx.transactionType || 'Transaction';\n      \n      // If we need to derive the transaction type from the reason\n      if (!tx.transactionType && tx.reason) {\n        // Extract the action part from the reason (e.g., \"Ante in round 1\" -> \"Ante\")\n        const reasonParts = tx.reason.split(' ');\n        transactionType = reasonParts[0]; // Take the first word as the type\n        \n        // Special case for \"Won bet\" which is two words\n        if (reasonParts[0] === 'Won') {\n          transactionType = 'Win';\n        }\n        // Special case for penalty reasons\n        else if (tx.reason.includes('penalty')) {\n          transactionType = 'Penalty';\n        }\n      }\n      \n      // Add the transaction row\n      csvContent += `${escapedName},${transactionType},${tx.amount},${tx.round || 'N/A'},${timestamp}\\n`;\n    });\n    \n    // Create and trigger download\n    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\n    const url = URL.createObjectURL(blob);\n    const link = document.createElement('a');\n    link.setAttribute('href', url);\n    link.setAttribute('download', `game-${gameId}-transactions.csv`);\n    link.style.visibility = 'hidden';\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  };\n\n  return (\n    <IconButton\n      icon={<DownloadIcon color=\"white\" size={20} />}\n      title={title}\n      onClick={downloadTransactionsCSV}\n      variant=\"default\"\n      {...restProps}\n    />\n  );\n};\n\nexport default TransactionDownloadButton;\n","import { useMemo } from 'react';\nimport styles from './styles/GameStats.module.css';\nimport CurrencyAmount from './common/CurrencyAmount';\n\nconst GameStats = ({ gameData }) => {\n  const transactions = gameData.gameTransactions;\n  const players = gameData.players;\n  \n  // Construct player names from both players and transactions\n  const playerNames = {};\n  \n  // First add current players\n  Object.entries(players).forEach(([playerId, player]) => {\n    playerNames[playerId] = player.name;\n  });\n  \n  // Then add players who left but have transactions\n  transactions.forEach(tx => {\n    if (tx.playerId && !playerNames[tx.playerId]) {\n      playerNames[tx.playerId] = tx.playerName || 'Unknown Player';\n    }\n  });\n\n  // Calculate game statistics from transaction data\n  const gameStats = useMemo(() => {\n    if (transactions.length === 0) {\n      return [];\n    }\n\n    // Helper function to format numbers with commas\n    const formatNumber = (num) => num.toLocaleString();\n\n    // Group transactions by player\n    const playerTransactions = {};\n    transactions.forEach(tx => {\n      if (!playerTransactions[tx.playerId]) {\n        playerTransactions[tx.playerId] = [];\n      }\n      playerTransactions[tx.playerId].push(tx);\n    });\n\n    // Get rounds from game data\n    const rounds = gameData.round || 1;\n    \n    // Calculate total decks - get from game data, not transactions\n    const decks = gameData.deckCount || 1;\n\n    // Calculate total ante amount\n    const totalAnteAmount = transactions\n      .filter(tx => tx.transactionType === 'Ante')\n      .reduce((sum, tx) => sum + Math.abs(tx.amount), 0);\n\n    // Calculate total bet amount\n    const totalBetAmount = transactions\n      .filter(tx => tx.transactionType === 'Bet')\n      .reduce((sum, tx) => sum + Math.abs(tx.amount), 0);\n\n    // Calculate biggest single bet\n    const bets = transactions.filter(tx => tx.transactionType === 'Bet');\n    const biggestBet = bets.length > 0 ?\n      bets.reduce((max, tx) => Math.abs(tx.amount) > Math.abs(max.amount) ? tx : max, bets[0]) :\n      null;\n\n    // Calculate biggest pot\n    const biggestPot = transactions.reduce((max, tx) => tx.potAmount > max ? tx.potAmount : max, 0);\n\n    // Calculate total penalties\n    const penalties = transactions.filter(tx => tx.transactionType === '2x' || tx.transactionType === '3x');\n    const totalPenaltyAmount = penalties.reduce((sum, tx) => sum + Math.abs(tx.amount), 0);\n\n    // Calculate player with most bets (aggressive player)\n    const playerBetCounts = {};\n    bets.forEach(tx => {\n      playerBetCounts[tx.playerId] = (playerBetCounts[tx.playerId] || 0) + 1;\n    });\n\n    let mostAggressivePlayerId = null;\n    let mostBets = 0;\n    \n    Object.entries(playerBetCounts).forEach(([playerId, count]) => {\n      if (count > mostBets) {\n        mostBets = count;\n        mostAggressivePlayerId = playerId;\n      }\n    });\n\n    // Calculate average bet size by player\n    const playerBetTotals = {};\n    bets.forEach(tx => {\n      if (!playerBetTotals[tx.playerId]) {\n        playerBetTotals[tx.playerId] = { total: 0, count: 0 };\n      }\n      playerBetTotals[tx.playerId].total += Math.abs(tx.amount);\n      playerBetTotals[tx.playerId].count += 1;\n    });\n\n    // Find player with highest average bet\n    let highestAvgBetPlayerId = null;\n    let highestAvgBet = 0;\n    \n    Object.entries(playerBetTotals).forEach(([playerId, data]) => {\n      const avg = data.total / data.count;\n      if (avg > highestAvgBet) {\n        highestAvgBet = avg;\n        highestAvgBetPlayerId = playerId;\n      }\n    });\n\n    // Calculate player wins count\n    const playerWins = {};\n    transactions\n      .filter(tx => tx.transactionType === 'Win')\n      .forEach(tx => {\n        playerWins[tx.playerId] = (playerWins[tx.playerId] || 0) + 1;\n      });\n\n    // Find most winning player\n    let mostWinningPlayerId = null;\n    let mostWins = 0;\n    \n    Object.entries(playerWins).forEach(([playerId, wins]) => {\n      if (wins > mostWins) {\n        mostWins = wins;\n        mostWinningPlayerId = playerId;\n      }\n    });\n\n    // Calculate penalty counts by player\n    const playerPenalties = {};\n    penalties.forEach(tx => {\n      playerPenalties[tx.playerId] = (playerPenalties[tx.playerId] || 0) + 1;\n    });\n\n    // Find player with most penalties\n    let mostPenaltiesPlayerId = null;\n    let mostPenalties = 0;\n    \n    Object.entries(playerPenalties).forEach(([playerId, count]) => {\n      if (count > mostPenalties) {\n        mostPenalties = count;\n        mostPenaltiesPlayerId = playerId;\n      }\n    });\n\n    // Use server-side calculated totals\n    const playerProfits = gameData.totals || {};\n\n    // Find biggest winner and loser\n    let biggestWinnerId = null;\n    let biggestWin = 0;\n    let biggestLoserId = null;\n    let biggestLoss = 0;\n    \n    Object.entries(playerProfits).forEach(([playerId, profit]) => {\n      if (profit > biggestWin) {\n        biggestWin = profit;\n        biggestWinnerId = playerId;\n      }\n      if (profit < biggestLoss) {\n        biggestLoss = profit;\n        biggestLoserId = playerId;\n      }\n    });\n\n    // Build stats array with all the interesting stats we've calculated\n    return [\n      {\n        key: 'totalDecks',\n        label: 'Total Decks',\n        value: decks,\n        type: 'number'\n      },\n      {\n        key: 'totalRounds',\n        label: 'Total Rounds',\n        value: rounds,\n        type: 'number'\n      },\n      {\n        key: 'totalBets',\n        label: 'Total Bets Placed',\n        value: bets.length,\n        type: 'number'\n      },\n      {\n        key: 'totalAnte',\n        label: 'Total Ante Amount',\n        value: totalAnteAmount,\n        type: 'currency'\n      },\n      {\n        key: 'totalBetAmount',\n        label: 'Total Bet Amount',\n        value: totalBetAmount,\n        type: 'currency'\n      },\n      {\n        key: 'biggestPot',\n        label: 'Biggest Pot',\n        value: biggestPot,\n        type: 'currency'\n      },\n      {\n        key: 'biggestBet',\n        label: 'Biggest Single Bet',\n        value: biggestBet ? Math.abs(biggestBet.amount) : 0,\n        type: 'currency',\n        suffix: biggestBet ? ` by ${biggestBet.playerName}` : ''\n      },\n      {\n        key: 'biggestWinner',\n        label: 'Biggest Winner',\n        value: biggestWinnerId ? playerNames[biggestWinnerId] || 'Unknown Player' : 'N/A',\n        type: 'text',\n        suffix: biggestWinnerId ? ` (+${formatNumber(biggestWin)})` : ''\n      },\n      {\n        key: 'biggestLoser',\n        label: 'Biggest Loser',\n        value: biggestLoserId ? playerNames[biggestLoserId] || 'Unknown Player' : 'N/A',\n        type: 'text',\n        suffix: biggestLoserId ? ` (${formatNumber(biggestLoss)})` : ''\n      },\n      {\n        key: 'mostAggressive',\n        label: 'Most Aggressive Player',\n        value: mostAggressivePlayerId ? playerNames[mostAggressivePlayerId] || 'Unknown Player' : 'N/A',\n        type: 'text',\n        suffix: mostAggressivePlayerId ? ` (${formatNumber(mostBets)} bets)` : ''\n      },\n      {\n        key: 'highestAvgBet',\n        label: 'Highest Average Bet',\n        value: highestAvgBetPlayerId ? playerNames[highestAvgBetPlayerId] || 'Unknown Player' : 'N/A',\n        type: 'text',\n        suffix: highestAvgBetPlayerId ? ` (avg: ${formatNumber(Math.round(highestAvgBet))})` : ''\n      },\n      {\n        key: 'mostWinning',\n        label: 'Most Winning Player',\n        value: mostWinningPlayerId ? playerNames[mostWinningPlayerId] || 'Unknown Player' : 'N/A',\n        type: 'text',\n        suffix: mostWinningPlayerId ? ` (${formatNumber(mostWins)} wins)` : ''\n      },\n      {\n        key: 'totalPenalties',\n        label: 'Total Penalties',\n        value: penalties.length,\n        type: 'number',\n        suffix: penalties.length > 0 ? ` (${formatNumber(totalPenaltyAmount)} coins)` : ''\n      },\n      {\n        key: 'unluckyPlayer',\n        label: 'Most Penalized Player',\n        value: mostPenaltiesPlayerId ? playerNames[mostPenaltiesPlayerId] || 'Unknown Player' : 'N/A',\n        type: 'text',\n        suffix: mostPenaltiesPlayerId ? ` (${formatNumber(mostPenalties)} penalties)` : ''\n      }\n    ];\n  }, [transactions, playerNames]);\n\n  // Helper function to format stat values based on their type\n  const formatStatValue = (type, value) => {\n    // Handle different types of values appropriately\n    if (type === 'currency') {\n      // Return CurrencyAmount component for currency values\n      return <CurrencyAmount amount={value} size=\"small\" />;\n    }\n    \n    if (type === 'percentage') {\n      return `${(value * 100).toFixed(1)}%`;\n    }\n    \n    if (type === 'number') {\n      return value.toLocaleString();\n    }\n    \n    // Default return for text and other types\n    return value;\n  };\n\n  return (\n    <div className={styles.tabContent}>\n      {gameStats.length === 0 ? (\n        <p className={styles.noDataMessage}>No statistics available for this game.</p>\n      ) : (\n        <div className={styles.statsGrid}>\n          {gameStats.map((stat) => (\n            <div key={stat.key} className={styles.statItem}>\n              <div className={styles.statLabel}>{stat.label}</div>\n              <div className={styles.statValue}>\n                {formatStatValue(stat.type, stat.value)}\n                {stat.suffix && <span className={styles.statSuffix}>{stat.suffix}</span>}\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default GameStats;\n","import React, { useMemo, useState } from 'react';\nimport { createPortal } from 'react-dom';\nimport styles from './styles/GameSummaryModal.module.css';\nimport CurrencyAmount from './common/CurrencyAmount';\nimport TransactionDownloadButton from './common/TransactionDownloadButton';\nimport GameStats from './GameStats';\n\n/**\n * Game Summary Modal component that displays running scores and settle-up calculations\n * Can be used with active game data from GameContext or with historical game data passed directly\n */\nconst GameSummaryModal = ({ onClose, gameData }) => {\n  if (!gameData) {\n    const loadingContent = (\n      <div className={styles.modalOverlay}>\n        <div className={styles.modalContent}>\n          <div className={styles.modalHeader}>\n            <h2>Game Summary</h2>\n            <button className={styles.closeButton} onClick={onClose} data-gamepad-focusable=\"true\"></button>\n          </div>\n          <div className={styles.settingsContainer}>\n            <div className={styles.loadingMessage}>Loading game data...</div>\n          </div>\n        </div>\n      </div>\n    );\n    return createPortal(loadingContent, document.body);\n  }\n\n  // Extract data from gameData with clean access now that structure is consistent\n  const gameTransactions = gameData.gameTransactions || [];\n  const players = gameData.players || {};\n  const gameId = gameData.id || 'unknown';\n  const showPayoutsTab = gameData.settings?.isPrivate || false;\n  \n  // Ensure gameTransactions is always an array\n  const transactions = Array.isArray(gameTransactions) ? gameTransactions : [];\n  \n  // Get player names (including those who left)\n  const playerNames = {};\n  \n  // First add current players\n  Object.entries(players).forEach(([playerId, player]) => {\n    playerNames[playerId] = player.name;\n  });\n  \n  // Then add players who left but have transactions\n  transactions.forEach(tx => {\n    if (tx.playerId && !playerNames[tx.playerId]) {\n      playerNames[tx.playerId] = tx.playerName || 'Unknown Player';\n    }\n  });\n\n  // Use server-side calculated totals (active games have totals, historical games have it at top level)\n  const playerTotals = gameData.totals || {};\n  \n  // Calculate settle-up payments\n  const settleUpPayments = useMemo(() => {\n    // For simple 2-player games, just have the loser pay the winner directly\n    if (Object.keys(playerTotals).length === 2) {\n      const players = Object.entries(playerTotals);\n      const [player1Id, player1Total] = players[0];\n      const [player2Id, player2Total] = players[1];\n      \n      // If totals sum to zero (or close to it), one player pays the other\n      if (Math.abs(player1Total + player2Total) < 0.1) {\n        if (player1Total > 0) {\n          // Player 2 pays Player 1\n          return [{\n            from: player2Id,\n            fromName: playerNames[player2Id],\n            to: player1Id,\n            toName: playerNames[player1Id],\n            amount: Math.abs(player1Total)\n          }];\n        } else if (player2Total > 0) {\n          // Player 1 pays Player 2\n          return [{\n            from: player1Id,\n            fromName: playerNames[player1Id],\n            to: player2Id,\n            toName: playerNames[player2Id],\n            amount: Math.abs(player2Total)\n          }];\n        }\n      }\n    }\n    \n    // For more complex cases with more players\n    const payments = [];\n    \n    // Split into winners and losers\n    const losers = Object.entries(playerTotals)\n      .filter(([_, amount]) => amount < 0)\n      .map(([playerId, amount]) => ({\n        playerId,\n        playerName: playerNames[playerId] || 'Unknown Player',\n        amount: Math.abs(amount) // Convert to positive amount for easier calculation\n      }));\n    \n    const winners = Object.entries(playerTotals)\n      .filter(([_, amount]) => amount > 0)\n      .map(([playerId, amount]) => ({\n        playerId,\n        playerName: playerNames[playerId] || 'Unknown Player',\n        amount\n      }));\n    \n    // Sort by amount (descending)\n    losers.sort((a, b) => b.amount - a.amount);\n    winners.sort((a, b) => b.amount - a.amount);\n    \n    // Process each winner, starting with the biggest winner\n    while (winners.length > 0 && losers.length > 0) {\n      const winner = winners[0];\n      const loser = losers[0];\n      \n      // Calculate payment amount\n      const paymentAmount = Math.min(winner.amount, loser.amount);\n      \n      if (paymentAmount > 0.01) { // Only process meaningful payments\n        // Add payment\n        payments.push({\n          from: loser.playerId,\n          fromName: loser.playerName,\n          to: winner.playerId,\n          toName: winner.playerName,\n          amount: paymentAmount\n        });\n        \n\n        \n        // Update balances\n        winner.amount -= paymentAmount;\n        loser.amount -= paymentAmount;\n        \n        // Remove settled players or re-sort if they still have balance\n        if (winner.amount < 0.01) {\n          winners.shift();\n        }\n        \n        if (loser.amount < 0.01) {\n          losers.shift();\n        }\n      } else {\n        // No meaningful payment possible\n        break;\n      }\n    }\n    \n    return payments;\n  }, [playerTotals, playerNames]);\n\n  // Track the active tab - start with 'totals' tab\n  const [activeTab, setActiveTab] = useState('totals');\n\n  const modalContent = (\n    <div className={styles.modalOverlay} onClick={(e) => e.target === e.currentTarget && onClose()}>\n      <div className={styles.modalContent}>\n        <div className={styles.modalHeader}>\n          <h2>Game Summary ({gameId})</h2>\n          <div className={styles.headerButtons}>\n            <TransactionDownloadButton gameState={gameData} />\n            <button className={styles.closeButton} onClick={onClose} data-gamepad-focusable=\"true\"></button>\n          </div>\n        </div>\n        \n        <div className={styles.settingsContainer}>\n          {/* Tab Bar Navigation */}\n          <div className={styles.tabsContainer}>\n            <button \n              className={`${styles.tabButton} ${activeTab === 'totals' ? styles.activeTab : ''}`}\n              onClick={() => setActiveTab('totals')}\n              data-gamepad-focusable=\"true\"\n            >\n              Totals\n            </button>\n            \n            <button \n              className={`${styles.tabButton} ${activeTab === 'stats' ? styles.activeTab : ''}`}\n              onClick={() => setActiveTab('stats')}\n              data-gamepad-focusable=\"true\"\n            >\n              Stats\n            </button>\n            \n            {showPayoutsTab && (\n              <button \n                className={`${styles.tabButton} ${activeTab === 'payouts' ? styles.activeTab : ''}`}\n                onClick={() => setActiveTab('payouts')}\n                data-gamepad-focusable=\"true\"\n              >\n                Payouts\n              </button>\n            )}\n          </div>\n\n          {/* Totals Tab Content */}\n          {activeTab === 'totals' && (\n            <div className={styles.tabContent}>\n              {Object.keys(playerTotals).length === 0 ? (\n                <p className={styles.noDataMessage}>No transactions recorded yet.</p>\n              ) : (\n                <div className={styles.totalsTable}>\n                  {Object.entries(playerTotals).map(([playerId, total]) => (\n                    <div key={playerId} className={styles.totalRow}>\n                      <span className={styles.playerName}>{playerNames[playerId] || 'Unknown Player'}</span>\n                      <span className={`${styles.totalAmount} ${total >= 0 ? styles.positive : styles.negative}`}>\n                        <CurrencyAmount amount={total} size=\"small\" />\n                      </span>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </div>\n          )}\n          \n          {/* Stats Tab Content */}\n          {activeTab === 'stats' && (\n            <GameStats gameData={gameData} />\n          )}\n\n          {/* Payouts Tab Content - Only shown for private games and when selected */}\n          {activeTab === 'payouts' && showPayoutsTab && (\n            <div className={styles.tabContent}>\n              {settleUpPayments.length === 0 ? (\n                <p className={styles.noDataMessage}>No payments needed or no transactions recorded yet.</p>\n              ) : (\n                <div className={styles.settleUpTable}>\n                  {settleUpPayments.map((payment, index) => (\n                    <div key={index} className={styles.paymentRow}>\n                      <span className={styles.paymentText}>\n                        <span className={styles.playerName}>{payment.fromName}</span> pays{' '}\n                        <span className={styles.playerName}>{payment.toName}</span>\n                      </span>\n                      <span className={styles.paymentAmount}>\n                        <CurrencyAmount amount={payment.amount} size=\"small\" />\n                      </span>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n\n  // Render modal using portal to document.body to avoid transform context issues\n  return createPortal(modalContent, document.body);\n};\n\nexport default GameSummaryModal;\n","import React, { createContext, useContext, useState, useEffect, useCallback, useRef } from 'react';\nimport { useSocket } from './SocketContext';\nimport { useAuth } from './AuthContext';\nimport { API_URL } from '../config';\n\nconst UserDataContext = createContext(null);\n\nexport const UserDataProvider = ({ children }) => {\n  const { socket } = useSocket();\n  const { token } = useAuth();\n  const [userCache, setUserCache] = useState(new Map());\n  const pendingFetches = useRef(new Set());\n  const fetchTimer = useRef(null);\n\n  // Subscribe to user data updates via socket\n  useEffect(() => {\n    if (!socket) return;\n\n    const handleUserDataUpdate = ({ userId, data }) => {\n      console.log('[UserDataContext] Received user data update:', userId, data);\n      setUserCache(prev => {\n        const newCache = new Map(prev);\n        newCache.set(userId, data);\n        return newCache;\n      });\n    };\n\n    socket.on('userDataUpdated', handleUserDataUpdate);\n    return () => {\n      socket.off('userDataUpdated', handleUserDataUpdate);\n    };\n  }, [socket]);\n\n  // Clean up timer on unmount\n  useEffect(() => {\n    return () => {\n      if (fetchTimer.current) {\n        clearTimeout(fetchTimer.current);\n      }\n    };\n  }, []);\n\n  const fetchUsersData = useCallback(async (userIds) => {\n    if (!userIds || userIds.length === 0 || !token) return {};\n\n    try {\n      const response = await fetch(`${API_URL}/users`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${token}`\n        },\n        body: JSON.stringify({ userIds })\n      });\n      \n      if (!response.ok) {\n        throw new Error('Failed to fetch users data');\n      }\n      \n      const userData = await response.json();\n      \n      setUserCache(prev => {\n        const newCache = new Map(prev);\n        Object.entries(userData).forEach(([userId, data]) => {\n          newCache.set(userId, data);\n        });\n        return newCache;\n      });\n      \n      return userData;\n    } catch (error) {\n      return {};\n    }\n  }, [token]);\n\n  const executeBatchFetch = useCallback(() => {\n    if (pendingFetches.current.size === 0) return;\n    \n    const userIds = Array.from(pendingFetches.current);\n    pendingFetches.current.clear();\n    \n    fetchUsersData(userIds);\n  }, [fetchUsersData]);\n\n  const getUserData = useCallback((userId) => {\n    if (!userId) return null;\n    \n    const cached = userCache.get(userId);\n    if (cached) return cached;\n    \n    // Add to pending fetches and debounce\n    pendingFetches.current.add(userId);\n    \n    if (fetchTimer.current) {\n      clearTimeout(fetchTimer.current);\n    }\n    \n    fetchTimer.current = setTimeout(() => {\n      executeBatchFetch();\n    }, 10);\n    \n    return null;\n  }, [userCache, executeBatchFetch]);\n\n  const prefetchUsers = useCallback((userIds) => {\n    const uncachedIds = userIds.filter(id => !userCache.has(id));\n    if (uncachedIds.length > 0) {\n      fetchUsersData(uncachedIds);\n    }\n  }, [userCache, fetchUsersData]);\n\n  const value = {\n    getUserData,\n    prefetchUsers\n  };\n\n  return (\n    <UserDataContext.Provider value={value}>\n      {children}\n    </UserDataContext.Provider>\n  );\n};\n\nexport const useUserData = (userId) => {\n  const context = useContext(UserDataContext);\n  \n  if (!context) {\n    throw new Error('useUserData must be used within UserDataProvider');\n  }\n  \n  return context.getUserData(userId);\n};\n\nexport default UserDataContext;","import React, { useState, useEffect } from 'react';\nimport styles from './styles/UserAvatar.module.css';\nimport { useUserData } from '../contexts/UserDataContext';\n\n/**\n * UserAvatar component displays a user's profile image or their initials if no image is available.\n * Uses centralized UserData system for consistent user information across the app.\n * \n * @param {Object} props - Component props\n * @param {string} props.userId - User ID to fetch data for\n * @param {string} props.size - Size of the avatar ('small', 'medium', 'large')\n * @param {boolean} props.showName - Whether to display the username next to the avatar\n * @param {string} props.namePosition - Position of the username ('right', 'below')\n * @param {string} props.className - Additional CSS class for styling\n * @param {boolean} props.showTitle - Whether to show the title\n */\nconst UserAvatar = ({ \n  userId,\n  size = 'medium', \n  showName = true, \n  namePosition = 'right',\n  className = '',\n  showTitle = true\n}) => {\n  const [showPlayerCard, setShowPlayerCard] = useState(false);\n  const user = useUserData(userId);\n  \n  if (!userId) return null;\n  \n  // Show loading state while user data loads\n  if (!user) {\n    const sizeClass = styles[size] || styles.medium;\n    const containerClass = showName ? styles[`container${namePosition.charAt(0).toUpperCase() + namePosition.slice(1)}`] : '';\n    \n    return (\n      <div className={`${styles.userAvatarContainer} ${containerClass} ${className}`}>\n        <div className={`${styles.avatar} ${sizeClass} ${styles.loading}`}>\n          <div className={styles.avatarLoader}></div>\n        </div>\n        {showName && (\n          <div className={styles.userInfo}>\n            <div className={styles.skeletonUsername}></div>\n            {showTitle && (\n              <div className={styles.skeletonTitle}></div>\n            )}\n          </div>\n        )}\n      </div>\n    );\n  }\n  \n  const { username, profileImg, title, xp, level } = user;\n  const initials = getInitials(username || 'Unknown');\n  const sizeClass = styles[size] || styles.medium;\n  const containerClass = showName ? styles[`container${namePosition.charAt(0).toUpperCase() + namePosition.slice(1)}`] : '';\n  \n  // Format the image URL to point to the server\n  const API_URL = import.meta.env.VITE_API_URL || 'http://localhost:3001';\n  \n  // Handle different URL formats\n  let formattedImageUrl = null;\n  if (profileImg) {\n    // If the URL already starts with http, use it as is\n    if (profileImg.startsWith('http')) {\n      formattedImageUrl = profileImg;\n    } \n    // If the URL contains /uploads/, replace it with /files/\n    else if (profileImg.includes('/uploads/')) {\n      // Extract just the filename from the path\n      const filename = profileImg.split('/').pop();\n      formattedImageUrl = `${API_URL}/files/images/${filename}`;\n    }\n    // Otherwise, just append the URL to the API_URL\n    else {\n      formattedImageUrl = `${API_URL}${profileImg}`;\n    }\n  }\n\n  \n  return (\n    <div className={`${styles.userAvatarContainer} ${containerClass} ${className}`}>\n      <div \n        className={`${styles.avatar} ${sizeClass}`}\n        onMouseEnter={() => setShowPlayerCard(true)}\n        onMouseLeave={() => setShowPlayerCard(false)}\n      >\n        <div className={styles.avatarImageContainer}>\n          {formattedImageUrl ? (\n            <img \n              src={formattedImageUrl} \n              alt={`${username}'s avatar`} \n              className={styles.avatarImage}\n              onError={(e) => {\n                console.error(`Failed to load profile image for ${username}:`, e);\n                e.target.style.display = 'none';\n                e.target.nextSibling.style.display = 'flex';\n              }}\n            />\n          ) : null}\n          <div \n            className={styles.initialsPlaceholder}\n            style={{ display: formattedImageUrl ? 'none' : 'flex' }}\n          >\n            {initials}\n          </div>\n        </div>\n\n        {/* Player Card */}\n        {showPlayerCard && (\n          <div className={styles.playerCard}>\n            <div className={styles.playerCardAvatar}>\n              {formattedImageUrl ? (\n                <img \n                  src={formattedImageUrl} \n                  alt={`${username}'s avatar`} \n                  className={styles.playerCardImage}\n                />\n              ) : (\n                <div className={styles.playerCardInitials}>\n                  {initials}\n                </div>\n              )}\n            </div>\n            <div className={styles.playerCardInfo}>\n              <div className={styles.playerCardUsername}>\n                {username || 'Unknown'}\n              </div>\n              {title && (\n                <div className={styles.playerCardTitle}>\n                  {title}\n                </div>\n              )}\n              {level !== undefined && xp !== undefined && (\n                <div className={styles.playerCardLevelXP}>\n                  Level {level} <span className={styles.separator}></span> <span className={styles.xpValue}>{formatXP(xp)} XP</span>\n                </div>\n              )}\n            </div>\n          </div>\n        )}\n      </div>\n      \n      {showName && (\n        <div className={styles.userInfo}>\n          <div className={styles.username}>\n            {username || 'Unknown'}\n          </div>\n          {showTitle && title && (\n            <div className={styles.userTitle}>\n              {title}\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  );\n};\n\n// Helper function to get initials from a name\nconst getInitials = (name) => {\n  if (!name) return '?';\n  \n  return name\n    .split(' ')\n    .map(part => part.charAt(0))\n    .join('')\n    .toUpperCase()\n    .substring(0, 2);\n};\n\n// Helper function to format XP with abbreviations\nconst formatXP = (xp) => {\n  if (xp >= 1000000) {\n    return (xp / 1000000).toFixed(1).replace(/\\.0$/, '') + 'M';\n  }\n  if (xp >= 1000) {\n    return (xp / 1000).toFixed(1).replace(/\\.0$/, '') + 'K';\n  }\n  return xp.toString();\n};\n\nexport default UserAvatar;\n","import React, { useState, useEffect, useContext } from 'react';\nimport CurrencyAmount from './common/CurrencyAmount';\nimport UserAvatar from './UserAvatar';\nimport styles from './styles/Leaderboard.module.css';\nimport { API_URL } from '../config';\nimport UserDataContext from '../contexts/UserDataContext';\n\nconst Leaderboard = () => {\n  const [leaderboard, setLeaderboard] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [duration, setDuration] = useState('all');\n  const userDataContext = useContext(UserDataContext);\n\n  useEffect(() => {\n    fetchLeaderboard();\n  }, [duration]);\n\n  const fetchLeaderboard = async () => {\n    setLoading(true);\n    setError(null);\n    \n    try {\n      const response = await fetch(`${API_URL}/leaderboard?duration=${duration}`);\n      \n      if (!response.ok) {\n        throw new Error('Failed to fetch leaderboard');\n      }\n      \n      const data = await response.json();\n      setLeaderboard(data.leaderboard || []);\n      \n      // Prefetch all user data for better performance\n      if (userDataContext && data.leaderboard) {\n        const userIds = data.leaderboard.map(player => player.userId);\n        userDataContext.prefetchUsers(userIds);\n      }\n    } catch (err) {\n      console.error('Error fetching leaderboard:', err);\n      setError(err.message);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const getRankDisplay = (rank) => {\n    if (rank === 1) return '';\n    if (rank === 2) return '';\n    if (rank === 3) return '';\n    return `#${rank}`;\n  };\n\n  return (\n    <div className={styles.leaderboardContainer}>\n      <div className={styles.leaderboardHeader}>\n        <div className={styles.durationSelector}>\n          <button \n            className={`${styles.durationButton} ${duration === 'all' ? styles.active : ''}`}\n            onClick={() => setDuration('all')}\n            data-gamepad-focusable=\"true\"\n          >\n            All Time\n          </button>\n          <button \n            className={`${styles.durationButton} ${duration === '30days' ? styles.active : ''}`}\n            onClick={() => setDuration('30days')}\n            data-gamepad-focusable=\"true\"\n          >\n            Last 30 Days\n          </button>\n        </div>\n      </div>\n\n      {loading ? (\n        <div className={styles.loadingMessage}>\n          <div className={styles.loadingSpinner}></div>\n          Loading leaderboard...\n        </div>\n      ) : error ? (\n        <div className={styles.errorMessage}>Error: {error}</div>\n      ) : leaderboard.length === 0 ? (\n        <div className={styles.emptyMessage}>\n          No players found for this time period.\n        </div>\n      ) : (\n        <div \n          className={styles.leaderboardList}\n          data-gamepad-scrollable=\"true\"\n          tabIndex=\"0\"\n        >\n          {leaderboard.map((player) => (\n            <div key={player.userId} className={styles.leaderboardRow}>\n              <div className={styles.rankCell}>\n                <span className={styles.rank}>{getRankDisplay(player.rank)}</span>\n              </div>\n              \n              <div className={styles.playerCell}>\n                <UserAvatar \n                  userId={player.userId}\n                  size=\"small\"\n                  showName={true}\n                  showTitle={true}\n                  namePosition=\"right\"\n                />\n              </div>\n              \n              <div className={styles.statsCell}>\n                <CurrencyAmount amount={player.totalProfit} size=\"small\" />\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default Leaderboard;","import React, { useState, useEffect } from 'react';\nimport { useAuth } from '../contexts/AuthContext';\nimport baseModalStyles from './common/BaseModal.module.css';\nimport BaseModal from './common/BaseModal';\nimport GameSummaryModal from './GameSummaryModal';\nimport CurrencyAmount from './common/CurrencyAmount';\nimport Leaderboard from './Leaderboard';\nimport styles from './styles/PlayerStatsModal.module.css';\nimport { API_URL } from '../config';\n\nconst PlayerStatsModal = ({ onClose }) => {\n  const { token } = useAuth();\n  const [activeTab, setActiveTab] = useState('leaderboard'); // 'leaderboard', 'stats', or 'history'\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [historyData, setHistoryData] = useState({ games: [], pagination: {} });\n  const [currentPage, setCurrentPage] = useState(0);\n  const [showGameSummary, setShowGameSummary] = useState(false);\n  const [selectedGameData, setSelectedGameData] = useState(null);\n  const [lifetimeStats, setLifetimeStats] = useState(null);\n  const [statsLoading, setStatsLoading] = useState(true);\n  const [statsError, setStatsError] = useState(null);\n  const pageSize = 5;\n\n  useEffect(() => {\n    const fetchGameHistory = async () => {\n      setLoading(true);\n      setError(null);\n      \n      try {\n        const response = await fetch(`${API_URL}/games/history?pageSize=${pageSize}&pageNumber=${currentPage}`, {\n          headers: {\n            'Authorization': `Bearer ${token}`\n          }\n        });\n        \n        if (!response.ok) {\n          throw new Error('Failed to fetch game history');\n        }\n        \n        const data = await response.json();\n        setHistoryData(data);\n      } catch (err) {\n        console.error('Error fetching game history:', err);\n        setError(err.message);\n      } finally {\n        setLoading(false);\n      }\n    };\n    \n    fetchGameHistory();\n  }, [token, currentPage]);\n  \n  // Fetch lifetime stats from the dedicated stats endpoint\n  useEffect(() => {\n    const fetchLifetimeStats = async () => {\n      setStatsLoading(true);\n      setStatsError(null);\n      \n      try {\n        const response = await fetch(`${API_URL}/me/stats`, {\n          headers: {\n            'Authorization': `Bearer ${token}`\n          }\n        });\n        \n        if (!response.ok) {\n          throw new Error('Failed to fetch lifetime stats');\n        }\n        \n        const data = await response.json();\n        setLifetimeStats(data.stats);\n      } catch (err) {\n        console.error('Error fetching lifetime stats:', err);\n        setStatsError(err.message);\n      } finally {\n        setStatsLoading(false);\n      }\n    };\n    \n    fetchLifetimeStats();\n  }, [token]);\n\n  const handlePreviousPage = () => {\n    if (currentPage > 0) {\n      setCurrentPage(currentPage - 1);\n    }\n  };\n\n  const handleNextPage = () => {\n    if (historyData.pagination && \n        historyData.games.length === pageSize) {\n      setCurrentPage(currentPage + 1);\n    }\n  };\n\n  const formatDate = (dateString) => {\n    if (!dateString) return 'Unknown';\n    \n    const date = new Date(dateString);\n    return new Intl.DateTimeFormat('en-US', {\n      year: 'numeric',\n      month: 'short',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit'\n    }).format(date);\n  };\n  \n  // Format stat label from camelCase to Title Case with spaces\n  const formatStatLabel = (key) => {\n    // Insert space before capital letters and uppercase the first letter\n    const formatted = key\n      .replace(/([A-Z])/g, ' $1')\n      .replace(/^./, (str) => str.toUpperCase());\n    \n    return formatted;\n  };\n  \n  // Format stat value based on the explicit type or the value itself\n  const formatStatValue = (type, value) => {\n    // Handle different types of values appropriately\n    if (typeof value === 'number') {\n      // Format based on explicit type if provided\n      if (type === 'currency') {\n        // Return CurrencyAmount component for currency values\n        return <CurrencyAmount amount={value.toFixed(2)} size=\"small\" />;\n      }\n      \n      if (type === 'percentage') {\n        return `${(value * 100).toFixed(1)}%`;\n      }\n      \n      // Just return the number for counts\n      return value.toLocaleString();\n    }\n    \n    // For boolean values\n    if (typeof value === 'boolean') {\n      return value ? 'Yes' : 'No';\n    }\n    \n    // For dates - only format as date if explicitly typed as 'date' or is an actual Date object\n    if (type === 'date' || value instanceof Date) {\n      return formatDate(value);\n    }\n    \n    // Handle numeric types explicitly\n    if (type === 'number') {\n      return Number(value).toLocaleString();\n    }\n    \n    // Default toString for anything else\n    return String(value);\n  };\n  \n  // Get the round count from the game data\n  const getRoundCount = (game) => {\n    return game.roundCount || 0;\n  };\n\n  const handleGameClick = (gameId) => {\n    // Find the selected game in our existing data\n    const selectedGame = historyData.games.find(game => game.id === gameId);\n    if (selectedGame) {\n      // Historical games now have the same structure as active games\n      setSelectedGameData(selectedGame);\n      setShowGameSummary(true);\n    }\n  };\n\n  return (\n    <>\n      <BaseModal title=\"Player Stats\" onClose={onClose} style={{ maxWidth: 800, height: '90vh' }}>\n        <div className={baseModalStyles.settingsContainer}>\n          {/* Tab Bar Navigation */}\n          <div className={styles.tabsContainer}>\n            <button \n              className={`${styles.tabButton} ${activeTab === 'leaderboard' ? styles.activeTab : ''}`}\n              onClick={() => setActiveTab('leaderboard')}\n              data-gamepad-focusable=\"true\"\n            >\n              Leaderboard\n            </button>\n            <button \n              className={`${styles.tabButton} ${activeTab === 'stats' ? styles.activeTab : ''}`}\n              onClick={() => setActiveTab('stats')}\n              data-gamepad-focusable=\"true\"\n            >\n              Lifetime Stats\n            </button>\n            <button \n              className={`${styles.tabButton} ${activeTab === 'history' ? styles.activeTab : ''}`}\n              onClick={() => setActiveTab('history')}\n              data-gamepad-focusable=\"true\"\n            >\n              Game History\n            </button>\n          </div>\n\n          {/* Leaderboard Tab Content */}\n          {activeTab === 'leaderboard' && (\n            <div className={styles.tabContent}>\n              <Leaderboard />\n            </div>\n          )}\n\n          {/* Lifetime Stats Tab Content */}\n          {activeTab === 'stats' && (\n            <div className={styles.tabContent}>\n              {statsLoading ? (\n                <div className={styles.loadingMessage}>\n                  <div className={styles.loadingSpinner}></div>\n                  Loading your lifetime stats...\n                </div>\n              ) : statsError ? (\n                <div className={styles.errorMessage}>Error: {statsError}</div>\n              ) : !lifetimeStats || lifetimeStats.length === 0 ? (\n                <div className={styles.statsPlaceholder}>\n                  <p>No lifetime statistics available.</p>\n                </div>\n              ) : (\n                <div \n                  className={styles.statsGrid}\n                  data-gamepad-scrollable=\"true\"\n                  tabIndex=\"0\"\n                >\n                  {lifetimeStats.map((stat, index) => (\n                    <div key={stat.key || `stat-${index}`} className={styles.statItem}>\n                      <div className={styles.statLabel}>{stat.label}</div>\n                      <div className={styles.statValue}>\n                        {formatStatValue(stat.type, stat.value)}\n                        {stat.suffix && <span className={styles.statSuffix}>{stat.suffix}</span>}\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </div>\n          )}\n\n          {/* Game History Tab Content */}\n          {activeTab === 'history' && (\n            <div className={styles.tabContent}>\n              {loading ? (\n                <div className={styles.loadingMessage}>\n                  <div className={styles.loadingSpinner}></div>\n                  Loading your game history...\n                </div>\n              ) : error ? (\n                <div className={styles.errorMessage}>Error: {error}</div>\n              ) : historyData.games.length === 0 ? (\n                <div className={styles.statsPlaceholder}>\n                  <p>No games found in your history.</p>\n                </div>\n              ) : (\n                <>\n                  <div \n                    className={styles.historyTable}\n                    data-gamepad-scrollable=\"true\"\n                    tabIndex=\"0\"\n                  >\n                    <div className={styles.tableHeader}>\n                      <div className={styles.gameNameHeader}>Game</div>\n                      <div className={styles.playerCountHeader}>Players</div>\n                      <div className={styles.roundsHeader}>Rounds</div>\n                      <div className={styles.endDateHeader}>Ended</div>\n                    </div>\n                    \n                    {historyData.games.map((game) => (\n                      <div key={game.id} className={styles.historyRow}>\n                        <div className={styles.gameNameCell}>\n                          <span \n                            className={styles.gameNameLink} \n                            onClick={() => handleGameClick(game.id)}\n                            tabIndex=\"0\"\n                            role=\"button\"\n                            data-gamepad-focusable=\"true\"\n                          >\n                            #{game.id}\n                          </span>\n                        </div>\n                        <div className={styles.playerCountCell}>{game.totalPlayerCount}</div>\n                        <div className={styles.roundsCell}>{getRoundCount(game)}</div>\n                        <div className={styles.endDateCell}>{formatDate(game.endedAt)}</div>\n                      </div>\n                    ))}\n                  </div>\n                  \n                  <div className={styles.pageInfo}>\n                    <button \n                      onClick={handlePreviousPage} \n                      disabled={currentPage === 0}\n                      className={styles.pageButton}\n                      aria-label=\"Previous page\"\n                      data-gamepad-focusable=\"true\"\n                    >\n                      &larr;\n                    </button>\n                    \n                    Page {currentPage + 1}\n                    {historyData.pagination && historyData.pagination.total ? \n                      ` of ${Math.ceil(historyData.pagination.total / pageSize)}` : ''}\n                    \n                    <button \n                      onClick={handleNextPage} \n                      disabled={!historyData.pagination || historyData.games.length < pageSize}\n                      className={styles.pageButton}\n                      aria-label=\"Next page\"\n                      data-gamepad-focusable=\"true\"\n                    >\n                      &rarr;\n                    </button>\n                  </div>\n                </>\n              )}\n            </div>\n          )}\n        </div>\n      </BaseModal>\n      \n      {showGameSummary && selectedGameData && (\n        <GameSummaryModal \n          gameData={selectedGameData}\n          onClose={() => {\n            setShowGameSummary(false);\n            setSelectedGameData(null);\n          }} \n        />\n      )}\n      \n\n    </>\n  );\n};\n\n\n\nexport default PlayerStatsModal;\n","import React, { useState, useEffect } from 'react';\nimport BarChartIcon from '../icons/BarChartIcon';\nimport PlayerStatsModal from '../PlayerStatsModal';\nimport IconButton from './IconButton';\n\nconst PlayerStatsButton = ({ onModalStateChange, ...props }) => {\n  const [isStatsOpen, setIsStatsOpen] = useState(false);\n\n  const openStats = () => {\n    setIsStatsOpen(true);\n  };\n\n  const closeStats = () => {\n    setIsStatsOpen(false);\n  };\n\n  // Notify parent when modal state changes\n  useEffect(() => {\n    if (onModalStateChange) {\n      onModalStateChange(isStatsOpen);\n    }\n  }, [isStatsOpen, onModalStateChange]);\n\n  return (\n    <>\n      <IconButton\n        onClick={openStats}\n        icon={<BarChartIcon color=\"white\" size={20} />}\n        aria-label=\"Open Player Stats\"\n        variant=\"stats\"\n        title=\"Player Stats\"\n        {...props}\n      />\n      {/* Render the modal conditionally */}\n      {isStatsOpen && <PlayerStatsModal isOpen={isStatsOpen} onClose={closeStats} />}\n    </>\n  );\n};\n\nexport default PlayerStatsButton;\n","import React from 'react';\n\nconst StoreIcon = ({ className = 'h-6 w-6', ...props }) => {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      fill=\"none\"\n      viewBox=\"0 0 24 24\"\n      strokeWidth={1.8}\n      stroke=\"currentColor\"\n      className={className}\n      {...props}\n    >\n      {/* Shopping bag */}\n      <path\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n        d=\"M15.75 10.5V6a3.75 3.75 0 10-7.5 0v4.5m-2.25 9h12a1.5 1.5 0 001.5-1.5v-6a1.5 1.5 0 00-1.5-1.5h-12a1.5 1.5 0 00-1.5 1.5v6a1.5 1.5 0 001.5 1.5z\"\n      />\n    </svg>\n  );\n};\n\nexport default StoreIcon;","import React from 'react';\nimport StoreIcon from './icons/StoreIcon';\nimport IconButton from './common/IconButton';\n\nconst StoreButton = ({ onClick, ...props }) => {\n  return (\n    <IconButton\n      onClick={onClick}\n      icon={<StoreIcon style={{ color: 'white', width: 20, height: 20 }} />}\n      aria-label=\"Store\"\n      variant=\"store\"\n      title=\"Store\"\n      {...props}\n    />\n  );\n};\n\nexport default StoreButton;","import React from 'react';\nimport styles from './styles/ProgressInfo.module.css';\nimport CurrencyAmount from './common/CurrencyAmount';\nimport { useUserData } from '../contexts/UserDataContext';\n\n/**\n * ProgressInfo component displays user's balance and XP progress in a unified display\n * \n * @param {Object} props - Component props\n * @param {string} props.userId - User ID to fetch data for\n * @param {number} props.balance - User's balance amount\n */\nconst ProgressInfo = ({ userId, balance }) => {\n  const userData = useUserData(userId);\n\n  return (\n    <div className={styles.progressInfoContainer}>\n      <div className={styles.balanceSection}>\n        <span className={styles.balanceLabel}>Balance:</span>\n        <CurrencyAmount amount={Number(balance) || 0} size=\"medium\" />\n      </div>\n      \n      {userData && (\n        <div className={styles.xpSection}>\n          <div className={styles.xpBarContainer}>\n            <div \n              className={styles.xpBar}\n              style={{ \n                width: userData.level >= 100 ? '100%' : \n                  `${Math.min(100, Math.max(0, (userData.xp / (userData.xp + userData.xpToNextLevel)) * 100))}%`\n              }}\n            />\n            <div className={styles.xpOverlay}>\n              <div className={styles.xpLevel}>Level {userData.level}</div>\n              <div className={styles.xpNext}>\n                {userData.level < 100 ? `${userData.xpToNextLevel.toLocaleString()} XP` : 'MAX'}\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default ProgressInfo;","import React, { useRef, useEffect } from 'react';\nimport { useVirtualKeyboardContext } from '../contexts/VirtualKeyboardContext';\n\n/**\n * Enhanced input component that automatically shows virtual keyboard for gamepad users\n * Drop-in replacement for regular input elements\n */\nconst GamepadInput = ({ \n  type = 'text',\n  title = '',\n  ...props \n}) => {\n  const inputRef = useRef(null);\n  const { enhanceInput } = useVirtualKeyboardContext();\n  \n  useEffect(() => {\n    if (inputRef.current) {\n      const cleanup = enhanceInput(inputRef.current, type, title);\n      return cleanup;\n    }\n  }, [enhanceInput, type, title]);\n  \n  return (\n    <input\n      ref={inputRef}\n      type={type}\n      data-gamepad-focusable=\"true\"\n      {...props}\n    />\n  );\n};\n\nexport default GamepadInput;","import React, { useState, useEffect } from 'react';\nimport ToggleSwitch from './ToggleSwitch.jsx';\nimport lobbyStyles from './styles/Lobby.module.css';\nimport BaseModal from './common/BaseModal';\nimport baseModalStyles from './common/BaseModal.module.css';\nimport GamepadInput from './GamepadInput';\n\nconst DEFAULT_SETTINGS = {\n  useCustomName: false,\n  customName: '',\n  isPrivate: false,\n  password: '',\n  enableAceChoice: true,\n  enableSecondChance: true,\n  numberOfBots: 0,\n};\n\nconst GameSettingsModal = ({ initialSettings = DEFAULT_SETTINGS, onSubmit, onClose }) => {\n  const [settings, setSettings] = useState({ ...DEFAULT_SETTINGS, ...initialSettings });\n  const [errors, setErrors] = useState({});\n\n  // Validation logic\n  const validateSettings = (currentSettings) => {\n    const newErrors = {};\n\n    // Validate Custom Name\n    if (currentSettings.useCustomName) {\n      const name = currentSettings.customName || '';\n      if (!name) {\n        newErrors.customName = 'Custom name is required.';\n      } else if (name.length < 4 || name.length > 26) {\n        newErrors.customName = 'Name must be 4-26 characters.';\n      } else if (!/^[a-zA-Z0-9_-]+$/.test(name)) {\n        newErrors.customName = 'Use letters, numbers, -, or _.';\n      }\n    }\n\n    // Validate Password\n    if (currentSettings.isPrivate) {\n      const pass = currentSettings.password || '';\n      if (!pass) {\n        newErrors.password = 'Password is required.';\n      } else if (pass.length < 3 || pass.length > 36) {\n        newErrors.password = 'Password must be 3-36 characters.';\n      }\n    }\n\n    // Validate Number of Bots\n    const botCount = currentSettings.numberOfBots;\n    if (botCount < 0 || botCount > 16) {\n      newErrors.numberOfBots = 'Number of bots must be between 0 and 16.';\n    }\n\n    return newErrors;\n  };\n\n  const handleChange = (key, value) => {\n    setSettings(prev => {\n      const updatedSettings = { ...prev, [key]: value };\n\n      // Clear customName and its error if useCustomName is turned off\n      if (key === 'useCustomName' && !value) {\n        updatedSettings.customName = '';\n        if (errors.customName) {\n          setErrors(currentErrors => {\n            const newErrors = { ...currentErrors };\n            delete newErrors.customName;\n            return newErrors;\n          });\n        }\n      }\n\n      // Clear password and its error if private is turned off\n      if (key === 'isPrivate' && !value) {\n        updatedSettings.password = '';\n        if (errors.password) {\n          setErrors(currentErrors => {\n            const newErrors = { ...currentErrors };\n            delete newErrors.password;\n            return newErrors;\n          });\n        }\n      }\n      return updatedSettings;\n    });\n\n    // Clear specific error when user starts typing/toggling again\n    if ((key === 'customName' || key === 'useCustomName') && errors.customName) {\n      setErrors(currentErrors => {\n        const newErrors = { ...currentErrors };\n        delete newErrors.customName;\n        return newErrors;\n      });\n    }\n    if ((key === 'password' || key === 'isPrivate') && errors.password) {\n      setErrors(currentErrors => {\n        const newErrors = { ...currentErrors };\n        delete newErrors.password;\n        return newErrors;\n      });\n    }\n    if (key === 'numberOfBots' && errors.numberOfBots) {\n      setErrors(currentErrors => {\n        const newErrors = { ...currentErrors };\n        delete newErrors.numberOfBots;\n        return newErrors;\n      });\n    }\n  };\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    const validationErrors = validateSettings(settings);\n    if (Object.keys(validationErrors).length > 0) {\n      setErrors(validationErrors);\n    } else {\n      setErrors({}); // Clear errors on successful submit\n      // Prepare the payload for submission\n      const payload = {\n        ...settings,\n        customName: settings.useCustomName ? settings.customName : null,\n      };\n      delete payload.useCustomName; // Remove the toggle state key\n\n      onSubmit(payload);\n    }\n  };\n\n  return (\n    <BaseModal\n      title=\"Game Options\"\n      onClose={onClose}\n      style={{ maxWidth: 600 }}\n      footer={\n        <div style={{ display: 'flex', gap: 8 }}>\n          <button\n            type=\"button\"\n            onClick={onClose}\n            className={`${lobbyStyles.actionButton} ${lobbyStyles.cancelButton || ''}`}\n            data-gamepad-focusable=\"true\"\n          >\n            Cancel\n          </button>\n          <button\n            type=\"submit\"\n            form=\"gameSettingsForm\"\n            className={`${lobbyStyles.actionButton} ${lobbyStyles.createButton}`}\n            disabled={Object.keys(errors).length > 0}\n            data-gamepad-focusable=\"true\"\n          >\n            Create Game\n          </button>\n        </div>\n      }\n    >\n      <form id=\"gameSettingsForm\" onSubmit={handleSubmit}>\n        <div className={baseModalStyles.settingsContainer}>\n          {/* Custom Game Name Setting */}\n          <div className={baseModalStyles.settingItem}>\n            <div className={baseModalStyles.settingDescription}>\n              <h4>Custom Game Name</h4>\n              <p>Set a custom name for your game lobby</p>\n            </div>\n            <div className={baseModalStyles.settingControls}>\n              <ToggleSwitch\n                isChecked={settings.useCustomName}\n                onChange={e => handleChange('useCustomName', e.target.checked)}\n              />\n              {settings.useCustomName && (\n                <GamepadInput\n                  title=\"Enter Game Name\"\n                  type=\"text\"\n                  value={settings.customName || ''}\n                  onChange={e => handleChange('customName', e.target.value)}\n                  className={`${baseModalStyles.textInput}${errors.customName ? ' ' + baseModalStyles.inputError : ''}`}\n                  placeholder=\"Game Name\"\n                  maxLength={26}\n                  autoFocus\n                  style={{ marginTop: 8 }}\n                />\n              )}\n              {errors.customName && <span className=\"errorMessage\">{errors.customName}</span>}\n            </div>\n          </div>\n\n          {/* Private Game Setting */}\n          <div className={baseModalStyles.settingItem}>\n            <div className={baseModalStyles.settingDescription}>\n              <h4>Private Game</h4>\n              <p>Only players with the password can join</p>\n            </div>\n            <div className={baseModalStyles.settingControls}>\n              <ToggleSwitch\n                isChecked={settings.isPrivate}\n                onChange={e => handleChange('isPrivate', e.target.checked)}\n              />\n              {settings.isPrivate && (\n                <GamepadInput\n                  title=\"Enter Game Password\"\n                  type=\"password\"\n                  value={settings.password || ''}\n                  onChange={e => handleChange('password', e.target.value)}\n                  className={`${baseModalStyles.textInput}${errors.password ? ' ' + baseModalStyles.inputError : ''}`}\n                  placeholder=\"Password\"\n                  maxLength={36}\n                  autoFocus={settings.isPrivate && !settings.useCustomName}\n                  style={{ marginTop: 8 }}\n                />\n              )}\n              {errors.password && <span className=\"errorMessage\">{errors.password}</span>}\n            </div>\n          </div>\n\n          {/* Number of Bots Setting */}\n          <div className={baseModalStyles.settingItem}>\n            <div className={baseModalStyles.settingDescription}>\n              <h4>Number of Bots</h4>\n              <p>Add AI players to your game (0-16)</p>\n            </div>\n            <div className={baseModalStyles.settingControls}>\n              <GamepadInput\n                title=\"Number of AI Players\"\n                type=\"number\"\n                min=\"0\"\n                max=\"16\"\n                value={settings.numberOfBots}\n                onChange={e => handleChange('numberOfBots', parseInt(e.target.value) || 0)}\n                className={`${baseModalStyles.textInput}${errors.numberOfBots ? ' ' + baseModalStyles.inputError : ''}`}\n              />\n              {errors.numberOfBots && <span className=\"errorMessage\">{errors.numberOfBots}</span>}\n            </div>\n          </div>\n\n          {/* Ace Choice Setting */}\n          <div className={baseModalStyles.settingItem}>\n            <div className={baseModalStyles.settingDescription}>\n              <h4>Enable Ace Choice</h4>\n              <p>Allow players to choose high/low on Ace</p>\n            </div>\n            <div className={baseModalStyles.settingControls}>\n              <ToggleSwitch\n                isChecked={settings.enableAceChoice}\n                onChange={e => handleChange('enableAceChoice', e.target.checked)}\n              />\n            </div>\n          </div>\n\n          {/* Second Chance Setting */}\n          <div className={baseModalStyles.settingItem}>\n            <div className={baseModalStyles.settingDescription}>\n              <h4>Enable Second Chance</h4>\n              <p>Allow players to ante up for a second chance</p>\n            </div>\n            <div className={baseModalStyles.settingControls}>\n              <ToggleSwitch\n                isChecked={settings.enableSecondChance}\n                onChange={e => handleChange('enableSecondChance', e.target.checked)}\n              />\n            </div>\n          </div>\n        </div>\n      </form>\n    </BaseModal>\n  );\n};\n\nexport default GameSettingsModal;\n","/**\n * Store Service for handling coin purchases and product offerings\n * Manages API calls for purchasing game currency and retrieving available products\n */\nclass StoreService {\n  constructor() {\n    // Get API URL from environment or use localhost as fallback\n    this.API_URL = import.meta.env.VITE_API_URL || 'http://localhost:3001';\n    this.baseURL = `${this.API_URL}/purchases`;\n  }\n\n  /**\n   * Get the authorization header for API requests\n   * @returns {Object} Headers object with authorization\n   */\n  getAuthHeaders() {\n    const token = localStorage.getItem('token');\n    return {\n      'Content-Type': 'application/json',\n      'Authorization': token ? `Bearer ${token}` : ''\n    };\n  }\n\n  /**\n   * Get product offerings by type\n   * @param {string} offeringType - Type of offering (e.g., 'coin')\n   * @returns {Promise<Array>} Array of product offerings\n   */\n  async getOfferingsByType(offeringType) {\n    try {\n      const url = `${this.baseURL}/offerings?offeringType=${encodeURIComponent(offeringType)}`;\n      const response = await fetch(url, {\n        method: 'GET',\n        headers: this.getAuthHeaders(),\n        credentials: 'include'\n      });\n\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({}));\n        throw new Error(errorData.error || `HTTP ${response.status}: Failed to fetch offerings`);\n      }\n\n      const data = await response.json();\n      return data.offerings || [];\n    } catch (error) {\n      console.error('[PURCHASE_SERVICE] Error fetching offerings:', error);\n      throw new Error(`Failed to fetch product offerings: ${error.message}`);\n    }\n  }\n\n  /**\n   * Get all available product offerings\n   * @returns {Promise<Array>} Array of all product offerings\n   */\n  async getAllOfferings() {\n    try {\n      const response = await fetch(`${this.baseURL}/offerings`, {\n        method: 'GET',\n        headers: this.getAuthHeaders(),\n        credentials: 'include'\n      });\n\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({}));\n        throw new Error(errorData.error || `HTTP ${response.status}: Failed to fetch offerings`);\n      }\n\n      const data = await response.json();\n      return data.offerings || [];\n    } catch (error) {\n      console.error('[PURCHASE_SERVICE] Error fetching all offerings:', error);\n      throw new Error(`Failed to fetch product offerings: ${error.message}`);\n    }\n  }\n\n  /**\n   * Process a purchase\n   * @param {string} productId - ID of the product to purchase\n   * @returns {Promise<Object>} Purchase result\n   */\n  async processPurchase(productId) {\n    try {\n      if (!productId) {\n        throw new Error('Product ID is required');\n      }\n\n      const response = await fetch(`${this.baseURL}/process`, {\n        method: 'POST',\n        headers: this.getAuthHeaders(),\n        credentials: 'include',\n        body: JSON.stringify({ productId })\n      });\n\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({}));\n        throw new Error(errorData.error || `HTTP ${response.status}: Purchase failed`);\n      }\n\n      const result = await response.json();\n      \n      // Log successful purchase for debugging\n      console.log('[PURCHASE_SERVICE] Purchase completed:', {\n        productId,\n        coinsAdded: result.coinsAdded,\n        newBalance: result.newBalance\n      });\n\n      return result;\n    } catch (error) {\n      console.error('[PURCHASE_SERVICE] Error processing purchase:', error);\n      throw new Error(`Purchase failed: ${error.message}`);\n    }\n  }\n\n  /**\n   * Get coin offerings specifically\n   * @returns {Promise<Array>} Array of coin product offerings\n   */\n  async getCoinOfferings() {\n    return this.getOfferingsByType('coin');\n  }\n}\n\n// Create a singleton instance\nconst storeService = new StoreService();\n\nexport default storeService;","import React, { useState, useEffect } from 'react';\nimport BaseModal from './common/BaseModal';\nimport baseModalStyles from './common/BaseModal.module.css';\nimport styles from './styles/PlayerStatsModal.module.css';\nimport storeService from '../services/StoreService';\n\nconst StoreModal = ({ onClose }) => {\n  const [activeTab, setActiveTab] = useState('coins');\n  const [coinOfferings, setCoinOfferings] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [purchasing, setPurchasing] = useState(null);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    loadCoinOfferings();\n  }, []);\n\n  const loadCoinOfferings = async () => {\n    try {\n      setLoading(true);\n      setError(null);\n      const offerings = await storeService.getCoinOfferings();\n      setCoinOfferings(offerings);\n    } catch (err) {\n      console.error('Failed to load coin offerings:', err);\n      setError('Failed to load products. Please try again.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handlePurchase = async (productId) => {\n    try {\n      setPurchasing(productId);\n      setError(null);\n      \n      const result = await storeService.processPurchase(productId);\n      \n      // Show success message or handle success\n      console.log('Purchase successful:', result);\n      \n      // Close modal on successful purchase\n      onClose();\n      \n    } catch (err) {\n      console.error('Purchase failed:', err);\n      setError(err.message || 'Purchase failed. Please try again.');\n    } finally {\n      setPurchasing(null);\n    }\n  };\n\n  const formatPrice = (price) => {\n    return new Intl.NumberFormat('en-US', {\n      style: 'currency',\n      currency: 'USD'\n    }).format(price);\n  };\n\n  const formatCoins = (amount) => {\n    return new Intl.NumberFormat('en-US').format(amount);\n  };\n\n  if (loading) {\n    return (\n      <BaseModal title=\"Store\" onClose={onClose} style={{ maxWidth: 800, maxHeight: '80vh' }}>\n        <div style={{ textAlign: 'center', padding: '2rem', color: '#a0b9d6' }}>Loading products...</div>\n      </BaseModal>\n    );\n  }\n\n  return (\n    <BaseModal title=\"Store\" onClose={onClose} style={{ maxWidth: 800, maxHeight: '80vh' }}>\n      {/* Tab Navigation */}\n      <div className={styles.tabsContainer}>\n        <button\n          className={`${styles.tabButton} ${activeTab === 'coins' ? styles.activeTab : ''}`}\n          onClick={() => setActiveTab('coins')}\n          data-gamepad-focusable=\"true\"\n        >\n          Coin Packs\n        </button>\n      </div>\n\n      {/* Error Message */}\n      {error && (\n        <div style={{\n          marginBottom: '1rem',\n          padding: '0.75rem',\n          backgroundColor: 'rgba(231, 76, 60, 0.1)',\n          border: '1px solid #e74c3c',\n          borderRadius: '8px',\n          color: '#ffb3b3'\n        }}>\n          {error}\n        </div>\n      )}\n\n      {/* Coin Packs Tab Content */}\n      {activeTab === 'coins' && (\n        <div>\n          <div className={baseModalStyles.sectionHeader}>Available Coin Packs</div>\n          \n          {coinOfferings.length === 0 ? (\n            <div style={{ textAlign: 'center', padding: '2rem', color: '#a0b9d6' }}>\n              No coin packs available at the moment.\n            </div>\n          ) : (\n            <div style={{ \n              display: 'grid', \n              gap: '1rem', \n              gridTemplateColumns: 'repeat(auto-fit, minmax(250px, 1fr))' \n            }}>\n              {coinOfferings.map((offering) => (\n                <div\n                  key={offering.id}\n                  className={baseModalStyles.settingItem}\n                  style={{\n                    flexDirection: 'column',\n                    alignItems: 'center',\n                    justifyContent: 'space-between',\n                    textAlign: 'center',\n                    padding: '1.5rem',\n                    background: 'rgba(255, 255, 255, 0.08)',\n                    borderRadius: '12px',\n                    minHeight: '280px'\n                  }}\n                >\n                  {/* Product Image */}\n                  <div style={{ \n                    display: 'flex', \n                    justifyContent: 'center', \n                    alignItems: 'center',\n                    height: '80px',\n                    marginBottom: '1rem' \n                  }}>\n                    {offering.imageUrl && (\n                      <img\n                        src={offering.imageUrl}\n                        alt={offering.name}\n                        style={{\n                          width: '64px',\n                          height: '64px',\n                          objectFit: 'contain'\n                        }}\n                        onError={(e) => {\n                          e.target.style.display = 'none';\n                        }}\n                      />\n                    )}\n                  </div>\n                  \n                  {/* Product Info */}\n                  <div style={{ \n                    flex: '1',\n                    display: 'flex',\n                    flexDirection: 'column',\n                    justifyContent: 'center',\n                    alignItems: 'center',\n                    textAlign: 'center',\n                    marginBottom: '1rem' \n                  }}>\n                    <h3 style={{\n                      fontSize: '1.25rem',\n                      fontWeight: 'bold',\n                      color: '#FFD700',\n                      margin: '0 0 0.5rem 0',\n                      textAlign: 'center'\n                    }}>\n                      {formatCoins(offering.coinAmount)} Coins\n                    </h3>\n                    <p style={{\n                      color: '#a0b9d6',\n                      fontSize: '0.875rem',\n                      margin: '0 0 0.75rem 0',\n                      textAlign: 'center',\n                      lineHeight: '1.4'\n                    }}>\n                      {offering.description}\n                    </p>\n                    <div style={{\n                      fontSize: '1.5rem',\n                      fontWeight: 'bold',\n                      color: '#bcdcff',\n                      textAlign: 'center'\n                    }}>\n                      {formatPrice(offering.priceUSD)}\n                    </div>\n                  </div>\n                  \n                  {/* Purchase Button */}\n                  <button\n                    onClick={() => handlePurchase(offering.id)}\n                    disabled={purchasing === offering.id}\n                    className={baseModalStyles.primaryButton}\n                    style={{\n                      width: '100%',\n                      opacity: purchasing === offering.id ? 0.6 : 1,\n                      cursor: purchasing === offering.id ? 'not-allowed' : 'pointer'\n                    }}\n                    data-gamepad-focusable=\"true\"\n                  >\n                    {purchasing === offering.id ? (\n                      <span style={{ display: 'flex', alignItems: 'center', justifyContent: 'center' }}>\n                        <div className={styles.loadingSpinner} style={{\n                          marginRight: '0.5rem'\n                        }}></div>\n                        Processing...\n                      </span>\n                    ) : (\n                      'Purchase'\n                    )}\n                  </button>\n                </div>\n              ))}\n            </div>\n          )}\n        </div>\n      )}\n    </BaseModal>\n  );\n};\n\nexport default StoreModal;","import React from 'react';\n\nconst LockIcon = ({ className = '', width = '1em', height = '1em', ...props }) => (\n  <svg \n    xmlns=\"http://www.w3.org/2000/svg\" \n    viewBox=\"0 0 24 24\" \n    fill=\"none\" \n    stroke=\"currentColor\" \n    strokeWidth=\"2\" \n    strokeLinecap=\"round\" \n    strokeLinejoin=\"round\" \n    className={`feather feather-lock ${className}`} \n    width={width} \n    height={height}\n    {...props}\n  >\n    <rect x=\"3\" y=\"11\" width=\"18\" height=\"11\" rx=\"2\" ry=\"2\"></rect>\n    <path d=\"M7 11V7a5 5 0 0 1 10 0v4\"></path>\n  </svg>\n);\n\nexport default LockIcon;\n","import React from 'react';\nimport styles from './styles/Lobby.module.css'; // Use the new CSS module\nimport LockIcon from './icons/LockIcon'; // Import the new icon\n\nfunction GameCard({ game, onJoin, userId }) { \n  // Determine display name: Use custom name if available, otherwise fallback to ID\n  const gameDisplayName = game.settings?.customName || `Game ${game.id}`;\n\n  // Determine user's status in this game\n  const isUserDisconnected = game.disconnectedPlayers?.some(player => player.userId === userId);\n  const isUserInGame = game.allPlayers?.some(player => player.userId === userId && !player.disconnected);\n\n  // Determine button text and class\n  let buttonText = 'Join';\n  let buttonClass = styles.joinGameButton; // Base class from original\n  if (isUserDisconnected) {\n    buttonText = 'Reconnect';\n    buttonClass += ` ${styles.reconnectButton}`;\n  } else if (isUserInGame) {\n    buttonText = 'Continue';\n    buttonClass += ` ${styles.continueButton}`;\n  }\n\n  // Determine card container class\n  let cardClass = styles.gameListItem; // Use original outer class\n  if (isUserDisconnected) {\n    cardClass += ` ${styles.userDisconnectedGame}`;\n  } else if (isUserInGame) {\n    cardClass += ` ${styles.userInGame}`;\n  }\n\n  return (\n    <div className={cardClass}> {/* Use gameListItem + conditional */}\n      {/* Replicate original info structure */}\n      <div className={styles.gameListInfo}>\n        <div className={styles.gameListId}> {/* Div for ID/Name + Badges */}\n          {gameDisplayName}\n          {game.settings?.isPrivate && (\n            <span className={styles.privatePill} title=\"Private Game\">\n              <LockIcon width=\"0.9em\" height=\"0.9em\" style={{ marginRight: '4px', verticalAlign: 'middle' }} />\n              Private\n            </span>\n          )}\n          {isUserDisconnected && (\n            <span className={styles.disconnectedBadge} title=\"You're disconnected from this game\"> Reconnect</span>\n          )}\n          {isUserInGame && (\n            <span className={styles.inGameBadge} title=\"You're in this game\">You're In</span>\n          )}\n        </div>\n        <div className={styles.gameListPlayers}> {/* Div for Player Count */}\n          {game.playerCount} {game.playerCount === 1 ? 'player' : 'players'}\n        </div>\n      </div>\n      {/* Button as sibling to gameListInfo */}\n      <button \n        className={buttonClass} // Use joinGameButton + conditional\n        onClick={() => onJoin(game.id)}\n        disabled={!userId}\n        data-gamepad-focusable=\"true\"\n      >\n        {buttonText} \n      </button>\n    </div>\n  );\n}\n\nexport default GameCard;\n","import React from 'react';\n\n/**\n * Question mark icon component for rules button\n * @param {Object} props - Component props\n * @param {string} props.color - Color of the icon (default: 'currentColor')\n * @param {number} props.size - Size of the icon in pixels (default: 24)\n */\nconst QuestionIcon = ({ color = 'currentColor', size = 24 }) => {\n  return (\n    <svg \n      xmlns=\"http://www.w3.org/2000/svg\" \n      width={size} \n      height={size} \n      viewBox=\"0 0 24 24\" \n      fill=\"none\" \n      stroke={color} \n      strokeWidth=\"2\" \n      strokeLinecap=\"round\" \n      strokeLinejoin=\"round\"\n    >\n      {/* Material Design style question mark icon */}\n      <circle cx=\"12\" cy=\"12\" r=\"10\" />\n      <path d=\"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3\" />\n      <line x1=\"12\" y1=\"17\" x2=\"12\" y2=\"17.01\" />\n    </svg>\n  );\n};\n\nexport default QuestionIcon;\n","/**\n * Frontend Constants - Game logic and UI constants for the web client\n * \n *   SHARED CONSTANTS - Keep synchronized with backend! \n * Some constants must match @am-games-api/src/constants.js\n * Any changes to shared constants should be reflected in the backend constants file.\n */\n\n// ========================================\n// SHARED CONSTANTS (Frontend + Backend)\n// ========================================\n\n/**\n * Game phase constants for consistent phase management across the application\n *  SHARED: Must match backend GamePhases\n */\nexport const GamePhases = {\n  // Initial phase when waiting for players and anteeing up\n  WAITING: 'waiting',\n  \n  // Phase when cards are being dealt\n  DEALING: 'dealing',\n  \n  // Phase when players are betting\n  BETTING: 'betting',\n  \n  // Phase when middle card is being revealed\n  REVEALING: 'revealing',\n  \n  // Phase when round results are shown\n  RESULTS: 'results'\n};\n\n/**\n * Core game configuration constants\n *  SHARED: Must match backend GAME_CONSTANTS\n */\nexport const GAME_CONSTANTS = {\n  // Game configuration\n  ANTE_AMOUNT: 1,  // Fixed ante amount - always $1\n  STARTING_BALANCE: 2000,  // Starting player balance\n  FULL_DECK_SIZE: 52,  // Number of cards in a full deck\n  RECONNECTION_TIMEOUT: 30000,  // Time window for player reconnection (30 seconds)\n  MAX_SEATS: 16, // Maximum number of seats/players allowed in a game\n  \n  // Timer durations (in milliseconds)\n  //  SHARED: Backend uses these for game logic, frontend for UI timers\n  TIMERS: {\n    DEAL_FIRST_CARD_DELAY: 1000,    // Delay before dealing the first card (1 second)\n    DEAL_SECOND_CARD_DELAY: 1000,   // Delay before dealing the second card (1 second)\n    DEAL_THIRD_CARD_DELAY: 2000,    // Delay before revealing the third card (2 seconds)\n    DEALING_DURATION: 3000,         // Total duration of dealing phase (3 seconds)\n    BETTING_DURATION: 30000,        // Duration for betting phase (30 seconds)\n    DECISION_DURATION: 15000,       // Duration for ace and second chance decisions (15 seconds)\n    REVEALING_DURATION: 3000,       // Duration for revealing phase\n    RESULTS_DURATION: 5000,         // Duration to show results before moving to next round (5 seconds)\n    PLAYER_INACTIVITY_TIMEOUT: 30000//Timeout for inactive players in WAITING phase\n  }\n};\n\n// ========================================\n// FRONTEND-ONLY CONSTANTS\n// ========================================\n\n/**\n * UI Icons used throughout the application\n *  FRONTEND-ONLY: These are only used for UI display\n */\nexport const ICONS = {\n  POT: '',\n  DEALER: '',\n  CHECK: '',\n  DECK: ''\n};\n\n// Export specific commonly used constants for convenience\nexport const { TIMERS, ANTE_AMOUNT, STARTING_BALANCE, FULL_DECK_SIZE, RECONNECTION_TIMEOUT, MAX_SEATS } = GAME_CONSTANTS;","import React from 'react';\nimport BaseModal from './common/BaseModal';\nimport baseModalStyles from './common/BaseModal.module.css';\nimport { ICONS } from '../constants';\n\n/**\n * Game Rules Modal that displays the rules of the game\n * @param {Object} props - Component props\n * @param {function} props.onClose - Function to call when the modal is closed\n */\nconst GameRulesModal = ({ onClose }) => {\n  return (\n    <BaseModal\n      title=\"Game Rules\"\n      onClose={onClose}\n      style={{ maxWidth: 600 }}\n    >\n      <div \n        className={`${baseModalStyles.content} ${baseModalStyles.scrollableContent}`} \n        style={{ maxHeight: '60vh', padding: '0' }}\n        data-gamepad-scrollable=\"true\"\n        tabIndex=\"0\"\n      >\n        <div style={{ marginBottom: 22 }}>\n          <div className={baseModalStyles.sectionHeader}>Objective</div>\n          <div className={baseModalStyles.settingDescription}>\n            The goal is to bet on whether the third card will have a value that falls \"in between\" the first two cards.\n          </div>\n        </div>\n        <div style={{ marginBottom: 22 }}>\n          <div className={baseModalStyles.sectionHeader}>Card Values</div>\n          <div className={baseModalStyles.settingDescription}>\n            Cards are valued numerically: 2-10 as face value, Jack = 11, Queen = 12, King = 13, and Ace = 1 or 14 (player's choice).\n          </div>\n        </div>\n        <div style={{ marginBottom: 22 }}>\n          <div className={baseModalStyles.sectionHeader}>Game Flow</div>\n          <div className={baseModalStyles.settingDescription}>\n            <ol style={{ paddingLeft: 20, margin: 0 }}>\n              <li>Each player antes up to join the round.</li>\n              <li>The player to the right of the dealer goes first.</li>\n              <li>Two cards are dealt face up.</li>\n              <li>Player decides whether to bet or pass.</li>\n              <li>If a bet is placed, the third card is revealed.</li>\n              <li>Bets are settled.</li>\n              <li>Next player goes.</li>\n              <li>If the pot is empty, players ante up again to start a new round.</li>\n            </ol>\n          </div>\n        </div>\n        <div style={{ marginBottom: 22 }}>\n          <div className={baseModalStyles.sectionHeader}>Betting</div>\n          <div className={baseModalStyles.settingDescription}>\n            If you think the third card will fall between the first two cards, you can bet up to the pot amount.<br/>\n            If you win, you receive the amount of your bet from the pot.<br/>\n            If you lose, your bet is added to the pot.\n          </div>\n        </div>\n        <div style={{ marginBottom: 22 }}>\n          <div className={baseModalStyles.sectionHeader}>POT Button</div>\n          <div className={baseModalStyles.settingDescription}>\n            The POT button allows you to bet the entire pot amount at once for maximum winnings.\n          </div>\n        </div>\n        <div style={{ marginBottom: 6 }}>\n          <div className={baseModalStyles.sectionHeader}>Special Rules</div>\n          <div className={baseModalStyles.settingDescription}>\n            <ul style={{ paddingLeft: 20, margin: 0 }}>\n              <li><strong>Ace Choice:</strong> If the first card is an Ace, you can choose to play it as low (1) or high (14).</li>\n              <li><strong>Second Chance:</strong> If the first two cards are the same, you can chose to ante again to see another hand.</li>\n            </ul>\n          </div>\n        </div>\n      </div>\n    </BaseModal>\n  );\n};\n\nexport default GameRulesModal;","import React, { useState, useEffect } from 'react';\nimport IconButton from './IconButton';\nimport QuestionIcon from '../icons/QuestionIcon';\nimport GameRulesModal from '../GameRulesModal';\n\n/**\n * A standardized rules button component that opens the game rules modal\n * \n * @param {Object} props Component props\n * @param {string} props.title Custom tooltip text (optional)\n * @param {function} props.onModalStateChange Callback when modal state changes\n */\nconst RulesButton = ({ \n  title = \"View Game Rules\",\n  onModalStateChange,\n  ...restProps \n}) => {\n  const [showRules, setShowRules] = useState(false);\n\n  const openRules = () => {\n    setShowRules(true);\n  };\n\n  const closeRules = () => {\n    setShowRules(false);\n  };\n\n  // Notify parent when modal state changes\n  useEffect(() => {\n    if (onModalStateChange) {\n      onModalStateChange(showRules);\n    }\n  }, [showRules, onModalStateChange]);\n\n  return (\n    <>\n      <IconButton\n        icon={<QuestionIcon color=\"white\" size={20} />}\n        title={title}\n        onClick={openRules}\n        variant=\"default\"\n        {...restProps}\n      />\n      \n      {showRules && <GameRulesModal onClose={closeRules} />}\n    </>\n  );\n};\n\nexport default RulesButton;\n","import React, { useState, useEffect, useMemo } from 'react';\nimport { useNavigate } from 'react-router-dom'; // Import useNavigate\nimport styles from './styles/Lobby.module.css';\nimport { useLobby } from '../contexts/LobbyContext.jsx';\nimport { useAuth } from '../contexts/AuthContext';\nimport { useSocket } from '../contexts/SocketContext';\nimport { usePreferences } from '../contexts/PreferencesContext';\nimport { useGamepadNavigation } from '../hooks/useGamepadNavigation';\nimport { useMediaQuery, InputAdornment } from '@mui/material';\nimport GamepadTextField from './GamepadTextField';\nimport AppHeader from './common/AppHeader';\nimport OnlinePlayerCount from './common/OnlinePlayerCount';\nimport CurrencyAmount from './common/CurrencyAmount';\nimport PreferencesButton from './common/PreferencesButton.jsx';\nimport PlayerStatsButton from './common/PlayerStatsButton.jsx';\nimport StoreButton from './StoreButton.jsx';\nimport UserAvatar from './UserAvatar.jsx';\nimport ProgressInfo from './ProgressInfo.jsx';\nimport { useUserData } from '../contexts/UserDataContext';\nimport soundService from '../services/SoundService';\nimport GameSettingsModal from './GameSettingsModal.jsx';\nimport StoreModal from './StoreModal.jsx';\nimport GameCard from './GameCard'; // Import the new GameCard component\nimport RulesButton from './common/RulesButton';\n\nconst Lobby = () => {\n  const { gameList, loading: lobbyLoading, error: lobbyError } = useLobby(); // Assuming lobby context handles its own loading\n  const { user, logout, loading: authLoading, refreshUserData } = useAuth();\n  const userData = useUserData(user?.id);\n  const { socket, isConnected, loading: socketLoading } = useSocket();\n  const { preferences } = usePreferences();\n  \n  // Initialize gamepad navigation\n  const { isGamepadConnected } = useGamepadNavigation(true);\n  const navigate = useNavigate(); // Get navigate function\n  const [searchQuery, setSearchQuery] = useState('');\n  const [error, setError] = useState(null); // Local error state for lobby actions\n\n  const isMobile = useMediaQuery('(max-width:600px)');\n  const isSmallMobile = useMediaQuery('(max-width:400px)');\n  \n  const userId = user?.username ? `user_${user.username}` : null;\n\n  // Modal state for custom game creation and store\n  const [showGameSettingsModal, setShowGameSettingsModal] = useState(false);\n  const [showStoreModal, setShowStoreModal] = useState(false);\n\n  // Refresh user data (including balance) on lobby mount/reconnect\n  useEffect(() => {\n    // Effect runs on mount and when isConnected changes.\n    // We just need to ensure refreshUserData is available from the context.\n    if (refreshUserData) {\n      refreshUserData();\n    }\n  }, [isConnected, refreshUserData]);\n\n  useEffect(() => {\n    if (!user) {\n      setError('Please log in to continue');\n      return;\n    }\n\n    if (!user.username || !user.id) {\n      console.error('[Lobby] Invalid user data received:', user);\n      setError('Invalid user data');\n      logout(); // Clear invalid session\n      return;\n    }\n\n    if (!isConnected) {\n      setError('Not connected to server. Attempting to reconnect...');\n    } else {\n      setError(null);\n    }\n  }, [user, logout, isConnected]);\n  \n  // Shared game creation logic\n  const createGameWithSettings = (settings) => {\n    if (!user?.id) {\n      setError('Please log in to create a game');\n      return;\n    }\n    if (!isConnected) {\n      setError('Not connected to server');\n      return;\n    }\n    setError(null);\n\n    const creationTimeout = setTimeout(() => {\n      setError('Game creation timed out. Please try again.');\n    }, 5000);\n\n    const handleGameCreated = (data) => {\n      clearTimeout(creationTimeout);\n      socket.off('gameCreated', handleGameCreated);\n      if (data?.game?.id) {\n        navigate(`/${data.game.id}`);\n      } else {\n        setError('Failed to create or join game. Invalid response.');\n      }\n    };\n\n    socket.on('gameCreated', handleGameCreated);\n    \n    if (settings) {\n      socket.emit('createGame', { settings });\n    } else {\n      socket.emit('createGame');\n    }\n  };\n\n  const handleCreateGame = () => createGameWithSettings({ numberOfBots: 5 });\n\n  // Handler for custom game creation\n  const handleCreateCustomGame = () => {\n    setShowGameSettingsModal(true);\n  };\n\n  // Handler for submitting custom settings modal\n  const handleSubmitCustomSettings = (settings) => {\n    setShowGameSettingsModal(false);\n    createGameWithSettings(settings);\n  };\n  \n  const handleJoinGame = (gameId) => {\n    if (!isConnected) {\n      setError('Not connected to server.');\n      return;\n    }\n    if (!user) {\n      setError('Please log in to join a game.');\n      return;\n    }\n\n    setError(null);\n    soundService.play('ui.click'); // Play join sound\n\n    navigate(`/${gameId}`);\n  };\n  \n  const handleSearchChange = (e) => {\n    setSearchQuery(e.target.value);\n  };\n  \n  const filteredGameList = useMemo(() => {\n    if (!gameList) return [];\n    \n    let filtered = gameList;\n    if (searchQuery.trim()) {\n      const query = searchQuery.trim().toLowerCase();\n      filtered = gameList.filter(game => \n        game.id.toLowerCase().includes(query)\n      );\n    }\n    \n    return filtered.sort((a, b) => {\n      const userInGameA = a.allPlayers?.some(player => player.userId === userId);\n      const userInGameB = b.allPlayers?.some(player => player.userId === userId);\n      \n      const userDisconnectedInA = a.disconnectedPlayers?.some(player => player.userId === userId);\n      const userDisconnectedInB = b.disconnectedPlayers?.some(player => player.userId === userId);\n      \n      if (userDisconnectedInA && !userDisconnectedInB) return -1;\n      if (!userDisconnectedInA && userDisconnectedInB) return 1;\n      if (userInGameA && !userInGameB) return -1;\n      if (!userInGameA && userInGameB) return 1;\n      return a.id.localeCompare(b.id); // Alphabetical by ID if tie\n    });\n  }, [gameList, searchQuery, userId]); // Dependency on userId ensures resorting if user changes\n  \n   return (\n     <div className={styles.lobbyContainer}>\n       <AppHeader />\n      <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', marginTop: '1.1em', marginBottom: '-0.6em' }}>\n        <OnlinePlayerCount />\n      </div>       \n       <div className={styles.formContainer}>\n         <div className={styles.formSection}>\n           <div className={styles.welcomeMessage}>\n             <div className={styles.welcomeHeader}>\n               {error ? (\n                 <div className={styles.error}>{error}</div>\n               ) : (\n                 <div className={styles.avatarContainer}>\n                   <UserAvatar \n                     userId={user?.id}\n                     size=\"medium\" \n                     showName={true} \n                     namePosition=\"right\"\n                   />\n                 </div>\n               )}\n               <ProgressInfo \n                 userId={user?.id}\n                 balance={user?.balance}\n               />\n               <div className={styles.headerButtons}>\n                 <button \n                   className={styles.logoutButton}\n                   onClick={logout}\n                   data-gamepad-focusable=\"true\"\n                 >\n                   <span className={styles.buttonText}>Logout</span>\n                 </button>\n                 <RulesButton data-gamepad-focusable=\"true\" />\n                 <PlayerStatsButton data-gamepad-focusable=\"true\" />\n                 <StoreButton onClick={() => setShowStoreModal(true)} data-gamepad-focusable=\"true\" />\n                 <PreferencesButton data-gamepad-focusable=\"true\" />\n               </div>\n             </div>\n           </div>\n           \n           <div className={styles.gradientDivider}></div>\n           \n           <div className={styles.buttonGroup}>\n             <button \n               className={`${styles.actionButton} ${styles.createButton}`}\n               onClick={handleCreateGame}\n               disabled={!user?.username}\n               data-gamepad-focusable=\"true\"\n             >\n               Create Quick Game\n             </button>\n             <button\n               className={`${styles.actionButton} ${styles.createButton}`}\n               style={{ marginTop: 8 }}\n               onClick={handleCreateCustomGame}\n               disabled={!user?.username}\n               data-gamepad-focusable=\"true\"\n             >\n               Create Custom Game\n             </button>\n           </div>\n           {showGameSettingsModal && (\n             <GameSettingsModal\n               onSubmit={handleSubmitCustomSettings}\n               onClose={() => setShowGameSettingsModal(false)}\n             />\n           )}\n           {showStoreModal && (\n             <StoreModal\n               onClose={() => {\n                 setShowStoreModal(false);\n                 // Refresh user data to update balance after purchase\n                 if (refreshUserData) {\n                   refreshUserData();\n                 }\n               }}\n             />\n           )}\n         </div>\n         \n         {error && (\n           <div className={styles.errorMessage}>\n             {error}\n           </div>\n         )}\n       </div>\n       \n       {/* Game List Section - Always shown */}\n       <div className={styles.gameListContainer}>\n         <h2 className={styles.gameListTitle}>Available Games</h2>\n         \n         {/* Search bar for filtering games */}\n         <div className={styles.searchContainer}>\n           <GamepadTextField\n             title=\"Search Games\"\n             placeholder=\"Search games by ID\"\n             variant=\"outlined\"\n             fullWidth\n             value={searchQuery}\n             onChange={handleSearchChange}\n             size={isSmallMobile ? \"small\" : \"medium\"}\n             type=\"text\"\n             InputProps={{\n               startAdornment: (\n                 <InputAdornment position=\"start\">\n                   <span className={styles.searchIcon}></span>\n                 </InputAdornment>\n               ),\n             }}\n           />\n         </div>\n         \n         {filteredGameList && filteredGameList.length > 0 ? (\n           <div className={styles.gameListWrapper}>\n             {filteredGameList.map(game => (\n               <GameCard \n                 key={game.id} \n                 game={game} \n                 onJoin={handleJoinGame} \n                 userId={userId} // Pass userId\n               />\n             ))}\n           </div>\n         ) : (\n           <div className={styles.emptyGameList}>\n             <div className={styles.emptyStateIcon}></div>\n             <p className={styles.emptyStateMessage}>\n               {searchQuery.trim() ? 'No matching games found' : 'No games in progress'}\n             </p>\n             <p className={styles.emptyStateHint}>\n               {searchQuery.trim() \n                 ? 'Try a different search or create a new game' \n                 : 'Create a new game to get started!'}\n             </p>\n           </div>\n         )}\n       </div>\n     </div>\n   );\n };\n\n export default Lobby;\n","import React, { createContext, useState, useContext, useEffect, useCallback, useRef } from 'react';\nimport { useSocket } from './SocketContext.jsx';\nimport { useAuth } from './AuthContext.jsx';\nimport soundService from '../services/SoundService';\n\n// Create context\nconst GameContext = createContext();\n\n// Custom hook to use the game context\nexport const useGameContext = () => {\n  const context = useContext(GameContext);\n  if (context === undefined) {\n    throw new Error('useGameContext must be used within a GameProvider');\n  }\n  return context;\n};\n\nexport const GameProvider = ({ children, gameId, initialGameState = null }) => {\n  // Get socket from socket context\n  const { socket, error: socketError } = useSocket();\n  \n  // Get user from auth context\n  const { user } = useAuth();\n  \n  // Game-specific state - we only need to track the full gameState object and error\n  /** @type {[GameState|null, React.Dispatch<React.SetStateAction<GameState|null>>]} */\n  const [gameState, setGameState] = useState(initialGameState);\n  \n  // Keep track of previous players to detect joins/leaves\n  const prevPlayersRef = useRef({});\n  \n  // Keep track of previous active player to detect turn changes\n  const prevActivePlayerRef = useRef(null);\n  \n  /** @type {[string|null, React.Dispatch<React.SetStateAction<string|null>>]} */\n  const [error, setError] = useState(null);\n\n  // Function to explicitly clear the provider's error state\n  const clearError = useCallback(() => {\n    setError(null);\n  }, []);\n\n  // Initialize with socket error if any\n  useEffect(() => {\n    if (socketError) {\n      setError(socketError);\n    }\n  }, [socketError]);\n  // Set up game-specific event handlers\n  useEffect(() => {\n    if (!socket) return;\n\n    // Handle game reconnection\n    socket.on('gameReconnected', (data) => {\n      console.log(`[Game] Reconnected to game: ${data.gameId}`, data.game);\n      \n      // Update game state with the full state from the server\n      setGameState(data.game);\n      \n      // Log reconnection with user ID from AuthContext\n      console.log(`[Game] Successfully reconnected as user ID: ${user?.id}`);\n      \n      // Clear any errors\n      setError(null);\n\n      // CRITICAL: Force a refresh of the player's game state to ensure betting works\n      if (data.game && data.game.id) {\n        // Small delay to ensure the state is fully updated\n        setTimeout(() => {\n          console.log(`[Game] Requesting fresh game state after reconnection`);\n          socket.emit('getGameState', { gameId: data.game.id });\n        }, 500);\n      }\n    });\n    \n    // Handle receiving updated game state\n    socket.on('gameState', (data) => {\n      if (data && data.id) { \n        // Restore check to prevent setting identical state\n        if (JSON.stringify(gameState) !== JSON.stringify(data)) {\n          // Check if it's now the player's turn and play alert sound if needed\n          if (data.currentPlayerId && user?.id) {\n            const isMyTurn = data.currentPlayerId === user.id;\n            const wasPreviouslyMyTurn = prevActivePlayerRef.current === user.id;\n            \n            // Only play sound if it wasn't my turn before but now it is\n            if (isMyTurn && !wasPreviouslyMyTurn) {\n              soundService.play('ui.alert');\n            }\n            \n            // Update the previous active player reference\n            prevActivePlayerRef.current = data.currentPlayerId;\n          }\n          \n          setGameState(data);\n          clearError(); // Clear any previous context errors on successful state update\n        } \n      } else {\n      }\n    });\n    \n    // Game-specific error handling\n    socket.on('gameError', (message) => {\n      console.error('Game error:', message);\n      setError(message);\n    });\n    \n    // Clean up game-specific event listeners\n    return () => {\n      socket.off('gameReconnected');\n      socket.off('gameState');\n      socket.off('gameError');\n    };\n  }, [socket]);\n\n  // Game-specific actions\n  const placeBet = useCallback((amount) => {\n    if (!socket || !gameId) return;\n    \n    try {\n      socket.emit('placeBet', { bet: amount, gameId });\n    } catch (err) {\n      console.error('Error placing bet:', err);\n      setError('Failed to place bet. Please try again.');\n    }\n  }, [socket, gameId]);\n  \n  const payAnte = useCallback(() => {\n    if (!socket || !gameId) return;\n    \n    try {\n      socket.emit('payAnte', { gameId });\n    } catch (err) {\n      console.error('Error paying ante:', err);\n      setError('Failed to pay ante. Please try again.');\n    }\n  }, [socket, gameId]);\n\n  const dealCards = useCallback(() => {\n    if (!socket || !gameId) return;\n    \n    try {\n      socket.emit('dealCards', { gameId });\n    } catch (err) {\n      console.error('Error dealing cards:', err);\n      setError('Failed to deal cards. Please try again.');\n    }\n  }, [socket, gameId]);\n  \n  const revealMiddleCard = useCallback(() => {\n    if (!socket || !gameId) return;\n    \n    try {\n      socket.emit('revealMiddleCard', { gameId });\n    } catch (err) {\n      console.error('Error revealing middle card:', err);\n      setError('Failed to reveal middle card. Please try again.');\n    }\n  }, [socket, gameId]);\n  \n  const nextRound = useCallback(() => {\n    if (!socket || !gameId) return;\n    \n    try {\n      socket.emit('nextRound', { gameId });\n    } catch (err) {\n      console.error('Error moving to next round:', err);\n      setError('Failed to move to next round. Please try again.');\n    }\n  }, [socket, gameId]);\n  \n  // Player ready function (for paying ante)\n  const playerReady = useCallback(() => {\n    if (!socket || !gameId) return;\n    \n    try {\n      // Server is listening for 'ready' event, not 'playerReady'\n      socket.emit('ready');\n    } catch (err) {\n      console.error('Error setting player ready:', err);\n      setError('Failed to set player ready. Please try again.');\n    }\n  }, [socket, gameId]);\n  \n  // Player unready function (withdraw ante)\n  const playerUnready = useCallback(() => {\n    if (!socket || !gameId) return;\n    \n    try {\n      socket.emit('unready');\n    } catch (err) {\n      console.error('Error setting player unready:', err);\n      setError('Failed to set player unready. Please try again.');\n    }\n  }, [socket, gameId]);\n\n  /**\n   * @typedef {Object} GameContextValue\n   * @property {GameState|null} gameState - The complete game state\n   * @property {string|null} error - Any error message \n   * @property {(amount: number) => void} placeBet - Function to place a bet\n   * @property {() => void} payAnte - Function to pay the ante\n   * @property {() => void} playerReady - Function to set player ready (pay ante)\n   * @property {() => void} playerUnready - Function to set player unready (withdraw ante)\n   * @property {() => void} dealCards - Function to deal cards\n   * @property {() => void} revealMiddleCard - Function to reveal the middle card\n   * @property {() => void} nextRound - Function to move to the next round\n   * @property {() => void} clearError - Function to clear any error\n   * @property {string|null} gameId - Current game ID\n   */\n\n  /** @type {GameContextValue} */\n  const value = {\n    // Game state - just provide the complete gameState object\n    gameState,\n    error,\n    gameId,\n    \n    // Game actions\n    placeBet,\n    payAnte,\n    playerReady,\n    playerUnready,\n    dealCards,\n    revealMiddleCard,\n    nextRound,\n    // Helper methods\n    clearError,\n  };\n\n  return (\n    <GameContext.Provider value={value}>\n      {children}\n    </GameContext.Provider>\n  );\n};\n\n// Named exports for specific pieces of state/actions\nexport const useGameState = () => {\n  const { gameState, players, currentPlayer, cards, gamePhase, dealerName, deckNumber, remainingCards, error } = useGameContext();\n  return { gameState, players, currentPlayer, cards, gamePhase, dealerName, deckNumber, remainingCards, error };\n};\n\nexport const useGameActions = () => {\n  const { placeBet, payAnte, dealCards, revealMiddleCard, nextRound, clearError } = useGameContext();\n  return { placeBet, payAnte, dealCards, revealMiddleCard, nextRound, clearError };\n};\n\nexport default GameContext;\n","import React from 'react';\n\n/**\n * Exit/door icon component for leave game button\n * @param {Object} props - Component props\n * @param {string} props.color - Color of the icon (default: 'currentColor')\n * @param {number} props.size - Size of the icon in pixels (default: 24)\n */\nconst ExitIcon = ({ color = 'currentColor', size = 24 }) => {\n  return (\n    <svg \n      xmlns=\"http://www.w3.org/2000/svg\" \n      width={size} \n      height={size} \n      viewBox=\"0 0 24 24\" \n      fill=\"none\" \n      stroke={color} \n      strokeWidth=\"2\" \n      strokeLinecap=\"round\" \n      strokeLinejoin=\"round\"\n    >\n      {/* Material Design style exit/logout icon */}\n      <path d=\"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4\" />\n      <polyline points=\"16 17 21 12 16 7\" />\n      <line x1=\"21\" y1=\"12\" x2=\"9\" y2=\"12\" />\n    </svg>\n  );\n};\n\nexport default ExitIcon;\n","import React from 'react';\nimport IconButton from './IconButton';\nimport ExitIcon from '../icons/ExitIcon';\n\n/**\n * A standardized leave/exit button component\n * \n * @param {Object} props Component props\n * @param {function} props.onClick Handler for when the button is clicked\n * @param {string} props.title Custom tooltip text (optional)\n */\nconst LeaveButton = ({ \n  onClick, \n  title = \"Leave Game\",\n  ...restProps \n}) => {\n  return (\n    <IconButton\n      icon={<ExitIcon color=\"white\" size={20} />}\n      title={title}\n      onClick={onClick}\n      variant=\"danger\"\n      {...restProps}\n    />\n  );\n};\n\nexport default LeaveButton;\n","import React, { useState, useEffect } from 'react';\nimport styles from './styles/GameHeader.module.css';\nimport { useGameContext } from '../contexts/GameContext';\nimport { useSocket } from '../contexts/SocketContext';\nimport { useAuth } from '../contexts/AuthContext';\nimport { TIMERS, ICONS } from '../constants';\nimport CurrencyAmount from './common/CurrencyAmount';\nimport GameSummaryModal from './GameSummaryModal.jsx';\nimport StoreModal from './StoreModal.jsx';\nimport RulesButton from './common/RulesButton';\nimport PlayerStatsButton from './common/PlayerStatsButton';\nimport PreferencesButton from './common/PreferencesButton';\nimport StoreButton from './StoreButton';\nimport LeaveButton from './common/LeaveButton';\n\n// Phase display mapping with icons and friendly names\nconst phaseDisplayMap = {\n  waiting: { text: 'Waiting for Players', icon: '' },\n  dealing: { text: 'Dealing Cards', icon: ICONS.DEALER },\n  revealing: { text: 'Revealing Cards', icon: '' },\n  results: { text: 'Round Results', icon: '' }\n};\n\nconst GameHeader = ({ handleLeaveGame, onModalStateChange }) => {\n  const { gameState, gameId } = useGameContext();\n  const { socket } = useSocket();\n  const { user } = useAuth();\n  \n  // Get the current user's balance from game state (real-time) or fallback to auth context\n  const currentUserId = socket?.auth?.userId;\n  const currentPlayer = currentUserId && gameState?.players ? gameState.players[currentUserId] : null;\n  const playerBalance = currentPlayer?.balance ?? user?.balance ?? 0;\n  const currentPhase = gameState?.phase || 'waiting';\n  const [timeLeft, setTimeLeft] = useState(null);\n  const [showGameSummary, setShowGameSummary] = useState(false);\n  const [showStoreModal, setShowStoreModal] = useState(false);\n  const [isPreferencesOpen, setIsPreferencesOpen] = useState(false);\n  const [isRulesOpen, setIsRulesOpen] = useState(false);\n  const [isStatsOpen, setIsStatsOpen] = useState(false);\n\n  // Timer effect for phases\n  useEffect(() => {\n    let timer;\n    \n    if (currentPhase === 'dealing') {\n      setTimeLeft(TIMERS.DEALING_DURATION);\n      timer = setInterval(() => {\n        setTimeLeft(prev => Math.max(0, prev - 100));\n      }, 100);\n    } else if (currentPhase === 'betting') {\n      setTimeLeft(TIMERS.BETTING_DURATION);\n      timer = setInterval(() => {\n        setTimeLeft(prev => Math.max(0, prev - 100));\n      }, 100);\n    } else if (currentPhase === 'revealing') {\n      setTimeLeft(TIMERS.REVEALING_DURATION);\n      timer = setInterval(() => {\n        setTimeLeft(prev => Math.max(0, prev - 100));\n      }, 100);\n    } else if (currentPhase === 'results') {\n      setTimeLeft(TIMERS.RESULTS_DURATION);\n      timer = setInterval(() => {\n        setTimeLeft(prev => Math.max(0, prev - 100));\n      }, 100);\n    } else {\n      setTimeLeft(null);\n    }\n\n    return () => {\n      if (timer) clearInterval(timer);\n    };\n  }, [currentPhase, gameState?.waitingForAceDecision]);\n\n  // Notify parent when modal state changes\n  useEffect(() => {\n    const isModalOpen = showGameSummary || showStoreModal || isPreferencesOpen || isRulesOpen || isStatsOpen;\n    if (onModalStateChange) {\n      onModalStateChange(isModalOpen);\n    }\n  }, [showGameSummary, showStoreModal, isPreferencesOpen, isRulesOpen, isStatsOpen, onModalStateChange]);\n  \n  // Get the phase display information\n  let phaseInfo = phaseDisplayMap[currentPhase] || { text: 'Unknown Phase', icon: '' };\n  \n  // Override phase info if waiting for Ace decision\n  if (gameState?.waitingForAceDecision && currentPhase === 'dealing') {\n    phaseInfo = { text: 'Choosing Ace Value', icon: '' };\n  }\n  \n  // Override phase info if waiting for second chance decision\n  if (gameState?.waitingForSecondChance) {\n    phaseInfo = { text: 'Second Chance Decision', icon: '' };\n  }\n  \n  // Check if current user is the current player (using userId instead of socket.id)\n  const isCurrentPlayersTurn = socket && socket.auth?.userId && gameState?.currentPlayerId === socket.auth.userId;\n  \n  // Special handling for betting phase\n  if (currentPhase === 'betting' && gameState?.currentPlayerId && gameState?.players) {\n    const currentPlayer = gameState.players[gameState.currentPlayerId];\n    \n    if (currentPlayer) {\n      if (isCurrentPlayersTurn) {\n        // It's YOUR turn to bet\n        phaseInfo = {\n          text: `Pass or Bet`,\n          icon: ''\n        };\n      } else {\n        // It's someone else's turn\n        phaseInfo = {\n          text: `${currentPlayer.name} is Betting`,\n          icon: ''\n        };\n      }\n    } else {\n      phaseInfo = { text: 'Betting Round', icon: '' };\n    }\n  }\n  \n  return (\n    <div className={styles.headerContainer}>\n      {/* Desktop layout - single row with 3 cells */}\n      <div className={styles.desktopLayout}>\n        {/* Left: Logo and game ID */}\n        <div className={styles.headerLeft}>\n          <h1 className={styles.gameTitle}>In Between <span className={styles.liveTag}>LIVE</span></h1>\n          <p className={styles.gameIdText}>\n            <span \n              className={styles.gameIdLink} \n              onClick={() => setShowGameSummary(true)}\n              title=\"Click to view game summary\"\n              data-gamepad-focusable=\"true\"\n              tabIndex=\"0\"\n            >\n              Game #{gameId}\n            </span>\n          </p>\n        </div>\n        \n        {/* Middle: Phase indicator */}\n        <div className={styles.headerCenter}>\n          <div \n            className={`${styles.gamePhase} ${currentPhase === 'betting' ? \n              (isCurrentPlayersTurn ? styles.phaseBettingYourTurn : styles.phaseBettingWaiting) : \n              styles[`phase${currentPhase.charAt(0).toUpperCase() + currentPhase.slice(1)}`]}`} \n            data-phase={currentPhase}\n          >\n            <span className={styles.phaseIcon}>{phaseInfo.icon}</span>\n            <span className={styles.phaseText}>{phaseInfo.text}</span>\n            {timeLeft !== null && (\n              <div className={styles.timerBar}>\n                <div \n                  className={styles.timerProgress} \n                  style={{ \n                    width: `${(timeLeft / (currentPhase === 'dealing' ? TIMERS.DEALING_DURATION :\n                                         currentPhase === 'betting' ? TIMERS.BETTING_DURATION :\n                                         currentPhase === 'revealing' ? TIMERS.REVEALING_DURATION :\n                                         TIMERS.RESULTS_DURATION)) * 100}%`\n                  }}\n                />\n              </div>\n            )}\n          </div>\n        </div>\n        \n        {/* Right: Balance and buttons */}\n        <div className={styles.headerRight}>\n          <div className={styles.controlsStack}>\n            <div className={styles.balanceDisplay}>\n              Balance: <CurrencyAmount amount={Number(playerBalance)} size=\"small\" />\n            </div>\n            <div className={styles.controlsGroup}>\n              <PreferencesButton \n                onModalStateChange={setIsPreferencesOpen}\n                data-gamepad-focusable=\"true\" \n              />\n              <RulesButton \n                onModalStateChange={setIsRulesOpen}\n                data-gamepad-focusable=\"true\" \n              />\n              <PlayerStatsButton \n                onModalStateChange={setIsStatsOpen}\n                data-gamepad-focusable=\"true\" \n              />\n              <StoreButton onClick={() => setShowStoreModal(true)} data-gamepad-focusable=\"true\" />\n              <LeaveButton onClick={handleLeaveGame} data-gamepad-focusable=\"true\" />\n            </div>\n          </div>\n        </div>\n      </div>\n      \n      {/* Mobile layout - two rows */}\n      <div className={styles.mobileLayout}>\n        {/* Top row: Logo/ID, Balance/Buttons */}\n        <div className={styles.mobileTopRow}>\n          <div className={styles.headerLeft}>\n            <h1 className={styles.gameTitle}>In Between <span className={styles.liveTag}>LIVE</span></h1>\n            <p className={styles.gameIdText}>\n              <span \n                className={styles.gameIdLink} \n                onClick={() => setShowGameSummary(true)}\n                title=\"Click to view game summary\"\n                data-gamepad-focusable=\"true\"\n                tabIndex=\"0\"\n              >\n                Game #{gameId}\n              </span>\n            </p>\n          </div>\n          \n          <div className={styles.mobileRight}>\n            <div className={styles.mobileControlsStack}>\n              <div className={styles.balanceDisplay}>\n                Balance: <CurrencyAmount amount={Number(playerBalance)} size=\"small\" />\n              </div>\n              <div className={styles.mobileActions}>\n                <PreferencesButton \n                  onModalStateChange={setIsPreferencesOpen}\n                  data-gamepad-focusable=\"true\" \n                />\n                <RulesButton \n                  onModalStateChange={setIsRulesOpen}\n                  data-gamepad-focusable=\"true\" \n                />\n                <PlayerStatsButton \n                  onModalStateChange={setIsStatsOpen}\n                  data-gamepad-focusable=\"true\" \n                />\n                <StoreButton onClick={() => setShowStoreModal(true)} data-gamepad-focusable=\"true\" />\n                <LeaveButton onClick={handleLeaveGame} data-gamepad-focusable=\"true\" />\n              </div>\n            </div>\n          </div>\n        </div>\n        \n        {/* Bottom row: Phase indicator (full width) */}\n        <div className={styles.mobileBottomRow}>\n          <div \n            className={`${styles.gamePhase} ${currentPhase === 'betting' ? \n              (isCurrentPlayersTurn ? styles.phaseBettingYourTurn : styles.phaseBettingWaiting) : \n              styles[`phase${currentPhase.charAt(0).toUpperCase() + currentPhase.slice(1)}`]}`} \n            data-phase={currentPhase}\n          >\n            <span className={styles.phaseIcon}>{phaseInfo.icon}</span>\n            <span className={styles.phaseText}>{phaseInfo.text}</span>\n            {timeLeft !== null && (\n              <div className={styles.timerBar}>\n                <div \n                  className={styles.timerProgress} \n                  style={{ \n                    width: `${(timeLeft / (currentPhase === 'dealing' ? TIMERS.DEALING_DURATION :\n                                         currentPhase === 'betting' ? TIMERS.BETTING_DURATION :\n                                         currentPhase === 'revealing' ? TIMERS.REVEALING_DURATION :\n                                         TIMERS.RESULTS_DURATION)) * 100}%`\n                  }}\n                />\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n      \n      {/* Game Summary Modal */}\n      {showGameSummary && (\n        <GameSummaryModal \n          onClose={() => setShowGameSummary(false)} \n          gameData={gameState}\n        />\n      )}\n      \n      {/* Store Modal */}\n      {showStoreModal && (\n        <StoreModal\n          onClose={() => setShowStoreModal(false)}\n        />\n      )}\n    </div>\n  );\n};\n\nexport default GameHeader;\n","import React from 'react';\n\n/**\n * Arrow icon component that can be rotated to point up or down\n * @param {Object} props - Component props\n * @param {string} props.direction - Direction of the arrow ('up' or 'down')\n * @param {string} props.color - Color of the arrow (default: 'currentColor')\n * @param {number} props.size - Size of the icon in pixels (default: 24)\n */\nconst ArrowIcon = ({ direction = 'up', color = 'currentColor', size = 24 }) => {\n  // Determine rotation based on direction\n  const rotation = direction === 'down' ? 'rotate(180deg)' : 'rotate(0deg)';\n  \n  return (\n    <svg \n      xmlns=\"http://www.w3.org/2000/svg\" \n      width={size} \n      height={size} \n      viewBox=\"0 0 24 24\" \n      fill=\"none\" \n      stroke={color} \n      strokeWidth=\"2\" \n      strokeLinecap=\"round\" \n      strokeLinejoin=\"round\"\n      style={{ transform: rotation, display: 'inline-block', transformOrigin: 'center' }}\n    >\n      {/* This is the shift/arrow up icon from Material Design */}\n      <path d=\"M7 11l5-5 5 5M7 17l5-5 5 5\" />\n    </svg>\n  );\n};\n\nexport default ArrowIcon;\n","import React from 'react';\nimport styles from './styles/CardDisplay.module.css';\nimport { useGameContext } from '../contexts/GameContext';\nimport ArrowIcon from './icons/ArrowIcon';\n\nconst CardDisplay = () => {\n  const { gameState } = useGameContext();\n  \n  if (!gameState) {\n    return <div className={styles.loading}>Loading game state...</div>;\n  }\n  \n  const { \n    firstCard,\n    secondCard,\n    thirdCard,\n    phase,\n    dealer\n  } = gameState;\n  \n  // Card state is managed by the game context\n  \n  const dealerName = dealer?.name;\n  const cardLabels = {\n    '2': '2', '3': '3', '4': '4', '5': '5', '6': '6', '7': '7', '8': '8', '9': '9', '10': '10',\n    'J': 'J', 'Q': 'Q', 'K': 'K', 'A': 'A'\n  };\n  \n  // Map for handling both string names and direct symbols\n  const suitSymbols = {\n    'hearts': '',\n    'diamonds': '',\n    'clubs': '',\n    'spades': '',\n    // Handle direct Unicode symbols as well\n    '': '',\n    '': '',\n    '': '',\n    '': ''\n  };\n  \n  // Helper to determine if a suit is red\n  const isRedSuit = (suit) => {\n    return suit === '' || suit === '' || suit === 'hearts' || suit === 'diamonds';\n  };\n  \n  const renderCard = (card, index) => {\n    if (!card) return (\n      <div key={`empty-${index}`} className={styles.card}>\n        <div className={styles.cardBack}></div>\n      </div>\n    );\n    \n    const isRed = isRedSuit(card.suit);\n    const isAce = card.value === 'A';\n    const isAceLow = card.isAceLow;\n    const isMiddleCard = index === 1; // Index 1 is the middle card position\n    \n    return (\n      <div key={`${card.value}-${card.suit}-${index}`} \n        className={`${styles.card} ${isRed ? styles.redCard : styles.blackCard} ${isAce ? styles.aceCard : ''}`}\n      >\n        {isAce && !isMiddleCard && (\n          <div className={`${styles.aceIndicator} ${isAceLow ? styles.aceLow : styles.aceHigh} ${isRed ? styles.redCard : styles.blackCard}`}>\n            {isAceLow ? (\n              <span className={styles.indicatorContent}>LOW <ArrowIcon direction=\"down\" color={isRed ? '#e74c3c' : '#2c3e50'} size={16} /></span>\n            ) : (\n              <span className={styles.indicatorContent}>HIGH <ArrowIcon direction=\"up\" color={isRed ? '#e74c3c' : '#2c3e50'} size={16} /></span>\n            )}\n          </div>\n        )}\n        <div className={styles.cardCorner}>\n          <div className={styles.cardValue}>{cardLabels[card.value]}</div>\n          <div className={styles.cardSuit}>{suitSymbols[card.suit]}</div>\n        </div>\n        <div className={styles.cardCenter}>\n          {suitSymbols[card.suit]}\n        </div>\n        <div className={`${styles.cardCorner} ${styles.bottomRight}`}>\n          <div className={styles.cardValue}>{cardLabels[card.value]}</div>\n          <div className={styles.cardSuit}>{suitSymbols[card.suit]}</div>\n        </div>\n      </div>\n    );\n  };\n  \n  // Function to handle card positioning \n  const renderCardLayout = () => {\n    // Create an array of 3 nulls to represent the card slots\n    let displayCards = [null, null, null];\n    \n    // Check if we have a valid game state with cards\n    if (!firstCard && !secondCard && !thirdCard) {\n      return displayCards.map((card, index) => renderCard(card, index));\n    }\n    \n    // Handle the individual card properties\n    if (firstCard) {\n      displayCards[0] = {...firstCard}; // Left position - use spread operator to create a copy\n    }\n    \n    if (secondCard) {\n      displayCards[2] = {...secondCard}; // Right position - use spread operator to create a copy\n    }\n    \n    if (thirdCard) {\n      displayCards[1] = {...thirdCard}; // Middle position - use spread operator to create a copy\n    }\n    \n    return displayCards.map((card, index) => renderCard(card, index));\n  };\n\n  return (\n    <div className={styles.cardDisplayContainer}>\n      <div className={`${styles.cardsRow} ${phase === 'dealing' ? styles.dealingPhase : ''} ${phase === 'revealing' ? styles.revealingPhase : ''}`}>\n        {renderCardLayout()}\n      </div>\n    </div>\n  );\n};\n\nexport default CardDisplay;\n","import React from 'react';\nimport styles from './styles/PotButton.module.css';\nimport CurrencyAmount from './common/CurrencyAmount';\n\n/**\n * PotButton - The most epic, baller button in the entire game\n * Features a shimmering gold border with a shiny silver background to make the gold currency pop\n * Includes multiple overlapping layers and effects for maximum visual impact\n * \n * @param {Object} props - Component props\n * @param {number} props.amount - The pot amount to display\n * @param {boolean} props.disabled - Whether the button is disabled\n * @param {function} props.onClick - Function to call when the button is clicked\n */\nconst PotButton = ({ amount, disabled, onClick, ...props }) => {\n  return (\n    <button\n      className={`${styles.potButton} ${disabled ? styles.disabled : ''}`}\n      onClick={onClick}\n      disabled={disabled}\n      aria-label={`Bet the pot: ${amount} chips`}\n      {...props}\n    >\n      {/* Layer 2: Gold border with texture */}\n      <div className={styles.shimmerBorder}></div>\n      \n      {/* Layer 4: Silver metallic background */}\n      <div className={styles.buttonBackground}></div>\n      \n      {/* Layer 5: Light reflection effects */}\n      <div className={styles.reflectionEffect}></div>\n      \n      {/* Layer 6-8: Button content with 3D transform */}\n      <div className={styles.buttonContent}>\n        <span className={styles.potText}>POT</span>\n        <span className={styles.potAmount}>\n          <CurrencyAmount amount={amount} background=\"pill\" />\n        </span>\n      </div>\n    </button>\n  );\n};\n\nexport default PotButton;\n","import React, { useState } from 'react';\nimport styles from './styles/BettingPanel.module.css';\nimport { useGameContext } from '../contexts/GameContext';\nimport { useSocket } from '../contexts/SocketContext';\nimport CurrencyAmount from './common/CurrencyAmount';\nimport PotButton from './PotButton.jsx';\nimport GamepadInput from './GamepadInput';\n\nconst BettingPanel = () => {\n  // Get game state and actions from context\n  const { gameState, placeBet } = useGameContext();\n  const { socket } = useSocket();\n  // Initialize state first - before any conditional returns\n  const [customBet, setCustomBet] = useState('');\n  \n  if (!gameState) return null;\n  \n  const { \n    players, \n    currentPlayerId, \n    pot: potAmount, \n    phase,\n    firstCard,\n    secondCard\n  } = gameState;\n  \n  // Only show in betting phase\n  if (phase !== 'betting') return null;\n  \n  const isCurrentPlayer = socket && currentPlayerId === socket.auth?.userId;\n  const myPlayer = socket && players && socket.auth?.userId ? players[socket.auth.userId] : null;\n  const playerBalance = Number(myPlayer?.balance || 0);\n  \n  const handleCustomBetChange = (e) => {\n    // Only allow numbers\n    const value = e.target.value.replace(/[^0-9]/g, '');\n    \n    // Don't allow bets greater than pot or player balance\n    const maxBet = Math.min(potAmount, playerBalance);\n    if (value && parseInt(value) > maxBet) {\n      setCustomBet(maxBet.toString());\n    } else {\n      setCustomBet(value);\n    }\n  };\n  \n  const handleCustomBetSubmit = () => {\n    if (customBet && !isNaN(customBet)) {\n      const betAmount = parseInt(customBet, 10);\n      // Verify bet is at least $1 and at most the pot/balance\n      if (betAmount >= 1 && betAmount <= Math.min(potAmount, playerBalance)) {\n        placeBet(betAmount);\n        setCustomBet('');\n      }\n    }\n  };\n  \n  // Helper to handle Enter key in the custom bet input\n  const handleKeyPress = (e) => {\n    if (e.key === 'Enter') {\n      handleCustomBetSubmit();\n    }\n  };\n  \n\n  \n  const renderBettingControls = () => {\n    if (!isCurrentPlayer) return null;\n    \n    return (\n      <div className={styles.betContainer}>\n        <p className={styles.betText}>Place your bet (Min: <CurrencyAmount amount={1} />, Max: <CurrencyAmount amount={Math.min(potAmount, playerBalance)} />)</p>\n        \n        {/* Extreme options row */}\n        <div className={styles.extremeOptionsRow}>\n          <button\n            className={`${styles.betButton} ${styles.extremeButton} ${styles.passButton}`}\n            onClick={() => placeBet(0)}\n            data-gamepad-focusable=\"true\"\n            autoFocus\n          >\n            PASS\n          </button>\n          \n          <PotButton \n            amount={potAmount}\n            onClick={() => placeBet(potAmount)}\n            disabled={potAmount > playerBalance}\n            data-gamepad-focusable=\"true\"\n          />\n        </div>\n        \n        {/* Standard bet options */}\n        <div className={styles.betButtons}>\n          {[1, 2, 5].map(amount => {\n            const maxBet = Math.min(potAmount, playerBalance);\n            const disabled = amount > maxBet;\n            return (\n              <button\n                key={amount}\n                className={`${styles.betButton} ${disabled ? styles.disabledButton : ''}`}\n                onClick={() => placeBet(amount)}\n                disabled={disabled}\n                data-gamepad-focusable=\"true\"\n              >\n                <CurrencyAmount amount={amount} />\n              </button>\n            );\n          })}\n          \n          {/* Custom bet input */}\n          <div className={styles.customBetContainer}>\n            <GamepadInput\n              title=\"Enter Bet Amount\"\n              type=\"number\"\n              className={styles.customBetInput}\n              placeholder=\"Custom\"\n              value={customBet}\n              onChange={handleCustomBetChange}\n              onKeyPress={handleKeyPress}\n            />\n            <button\n              className={styles.customBetButton}\n              onClick={handleCustomBetSubmit}\n              disabled={!customBet}\n              data-gamepad-focusable=\"true\"\n            >\n              Bet\n            </button>\n          </div>\n        </div>\n      </div>\n    );\n  };\n  \n\n  // Only render the panel for the current player\n  if (!isCurrentPlayer) return null;\n  \n  return (\n    <div className={styles.bettingPanel}>\n      {renderBettingControls()}\n    </div>\n  );\n};\n\nexport default BettingPanel;\n","import React, { useRef, useEffect, useState, useMemo, useContext } from 'react';\nimport styles from './styles/PlayerList.module.css';\nimport { useGameContext } from '../contexts/GameContext';\nimport { useSocket } from '../contexts/SocketContext';\nimport CurrencyAmount from './common/CurrencyAmount';\nimport UserAvatar from './UserAvatar.jsx';\nimport { ICONS } from '../constants';\nimport UserDataContext from '../contexts/UserDataContext';\n\nconst PlayerList = () => {\n  const { gameState } = useGameContext();\n  const { socket } = useSocket();\n  const userDataContext = useContext(UserDataContext);\n  \n  // Prefetch user data for all players when game state changes\n  useEffect(() => {\n    if (gameState?.players && userDataContext) {\n      const userIds = Object.values(gameState.players).map(player => player.userId).filter(Boolean);\n      if (userIds.length > 0) {\n        userDataContext.prefetchUsers(userIds);\n      }\n    }\n  }, [gameState?.players, userDataContext]);\n  \n  if (!gameState || !gameState.players) {\n    return (\n      <div className={styles.emptyPlayerList}>\n        <p>Waiting for game data...</p>\n      </div>\n    );\n  }\n  \n  const { players, currentPlayerId, dealerId, gameTransactions = [] } = gameState;\n  const currentUserId = socket?.auth?.userId;\n  \n  // Use server-side calculated totals\n  const playerTotals = gameState.totals || {};\n  if (!players || Object.keys(players).length === 0) {\n    return (\n      <div className={styles.emptyPlayerList}>\n        <p>Waiting for players to join...</p>\n      </div>\n    );\n  }\n\n  \n  return (\n    <div className={styles.playersContainer}>\n      <h3 className={styles.playersTitle}>Scoreboard</h3>\n      \n      <div className={styles.playersList}>\n        {/* Use gameState.seats to render players in seat order */}\n        {gameState.seats\n          .filter(playerId => playerId !== null && players[playerId])\n          .map(playerId => {\n            const player = players[playerId];\n            const isCurrentPlayer = playerId === currentPlayerId;\n            // Compare player.userId with currentUserId instead of comparing playerId with currentUserId\n            const isCurrentUser = player.userId === currentUserId;\n            const isDealer = playerId === dealerId; // Use playerId instead of player.id\n            const isDisconnected = player.disconnected === true;\n            \n            return (\n              <div \n                key={playerId} \n                className={`\n                  ${styles.playerItem}\n                  ${isCurrentPlayer ? styles.currentPlayer : ''}\n                  ${isCurrentUser ? styles.currentUser : ''}\n                `}\n              >\n              <div className={styles.playerInfo}>\n                <UserAvatar \n                  userId={player.userId}\n                  size=\"small\" \n                  showName={false}\n                />\n                <span className={styles.playerName}>\n                  {player.name}\n                  <span className={styles.playerStatus}>\n                    {isDealer && ` ${ICONS.DEALER}`}\n                    {player.disconnected && <span className={styles.disconnectedIndicator} title=\"Player disconnected\"> Disconnected</span>}\n                  </span>\n                </span>\n              </div>\n              <div className={styles.playerBalanceContainer}>\n                <BalanceDisplay balance={playerTotals[playerId] || 0} />\n\n                <div \n                  className={`\n                    ${styles.readyIndicator} \n                    ${player.isSittingOut ? styles.sittingOut : (player.isReady ? styles.ready : styles.notReady)}\n                  `}\n                  title={player.isSittingOut ? 'Sitting Out' : (player.isReady ? 'Ready' : 'Not Ready')}\n                >\n                </div>\n              </div>\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n};\n\nconst BalanceDisplay = ({ balance }) => {\n  const [prevBalance, setPrevBalance] = useState(balance);\n  const [animationClass, setAnimationClass] = useState('');\n  const timeoutRef = useRef(null);\n\n  useEffect(() => {\n    if (balance !== prevBalance) {\n      // Determine if balance increased or decreased\n      const isIncrease = balance > prevBalance;\n      setAnimationClass(isIncrease ? styles.balanceIncrease : styles.balanceDecrease);\n\n      // Clear previous timeout if it exists\n      if (timeoutRef.current) {\n        clearTimeout(timeoutRef.current);\n      }\n\n      // Remove animation class after animation completes\n      timeoutRef.current = setTimeout(() => {\n        setAnimationClass('');\n      }, 1000); // Match animation duration\n\n      setPrevBalance(balance);\n    }\n\n    return () => {\n      if (timeoutRef.current) {\n        clearTimeout(timeoutRef.current);\n      }\n    };\n  }, [balance]);\n\n  return (\n    <span className={`${styles.playerBalance} ${animationClass}`}>\n      <CurrencyAmount amount={balance} />\n    </span>\n  );\n};\n\nexport default PlayerList;\n","import React from 'react';\nimport styles from './styles/PotDisplay.module.css';\nimport { useGameContext } from '../contexts/GameContext';\nimport CurrencyAmount from './common/CurrencyAmount';\nimport { ICONS } from '../constants';\n\nconst PotDisplay = () => {\n  const { gameState } = useGameContext();\n  \n  if (!gameState) return null;\n  \n  const { pot, round = 1 } = gameState;\n  \n  return (\n    <div className={styles.potDisplayContainer}>\n      <div className={styles.potIconWrapper}>\n        <span className={styles.potIcon}>{ICONS.POT}</span>\n      </div>\n      <div className={styles.potInfo}>\n        <h3 className={styles.potLabel}>\n          POT <span className={styles.potCounter}>({round})</span>\n        </h3>\n        <span className={styles.potAmount}><CurrencyAmount amount={pot} size=\"medium\" /></span>\n      </div>\n    </div>\n  );\n};\n\nexport default PotDisplay;\n","import React from 'react';\nimport styles from './styles/DeckDisplay.module.css';\nimport { useGameContext } from '../contexts/GameContext';\nimport { ICONS } from '../constants';\n\nconst DeckDisplay = () => {\n  const { gameState } = useGameContext();\n  \n  if (!gameState) return null;\n  \n  // Get the deck size and deck count from the game state\n  const { deckSize = 0, deckCount = 1 } = gameState;\n  \n  // Calculate the visual thickness of the deck based on remaining cards\n  const getThicknessClass = () => {\n    if (deckSize >= 40) return styles.deckThick;\n    if (deckSize >= 25) return styles.deckMedium;\n    if (deckSize >= 10) return styles.deckThin;\n    return styles.deckVeryThin;\n  };\n  \n  return (\n    <div className={styles.deckDisplayContainer}>\n      <div className={`${styles.deckVisual} ${getThicknessClass()}`}>\n        <div className={styles.deckIcon}>{ICONS.DECK}</div>\n      </div>\n      <div className={styles.deckInfo}>\n        <h3 className={styles.deckLabel}>\n          DECK <span className={styles.deckCounter}>({deckCount})</span>\n        </h3>\n        <span className={styles.deckCount}>{deckSize}</span>\n      </div>\n    </div>\n  );\n};\n\nexport default DeckDisplay;\n","import React from 'react';\nimport { usePreferences } from '../contexts/PreferencesContext';\nimport { useGameContext } from '../contexts/GameContext';\nimport { useSocket } from '../contexts/SocketContext';\nimport styles from './styles/AutoAnteToggle.module.css';\n\nconst AutoAnteToggle = () => {\n  const { preferences, toggleAutoAnte, loading } = usePreferences();\n  const { gameState, playerReady } = useGameContext();\n  const { socket } = useSocket();\n  \n  const handleToggle = async () => {\n    const newValue = !preferences.autoAnte;\n    const success = await toggleAutoAnte();\n    \n    // Only auto-ante if the player is not already anted\n    if (newValue && success && playerReady) {\n      // Check if player is already anted (using userId instead of socket.id)\n      let myPlayer = null;\n      if (socket && socket.auth?.userId && gameState?.players) {\n        // Find player by userId\n        const playerIds = Object.keys(gameState.players);\n        for (const id of playerIds) {\n          if (gameState.players[id].userId === socket.auth.userId) {\n            myPlayer = gameState.players[id];\n            break;\n          }\n        }\n      }\n      const isPlayerReady = myPlayer?.isReady;\n      \n      // Only call playerReady if the player is not already ready\n      if (!isPlayerReady) {\n        playerReady();\n      }\n    }\n  };\n  \n  if (loading) {\n    return <div className={styles.loading}>Loading preferences...</div>;\n  }\n  \n  return (\n    <div className={styles.toggleContainer}>\n      <label className={styles.toggleLabel}>\n        <input\n          type=\"checkbox\"\n          checked={preferences.autoAnte}\n          onChange={handleToggle}\n          className={styles.toggleInput}\n          data-gamepad-focusable=\"true\"\n        />\n        <span className={styles.toggleSlider}></span>\n        <span className={styles.toggleText}>\n          Auto-Ante\n        </span>\n      </label>\n    </div>\n  );\n};\n\nexport default AutoAnteToggle;\n","import React from 'react';\nimport styles from './styles/AnteControls.module.css';\nimport { useGameContext } from '../contexts/GameContext';\nimport { useSocket } from '../contexts/SocketContext';\nimport { useAuth } from '../contexts/AuthContext';\nimport CurrencyAmount from './common/CurrencyAmount';\nimport { ICONS } from '../constants';\nimport AutoAnteToggle from './AutoAnteToggle.jsx';\n\n\nconst AnteControls = () => {\n  // Get game state and actions from context\n  const { gameState, playerReady, playerUnready } = useGameContext();\n  const { socket } = useSocket();\n  const { user } = useAuth();\n  \n  if (!gameState) return null;\n  \n  const { \n    players, \n    anteAmount, \n    phase \n  } = gameState;\n  \n  // Only show in waiting phase\n  if (phase !== 'waiting') return null;\n  \n  // Find the player by user ID\n  let myPlayer = null;\n  if (socket && socket.auth?.userId && players) {\n    // Find player by userId\n    const playerIds = Object.keys(players);\n    for (const id of playerIds) {\n      if (players[id].userId === socket.auth.userId) {\n        myPlayer = players[id];\n        break;\n      }\n    }\n  } else if (user && players) {\n    // If we can't find by socket ID, try to find by user ID\n    const playerIds = Object.keys(players);\n    for (const id of playerIds) {\n      if (players[id].userId === user.id) {\n        myPlayer = players[id];\n        console.log(`[AnteControls] Found player by user ID instead of socket ID`);\n        break;\n      }\n    }\n  }\n  \n  // Get player balance and ready status\n  const playerBalance = Number(myPlayer?.balance || 0);\n  const isPlayerReady = myPlayer?.isReady;\n  \n  // Check if player has enough chips\n  const hasEnoughChips = playerBalance >= anteAmount;\n  \n  // Player state and readiness is managed by the game context\n  \n  return (\n    <div className={styles.anteControlsWrapper}>\n      <div className={styles.controlsContainer}>\n        {/* Main action button (Ante or Back Out) */}\n        <div className={styles.buttonContainerRow}>\n          {!isPlayerReady ? (\n            // Player is not ready - show Ante button and Sit Out button side by side\n            <div className={styles.buttonContainerRow}>\n              <button \n                className={styles.anteButton}\n                onClick={playerReady}\n                disabled={!hasEnoughChips}\n                aria-label=\"Ante up\"\n                data-gamepad-focusable=\"true\"\n                autoFocus\n              >\n                {/* Add shimmer border for glimmering effect */}\n                <div className={styles.shimmerBorder}></div>\n                <span className={styles.anteIcon}>{ICONS.CHECK}</span>\n                <div className={styles.buttonInfo}>\n                  <h3 className={styles.buttonLabel}>ANTE</h3>\n                  <span className={styles.buttonAmount}><CurrencyAmount amount={anteAmount} /></span>\n                </div>\n              </button>\n\n              <button\n                className={`${styles.backOutButton} ${styles.sitOutHalfWidth}`}\n                onClick={() => {\n                  if (socket && gameState && user) {\n                    socket.emit('sitOut', {\n                      gameId: gameState.id,\n                      userId: socket.auth?.userId || user.id\n                    });\n                  }\n                }}\n                disabled={myPlayer?.isSittingOut} // Disable if sitting out\n                title={myPlayer?.isSittingOut ? \"You are currently sitting out\" : \"Sit out next round\"}\n                aria-label=\"Sit Out\"\n                data-gamepad-focusable=\"true\"\n              >\n                <div className={styles.shimmerBorder}></div>\n                <div className={styles.buttonInfo}>\n                  <h3 className={styles.buttonLabel}>SIT OUT</h3>\n                </div>\n              </button>\n\n              {!hasEnoughChips && (\n                <p className={styles.notEnoughChipsText}>Not enough coins (<CurrencyAmount amount={anteAmount} /> required)</p>\n              )}\n            </div>\n          ) : (\n            // Player is ready - show Back Out button\n            <div className={styles.buttonContainerRow}>\n              <button \n                className={styles.backOutButton}\n                onClick={() => {\n                  if (typeof playerUnready === 'function') {\n                    playerUnready();\n                  } else {\n                    console.error('playerUnready is not a function');\n                  }\n                }}\n                aria-label=\"Back out\"\n                data-gamepad-focusable=\"true\"\n              >\n                {/* Add shimmer border for glimmering effect */}\n                <div className={styles.shimmerBorder}></div>\n                <span className={styles.backOutIcon}></span>\n                <div className={styles.buttonInfo}>\n                  <h3 className={styles.buttonLabel}>BACK OUT</h3>\n                </div>\n              </button>\n            </div>\n          )}\n        </div>\n        \n        {/* Auto-Ante toggle - always shown */}\n        <div className={styles.autoAnteContainer}>\n          <AutoAnteToggle />\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default AnteControls;\n","import { useGameContext } from '../contexts/GameContext';\nimport styles from './styles/ResultsPanel.module.css';\nimport CurrencyAmount from './common/CurrencyAmount';\n\n/**\n * Results panel component that displays the outcome of a hand during the results phase\n */\nconst ResultsPanel = () => {\n  const { gameState } = useGameContext();\n\n  // If there's no result, don't render anything\n  if (!gameState.result) return null;\n\n  const { result, players, resultCountdown } = gameState;\n  const playerName = players[result.playerId]?.name;\n\n  const renderWinResult = () => (\n    <>\n      <h2 className={`${styles.resultText} ${styles.winText}`}>\n        {playerName} WON!\n      </h2>\n      {result.winnings > 0 && (\n        <p className={styles.winningsText}>\n          Winnings: <CurrencyAmount amount={result.winnings / 2} size=\"medium\" />\n        </p>\n      )}\n    </>\n  );\n\n  const renderLossResult = () => (\n    <>\n      <h2 className={`${styles.resultText} ${styles.loseText}`}>\n        {playerName} LOST!\n      </h2>\n      {result.betAmount > 0 && (\n        <p className={styles.winningsText}>\n          Loss: <CurrencyAmount amount={result.betAmount} size=\"medium\" />\n        </p>\n      )}\n    </>\n  );\n\n  const renderTieResult = () => {\n    const penaltyAmount = result.betAmount * (result.isTripleAceTie ? 3 : 2);\n    \n    return (\n      <>\n        <div className={styles.penaltyWarning}>\n          <div className={styles.cautionTape}></div>\n        </div>\n        <h2 className={`${styles.resultText} ${styles.tieText}`}>\n          {playerName} {result.isTripleAceTie ? '3X' : '2X'} PENALTY!\n        </h2>\n        {result.betAmount > 0 && (\n          <p className={styles.winningsText}>\n            Penalty: <CurrencyAmount amount={penaltyAmount} size=\"medium\" />\n          </p>\n        )}\n      </>\n    );\n  };\n\n  const renderOutcome = () => {\n    switch (result.outcome) {\n      case 'win':\n        return renderWinResult();\n      case 'lose':\n        return renderLossResult();\n      case 'tie':\n        return renderTieResult();\n      default:\n        return null;\n    }\n  };\n\n  return (\n    <div className={styles.resultsPanel}>\n      {/* Card display section removed - cards are now visible in the game board */}\n\n      <div className={styles.resultContent}>\n        {renderOutcome()}\n        \n        {resultCountdown && (\n          <div className={styles.countdownContainer}>\n            <p className={styles.countdownText}>\n              Next hand in: {resultCountdown.countdownSeconds}s\n            </p>\n            <div className={styles.countdownProgress}>\n              <div \n                className={styles.countdownBar} \n                style={{ width: `${(resultCountdown.countdownSeconds / 5) * 100}%` }}\n              ></div>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default ResultsPanel;","import React, { useState, useEffect } from 'react';\nimport styles from './styles/AceChoicePanel.module.css';\nimport { useSocket } from '../contexts/SocketContext';\nimport { useGameContext } from '../contexts/GameContext';\nimport { useAuth } from '../contexts/AuthContext';\nimport ArrowIcon from './icons/ArrowIcon';\n\nconst AceChoicePanel = () => {\n  const { socket } = useSocket();\n  const { gameState } = useGameContext();\n  const { user } = useAuth();\n  const [countdown, setCountdown] = useState(15);\n  \n  // Set up countdown timer when the component mounts\n  useEffect(() => {\n    if (gameState?.waitingForAceDecision && socket?.auth?.userId === gameState.currentPlayerId) {\n      setCountdown(15); // Reset to 15 seconds\n      \n      const timer = setInterval(() => {\n        setCountdown(prevCount => {\n          if (prevCount <= 1) {\n            clearInterval(timer);\n            return 0;\n          }\n          return prevCount - 1;\n        });\n      }, 1000);\n      \n      return () => clearInterval(timer);\n    }\n  }, [gameState?.waitingForAceDecision, gameState?.currentPlayerId, socket?.auth?.userId]);\n  \n  const handleAceChoice = (isAceLow) => {\n    socket.emit('chooseAceValue', { isAceLow });\n  };\n  \n  // Check if it's the current player's turn\n  const isCurrentPlayersTurn = socket?.auth?.userId === gameState.currentPlayerId;\n  const currentPlayerName = gameState.players[gameState.currentPlayerId]?.name || 'Current player';\n  \n  const renderAceChoiceControls = () => {\n    if (!isCurrentPlayersTurn) return null;\n    \n    return (\n      <div className={styles.aceChoiceControls}>\n        <p className={styles.aceChoiceText}>\n          You've been dealt an Ace! Choose whether it should be high or low.\n          <span className={styles.countdown}> ({countdown}s)</span>\n        </p>\n        \n        <div className={styles.aceChoiceButtons}>\n          <button \n            className={`${styles.aceChoiceButton} ${styles.aceHighButton}`}\n            onClick={() => handleAceChoice(false)}\n            data-gamepad-focusable=\"true\"\n            autoFocus\n          >\n            <span className={styles.buttonContent}>ACE HIGH <ArrowIcon direction=\"up\" color=\"white\" size={20} /></span>\n          </button>\n          <button \n            className={`${styles.aceChoiceButton} ${styles.aceLowButton}`}\n            onClick={() => handleAceChoice(true)}\n            data-gamepad-focusable=\"true\"\n          >\n            <span className={styles.buttonContent}>ACE LOW <ArrowIcon direction=\"down\" color=\"white\" size={20} /></span>\n          </button>\n        </div>\n      </div>\n    );\n  };\n  \n  const renderWaitingMessage = () => {\n    if (isCurrentPlayersTurn) return null;\n    \n    return (\n      <div className={styles.waitingMessage}>\n        <p className={styles.waitingText}>\n          {currentPlayerName} is choosing whether their Ace is high or low...\n        </p>\n      </div>\n    );\n  };\n  \n  return (\n    <div className={styles.aceChoicePanel}>\n      {renderAceChoiceControls()}\n      {renderWaitingMessage()}\n    </div>\n  );\n};\n\nexport default AceChoicePanel;\n","import React, { useState, useEffect } from 'react';\nimport styles from './styles/SecondChancePanel.module.css';\nimport { useGameContext } from '../contexts/GameContext';\nimport { useSocket } from '../contexts/SocketContext';\nimport CurrencyAmount from './common/CurrencyAmount';\n\nconst SecondChancePanel = () => {\n  const { gameState } = useGameContext();\n  const { socket } = useSocket();\n  const [loading, setLoading] = useState(false);\n  const [actionType, setActionType] = useState(null); // 'ante' or 'pass'\n  const [countdown, setCountdown] = useState(15);\n  \n  // Set up countdown timer when the component mounts\n  useEffect(() => {\n    if (gameState?.waitingForSecondChance && socket?.auth?.userId === gameState.currentPlayerId) {\n      setCountdown(15); // Reset to 15 seconds\n      \n      const timer = setInterval(() => {\n        setCountdown(prevCount => {\n          if (prevCount <= 1) {\n            clearInterval(timer);\n            return 0;\n          }\n          return prevCount - 1;\n        });\n      }, 1000);\n      \n      return () => clearInterval(timer);\n    }\n  }, [gameState?.waitingForSecondChance, gameState?.currentPlayerId, socket?.auth?.userId]);\n  \n  const { \n    players, \n    currentPlayerId, \n    anteAmount = 1\n  } = gameState;\n  \n  const isCurrentPlayer = socket && currentPlayerId === socket.auth?.userId;\n  const currentPlayer = players[currentPlayerId];\n  \n  const handleSecondChance = (anteAgain) => {\n    if (socket) {\n      setLoading(true);\n      setActionType(anteAgain ? 'ante' : 'pass');\n      socket.emit('secondChance', { anteAgain });\n    }\n  };\n  \n  const renderSecondChanceControls = () => {\n    if (!isCurrentPlayer) return null;\n    \n    return (\n      <div className={styles.secondChanceControls}>\n        <p className={styles.secondChanceText}>\n          Would you like to ante up again for a second chance?\n          <span className={styles.countdown}> ({countdown}s)</span>\n        </p>\n        \n        <div className={styles.secondChanceButtons}>\n          <button\n            className={`${styles.secondChanceButton} ${styles.anteAgainButton}`}\n            onClick={() => handleSecondChance(true)}\n            data-gamepad-focusable=\"true\"\n            autoFocus\n          >\n            {loading && actionType === 'ante' ? 'Processing...' : (\n              <>\n                Ante Up <span className={styles.currencyWrapper}>\n                  <CurrencyAmount amount={anteAmount} size=\"small\" />\n                </span>\n              </>\n            )}\n          </button>\n          <button\n            className={`${styles.secondChanceButton} ${styles.passButton}`}\n            onClick={() => handleSecondChance(false)}\n            data-gamepad-focusable=\"true\"\n          >\n            {loading && actionType === 'pass' ? 'Processing...' : 'Pass'}\n          </button>\n        </div>\n      </div>\n    );\n  };\n  \n  const renderWaitingMessage = () => {\n    if (isCurrentPlayer) return null;\n    \n    return (\n      <div className={styles.waitingMessage}>\n          <p className={styles.waitingText}>\n            {currentPlayer?.name} is deciding whether to take a second chance.\n          </p>\n      </div>\n    );\n  };\n  \n  return (\n    <div className={styles.secondChancePanel}>\n      {renderSecondChanceControls()}\n      {renderWaitingMessage()}\n    </div>\n  );\n};\n\nexport default SecondChancePanel;\n","import React, { useState } from 'react';\nimport styles from './styles/GameLog.module.css';\nimport { useGameContext } from '../contexts/GameContext';\n\nconst GameLog = () => {\n  const { gameState } = useGameContext();\n  const [isExpanded, setIsExpanded] = useState(false);\n  \n  if (!gameState || !gameState.gameLog) return null;\n  \n  // Get the game log entries\n  const logEntries = gameState.gameLog || [];\n  \n  // Format timestamp to readable time\n  const formatTime = (timestamp) => {\n    const date = new Date(timestamp);\n    return date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', second: '2-digit' });\n  };\n  \n  // Toggle expanded state\n  const toggleExpanded = () => {\n    setIsExpanded(!isExpanded);\n  };\n  \n  // Determine how many entries to show\n  const displayEntries = isExpanded ? logEntries : logEntries.slice(0, 5);\n  \n  return (\n    <div className={styles.gameLogContainer}>\n      <div className={styles.gameLogHeader} onClick={toggleExpanded}>\n        <h3>Game Log</h3>\n        <span className={styles.expandIcon}>{isExpanded ? '' : ''}</span>\n      </div>\n      \n      <div className={`${styles.gameLogEntries} ${isExpanded ? styles.expanded : ''}`}>\n        {displayEntries.length === 0 ? (\n          <div className={styles.emptyLog}>No game events yet</div>\n        ) : (\n          displayEntries.map((entry, index) => (\n            <div key={index} className={styles.logEntry}>\n              <span className={styles.logTime}>{formatTime(entry.timestamp)}</span>\n              <span className={styles.logMessage}>{entry.message}</span>\n            </div>\n          ))\n        )}\n      </div>\n      \n      {!isExpanded && logEntries.length > 5 && (\n        <div className={styles.showMoreButton} onClick={toggleExpanded}>\n          Show {logEntries.length - 5} more entries\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default GameLog;\n","import React, { useState } from 'react';\nimport styles from './styles/EmojiReactions.module.css';\nimport { useSocket } from '../contexts/SocketContext';\nimport { useGameContext } from '../contexts/GameContext';\nimport { useAuth } from '../contexts/AuthContext';\n\nconst EmojiReactions = () => {\n  const [isOpen, setIsOpen] = useState(false);\n  const { socket } = useSocket();\n  const { gameState } = useGameContext();\n  const { user } = useAuth();\n\n  // Available emojis for reactions - colors matched to emoji appearance\n  const emojis = [\n    { emoji: '', name: 'Fire', color: '#FF6B35' },       // Orange-red flame\n    { emoji: '', name: 'Happy', color: '#FFD93D' },      // Yellow happy face\n    { emoji: '', name: 'Poop', color: '#8B4513' },       // Brown\n    { emoji: '', name: 'Cool', color: '#4A5568' },       // Dark gray (sunglasses)\n    { emoji: '', name: 'Mind Blown', color: '#FFA500' }, // Orange explosion\n    { emoji: '', name: 'Devilish', color: '#9333EA' },   // Purple devil\n    { emoji: '', name: 'Worried', color: '#FCD34D' },    // Yellow grimace\n    { emoji: '', name: 'Applause', color: '#FBBF24' },   // Skin tone yellow\n    { emoji: '', name: 'Crying', color: '#3B82F6' },     // Blue tears\n    { emoji: '', name: 'Clown', color: '#EF4444' },      // Red nose\n    { emoji: '', name: 'Strong', color: '#F59E0B' },     // Skin/muscle tone\n    { emoji: '', name: 'Nervous', color: '#60A5FA' },    // Blue sweat drop\n    { emoji: '', name: 'Celebration', color: '#A855F7' }, // Multi-color party\n    { emoji: '', name: 'Thinking', color: '#6B7280' },   // Neutral gray\n    { emoji: '', name: 'See No Evil', color: '#A0522D' }, // Monkey brown\n    { emoji: '', name: 'Confident', color: '#DC2626' }   // Red anger/steam\n  ];\n\n  const handleEmojiClick = (emojiData) => {\n    if (!socket || !gameState || !user) {\n      return;\n    }\n\n    // Send emoji reaction to server\n    socket.emit('emojiReaction', {\n      gameId: gameState.id,\n      emoji: emojiData.emoji,\n      color: emojiData.color,\n      playerName: user.username\n    });\n\n    // Close panel after selection\n    setIsOpen(false);\n  };\n\n  const togglePanel = () => {\n    setIsOpen(!isOpen);\n  };\n\n  return (\n    <div className={styles.emojiReactions}>\n      {/* Toggle button */}\n      <button\n        className={styles.toggleButton}\n        onClick={togglePanel}\n        data-gamepad-focusable=\"true\"\n        aria-label=\"Toggle emoji reactions\"\n      >\n        \n      </button>\n\n      {/* Emoji panel */}\n      {isOpen && (\n        <div className={styles.emojiPanel}>\n          <div className={styles.emojiGrid}>\n            {emojis.map((emojiData, index) => (\n              <button\n                key={index}\n                className={styles.emojiButton}\n                onClick={() => handleEmojiClick(emojiData)}\n                data-gamepad-focusable=\"true\"\n                title={emojiData.name}\n                style={{ '--emoji-color': emojiData.color }}\n              >\n                {emojiData.emoji}\n              </button>\n            ))}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default EmojiReactions;","import React, { useEffect, useState } from 'react';\nimport styles from './styles/GameScreen.module.css';\nimport GameHeader from './GameHeader.jsx';\nimport CardDisplay from './CardDisplay.jsx';\nimport BettingPanel from './BettingPanel.jsx';\nimport PlayerList from './PlayerList.jsx';\nimport PotDisplay from './PotDisplay.jsx';\nimport DeckDisplay from './DeckDisplay.jsx';\nimport AnteControls from './AnteControls.jsx';\nimport ResultsPanel from './ResultsPanel.jsx';\nimport AceChoicePanel from './AceChoicePanel.jsx';\nimport SecondChancePanel from './SecondChancePanel.jsx';\nimport GameLog from './GameLog.jsx';\nimport EmojiReactions from './EmojiReactions.jsx';\n\nimport { useGameContext } from '../contexts/GameContext';\nimport { useSocket } from '../contexts/SocketContext';\nimport { useAuth } from '../contexts/AuthContext';\nimport { useGamepadNavigation } from '../hooks/useGamepadNavigation';\n\nconst GameScreen = ({ onReturnToLobby }) => {\n  // Track modal state to hide emoji reactions\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  \n  // Get state and actions from context\n  const { \n    gameState,\n    error,\n    clearError\n  } = useGameContext();\n  \n  // Initialize gamepad navigation\n  const { isGamepadConnected } = useGamepadNavigation(true);\n  \n  // Auto-clear errors after 10 seconds\n  useEffect(() => {\n    if (error) {\n      const timer = setTimeout(() => {\n        clearError();\n      }, 10000); // 10 seconds\n      \n      return () => clearTimeout(timer);\n    }\n  }, [error, clearError]);\n  \n  // Handle returning to lobby\n  const handleLeaveGame = () => {\n    // Call the parent callback\n    if (onReturnToLobby) {\n      onReturnToLobby();\n    }\n  };\n  \n  // Get the socket instance for event emission\n  const { socket } = useSocket(); \n  // Get the authenticated user data from AuthContext\n  const { user } = useAuth(); \n  \n  // Safety check for null gameState or missing phase\n  if (!gameState) {\n    return (\n      <div className={styles.loadingContainer}>\n        <p>Loading game state...</p>\n      </div>\n    );\n  }\n  \n  // Make sure we have a valid phase\n  const phase = gameState.phase || 'waiting';\n\n  // Find the current player based on the authenticated user ID from AuthContext\n  // Assuming the user object from AuthContext has an 'id' property\n  const currentUserId = user?.id; // Use user.id (adjust if property name is different e.g., user.userId)\n  const currentPlayer = gameState.players && currentUserId ? gameState.players[currentUserId] : null;\n\n  // Handler for the 'I'm Back' button\n  const handleImBackClick = () => {\n    if (socket && gameState.id) {\n      socket.emit('imBack', { gameId: gameState.id });\n    } else {\n      console.error(\"Cannot emit 'imBack': socket or gameId missing.\");\n    }\n  };\n\n\n  return (\n    <div className={styles.gameContainer}>\n      <div className={`${styles.gameScreen} mobile-scale-content`}>\n        <GameHeader \n          handleLeaveGame={handleLeaveGame} \n          onModalStateChange={setIsModalOpen}\n        />\n        \n        {error && (\n          <div className={styles.errorContainer}>\n            <p className={styles.errorText}>{error}</p>\n          </div>\n        )}\n        \n        <div className={styles.gameInfoWrapper}>\n          <DeckDisplay />\n          <PotDisplay />\n        </div>\n        \n        {/* Always show the CardDisplay component */}\n        <CardDisplay />\n        \n        {/* Primary check: Is the current player sitting out? */}\n        {currentPlayer?.isSittingOut ? (\n          // If sitting out, always show the 'I'm Back!' button regardless of phase\n          <button onClick={handleImBackClick} className={styles.imBackButton} data-gamepad-focusable=\"true\" autoFocus> \n            I'm Back!\n          </button>\n        ) : (\n          // If not sitting out, render controls based on the game phase\n          phase === 'waiting' ? (\n            /* Show ante controls during waiting phase */\n            <AnteControls />\n          ) : phase === 'results' ? (\n            /* Show the results panel during results phase */\n            <ResultsPanel />\n          ) : gameState.waitingForAceDecision ? (\n            /* Show the Ace choice panel when first card is an Ace */\n            <AceChoicePanel />\n          ) : gameState.waitingForSecondChance ? (\n            /* Show the Second Chance panel when matching cards are dealt */\n            <SecondChancePanel />\n          ) : phase === 'betting' ? (\n            /* Show the betting panel only during betting phase */\n            <BettingPanel />\n          ) : null\n        )}\n        \n        <div className={styles.gameBottomSection}>\n          <div className={styles.playerListContainer}>\n            <PlayerList />\n          </div>\n          <div className={styles.gameLogContainer}>\n            <GameLog />\n          </div>\n        </div>\n      </div>\n      \n      {/* Emoji reactions - positioned outside scaled content, hidden when modal is open */}\n      {!isModalOpen && <EmojiReactions />}\n    </div>\n  );\n};\n\nexport default GameScreen;\n","import React from 'react';\nimport styles from './LoadingScreen.module.css';\n\n/**\n * A reusable loading screen component\n * @param {Object} props\n * @param {string} props.message - The message to display while loading\n */\nexport const LoadingScreen = ({ message = 'Loading...' }) => {\n  return (\n    <div className={styles.loadingScreen}>\n      <div className={styles.loadingContainer}>\n        <div className={styles.spinner}></div>\n        <p className={styles.message}>{message}</p>\n      </div>\n    </div>\n  );\n};\n","import React, { useState } from 'react';\nimport styles from '../../styles/PasswordPromptModal.module.css';\nimport GamepadInput from '../GamepadInput';\n\nfunction PasswordPromptModal({ isOpen, onClose, onSubmit, gameId }) {\n  const [password, setPassword] = useState('');\n\n  if (!isOpen) return null;\n\n  const handleSubmit = (e) => {\n    e.preventDefault(); // Prevent default form submission\n    onSubmit(password);\n    setPassword(''); // Clear password after submit\n  };\n\n  const handleCancel = () => {\n    setPassword(''); // Clear password on cancel\n    onClose();\n  };\n\n  return (\n    <div className={styles.modalOverlay}>\n      <div className={styles.modalContent}>\n        <h2>Password Required</h2>\n        <p>Please enter the password for game <strong>{gameId || ''}</strong>:</p>\n        <form onSubmit={handleSubmit}>\n          <GamepadInput\n            title=\"Enter Game Password\"\n            type=\"password\"\n            value={password}\n            onChange={(e) => setPassword(e.target.value)}\n            className={styles.passwordInput}\n            autoFocus\n            required\n          />\n          <div className={styles.modalActions}>\n            <button type=\"button\" onClick={handleCancel} className={`${styles.modalButton} ${styles.cancelButton}`} data-gamepad-focusable=\"true\">\n              Cancel\n            </button>\n            <button type=\"submit\" className={`${styles.modalButton} ${styles.submitButton}`} data-gamepad-focusable=\"true\">\n              Join Game\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n}\n\nexport default PasswordPromptModal;\n","import React, { useEffect, useState, useCallback, useRef } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { GameProvider, useGameContext } from '../contexts/GameContext';\nimport GameScreen from './GameScreen';\nimport { useSocket } from '../contexts/SocketContext';\nimport { LoadingScreen } from './common/LoadingScreen';\nimport PasswordPromptModal from './common/PasswordPromptModal';\nimport soundService from '../services/SoundService';\n\nconst GameRoom = () => {\n  const { gameId } = useParams();\n  const navigate = useNavigate();\n  const { socket, isConnected } = useSocket();\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [isPasswordModalOpen, setIsPasswordModalOpen] = useState(false);\n  const hasInitiatedJoin = useRef(false); // Ref to track true initiation\n\n  const handleReturnToLobby = useCallback(() => {\n    if (socket && isConnected && gameId) {\n      soundService.play('ui.leave'); \n      socket.emit('leaveGame', { gameId }); \n      navigate('/');\n    }\n  }, [socket, isConnected, gameId, navigate]);\n\n  const handlePasswordSubmit = useCallback((password) => {\n    setIsPasswordModalOpen(false);\n    if (socket && gameId && password) {\n      setError(null); \n      socket.emit('joinGame', { gameId, password });\n      setLoading(true);\n    }\n  }, [socket, gameId]);\n\n  const handlePasswordCancel = useCallback(() => {\n    setIsPasswordModalOpen(false);\n    navigate('/');\n  }, [navigate]);\n\n  useEffect(() => {\n    setError(null);          \n    setIsPasswordModalOpen(false); \n    setLoading(true);        \n  }, [gameId]);\n\n  useEffect(() => {\n    if (!socket) {\n      return; \n    }\n\n    const onGameJoined = (data) => {\n      if (data && data.game && data.game.id === gameId) {\n        soundService.play('ui.join');\n        setLoading(false);\n        setError(null);\n        setIsPasswordModalOpen(false);\n      }\n    };\n\n    const onError = (errorData) => {\n      const message = errorData.message || 'An unknown error occurred';\n\n      if (message === 'Password required') {\n        console.error(errorData);\n        setIsPasswordModalOpen(true);\n        setLoading(false);\n        setError(null);\n      } else if (message === 'Invalid password') {\n        console.error(errorData);\n        setError('Invalid password.');\n        setIsPasswordModalOpen(true);\n        setLoading(false);\n      } else if (message === 'Game not found') {\n        navigate('/');\n      } else if (message === 'Game is full') {\n        setError(message);\n        setLoading(false);\n        setIsPasswordModalOpen(false);\n        setTimeout(() => navigate('/'), 3000);\n      } else {\n        setError(message);\n        setLoading(false);\n        setIsPasswordModalOpen(false);\n      }\n    };\n\n    socket.on('gameJoined', onGameJoined);\n    socket.on('error', onError);\n\n    return () => {\n      socket.off('gameJoined', onGameJoined);\n      socket.off('error', onError);\n    };\n  }, [socket, gameId, navigate]); \n\n  useEffect(() => {\n    // Use ref to prevent double emission due to StrictMode or rapid state changes\n    if (socket && gameId && !hasInitiatedJoin.current) {\n      hasInitiatedJoin.current = true; // Mark as initiated *immediately*\n      setLoading(true); \n      setError(null); \n      setIsPasswordModalOpen(false); \n      socket.emit('joinGame', { gameId });\n    } else {\n    }\n    // Dependencies remain minimal: only run when socket or gameId fundamentally change\n  }, [socket, gameId]); \n\n  const GameRoomContent = () => {\n    const { gameState } = useGameContext(); \n\n    return (\n      <>\n        <PasswordPromptModal \n          isOpen={isPasswordModalOpen}\n          onClose={handlePasswordCancel}\n          onSubmit={handlePasswordSubmit}\n          gameId={gameId} \n        />\n\n        {loading && <LoadingScreen message={`Joining game ${gameId}...`} />} \n        \n        {error && !loading && !isPasswordModalOpen && (\n          <div className=\"error-container\" style={{ padding: '20px', color: 'red', textAlign: 'center' }}>\n            <h2>An error occurred</h2>\n            <p>{error}</p>\n        {/* Suggest refreshing the page instead of navigating back */}\n        <button onClick={() => window.location.reload()}>Refresh Page</button>\n          </div>\n        )}\n        \n        {!loading && !error && gameState && \n          <GameScreen onReturnToLobby={handleReturnToLobby} />\n        }\n      </>\n    );\n  };\n\n  return (\n    <GameProvider gameId={gameId}>\n      <GameRoomContent /> \n    </GameProvider>\n  );\n};\n\nexport default GameRoom;\n","import { createBrowserRouter, Navigate } from 'react-router-dom';\nimport AuthPage from './components/auth/AuthPage';\nimport Lobby from './components/Lobby';\nimport GameRoom from './components/GameRoom';\nimport { LoadingScreen } from './components/common/LoadingScreen';\nimport { useAuth } from './contexts/AuthContext';\nimport { LobbyProvider } from './contexts/LobbyContext';\n\n// Auth protection wrapper component\nconst ProtectedRoute = ({ children }) => {\n  const { user, loading } = useAuth();\n  \n  if (loading) {\n    return <LoadingScreen message=\"Checking authentication...\" />;\n  }\n  \n  if (!user) {\n    return <Navigate to=\"/auth\" replace />;\n  }\n  \n  return children;\n};\n\n// Define the router configuration\nexport const router = createBrowserRouter([\n  {\n    path: '/',\n    element: (\n      <ProtectedRoute>\n        <LobbyProvider>\n          <Lobby />\n        </LobbyProvider>\n      </ProtectedRoute>\n    ),\n  },\n  {\n    path: '/auth',\n    element: <AuthPage />,\n  },\n  {\n    path: '/:gameId',\n    element: <ProtectedRoute><GameRoom /></ProtectedRoute>,\n  },\n  {\n    path: '*',\n    element: <Navigate to=\"/\" replace />,\n  },\n]);\n","import React, { useEffect, useState } from 'react';\nimport styles from './styles/Toast.module.css';\n\nconst Toast = ({ \n  title, \n  message, \n  emoji = '', \n  color = '#3498db', \n  duration = 4000, \n  onClose, \n  position \n}) => {\n  const [isVisible, setIsVisible] = useState(true);\n\n  useEffect(() => {\n    if (duration > 0) {\n      const timer = setTimeout(() => {\n        setIsVisible(false);\n        // Wait for fade animation to complete before removing\n        setTimeout(onClose, 300);\n      }, duration);\n      \n      return () => clearTimeout(timer);\n    }\n  }, [duration, onClose]);\n\n  // Determine if this is an emoji reaction (no title and emoji is not default)\n  const isEmojiReaction = !title && emoji !== '';\n\n  return (\n    <div \n      className={`${styles.toast} ${isEmojiReaction && isVisible ? styles.emojiReaction : ''} ${!isVisible ? styles.slideOut : ''}`}\n      style={{ \n        top: '20px', \n        zIndex: 10000 + position,\n        borderColor: color,\n        background: `linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%)`\n      }}\n    >\n      <div \n        className={styles.iconWrapper}\n      >\n        <span \n          className={`${styles.icon} ${isEmojiReaction ? styles.emojiIcon : ''}`} \n          style={{ \n            color: color,\n            textShadow: isEmojiReaction \n              ? `0 0 20px ${color}, 0 0 40px ${color}60` \n              : `0 0 8px ${color}80`\n          }}\n        >\n          {emoji}\n        </span>\n      </div>\n      <div className={styles.content}>\n        {title && <div className={styles.title}>{title}</div>}\n        <div className={`${styles.message} ${isEmojiReaction ? styles.emojiMessage : ''}`}>\n          {isEmojiReaction ? (\n            <>\n              <span className={styles.playerName}>{message}</span>\n              <span className={styles.reactionText}>reacted!</span>\n            </>\n          ) : (\n            message\n          )}\n        </div>\n      </div>\n      <button \n        className={styles.closeButton} \n        onClick={onClose}\n        aria-label=\"Close notification\"\n      >\n        \n      </button>\n    </div>\n  );\n};\n\nexport default Toast;","import React, { createContext, useContext, useState, useCallback, useEffect } from 'react';\nimport { useSocket } from './SocketContext';\nimport Toast from '../components/Toast';\n\nconst ToastContext = createContext();\n\nexport const useToast = () => {\n  const context = useContext(ToastContext);\n  if (!context) {\n    throw new Error('useToast must be used within a ToastProvider');\n  }\n  return context;\n};\n\nexport const ToastProvider = ({ children }) => {\n  const [toasts, setToasts] = useState([]);\n  const [toastQueue, setToastQueue] = useState([]);\n  const [lastToastTime, setLastToastTime] = useState(0);\n  const { socket } = useSocket();\n\n  const addToast = useCallback((title, message, emoji = '', color = '#3498db', duration = 4000) => {\n    const id = Date.now() + Math.random();\n    const newToast = { id, title, message, emoji, color, duration };\n    \n    const now = Date.now();\n    const timeSinceLastToast = now - lastToastTime;\n    \n    if (timeSinceLastToast >= 600) {\n      // Show immediately if enough time has passed\n      setToasts(prev => [...prev, newToast]);\n      setLastToastTime(now);\n    } else {\n      // Queue the toast for later\n      setToastQueue(prev => [...prev, newToast]);\n    }\n    \n    return id;\n  }, [lastToastTime]);\n\n  const removeToast = useCallback((id) => {\n    setToasts(prev => prev.filter(toast => toast.id !== id));\n  }, []);\n\n  // Convenience methods for common notification patterns\n  const showSuccess = useCallback((title, message, duration) => {\n    return addToast(title, message, '', '#27ae60', duration);\n  }, [addToast]);\n\n  const showError = useCallback((title, message, duration) => {\n    return addToast(title, message, '', '#e74c3c', duration);\n  }, [addToast]);\n\n  const showWarning = useCallback((title, message, duration) => {\n    return addToast(title, message, '', '#f39c12', duration);\n  }, [addToast]);\n\n  const showInfo = useCallback((title, message, duration) => {\n    return addToast(title, message, '', '#3498db', duration);\n  }, [addToast]);\n\n  const showGameEvent = useCallback((title, message, duration) => {\n    return addToast(title, message, '', '#9b59b6', duration);\n  }, [addToast]);\n\n  const showMoneyEvent = useCallback((title, message, duration) => {\n    return addToast(title, message, '', '#16a085', duration);\n  }, [addToast]);\n\n  // Process queued toasts with debouncing\n  useEffect(() => {\n    if (toastQueue.length === 0) return;\n\n    const timer = setTimeout(() => {\n      const nextToast = toastQueue[0];\n      setToastQueue(prev => prev.slice(1));\n      setToasts(prev => [...prev, nextToast]);\n      setLastToastTime(Date.now());\n    }, 600);\n\n    return () => clearTimeout(timer);\n  }, [toastQueue, toasts]); // Trigger when queue changes or when toasts change\n\n  // Socket event listeners for toast notifications\n  useEffect(() => {\n    if (!socket) return;\n\n    // Generic toast handler\n    const handleToast = (data) => {\n      addToast(data.title || '', data.message, data.emoji || '', data.color || '#3498db', data.duration);\n    };\n\n    // Register socket event listener\n    socket.on('toast', handleToast);\n\n    // Cleanup\n    return () => {\n      socket.off('toast', handleToast);\n    };\n  }, [socket, addToast]);\n\n  const value = {\n    addToast,\n    removeToast,\n    showSuccess,\n    showError,\n    showWarning,\n    showInfo,\n    showGameEvent,\n    showMoneyEvent,\n    toasts\n  };\n\n  return (\n    <ToastContext.Provider value={value}>\n      {children}\n      <div className=\"toast-container\" style={{ position: 'fixed', top: 0, right: 0, zIndex: 10000 }}>\n        {toasts.map((toast, index) => (\n          <Toast\n            key={toast.id}\n            title={toast.title}\n            message={toast.message}\n            emoji={toast.emoji}\n            color={toast.color}\n            duration={toast.duration}\n            position={index}\n            onClose={() => removeToast(toast.id)}\n          />\n        ))}\n      </div>\n    </ToastContext.Provider>\n  );\n};","import React, { useEffect } from 'react';\nimport { RouterProvider } from 'react-router-dom';\nimport soundService from './services/SoundService';\nimport { router } from './router';\nimport { VirtualKeyboardProvider } from './contexts/VirtualKeyboardContext';\nimport { ToastProvider } from './contexts/ToastContext';\nimport './styles/global.css';\n\nfunction App() {\n  // Initialize Sound Service\n  useEffect(() => {\n    soundService.initialize();\n  }, []);\n\n  return (\n    <ToastProvider>\n      <VirtualKeyboardProvider>\n        <RouterProvider router={router} />\n      </VirtualKeyboardProvider>\n    </ToastProvider>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom/client';\nimport App from './App';\n\n// Import global styles\nimport './styles/variables.css';\n\n// Import our context providers\nimport { SocketProvider } from './contexts/SocketContext';\nimport { AuthProvider } from './contexts/AuthContext';\nimport { PreferencesProvider } from './contexts/PreferencesContext';\nimport { UserDataProvider } from './contexts/UserDataContext';\n\nReactDOM.createRoot(document.getElementById('root')).render(\n  <React.StrictMode>\n    <AuthProvider>\n      <SocketProvider>\n        <UserDataProvider>\n          <PreferencesProvider>\n            <App />\n          </PreferencesProvider>\n        </UserDataProvider>\n      </SocketProvider>\n    </AuthProvider>\n  </React.StrictMode>\n);\n"],"names":["m","require$$0","createRoot","hydrateRoot","HowlerGlobal","this","init","prototype","self","Howler","_counter","_html5AudioPool","html5PoolSize","_codecs","_howls","_muted","_volume","_canPlayEvent","_navigator","window","navigator","masterGain","noAudio","usingWebAudio","autoSuspend","ctx","autoUnlock","_setup","volume","vol","parseFloat","setupAudioContext","gain","setValueAtTime","currentTime","i","length","_webAudio","ids","_getSoundIds","j","sound","_soundById","_node","mute","muted","stop","unload","close","codecs","ext","replace","state","_autoSuspend","Audio","oncanplaythrough","e","_setupCodecs","audioTest","err","canPlayType","mpegTest","ua","userAgent","checkOpera","match","isOldOpera","parseInt","split","checkSafari","indexOf","safariVersion","isOldSafari","mp3","mpeg","opus","ogg","oga","wav","aac","caf","m4a","m4b","mp4","weba","webm","dolby","flac","_unlockAudio","_audioUnlocked","_mobileUnloaded","sampleRate","_scratchBuffer","createBuffer","unlock","audioNode","_unlocked","_releaseHtml5Audio","load","_autoResume","source","createBufferSource","buffer","connect","destination","start","noteOn","resume","onended","disconnect","document","removeEventListener","_emit","addEventListener","_obtainHtml5Audio","pop","testPlay","play","Promise","then","catch","console","warn","audio","push","suspend","_sounds","_paused","_suspendTimer","clearTimeout","setTimeout","handleSuspension","_resumeAfterSuspend","Howl","o","src","error","_autoplay","autoplay","_format","format","_html5","html5","_loop","loop","_pool","pool","_preload","preload","_rate","rate","_sprite","sprite","_src","_xhr","method","xhr","headers","withCredentials","_duration","_state","_endTimers","_queue","_playLock","_onend","onend","fn","_onfade","onfade","_onload","onload","_onloaderror","onloaderror","_onplayerror","onplayerror","_onpause","onpause","_onplay","onplay","_onstop","onstop","_onmute","onmute","_onvolume","onvolume","_onrate","onrate","_onseek","onseek","_onunlock","onunlock","_onresume","event","action","url","str","exec","toLowerCase","location","protocol","slice","Sound","loadBuffer","internal","id","num","_ended","_id","_inactiveSound","soundId","_loadQueue","seek","Math","max","_seek","duration","timeout","abs","setParams","_start","_stop","node","playWebAudio","_refreshBuffer","_playStart","bufferSource","noteGrainOn","Infinity","bind","once","_clearTimer","playHtml5","playbackRate","paused","loadedNoReadyState","ejecta","readyState","isCocoonJS","listener","pause","_rateSeek","_stopFade","noteOff","_cleanBuffer","isNaN","arguments","_clearSound","_interval","args","apply","fade","from","to","len","min","end","linearRampToValueAtTime","_startFadeInterval","isGroup","diff","steps","stepLen","lastTick","Date","now","_fadeTo","setInterval","tick","round","clearInterval","cancelScheduledValues","loopStart","loopEnd","playing","realTime","rateSeek","seekAndEmit","emitSeek","sounds","_errorFn","_loadFn","_endFn","index","splice","remCache","cache","on","events","off","isId","keys","Object","Array","isArray","msg","call","task","shift","ended","_drain","reset","limit","cnt","_panner","isIOS","vendor","test","howl","_parent","parent","create","createGain","createGainNode","_errorListener","_loadListener","_endListener","code","ceil","__default","loadSound","data","atob","dataView","Uint8Array","charCodeAt","decodeAudioData","XMLHttpRequest","open","responseType","forEach","key","setRequestHeader","status","response","onerror","safeXhrSend","send","arraybuffer","success","AudioContext","webkitAudioContext","iOS","platform","appVersion","version","safari","exports","global","_pos","_orientation","stereo","pan","pos","x","y","z","positionX","setTargetAtTime","positionY","positionZ","setPosition","orientation","xUp","yUp","zUp","or","forwardX","forwardY","forwardZ","upX","upY","upZ","setOrientation","_super","_stereo","_pannerAttr","coneInnerAngle","coneOuterAngle","coneOuterGain","distanceModel","maxDistance","panningModel","refDistance","rolloffFactor","_onstereo","onstereo","_onpos","onpos","_onorientation","onorientation","pannerType","createStereoPanner","setupPanner","orientationX","orientationY","orientationZ","pannerAttr","_coneInnerAngle","_coneOuterAngle","_coneOuterGain","_distanceModel","_maxDistance","_refDistance","_rolloffFactor","_panningModel","pa","panner","type","createPanner","soundService","constructor","initialized","categories","lastPlayedTime","debounceTime","audioUnlocked","API_URL","import","initialize","_setupMobileAudioUnlock","loadCategory","category","sprites","join","leave","alert","_isMobileDevice","soundName","includes","soundKey","setMuted","values","syncWithPreferences","preferences","unlockAudio","silence","body","maxTouchPoints","BaseModal","title","onClose","children","footer","className","overlayStyle","props","modalContent","jsx","styles","overlay","style","onClick","jsxs","modal","stopPropagation","header","closeButton","content","createPortal","VirtualKeyboard","isVisible","onEnter","inputType","initialValue","keyboardTitle","useVirtualKeyboardContext","currentLayout","setCurrentLayout","useState","tempInput","setTempInput","useEffect","lowercase","uppercase","numbers","handleKeyPress","useCallback","prev","getKeyDisplayText","getKeyClass","handleKeyDown","preventDefault","zIndex","value","readOnly","placeholder","map","row","rowIndex","keyIndex","VirtualKeyboardContext","createContext","context","useContext","Error","VirtualKeyboardProvider","keyboardState","useVirtualKeyboard","setIsVisible","currentInput","setCurrentInput","setInputType","setKeyboardTitle","isGamepadActive","setIsGamepadActive","checkGamepadNavigation","connected","classList","contains","observer","MutationObserver","observe","attributes","attributeFilter","showKeyboard","inputElement","blur","hideKeyboard","handleEnter","finalValue","getOwnPropertyDescriptor","HTMLInputElement","set","inputEvent","Event","bubbles","dispatchEvent","changeEvent","enhanceInput","actualInput","querySelector","handleClick","getCurrentInputValue","Provider","GamepadTextField","inputProps","textFieldRef","useRef","current","cleanup","TextField","ref","AuthForm","onSubmit","mode","username","setUsername","password","setPassword","setError","useMediaQuery","isSmallMobile","Paper","elevation","Typography","variant","component","gutterBottom","sx","color","fontWeight","jsxRuntimeExports","Alert","severity","mb","backgroundColor","async","message","label","fullWidth","margin","onChange","target","required","size","minLength","borderColor","fontSize","padding","marginBottom","Button","mt","background","textTransform","letterSpacing","boxShadow","transform","PACKET_TYPES","PACKET_TYPES_REVERSE","ERROR_PACKET","withNativeBlob","Blob","toString","withNativeArrayBuffer","ArrayBuffer","isView","obj","encodePacket","supportsBinary","callback","encodeBlobAsBase64","fileReader","FileReader","result","readAsDataURL","toArray","byteOffset","byteLength","TEXT_ENCODER","chars","lookup","decodePacket","encodedPacket","binaryType","mapBinary","charAt","decodeBase64Packet","substring","decoded","base64","encoded1","encoded2","encoded3","encoded4","bufferLength","p","bytes","decode","SEPARATOR","String","fromCharCode","createPacketEncoderStream","TransformStream","packet","controller","arrayBuffer","encoded","TextEncoder","encode","encodePacketToBinary","payloadLength","DataView","setUint8","view","setUint16","setBigUint64","BigInt","enqueue","TEXT_DECODER","totalLength","chunks","reduce","acc","chunk","concatChunks","Emitter","mixin","_callbacks","removeListener","removeAllListeners","cb","callbacks","emit","emitReserved","listeners","hasListeners","nextTick","resolve","setTimeoutFn","globalThisShim","Function","pick","attr","k","hasOwnProperty","NATIVE_SET_TIMEOUT","globalThis","NATIVE_CLEAR_TIMEOUT","installTimerFunctions","opts","useNativeTimers","clearTimeoutFn","randomString","random","TransportError","reason","description","super","Transport","writable","query","socket","forceBase64","onError","doOpen","doClose","packets","write","onOpen","onData","onPacket","details","onPause","createUri","schema","_hostname","_port","path","_query","hostname","port","secure","Number","encodedQuery","encodeURIComponent","Polling","_polling","name","_poll","total","doPoll","encodedPayload","encodedPackets","decodedPacket","decodePayload","count","encodePayload","doWrite","uri","timestampRequests","timestampParam","sid","b64","hasCORS","empty","BaseXHR","isSSL","xd","req","request","xhrStatus","pollXhr","Request","createRequest","_opts","_method","_uri","_data","_create","_a","xdomain","extraHeaders","setDisableHeaderCheck","cookieJar","addCookies","requestTimeout","onreadystatechange","parseCookies","getResponseHeader","_onLoad","_onError","_index","requestsCount","requests","_cleanup","fromError","abort","responseText","attachEvent","unloadHandler","hasXHR2","newRequest","concat","isReactNative","product","BaseWS","protocols","ws","createSocket","addEventListeners","onopen","autoUnref","_socket","unref","onclose","closeEvent","onmessage","ev","lastPacket","WebSocketCtor","WebSocket","MozWebSocket","transports","websocket","_packet","webtransport","_transport","WebTransport","transportOptions","closed","ready","createBidirectionalStream","stream","decoderStream","maxPayload","TextDecoder","expectedLength","isBinary","headerArray","getUint16","n","getUint32","pow","createPacketDecoderStream","MAX_SAFE_INTEGER","reader","readable","pipeThrough","getReader","encoderStream","pipeTo","_writer","getWriter","read","done","polling","assign","re","parts","parse","b","host","authority","ipv6uri","pathNames","regx","names","queryKey","$0","$1","$2","withEventListeners","OFFLINE_EVENT_LISTENERS","SocketWithoutUpgrade","writeBuffer","_prevBufferLen","_pingInterval","_pingTimeout","_maxPayload","_pingTimeoutTime","parsedUri","_transportsByName","t","transportName","agent","upgrade","rememberUpgrade","addTrailingSlash","rejectUnauthorized","perMessageDeflate","threshold","closeOnBeforeunload","qs","qry","pairs","l","pair","decodeURIComponent","_beforeunloadEventListener","transport","_offlineEventListener","_onClose","_cookieJar","createCookieJar","_open","createTransport","EIO","priorWebsocketSuccess","setTransport","_onDrain","_onPacket","flush","onHandshake","JSON","_sendPacket","_resetPingTimeout","pingInterval","pingTimeout","_pingTimeoutTimer","delay","upgrading","_getWritablePackets","payloadSize","c","utf8Length","_hasPingExpired","hasExpired","options","compress","cleanupAndClose","waitForUpgrade","tryAllTransports","SocketWithUpgrade","_upgrades","_probe","failed","onTransportOpen","freezeTransport","onTransportClose","onupgrade","_filterUpgrades","upgrades","filteredUpgrades","DEFAULT_TRANSPORTS","filter","withNativeFile","File","hasBinary","toJSON","deconstructPacket","buffers","packetData","pack","_deconstructPacket","attachments","_placeholder","newData","reconstructPacket","_reconstructPacket","RESERVED_EVENTS","PacketType","isObject","Decoder","reviver","add","reconstructor","decodeString","isBinaryEvent","BINARY_EVENT","BINARY_ACK","EVENT","ACK","BinaryReconstructor","takeBinaryData","buf","nsp","next","payload","tryParse","substr","isPayloadValid","CONNECT","DISCONNECT","CONNECT_ERROR","destroy","finishedReconstruction","reconPack","binData","replacer","encodeAsString","encodeAsBinary","stringify","deconstruction","unshift","freeze","connect_error","disconnecting","newListener","Socket","io","recovered","receiveBuffer","sendBuffer","_queueSeq","acks","flags","auth","_autoConnect","disconnected","subEvents","subs","onpacket","active","_readyState","_b","_c","retries","fromQueue","volatile","_addToQueue","ack","_registerAckCallback","isTransportWritable","engine","isConnected","notifyOutgoingListeners","ackTimeout","timer","withError","emitWithAck","reject","arg1","arg2","tryCount","pending","responseArgs","_drainQueue","force","_sendConnectPacket","_pid","pid","offset","_lastOffset","_clearAcks","some","onconnect","onevent","onack","ondisconnect","emitEvent","_anyListeners","sent","emitBuffered","subDestroy","onAny","prependAny","offAny","listenersAny","onAnyOutgoing","_anyOutgoingListeners","prependAnyOutgoing","offAnyOutgoing","listenersAnyOutgoing","Backoff","ms","factor","jitter","attempts","rand","deviation","floor","setMin","setMax","setJitter","Manager","nsps","reconnection","reconnectionAttempts","reconnectionDelay","reconnectionDelayMax","randomizationFactor","backoff","_parser","parser","encoder","Encoder","decoder","autoConnect","v","_reconnection","skipReconnect","_reconnectionAttempts","_reconnectionDelay","_randomizationFactor","_reconnectionDelayMax","_timeout","maybeReconnectOnOpen","_reconnecting","reconnect","Engine","openSubDestroy","errorSub","onping","ondata","ondecoded","_destroy","_close","onreconnect","attempt","parsed","loc","href","sameNamespace","forceNew","multiplex","SocketContext","useSocket","SocketProvider","token","useAuth","setSocket","setIsConnected","newSocket","userData","userId","socketEvents","CoinIcon","sizeMap","small","medium","large","pixelSize","gradientId","useMemo","shineId","coinIcon","width","height","viewBox","fill","xmlns","x1","y1","x2","y2","stopColor","d","stroke","strokeWidth","opacity","AuthContext","AuthProvider","user","setUser","setToken","loading","setLoading","showWelcomePopup","setShowWelcomePopup","socketData","log","balance","updatedUser","fetchUserData","authToken","fetch","Authorization","ok","json","currentToken","localStorage","getItem","removeItem","initializeAuth","login","logout","refreshUserData","newToken","initialUserData","setItem","completeUserData","useGamepadNavigation","isEnabled","focusedElement","setFocusedElement","navigableElements","setNavigableElements","isGamepadConnected","setIsGamepadConnected","showFocusIndicator","setShowFocusIndicator","lastNavigationTime","buttonStates","registerNavigableElements","visibleElements","querySelectorAll","element","rect","getBoundingClientRect","closest","parentElement","parentRect","modals","modalContainers","getAttribute","topmostModal","sort","a","aZIndex","getComputedStyle","bZIndex","aOverlay","bOverlay","prevElements","every","el","navigateDirection","direction","actualFocusedElement","activeElement","currentElement","currentIndex","findIndex","firstElement","focus","currentElem","scrollAmount","isAtTop","scrollTop","isAtBottom","scrollHeight","clientHeight","nextElement","currentRect","container","currentCenterX","left","candidates","bottom","top","sortedCandidates","candidate","horizontalDistance","verticalDistance","horizontalDiff","verticalDiff","allOtherElements","targetY","innerHeight","best","currentCenterY","rowTolerance","sameRowElements","candidateCenterY","currentRowIndex","activateElement","elementToActivate","click","isTextInput","tagName","animationFrame","checkGamepads","gamepads","getGamepads","gamepad","prevStates","upPressed","buttons","pressed","downPressed","leftPressed","rightPressed","aPressed","up","down","right","leftStickX","axes","leftStickY","deadzone","stickMoved","rightStickX","rightStickY","scrollDeadzone","scrollSpeed","scrollBy","requestAnimationFrame","cancelAnimationFrame","handleMouseMove","remove","handleFocusChange","childList","subtree","AppHeader","AuthPage","setMode","navigate","useNavigate","Box","endpoint","requestBody","credentials","hasUser","hasUsername","hasId","hasToken","textAlign","LobbyContext","LobbyProvider","gameList","setGameList","handleGameList","games","handleError","contextValue","PreferencesContext","formatImageUrl","startsWith","filename","formatPreferencesData","profileImg","twoSecondPotGif","twoSecondPotMp3","PreferencesProvider","setPreferences","autoAnte","selectedTitle","loadPreferences","React","finalPreferences","updatePreference","key2","formattedData","toggleAutoAnte","newValue","toggleMute","updateSelectedTitle","titleString","uploadTwoSecondPotGif","file","formData","FormData","append","text","formattedUrl","fileUrl","uploadTwoSecondPotMp3","uploadProfileImg","usePreferences","OnlinePlayerCount","setCount","handler","CurrencyAmount","amount","customClass","containerClasses","currencyAmount","darkBackground","pillBackground","Boolean","toLocaleString","GearIcon","strokeLinecap","strokeLinejoin","ToggleSwitch","isChecked","checked","FileUpload","onUpload","currentFileUrl","acceptedFileTypes","previewType","isUploading","setIsUploading","fileInputRef","files","accept","alt","controls","handleButtonClick","disabled","TitlesSelector","titles","setTitles","loadTitles","userTitles","handleTitleSelect","baseModalStyles","loadingMessage","errorMessage","display","overflowX","overflowY","whiteSpace","paddingBottom","borderRadius","cursor","border","verticalAlign","flexDirection","justifyContent","marginTop","PreferencesModal","maxWidth","maxHeight","settingsContainer","sectionHeader","settingItem","settingDescription","alignItems","marginRight","IconButton","icon","compact","restProps","iconButton","PreferencesButton","onModalStateChange","isPreferencesOpen","setIsPreferencesOpen","Fragment","openPreferences","isOpen","closePreferences","BarChartIcon","DownloadIcon","useGameContext","require","gameState","TransactionDownloadButton","propGameState","gameData","gameTransactions","gameId","downloadTransactionsCSV","transactions","csvContent","sortedTransactions","tx","timestamp","playerName","player","escapedName","transactionType","reasonParts","blob","URL","createObjectURL","link","createElement","setAttribute","visibility","appendChild","removeChild","GameStats","players","playerNames","entries","playerId","gameStats","formatNumber","playerTransactions","rounds","decks","deckCount","totalAnteAmount","sum","totalBetAmount","bets","biggestBet","biggestPot","potAmount","penalties","totalPenaltyAmount","playerBetCounts","mostAggressivePlayerId","mostBets","playerBetTotals","highestAvgBetPlayerId","highestAvgBet","avg","playerWins","mostWinningPlayerId","mostWins","wins","playerPenalties","mostPenaltiesPlayerId","mostPenalties","playerProfits","totals","biggestWinnerId","biggestWin","biggestLoserId","biggestLoss","profit","suffix","stat","formatStatValue","toFixed","GameSummaryModal","loadingContent","showPayoutsTab","settings","isPrivate","playerTotals","settleUpPayments","player1Id","player1Total","player2Id","player2Total","fromName","toName","payments","losers","_","winners","winner","loser","paymentAmount","activeTab","setActiveTab","currentTarget","payment","UserDataContext","UserDataProvider","userCache","setUserCache","Map","pendingFetches","Set","fetchTimer","handleUserDataUpdate","newCache","fetchUsersData","userIds","executeBatchFetch","clear","getUserData","cached","get","prefetchUsers","uncachedIds","has","useUserData","UserAvatar","showName","namePosition","showTitle","showPlayerCard","setShowPlayerCard","sizeClass","containerClass","toUpperCase","userAvatarContainer","avatar","avatarLoader","userInfo","skeletonUsername","skeletonTitle","xp","level","initials","getInitials","formattedImageUrl","onMouseEnter","onMouseLeave","avatarImageContainer","avatarImage","nextSibling","initialsPlaceholder","playerCard","playerCardAvatar","playerCardImage","playerCardInitials","playerCardInfo","playerCardUsername","playerCardTitle","undefined","playerCardLevelXP","separator","xpValue","formatXP","userTitle","part","Leaderboard","leaderboard","setLeaderboard","setDuration","userDataContext","fetchLeaderboard","tabIndex","getRankDisplay","rank","totalProfit","PlayerStatsModal","historyData","setHistoryData","pagination","currentPage","setCurrentPage","showGameSummary","setShowGameSummary","selectedGameData","setSelectedGameData","lifetimeStats","setLifetimeStats","statsLoading","setStatsLoading","statsError","setStatsError","fetchGameHistory","stats","fetchLifetimeStats","formatDate","dateString","date","Intl","DateTimeFormat","year","month","day","hour","minute","getRoundCount","game","roundCount","selectedGame","find","handleGameClick","role","totalPlayerCount","endedAt","handlePreviousPage","handleNextPage","PlayerStatsButton","isStatsOpen","setIsStatsOpen","openStats","closeStats","StoreIcon","StoreButton","ProgressInfo","xpToNextLevel","GamepadInput","inputRef","DEFAULT_SETTINGS","useCustomName","customName","enableAceChoice","enableSecondChance","numberOfBots","GameSettingsModal","initialSettings","setSettings","errors","setErrors","handleChange","updatedSettings","currentErrors","newErrors","gap","lobbyStyles","actionButton","cancelButton","form","createButton","validationErrors","currentSettings","pass","botCount","validateSettings","settingControls","textInput","inputError","maxLength","autoFocus","storeService","baseURL","getAuthHeaders","getOfferingsByType","offeringType","errorData","offerings","getAllOfferings","processPurchase","productId","coinsAdded","newBalance","getCoinOfferings","StoreModal","coinOfferings","setCoinOfferings","purchasing","setPurchasing","loadCoinOfferings","gridTemplateColumns","offering","minHeight","imageUrl","objectFit","flex","formatCoins","coinAmount","NumberFormat","lineHeight","formatPrice","price","priceUSD","currency","handlePurchase","primaryButton","LockIcon","rx","ry","GameCard","onJoin","gameDisplayName","isUserDisconnected","disconnectedPlayers","isUserInGame","allPlayers","buttonText","buttonClass","joinGameButton","reconnectButton","continueButton","cardClass","gameListItem","userDisconnectedGame","userInGame","gameListInfo","gameListId","privatePill","disconnectedBadge","inGameBadge","gameListPlayers","playerCount","QuestionIcon","cx","cy","r","ICONS","TIMERS","DEALING_DURATION","BETTING_DURATION","REVEALING_DURATION","RESULTS_DURATION","GameRulesModal","scrollableContent","paddingLeft","RulesButton","showRules","setShowRules","openRules","closeRules","Lobby","lobbyLoading","lobbyError","authLoading","socketLoading","searchQuery","setSearchQuery","showGameSettingsModal","setShowGameSettingsModal","showStoreModal","setShowStoreModal","createGameWithSettings","creationTimeout","handleGameCreated","handleJoinGame","filteredGameList","filtered","trim","userInGameA","userInGameB","userDisconnectedInA","userDisconnectedInB","localeCompare","lobbyContainer","formContainer","formSection","welcomeMessage","welcomeHeader","avatarContainer","headerButtons","logoutButton","gradientDivider","buttonGroup","handleCreateGame","handleCreateCustomGame","gameListContainer","gameListTitle","searchContainer","InputProps","startAdornment","InputAdornment","position","searchIcon","gameListWrapper","emptyGameList","emptyStateIcon","emptyStateMessage","emptyStateHint","GameContext","GameProvider","initialGameState","socketError","setGameState","prevActivePlayerRef","clearError","currentPlayerId","isMyTurn","wasPreviouslyMyTurn","placeBet","bet","payAnte","dealCards","revealMiddleCard","nextRound","playerReady","playerUnready","ExitIcon","points","LeaveButton","phaseDisplayMap","waiting","dealing","revealing","results","GameHeader","handleLeaveGame","currentUserId","currentPlayer","playerBalance","currentPhase","phase","timeLeft","setTimeLeft","isRulesOpen","setIsRulesOpen","waitingForAceDecision","phaseInfo","waitingForSecondChance","isCurrentPlayersTurn","headerContainer","desktopLayout","headerLeft","gameTitle","liveTag","gameIdText","gameIdLink","headerCenter","gamePhase","phaseBettingYourTurn","phaseBettingWaiting","phaseIcon","phaseText","timerBar","timerProgress","headerRight","controlsStack","balanceDisplay","controlsGroup","mobileLayout","mobileTopRow","mobileRight","mobileControlsStack","mobileActions","mobileBottomRow","ArrowIcon","rotation","transformOrigin","CardDisplay","firstCard","secondCard","thirdCard","dealer","cardLabels","J","Q","K","A","suitSymbols","hearts","diamonds","clubs","spades","renderCard","card","cardBack","isRed","suit","isAce","isAceLow","isMiddleCard","redCard","blackCard","aceCard","aceIndicator","aceLow","aceHigh","indicatorContent","cardCorner","cardValue","cardSuit","cardCenter","bottomRight","cardDisplayContainer","cardsRow","dealingPhase","revealingPhase","renderCardLayout","displayCards","PotButton","BettingPanel","customBet","setCustomBet","pot","isCurrentPlayer","myPlayer","handleCustomBetChange","maxBet","handleCustomBetSubmit","betAmount","renderBettingControls","onKeyPress","PlayerList","dealerId","seats","isCurrentUser","isDealer","BalanceDisplay","isSittingOut","isReady","prevBalance","setPrevBalance","animationClass","setAnimationClass","timeoutRef","PotDisplay","POT","DeckDisplay","deckSize","AutoAnteToggle","playerIds","AnteControls","anteAmount","isPlayerReady","hasEnoughChips","ResultsPanel","resultCountdown","resultsPanel","resultContent","renderOutcome","outcome","resultText","winText","winnings","winningsText","loseText","renderTieResult","penaltyAmount","isTripleAceTie","penaltyWarning","cautionTape","tieText","countdownContainer","countdownText","countdownSeconds","countdownProgress","countdownBar","AceChoicePanel","countdown","setCountdown","prevCount","handleAceChoice","currentPlayerName","renderAceChoiceControls","SecondChancePanel","actionType","setActionType","handleSecondChance","anteAgain","renderSecondChanceControls","GameLog","isExpanded","setIsExpanded","gameLog","logEntries","toggleExpanded","displayEntries","entry","formatTime","toLocaleTimeString","second","EmojiReactions","setIsOpen","togglePanel","emojis","emoji","emojiData","handleEmojiClick","GameScreen","onReturnToLobby","isModalOpen","setIsModalOpen","loadingContainer","gameContainer","gameScreen","errorContainer","errorText","gameInfoWrapper","handleImBackClick","imBackButton","gameBottomSection","playerListContainer","gameLogContainer","LoadingScreen","PasswordPromptModal","handleCancel","GameRoom","useParams","isPasswordModalOpen","setIsPasswordModalOpen","hasInitiatedJoin","handleReturnToLobby","handlePasswordSubmit","handlePasswordCancel","onGameJoined","GameRoomContent","reload","ProtectedRoute","Navigate","router","createBrowserRouter","Toast","isEmojiReaction","textShadow","ToastContext","ToastProvider","toasts","setToasts","toastQueue","setToastQueue","lastToastTime","setLastToastTime","addToast","newToast","removeToast","toast","showSuccess","showError","showWarning","showInfo","showGameEvent","showMoneyEvent","nextToast","handleToast","App","RouterProvider","ReactDOM","getElementById","render","StrictMode"],"mappings":"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","x_google_ignoreList":[0,1,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35]}