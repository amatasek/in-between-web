import{r as e,j as s}from"./react-7X_HfTL4.js";import{a,b as t,B as n,c as r,u as o,d as i,s as c}from"./index-Dm4-3FPD.js";import{u as l}from"./useGamepadNavigation-DCtNTfjZ.js";import{A as m,G as d}from"./AppHeader-DXoUyqtL.js";import{C as u,T as h,G as x,U as _,R as p,P as g,S as j,a as v,b as N}from"./StoreModal-166bbhJc.js";import{I as C}from"./vendor-CrXq7rKl.js";import{b,I as f}from"./mui-B3QJ8a6B.js";import"./socket-CR9bC8yV.js";const y="_lobbyContainer_1v9ur_1",B="_gameListContainer_1v9ur_90",w="_gameListTitle_1v9ur_115",I="_searchContainer_1v9ur_128",P="_searchIcon_1v9ur_170",S="_gameListWrapper_1v9ur_175",k="_gameListItem_1v9ur_181",$="_userDisconnectedGame_1v9ur_194",G="_userInGame_1v9ur_201",L="_gameListInfo_1v9ur_224",O="_gameListId_1v9ur_229",A="_disconnectedBadge_1v9ur_238",q="_inGameBadge_1v9ur_250",D="_gameListPlayers_1v9ur_262",E="_joinGameButton_1v9ur_268",T="_reconnectButton_1v9ur_279",M="_continueButton_1v9ur_290",U="_emptyGameList_1v9ur_316",z="_emptyStateIcon_1v9ur_329",F="_emptyStateMessage_1v9ur_335",R="_emptyStateHint_1v9ur_342",W="_privatePill_1v9ur_348",J="_pill_1hv5h_1",Y="_pulse_1hv5h_22",H="_text_1hv5h_48",X=()=>{const{socket:t,isConnected:n}=a(),[r,o]=e.useState(null);return e.useEffect((()=>{if(!t||!n)return;t.emit("getOnlinePlayerCount",(e=>{o(e)}));const e=e=>o(e);return t.on("onlinePlayerCountUpdate",e),()=>{t.off("onlinePlayerCountUpdate",e)}}),[t,n]),null===r?null:s.jsxs("div",{className:J,children:[s.jsx("span",{className:Y}),s.jsxs("span",{className:H,children:[r," online"]})]})},Q="_progressInfoContainer_nucsq_1",V="_balanceSection_nucsq_13",Z="_balanceLabel_nucsq_22",K="_xpSection_nucsq_29",ee="_xpBarContainer_nucsq_33",se="_xpOverlay_nucsq_43",ae="_xpLevel_nucsq_57",te="_xpNext_nucsq_64",ne="_xpBar_nucsq_33",re=({userId:e,balance:a})=>{const n=t(e);return s.jsxs("div",{className:Q,children:[s.jsxs("div",{className:V,children:[s.jsx("span",{className:Z,children:"Balance:"}),s.jsx(u,{amount:Number(a)||0,size:"medium"})]}),n&&s.jsx("div",{className:K,children:s.jsxs("div",{className:ee,children:[s.jsx("div",{className:ne,style:{width:n.level>=100?"100%":`${n.percentToNextLevel||0}%`}}),s.jsxs("div",{className:se,children:[s.jsxs("div",{className:ae,children:["Level ",n.level]}),s.jsx("div",{className:te,children:n.level<100?`${n.xpToNextLevel.toLocaleString()} XP`:"MAX"})]})]})})]})},oe={playerPanel:"_playerPanel_1e2ac_1",userSection:"_userSection_1e2ac_28",avatarContainer:"_avatarContainer_1e2ac_43",headerButtons:"_headerButtons_1e2ac_47",logoutButton:"_logoutButton_1e2ac_77",divider:"_divider_1e2ac_116",actionSection:"_actionSection_1e2ac_124",actionButton:"_actionButton_1e2ac_131",createButton:"_createButton_1e2ac_156",cancelButton:"_cancelButton_1e2ac_173"},ie={useCustomName:!1,customName:"",isPrivate:!1,password:"",enableAceChoice:!0,enableSecondChance:!0,numberOfBots:0},ce=({initialSettings:a=ie,onSubmit:t,onClose:o})=>{const[i,c]=e.useState({...ie,...a}),[l,m]=e.useState({}),d=(e,s)=>{c((a=>{const t={...a,[e]:s};return"useCustomName"!==e||s||(t.customName="",l.customName&&m((e=>{const s={...e};return delete s.customName,s}))),"isPrivate"!==e||s||(t.password="",l.password&&m((e=>{const s={...e};return delete s.password,s}))),t})),"customName"!==e&&"useCustomName"!==e||!l.customName||m((e=>{const s={...e};return delete s.customName,s})),"password"!==e&&"isPrivate"!==e||!l.password||m((e=>{const s={...e};return delete s.password,s})),"numberOfBots"===e&&l.numberOfBots&&m((e=>{const s={...e};return delete s.numberOfBots,s}))};return s.jsx(n,{title:"Game Options",onClose:o,style:{maxWidth:600},footer:s.jsxs("div",{style:{display:"flex",gap:8},children:[s.jsx("button",{type:"button",onClick:o,className:`${oe.actionButton} ${oe.cancelButton}`,"data-gamepad-focusable":"true",children:"Cancel"}),s.jsx("button",{type:"submit",form:"gameSettingsForm",className:`${oe.actionButton} ${oe.createButton}`,disabled:Object.keys(l).length>0,"data-gamepad-focusable":"true",children:"Create Game"})]}),children:s.jsx("form",{id:"gameSettingsForm",onSubmit:e=>{e.preventDefault();const s=(e=>{const s={};if(e.useCustomName){const a=e.customName||"";a?a.length<4||a.length>26?s.customName="Name must be 4-26 characters.":/^[a-zA-Z0-9_-]+$/.test(a)||(s.customName="Use letters, numbers, -, or _."):s.customName="Custom name is required."}if(e.isPrivate){const a=e.password||"";a?(a.length<3||a.length>36)&&(s.password="Password must be 3-36 characters."):s.password="Password is required."}const a=e.numberOfBots;return(a<0||a>16)&&(s.numberOfBots="Number of bots must be between 0 and 16."),s})(i);if(Object.keys(s).length>0)m(s);else{m({});const e={...i,customName:i.useCustomName?i.customName:null};delete e.useCustomName,t(e)}},children:s.jsxs("div",{className:r.settingsContainer,children:[s.jsxs("div",{className:r.settingItem,children:[s.jsxs("div",{className:r.settingDescription,children:[s.jsx("h4",{children:"Custom Game Name"}),s.jsx("p",{children:"Set a custom name for your game lobby"})]}),s.jsxs("div",{className:r.settingControls,children:[s.jsx(h,{isChecked:i.useCustomName,onChange:e=>d("useCustomName",e.target.checked)}),i.useCustomName&&s.jsx(x,{title:"Enter Game Name",type:"text",value:i.customName||"",onChange:e=>d("customName",e.target.value),className:`${r.textInput}${l.customName?" "+r.inputError:""}`,placeholder:"Game Name",maxLength:26,autoFocus:!0,style:{marginTop:8}}),l.customName&&s.jsx("span",{className:"errorMessage",children:l.customName})]})]}),s.jsxs("div",{className:r.settingItem,children:[s.jsxs("div",{className:r.settingDescription,children:[s.jsx("h4",{children:"Private Game"}),s.jsx("p",{children:"Only players with the password can join"})]}),s.jsxs("div",{className:r.settingControls,children:[s.jsx(h,{isChecked:i.isPrivate,onChange:e=>d("isPrivate",e.target.checked)}),i.isPrivate&&s.jsx(x,{title:"Enter Game Password",type:"password",value:i.password||"",onChange:e=>d("password",e.target.value),className:`${r.textInput}${l.password?" "+r.inputError:""}`,placeholder:"Password",maxLength:36,autoFocus:i.isPrivate&&!i.useCustomName,style:{marginTop:8}}),l.password&&s.jsx("span",{className:"errorMessage",children:l.password})]})]}),s.jsxs("div",{className:r.settingItem,children:[s.jsxs("div",{className:r.settingDescription,children:[s.jsx("h4",{children:"Number of Bots"}),s.jsx("p",{children:"Add AI players to your game (0-16)"})]}),s.jsxs("div",{className:r.settingControls,children:[s.jsx(x,{title:"Number of AI Players",type:"number",min:"0",max:"16",value:i.numberOfBots,onChange:e=>d("numberOfBots",parseInt(e.target.value)||0),className:`${r.textInput}${l.numberOfBots?" "+r.inputError:""}`}),l.numberOfBots&&s.jsx("span",{className:"errorMessage",children:l.numberOfBots})]})]}),s.jsxs("div",{className:r.settingItem,children:[s.jsxs("div",{className:r.settingDescription,children:[s.jsx("h4",{children:"Enable Ace Choice"}),s.jsx("p",{children:"Allow players to choose high/low on Ace"})]}),s.jsx("div",{className:r.settingControls,children:s.jsx(h,{isChecked:i.enableAceChoice,onChange:e=>d("enableAceChoice",e.target.checked)})})]}),s.jsxs("div",{className:r.settingItem,children:[s.jsxs("div",{className:r.settingDescription,children:[s.jsx("h4",{children:"Enable Second Chance"}),s.jsx("p",{children:"Allow players to ante up for a second chance"})]}),s.jsx("div",{className:r.settingControls,children:s.jsx(h,{isChecked:i.enableSecondChance,onChange:e=>d("enableSecondChance",e.target.checked)})})]})]})})})},le=()=>{const{user:t,logout:n,refreshUserData:r}=o(),{socket:i,isConnected:c}=a(),l=C(),[m,d]=e.useState(!1),[u,h]=e.useState(!1),x=e=>{if(!t?.id||!c)return;const s=e=>{i.off("gameCreated",s),e?.game?.id&&l(`/${e.game.id}`)};i.on("gameCreated",s),e?i.emit("createGame",{settings:e}):i.emit("createGame")};return s.jsxs("div",{className:oe.playerPanel,children:[s.jsxs("div",{className:oe.userSection,children:[s.jsx("div",{className:oe.avatarContainer,children:s.jsx(_,{userId:t?.id,size:"medium",showName:!0,namePosition:"right"})}),s.jsx(re,{userId:t?.id,balance:t?.balance}),s.jsxs("div",{className:oe.headerButtons,children:[s.jsx("button",{className:oe.logoutButton,onClick:n,"data-gamepad-focusable":"true",children:s.jsx("span",{className:oe.buttonText,children:"Logout"})}),s.jsx(p,{"data-gamepad-focusable":"true"}),s.jsx(g,{"data-gamepad-focusable":"true"}),s.jsx(j,{onClick:()=>h(!0),"data-gamepad-focusable":"true"}),s.jsx(v,{"data-gamepad-focusable":"true"})]})]}),s.jsx("div",{className:oe.divider}),s.jsxs("div",{className:oe.actionSection,children:[s.jsx("button",{className:`${oe.actionButton} ${oe.createButton}`,onClick:()=>x({numberOfBots:5}),disabled:!t?.username,"data-gamepad-focusable":"true",children:"Create Quick Game"}),s.jsx("button",{className:`${oe.actionButton} ${oe.createButton}`,onClick:()=>{d(!0)},disabled:!t?.username,"data-gamepad-focusable":"true",children:"Create Custom Game"})]}),m&&s.jsx(ce,{onSubmit:e=>{d(!1),x(e)},onClose:()=>d(!1)}),u&&s.jsx(N,{onClose:()=>{h(!1),r&&r()}})]})},me=({className:e="",width:a="1em",height:t="1em",...n})=>s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`feather feather-lock ${e}`,width:a,height:t,...n,children:[s.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),s.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]});function de({game:e,onJoin:a,userId:t}){const n=e.settings?.customName||`Game ${e.id}`,r=e.disconnectedPlayers?.some((e=>e.userId===t)),o=e.allPlayers?.some((e=>e.userId===t&&!e.disconnected));let i="Join",c=E;r?(i="Reconnect",c+=` ${T}`):o&&(i="Continue",c+=` ${M}`);let l=k;return r?l+=` ${$}`:o&&(l+=` ${G}`),s.jsxs("div",{className:l,children:[" ",s.jsxs("div",{className:L,children:[s.jsxs("div",{className:O,children:[" ",n,e.settings?.isPrivate&&s.jsxs("span",{className:W,title:"Private Game",children:[s.jsx(me,{width:"0.9em",height:"0.9em",style:{marginRight:"4px",verticalAlign:"middle"}}),"Private"]}),r&&s.jsx("span",{className:A,title:"You're disconnected from this game",children:"‚ö†Ô∏è Reconnect"}),o&&s.jsx("span",{className:q,title:"You're in this game",children:"You're In"})]}),s.jsxs("div",{className:D,children:[" ",e.playerCount," ",1===e.playerCount?"player":"players"]})]}),s.jsx("button",{className:c,onClick:()=>a(e.id),disabled:!t,"data-gamepad-focusable":"true",children:i})]})}const ue=()=>{const{gameList:n,loading:r}=i(),{user:u,logout:h}=o();t(u?.id);const{isConnected:x}=a();l(!0);const _=C(),[p,g]=e.useState("");b("(max-width:600px)");const j=b("(max-width:400px)"),v=u?.username?`user_${u.username}`:null;e.useEffect((()=>{u&&(u.username&&u.id||h())}),[u,h]);const N=e=>{x&&u&&(c.play("ui.click"),_(`/${e}`))},k=e.useMemo((()=>{if(!n)return[];let e=n;if(p.trim()){const s=p.trim().toLowerCase();e=n.filter((e=>e.id.toLowerCase().includes(s)))}return e.sort(((e,s)=>{const a=e.allPlayers?.some((e=>e.userId===v)),t=s.allPlayers?.some((e=>e.userId===v)),n=e.disconnectedPlayers?.some((e=>e.userId===v)),r=s.disconnectedPlayers?.some((e=>e.userId===v));return n&&!r?-1:!n&&r?1:a&&!t?-1:!a&&t?1:e.id.localeCompare(s.id)}))}),[n,p,v]);return s.jsxs("div",{className:y,children:[s.jsx(m,{}),s.jsx("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginTop:"1.1em",marginBottom:"-0.6em"},children:s.jsx(X,{})}),s.jsx(le,{}),s.jsxs("div",{className:B,children:[s.jsx("h2",{className:w,children:"Available Games"}),s.jsx("div",{className:I,children:s.jsx(d,{title:"Search Games",placeholder:"Search games by ID",variant:"outlined",fullWidth:!0,value:p,onChange:e=>{g(e.target.value)},size:j?"small":"medium",type:"text",InputProps:{startAdornment:s.jsx(f,{position:"start",children:s.jsx("span",{className:P,children:"üîç"})})}})}),k&&k.length>0?s.jsx("div",{className:S,children:k.map((e=>s.jsx(de,{game:e,onJoin:N,userId:v},e.id)))}):s.jsxs("div",{className:U,children:[s.jsx("div",{className:z,children:"üÉè"}),s.jsx("p",{className:F,children:p.trim()?"No matching games found":"No games in progress"}),s.jsx("p",{className:R,children:p.trim()?"Try a different search or create a new game":"Create a new game to get started!"})]})]})]})};export{ue as default};
