import{j as e,c as ie,a as re,e as oe,A as X,f as I,g as ce,h as de,B as E,U as ue,u as me}from"./index-Dz_3LXOj.js";import{b as d}from"./vendor-ByZL_ylL.js";const pe="_coinIcon_isycs_1",ge="_small_isycs_13",he="_medium_isycs_17",fe="_large_isycs_21",ee={coinIcon:pe,small:ge,medium:he,large:fe},ye=({size:s="small",className:t=""})=>{const n={small:15,medium:19,large:24},a=n[s]||n.small,i=d.useMemo(()=>`goldGradient-${Math.random().toString(36).substr(2,9)}`,[]),m=d.useMemo(()=>`goldShine-${Math.random().toString(36).substr(2,9)}`,[]);return e.jsx("span",{className:`${ee.coinIcon} ${ee[s]} ${t}`,children:e.jsxs("svg",{width:a,height:a,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:i,x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#FFD700"}),e.jsx("stop",{offset:"50%",stopColor:"#FFA500"}),e.jsx("stop",{offset:"100%",stopColor:"#FF8C00"})]}),e.jsxs("linearGradient",{id:m,x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#FFED4E"}),e.jsx("stop",{offset:"100%",stopColor:"#FFD700"})]})]}),e.jsx("path",{d:"M12 2L22 12L12 22L2 12L12 2Z",fill:`url(#${i})`,stroke:"#D4AF37",strokeWidth:"0.5"}),e.jsx("path",{d:"M12 5L18 12L12 18L6 12L12 5Z",fill:`url(#${m})`,opacity:"0.6"}),e.jsx("path",{d:"M12 2L16 6L12 8L8 6L12 2Z",fill:"#FFFACD",opacity:"0.7"})]})})},xe="_userAvatarContainer_32qpa_1",be="_containerRight_32qpa_6",_e="_containerBelow_32qpa_11",ve="_avatar_32qpa_16",je="_small_32qpa_34",we="_medium_32qpa_40",ke="_large_32qpa_46",Ce="_avatarImageContainer_32qpa_52",Ne="_avatarImage_32qpa_52",Se="_initialsPlaceholder_32qpa_70",Pe="_userInfo_32qpa_84",Ie="_username_32qpa_92",Te="_userTitle_32qpa_101",$e="_playerCard_32qpa_120",Ae="_cardAppear_32qpa_1",Be="_playerCardAvatar_32qpa_149",Le="_playerCardImage_32qpa_158",Me="_playerCardInitials_32qpa_166",Ee="_playerCardInfo_32qpa_180",Ue="_playerCardUsername_32qpa_189",De="_playerCardTitle_32qpa_197",Re="_playerCardXP_32qpa_205",ze="_playerCardLevelXP_32qpa_213",Fe="_separator_32qpa_221",He="_xpValue_32qpa_225",Ge="_loading_32qpa_230",Oe="_shimmerBg_32qpa_1",qe="_avatarLoader_32qpa_236",We="_shimmerOverlay_32qpa_1",Ve="_skeletonUsername_32qpa_245",Xe="_skeletonTitle_32qpa_255",Ke="_shimmerText_32qpa_1",_={userAvatarContainer:xe,containerRight:be,containerBelow:_e,avatar:ve,small:je,medium:we,large:ke,avatarImageContainer:Ce,avatarImage:Ne,initialsPlaceholder:Se,userInfo:Pe,username:Ie,userTitle:Te,playerCard:$e,cardAppear:Ae,playerCardAvatar:Be,playerCardImage:Le,playerCardInitials:Me,playerCardInfo:Ee,playerCardUsername:Ue,playerCardTitle:De,playerCardXP:Re,playerCardLevelXP:ze,separator:Fe,xpValue:He,loading:Ge,shimmerBg:Oe,avatarLoader:qe,shimmerOverlay:We,skeletonUsername:Ve,skeletonTitle:Xe,shimmerText:Ke},Ye=({userId:s,size:t="medium",showName:n=!0,namePosition:a="right",className:i="",showTitle:m=!0,fontWeight:c="normal"})=>{const[p,h]=d.useState(!1),k=ie(s);if(!s)return null;if(!k){const T=_[t]||_.medium,B=n?_[`container${a.charAt(0).toUpperCase()+a.slice(1)}`]:"";return e.jsxs("div",{className:`${_.userAvatarContainer} ${B} ${i}`,children:[e.jsx("div",{className:`${_.avatar} ${T} ${_.loading}`,children:e.jsx("div",{className:_.avatarLoader})}),n&&e.jsxs("div",{className:_.userInfo,children:[e.jsx("div",{className:_.skeletonUsername}),m&&e.jsx("div",{className:_.skeletonTitle})]})]})}const{username:f,profileImg:o,title:u,xp:x,level:y}=k,r=Ze(f||"Unknown"),g=_[t]||_.medium,S=n?_[`container${a.charAt(0).toUpperCase()+a.slice(1)}`]:"",N="https://api.in-between.live";let C=null;if(o)if(o.startsWith("http"))C=o;else if(o.includes("/uploads/")){const T=o.split("/").pop();C=`${N}/files/images/${T}`}else C=`${N}${o}`;return e.jsxs("div",{className:`${_.userAvatarContainer} ${S} ${i}`,children:[e.jsxs("div",{className:`${_.avatar} ${g}`,onMouseEnter:()=>h(!0),onMouseLeave:()=>h(!1),children:[e.jsxs("div",{className:_.avatarImageContainer,children:[C?e.jsx("img",{src:C,alt:`${f}'s avatar`,className:_.avatarImage,onError:T=>{console.error(`Failed to load profile image for ${f}:`,T),T.target.style.display="none",T.target.nextSibling.style.display="flex"}}):null,e.jsx("div",{className:_.initialsPlaceholder,style:{display:C?"none":"flex"},children:r})]}),p&&e.jsxs("div",{className:_.playerCard,children:[e.jsx("div",{className:_.playerCardAvatar,children:C?e.jsx("img",{src:C,alt:`${f}'s avatar`,className:_.playerCardImage}):e.jsx("div",{className:_.playerCardInitials,children:r})}),e.jsxs("div",{className:_.playerCardInfo,children:[e.jsx("div",{className:_.playerCardUsername,children:f||"Unknown"}),u&&e.jsx("div",{className:_.playerCardTitle,children:u}),y!==void 0&&x!==void 0&&e.jsxs("div",{className:_.playerCardLevelXP,children:["Level ",y," ",e.jsx("span",{className:_.separator,children:"•"})," ",e.jsxs("span",{className:_.xpValue,children:[Je(x)," XP"]})]})]})]})]}),n&&e.jsxs("div",{className:_.userInfo,children:[e.jsx("div",{className:_.username,style:{fontWeight:c},children:f||"Unknown"}),m&&u&&e.jsx("div",{className:_.userTitle,children:u})]})]})},Ze=s=>s.split(" ").map(t=>t.charAt(0)).join("").toUpperCase().substring(0,2),Je=s=>s>=1e6?(s/1e6).toFixed(1).replace(/\.0$/,"")+"M":s>=1e3?(s/1e3).toFixed(1).replace(/\.0$/,"")+"K":s.toString(),Qe="_currencyAmount_rl73n_1",et="_pillBackground_rl73n_17",tt="_darkBackground_rl73n_28",Z={currencyAmount:Qe,pillBackground:et,darkBackground:tt},q=({amount:s=0,size:t,background:n,customClass:a})=>{const i=[Z.currencyAmount,n==="dark"?Z.darkBackground:"",n==="pill"?Z.pillBackground:"",a||""].filter(Boolean).join(" "),m=typeof s=="number"?s:0;return e.jsxs("span",{className:i,children:[e.jsx(ye,{size:t}),e.jsx("span",{children:m.toLocaleString()})]})},at=({className:s="h-6 w-6",...t})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:s,...t,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.004.827c-.29.24-.438.613-.431.992a6.759 6.759 0 010 1.905c-.007.378.141.75.431.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.29-.24.438-.613.43-.992a6.932 6.932 0 010-1.905c.007-.378-.14-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281zM15 12a3 3 0 11-6 0 3 3 0 016 0z"})}),st="_toggleContainer_1gama_1",nt="_toggleInput_1gama_5",rt="_toggleLabel_1gama_11",ot="_toggleSlider_1gama_17",lt="_toggleText_1gama_65",G={toggleContainer:st,toggleInput:nt,toggleLabel:rt,toggleSlider:ot,toggleText:lt},te=({isChecked:s,onChange:t,label:n})=>e.jsx("div",{className:G.toggleContainer,children:e.jsxs("label",{className:G.toggleLabel,children:[e.jsx("input",{type:"checkbox",checked:s,onChange:t,className:G.toggleInput,"data-gamepad-focusable":"true"}),e.jsx("span",{className:G.toggleSlider}),n&&e.jsx("span",{className:G.toggleText,children:n})]})}),it="_fileUploadContainer_z5fvc_1",ct="_fileInput_z5fvc_8",dt="_uploadButton_z5fvc_12",ut="_changeButton_z5fvc_37",mt="_previewContainer_z5fvc_53",pt="_imagePreview_z5fvc_61",gt="_audioPreview_z5fvc_70",ht="_errorMessage_z5fvc_76",L={fileUploadContainer:it,fileInput:ct,uploadButton:dt,changeButton:ut,previewContainer:mt,imagePreview:pt,audioPreview:gt,errorMessage:ht},ft=({onUpload:s,currentFileUrl:t,acceptedFileTypes:n,label:a,previewType:i="image"})=>{const[m,c]=d.useState(!1),[p,h]=d.useState(null),k=d.useRef(null),f=async x=>{const y=x.target.files[0];if(!y){console.error("[FileUpload] No file selected");return}console.log("[FileUpload] File selected:",{name:y.name,type:y.type,size:y.size}),h(null),c(!0);try{console.log("[FileUpload] Calling onUpload function");const r=await s(y);console.log("[FileUpload] Upload result:",r),r?console.log("[FileUpload] Upload successful"):(console.error("[FileUpload] Upload failed"),h("Failed to upload file. Please try again."))}catch(r){console.error("[FileUpload] Error uploading file:",r),h("An error occurred during upload.")}finally{c(!1)}},o=()=>{k.current.click()},u=()=>t?i==="image"?e.jsx("div",{className:L.previewContainer,children:e.jsx("img",{src:t,alt:"Preview",className:L.imagePreview})}):i==="audio"?e.jsx("div",{className:L.previewContainer,children:e.jsx("audio",{controls:!0,src:t,className:L.audioPreview,children:"Your browser does not support the audio element."})}):null:null;return e.jsxs("div",{className:L.fileUploadContainer,children:[e.jsx("input",{type:"file",ref:k,onChange:f,accept:n,className:L.fileInput}),t&&u(),e.jsx("button",{type:"button",onClick:o,className:`${L.uploadButton} ${t?L.changeButton:""}`,disabled:m,"data-gamepad-focusable":"true",children:m?"Uploading...":t?`Change ${a}`:`Upload ${a}`}),p&&e.jsx("div",{className:L.errorMessage,children:p})]})},yt=()=>{const{token:s}=re(),{preferences:t,updateSelectedTitle:n}=oe(),[a,i]=d.useState([]),[m,c]=d.useState(!0),[p,h]=d.useState(null);d.useEffect(()=>{k()},[]);const k=async()=>{try{c(!0);const o=await fetch(`${X}/me/titles`,{headers:{Authorization:`Bearer ${s}`}});if(!o.ok)throw new Error("Failed to load titles");const u=await o.json();i(u)}catch(o){h(o.message)}finally{c(!1)}},f=async o=>{try{await n(o)}catch{h("Failed to update title")}};return m?e.jsx("div",{className:I.loadingMessage,children:"Loading titles..."}):p?e.jsx("div",{className:I.errorMessage,children:p}):a.length===0?e.jsx("div",{style:{textAlign:"center",padding:"20px",color:"var(--text-muted)"},children:"No titles unlocked yet. Play games to earn achievements!"}):e.jsxs("div",{style:{display:"block",width:"100%",overflowX:"auto",overflowY:"hidden",whiteSpace:"nowrap",paddingBottom:"8px",padding:"6px"},children:[e.jsxs("div",{onClick:()=>f(""),tabIndex:0,"data-gamepad-focusable":"true",onKeyDown:o=>{(o.key==="Enter"||o.key===" ")&&(o.preventDefault(),f(""))},style:{display:"inline-flex",width:"120px",height:"36px",padding:"8px",margin:"0 8px 0 0",borderRadius:"6px",cursor:"pointer",textAlign:"center",backgroundColor:t.selectedTitle?"rgba(255, 255, 255, 0.08)":"var(--btn-tertiary-shadow)",border:t.selectedTitle?"2px solid rgba(255, 255, 255, 0.15)":"2px solid var(--btn-tertiary-start)",verticalAlign:"top",whiteSpace:"normal",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[e.jsx("div",{style:{fontWeight:"bold",color:"var(--text-primary)",fontSize:"13px"},children:"No Title"}),e.jsx("div",{style:{color:"var(--text-muted)",fontSize:"10px",marginTop:"2px"},children:"Display no title"})]}),a.map(o=>e.jsxs("div",{onClick:()=>f(o.title),tabIndex:0,"data-gamepad-focusable":"true",onKeyDown:u=>{(u.key==="Enter"||u.key===" ")&&(u.preventDefault(),f(o.title))},style:{display:"inline-flex",flexDirection:"column",justifyContent:"center",alignItems:"center",width:"130px",height:"36px",padding:"8px",margin:"0 8px 0 0",borderRadius:"6px",cursor:"pointer",textAlign:"center",backgroundColor:t.selectedTitle===o.title?"var(--btn-tertiary-shadow)":"rgba(255, 255, 255, 0.08)",border:t.selectedTitle===o.title?"2px solid var(--btn-tertiary-start)":"2px solid rgba(255, 255, 255, 0.15)",verticalAlign:"top",whiteSpace:"normal"},children:[e.jsx("div",{style:{fontWeight:"bold",color:"var(--text-primary)",fontSize:"13px"},children:o.title}),e.jsx("div",{style:{color:"var(--text-muted)",fontSize:"10px",marginTop:"2px"},children:o.description})]},o.title)),a.length===0&&e.jsx("div",{style:{textAlign:"center",padding:"16px",color:"var(--text-muted)",backgroundColor:"rgba(255, 255, 255, 0.05)",borderRadius:"6px",border:"1px solid rgba(255, 255, 255, 0.1)",marginTop:"8px",whiteSpace:"normal"},children:"No titles unlocked yet. Play games to earn achievements!"})]})},xt=[{id:"default",name:"Default",description:"Classic blue theme",primary:"#1a2a3a",accent:"#3498db"},{id:"light",name:"Light Mode",description:"Professional theme",primary:"#f8f9fa",accent:"#ffc107"},{id:"dark",name:"Dark Mode",description:"Deep dark theme",primary:"#0d0d0d",accent:"#2980b9"},{id:"packers",name:"Packers",description:"Go Pack Go!",primary:"#203731",accent:"#FFB612"},{id:"sunset",name:"Sunset",description:"Romantic twilight",primary:"#0c1929",accent:"#ff6b6b"},{id:"miami-vice",name:"Miami Vice",description:"Neon pink & cyan",primary:"#1a0f2e",accent:"#00d2d3"},{id:"purple",name:"Royal Purple",description:"Elegant purple theme",primary:"#1a1a2e",accent:"#8e44ad"}],bt=()=>{const[s,t]=d.useState("default");d.useEffect(()=>{const a=ce();t(a)},[]);const n=a=>{t(a),de(a)};return e.jsx("div",{style:{display:"block",width:"100%",overflowX:"auto",overflowY:"hidden",whiteSpace:"nowrap",paddingBottom:"8px",padding:"6px"},children:xt.map(a=>e.jsxs("div",{onClick:()=>n(a.id),tabIndex:0,"data-gamepad-focusable":"true",onKeyDown:i=>{(i.key==="Enter"||i.key===" ")&&(i.preventDefault(),n(a.id))},style:{display:"inline-flex",flexDirection:"column",justifyContent:"center",alignItems:"center",width:"130px",height:"50px",padding:"8px",margin:"0 8px 0 0",borderRadius:"6px",cursor:"pointer",textAlign:"center",backgroundColor:s===a.id?"var(--btn-tertiary-shadow)":"rgba(255, 255, 255, 0.08)",border:s===a.id?"2px solid var(--btn-tertiary-start)":"2px solid rgba(255, 255, 255, 0.15)",verticalAlign:"top",whiteSpace:"normal",position:"relative"},children:[e.jsxs("div",{style:{position:"absolute",top:"6px",right:"6px",display:"flex",gap:"3px"},children:[e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:a.primary,border:"1px solid rgba(255,255,255,0.3)"}}),e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:a.accent,border:"1px solid rgba(255,255,255,0.3)"}})]}),e.jsx("div",{style:{fontWeight:"bold",color:"var(--text-primary)",fontSize:"13px"},children:a.name}),e.jsx("div",{style:{color:"var(--text-muted)",fontSize:"10px",marginTop:"2px"},children:a.description})]},a.id))})},J={back01:"/cards/back01.png",back02:"/cards/back02.png",back03:"/cards/back03.png",back04:"/cards/back04.png",back05:"/cards/back05.png",back06:"/cards/back06.png",back07:"/cards/back07.png",back08:"/cards/back08.png"},le=()=>localStorage.getItem("selectedCardBack")||"back01",Wa=()=>{const s=le();return J[s]||J.back01},_t=s=>{J[s]&&(localStorage.setItem("selectedCardBack",s),window.dispatchEvent(new CustomEvent("cardbackchange",{detail:s})))},ae=[{id:"back01",image:"/cards/back01.png"},{id:"back02",image:"/cards/back02.png"},{id:"back03",image:"/cards/back03.png"},{id:"back04",image:"/cards/back04.png"},{id:"back05",image:"/cards/back05.png"},{id:"back06",image:"/cards/back06.png"},{id:"back07",image:"/cards/back07.png"},{id:"back08",image:"/cards/back08.png"}],vt=()=>{const[s,t]=d.useState("back01");d.useEffect(()=>{const a=le();t(a)},[]);const n=a=>{t(a),_t(a)};return e.jsx("div",{style:{display:"flex",gap:"12px",overflowX:"auto",overflowY:"visible",paddingTop:"8px",paddingBottom:"8px",alignItems:"center",minHeight:"100px"},children:ae.map((a,i)=>e.jsx("div",{onClick:()=>n(a.id),tabIndex:0,"data-gamepad-focusable":"true",onKeyDown:m=>{(m.key==="Enter"||m.key===" ")&&(m.preventDefault(),n(a.id))},style:{position:"relative",cursor:"pointer",flexShrink:0,transition:"transform 0.2s ease",transform:s===a.id?"scale(1.1)":"scale(1)",marginLeft:i===0?"8px":0,marginRight:i===ae.length-1?"8px":0},children:e.jsx("div",{style:{width:"60px",height:"84px",backgroundImage:`url(${a.image})`,backgroundSize:"cover",backgroundPosition:"center",borderRadius:"6px",boxShadow:s===a.id?"0 0 0 3px var(--btn-tertiary-start), 0 4px 12px rgba(0,0,0,0.3)":"0 2px 8px rgba(0,0,0,0.2)",border:"1px solid rgba(255,255,255,0.1)"}})},a.id))})},jt=({onClose:s})=>{const{preferences:t,toggleAutoAnte:n,toggleMute:a,uploadProfileImg:i,loading:m}=oe();return m?e.jsx(E,{title:"Preferences",onClose:s,style:{maxWidth:600,maxHeight:"25vh"},children:e.jsx("div",{className:I.loadingMessage,children:"Loading preferences..."})}):e.jsxs(E,{title:"Preferences",onClose:s,style:{maxWidth:600},children:[e.jsx("div",{className:I.sectionHeader,children:"Game Options"}),e.jsxs("div",{className:"panel-alt",style:{marginBottom:"20px",display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h4",{style:{margin:0},children:"Mute Sound"}),e.jsx(te,{isChecked:t.muted,onChange:a})]}),e.jsxs("div",{className:"panel-alt",style:{marginBottom:"20px",display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h4",{style:{margin:0},children:"Auto-Ante"}),e.jsx(te,{isChecked:t.autoAnte,onChange:n})]}),e.jsx("div",{className:I.sectionHeader,children:"Customization Options"}),e.jsxs("div",{className:"panel-alt",style:{marginBottom:"20px",display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h4",{style:{margin:0},children:"Profile Image"}),e.jsx(ft,{onUpload:i,currentFileUrl:t.profileImg,acceptedFileTypes:"image/jpeg,image/png,image/gif",label:"Image",previewType:"image"})]}),e.jsxs("div",{className:"panel-alt",style:{marginBottom:"20px"},children:[e.jsx("h4",{style:{margin:"0 0 12px 0"},children:"Title"}),e.jsx(yt,{})]}),e.jsxs("div",{className:"panel-alt",style:{marginBottom:"20px"},children:[e.jsx("h4",{style:{margin:"0 0 12px 0"},children:"Theme"}),e.jsx(bt,{})]}),e.jsxs("div",{className:"panel-alt",style:{marginBottom:"20px"},children:[e.jsx("h4",{style:{margin:"0 0 12px 0"},children:"Card Back"}),e.jsx(vt,{})]})]})},wt="_iconButton_3xp6j_1",kt="_danger_3xp6j_31",Ct="_preferences_3xp6j_44",Nt="_stats_3xp6j_57",St="_store_3xp6j_70",se={iconButton:wt,default:"_default_3xp6j_18",danger:kt,preferences:Ct,stats:Nt,store:St},W=({icon:s,title:t,onClick:n,variant:a="default",compact:i=!0,className:m="",...c})=>e.jsx("button",{className:`${se.iconButton} ${se[a]} ${m}`,onClick:n,title:t,type:"button",...c,children:s}),Va=({onModalStateChange:s})=>{const[t,n]=d.useState(!1),a=()=>{n(!0)},i=()=>{n(!1)};return d.useEffect(()=>{s&&s(t)},[t,s]),e.jsxs(e.Fragment,{children:[e.jsx(W,{onClick:a,icon:e.jsx(at,{style:{color:"white",width:20,height:20}}),"aria-label":"Open Preferences",variant:"preferences",title:"Preferences","data-gamepad-focusable":"true"}),t&&e.jsx(jt,{isOpen:t,onClose:i})]})},Pt=({color:s="currentColor",size:t=24})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 24 24",fill:"none",stroke:s,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("line",{x1:"18",y1:"20",x2:"18",y2:"10"}),e.jsx("line",{x1:"12",y1:"20",x2:"12",y2:"4"}),e.jsx("line",{x1:"6",y1:"20",x2:"6",y2:"14"}),e.jsx("line",{x1:"3",y1:"20",x2:"21",y2:"20"})]}),It="_totalsTable_ugw0i_3",Tt="_settleUpTable_ugw0i_3",$t="_totalRow_ugw0i_9",At="_paymentRow_ugw0i_9",Bt="_playerName_ugw0i_18",Lt="_totalAmount_ugw0i_29",Mt="_paymentAmount_ugw0i_29",Et="_positive_ugw0i_35",Ut="_negative_ugw0i_39",Dt="_paymentText_ugw0i_43",Rt="_noDataMessage_ugw0i_54",zt="_loadingMessage_ugw0i_61",$={totalsTable:It,settleUpTable:Tt,totalRow:$t,paymentRow:At,playerName:Bt,totalAmount:Lt,paymentAmount:Mt,positive:Et,negative:Ut,paymentText:Dt,noDataMessage:Rt,loadingMessage:zt},Ft=({color:s="currentColor",size:t=24})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 24 24",fill:"none",stroke:s,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M14 3v4a1 1 0 0 0 1 1h4"}),e.jsx("path",{d:"M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z"}),e.jsx("path",{d:"M12 15 L12 18"}),e.jsx("path",{d:"M9.5 16.5 L12 19 L14.5 16.5"}),e.jsx("path",{d:"M8 10 L10 10"}),e.jsx("path",{d:"M12 10 L14 10"}),e.jsx("path",{d:"M16 10 L16 10"})]});let K;try{K=require("../../contexts/GameContext").useGameContext}catch{K=()=>({gameState:null})}const Ht=({title:s="Download Transaction Log as CSV",gameState:t,...n})=>{let a;try{a=K?K():{gameState:null}}catch{a={gameState:null}}const i=t||a?.gameState,m=i?.gameTransactions||i?.gameData?.gameTransactions||[],c=i?._id||i?.id||"unknown",p=()=>{const h=Array.isArray(m)?m:[];if(h.length===0)return;let k=`Player,Transaction Type,Amount,Round,Timestamp
`;const f=[...h].map(y=>({...y,timestamp:y.timestamp?new Date(y.timestamp):new Date}));f.sort((y,r)=>y.timestamp-r.timestamp),f.forEach(y=>{const r=y.timestamp?new Date(y.timestamp).toLocaleString():"N/A",g=y.playerName||y.player||"Unknown Player",S=g.includes(",")?`"${g}"`:g;let N=y.transactionType||"Transaction";if(!y.transactionType&&y.reason){const C=y.reason.split(" ");N=C[0],C[0]==="Won"?N="Win":y.reason.includes("penalty")&&(N="Penalty")}k+=`${S},${N},${y.amount},${y.round||"N/A"},${r}
`});const o=new Blob([k],{type:"text/csv;charset=utf-8;"}),u=URL.createObjectURL(o),x=document.createElement("a");x.setAttribute("href",u),x.setAttribute("download",`game-${c}-transactions.csv`),x.style.visibility="hidden",document.body.appendChild(x),x.click(),document.body.removeChild(x)};return e.jsx(W,{icon:e.jsx(Ft,{color:"white",size:20}),title:s,onClick:p,variant:"default",...n})},Gt="_noDataMessage_13uuv_2",Ot="_statsGrid_13uuv_9",qt="_statLabel_13uuv_42",Wt="_statValue_13uuv_49",Vt="_statSuffix_13uuv_57",O={noDataMessage:Gt,statsGrid:Ot,statLabel:qt,statValue:Wt,statSuffix:Vt},Xt=({gameData:s})=>{const t=s.gameTransactions,n=s.players,a={};Object.entries(n).forEach(([c,p])=>{a[c]=p.name}),t.forEach(c=>{c.playerId&&!a[c.playerId]&&(a[c.playerId]=c.playerName||"Unknown Player")});const i=d.useMemo(()=>{if(t.length===0)return[];const c=l=>l.toLocaleString(),p={};t.forEach(l=>{p[l.playerId]||(p[l.playerId]=[]),p[l.playerId].push(l)});const h=s.round||1,k=s.deckCount||1,f=t.filter(l=>l.transactionType==="Ante").reduce((l,w)=>l+Math.abs(w.amount),0),o=t.filter(l=>l.transactionType==="Bet").reduce((l,w)=>l+Math.abs(w.amount),0),u=t.filter(l=>l.transactionType==="Bet"),x=u.length>0?u.reduce((l,w)=>Math.abs(w.amount)>Math.abs(l.amount)?w:l,u[0]):null,y=t.reduce((l,w)=>w.potAmount>l?w.potAmount:l,0),r=t.filter(l=>l.transactionType==="2x"||l.transactionType==="3x"),g=r.reduce((l,w)=>l+Math.abs(w.amount),0),S={};u.forEach(l=>{S[l.playerId]=(S[l.playerId]||0)+1});let N=null,C=0;Object.entries(S).forEach(([l,w])=>{w>C&&(C=w,N=l)});const T={};u.forEach(l=>{T[l.playerId]||(T[l.playerId]={total:0,count:0}),T[l.playerId].total+=Math.abs(l.amount),T[l.playerId].count+=1});let B=null,M=0;Object.entries(T).forEach(([l,w])=>{const Q=w.total/w.count;Q>M&&(M=Q,B=l)});const z={};t.filter(l=>l.transactionType==="Win").forEach(l=>{z[l.playerId]=(z[l.playerId]||0)+1});let D=null,U=0;Object.entries(z).forEach(([l,w])=>{w>U&&(U=w,D=l)});const F={};r.forEach(l=>{F[l.playerId]=(F[l.playerId]||0)+1});let R=null,H=0;Object.entries(F).forEach(([l,w])=>{w>H&&(H=w,R=l)});const v=s.totals||{};let b=null,A=0,V=null,Y=0;return Object.entries(v).forEach(([l,w])=>{w>A&&(A=w,b=l),w<Y&&(Y=w,V=l)}),[{key:"totalDecks",label:"Total Decks",value:k,type:"number"},{key:"totalRounds",label:"Total Rounds",value:h,type:"number"},{key:"totalBets",label:"Total Bets Placed",value:u.length,type:"number"},{key:"totalAnte",label:"Total Ante Amount",value:f,type:"currency"},{key:"totalBetAmount",label:"Total Bet Amount",value:o,type:"currency"},{key:"biggestPot",label:"Biggest Pot",value:y,type:"currency"},{key:"biggestBet",label:"Biggest Single Bet",value:x?Math.abs(x.amount):0,type:"currency",suffix:x?` by ${x.playerName}`:""},{key:"biggestWinner",label:"Biggest Winner",value:b?a[b]||"Unknown Player":"N/A",type:"text",suffix:b?` (+${c(A)})`:""},{key:"biggestLoser",label:"Biggest Loser",value:V?a[V]||"Unknown Player":"N/A",type:"text",suffix:V?` (${c(Y)})`:""},{key:"mostAggressive",label:"Most Aggressive Player",value:N?a[N]||"Unknown Player":"N/A",type:"text",suffix:N?` (${c(C)} bets)`:""},{key:"highestAvgBet",label:"Highest Average Bet",value:B?a[B]||"Unknown Player":"N/A",type:"text",suffix:B?` (avg: ${c(Math.round(M))})`:""},{key:"mostWinning",label:"Most Winning Player",value:D?a[D]||"Unknown Player":"N/A",type:"text",suffix:D?` (${c(U)} wins)`:""},{key:"totalPenalties",label:"Total Penalties",value:r.length,type:"number",suffix:r.length>0?` (${c(g)} coins)`:""},{key:"unluckyPlayer",label:"Most Penalized Player",value:R?a[R]||"Unknown Player":"N/A",type:"text",suffix:R?` (${c(H)} penalties)`:""}]},[t,a]),m=(c,p)=>c==="currency"?e.jsx(q,{amount:p,size:"small"}):c==="percentage"?`${(p*100).toFixed(1)}%`:c==="number"?p.toLocaleString():p;return e.jsx(e.Fragment,{children:i.length===0?e.jsx("p",{className:O.noDataMessage,children:"No statistics available for this game."}):e.jsx("div",{className:O.statsGrid,"data-gamepad-scrollable":"true",tabIndex:"0",children:i.map(c=>e.jsxs("div",{className:"panel-alt",children:[e.jsx("div",{className:O.statLabel,children:c.label}),e.jsxs("div",{className:O.statValue,children:[m(c.type,c.value),c.suffix&&e.jsx("span",{className:O.statSuffix,children:c.suffix})]})]},c.key))})})},Kt=({onClose:s,gameData:t})=>{if(!t)return e.jsx(E,{title:"Game Summary",onClose:s,style:{maxWidth:800,height:"80vh"},children:e.jsx("div",{className:$.loadingMessage,children:"Loading game data..."})});const n=t.gameTransactions||[],a=t.players||{},i=t.id||"unknown",m=t.settings?.isPrivate||!1,c=Array.isArray(n)?n:[],p={};Object.entries(a).forEach(([u,x])=>{p[u]=x.name}),c.forEach(u=>{u.playerId&&!p[u.playerId]&&(p[u.playerId]=u.playerName||"Unknown Player")});const h=t.totals||{},k=d.useMemo(()=>{if(Object.keys(h).length===2){const r=Object.entries(h),[g,S]=r[0],[N,C]=r[1];if(Math.abs(S+C)<.1){if(S>0)return[{from:N,fromName:p[N],to:g,toName:p[g],amount:Math.abs(S)}];if(C>0)return[{from:g,fromName:p[g],to:N,toName:p[N],amount:Math.abs(C)}]}}const u=[],x=Object.entries(h).filter(([r,g])=>g<0).map(([r,g])=>({playerId:r,playerName:p[r]||"Unknown Player",amount:Math.abs(g)})),y=Object.entries(h).filter(([r,g])=>g>0).map(([r,g])=>({playerId:r,playerName:p[r]||"Unknown Player",amount:g}));for(x.sort((r,g)=>g.amount-r.amount),y.sort((r,g)=>g.amount-r.amount);y.length>0&&x.length>0;){const r=y[0],g=x[0],S=Math.min(r.amount,g.amount);if(S>.01)u.push({from:g.playerId,fromName:g.playerName,to:r.playerId,toName:r.playerName,amount:S}),r.amount-=S,g.amount-=S,r.amount<.01&&y.shift(),g.amount<.01&&x.shift();else break}return u},[h,p]),[f,o]=d.useState("totals");return e.jsxs(E,{title:`Game Summary (${i})`,onClose:s,headerButtons:e.jsx(Ht,{gameState:t}),style:{maxWidth:800,height:"80vh"},children:[e.jsxs("div",{className:"tabs-container",children:[e.jsx("button",{className:`tab-button ${f==="totals"?"active":""}`,onClick:()=>o("totals"),"data-gamepad-focusable":"true",children:"Totals"}),e.jsx("button",{className:`tab-button ${f==="stats"?"active":""}`,onClick:()=>o("stats"),"data-gamepad-focusable":"true",children:"Stats"}),m&&e.jsx("button",{className:`tab-button ${f==="payouts"?"active":""}`,onClick:()=>o("payouts"),"data-gamepad-focusable":"true",children:"Payouts"})]}),f==="totals"&&e.jsx("div",{className:"tab-content",children:Object.keys(h).length===0?e.jsx("p",{className:$.noDataMessage,children:"No transactions recorded yet."}):e.jsx("div",{className:$.totalsTable,children:Object.entries(h).map(([u,x])=>e.jsxs("div",{className:$.totalRow,children:[e.jsx("span",{className:$.playerName,children:p[u]||"Unknown Player"}),e.jsx("span",{className:`${$.totalAmount} ${x>=0?$.positive:$.negative}`,children:e.jsx(q,{amount:x,size:"small"})})]},u))})}),f==="stats"&&e.jsx(Xt,{gameData:t}),f==="payouts"&&m&&e.jsx("div",{className:"tab-content",children:k.length===0?e.jsx("p",{className:$.noDataMessage,children:"No payments needed or no transactions recorded yet."}):e.jsx("div",{className:$.settleUpTable,children:k.map((u,x)=>e.jsxs("div",{className:$.paymentRow,children:[e.jsxs("span",{className:$.paymentText,children:[e.jsx("span",{className:$.playerName,children:u.fromName})," pays"," ",e.jsx("span",{className:$.playerName,children:u.toName})]}),e.jsx("span",{className:$.paymentAmount,children:e.jsx(q,{amount:u.amount,size:"small"})})]},x))})})]})},Yt="_leaderboardContainer_1al73_1",Zt="_leaderboardHeader_1al73_9",Jt="_durationSelector_1al73_15",Qt="_durationButton_1al73_24",ea="_active_1al73_41",ta="_loadingMessage_1al73_48",aa="_errorMessage_1al73_48",sa="_emptyMessage_1al73_48",na="_loadingSpinner_1al73_60",ra="_leaderboardList_1al73_78",oa="_leaderboardRow_1al73_88",la="_rankCell_1al73_102",ia="_rank_1al73_102",ca="_playerCell_1al73_113",da="_statsCell_1al73_118",P={leaderboardContainer:Yt,leaderboardHeader:Zt,durationSelector:Jt,durationButton:Qt,active:ea,loadingMessage:ta,errorMessage:aa,emptyMessage:sa,loadingSpinner:na,leaderboardList:ra,leaderboardRow:oa,rankCell:la,rank:ia,playerCell:ca,statsCell:da},ua=()=>{const[s,t]=d.useState([]),[n,a]=d.useState(!0),[i,m]=d.useState(null),[c,p]=d.useState("all"),h=d.useContext(ue);d.useEffect(()=>{k()},[c]);const k=async()=>{a(!0),m(null);try{const o=await fetch(`${X}/leaderboard?duration=${c}`);if(!o.ok)throw new Error("Failed to fetch leaderboard");const u=await o.json();if(t(u.leaderboard||[]),h&&u.leaderboard){const x=u.leaderboard.map(y=>y.userId);h.prefetchUsers(x)}}catch(o){console.error("Error fetching leaderboard:",o),m(o.message)}finally{a(!1)}},f=o=>o===1?"🥇":o===2?"🥈":o===3?"🥉":`#${o}`;return e.jsxs("div",{className:P.leaderboardContainer,children:[e.jsx("div",{className:P.leaderboardHeader,children:e.jsxs("div",{className:P.durationSelector,children:[e.jsx("button",{className:`${P.durationButton} ${c==="all"?P.active:""}`,onClick:()=>p("all"),"data-gamepad-focusable":"true",children:"All Time"}),e.jsx("button",{className:`${P.durationButton} ${c==="30days"?P.active:""}`,onClick:()=>p("30days"),"data-gamepad-focusable":"true",children:"Last 30 Days"})]})}),n?e.jsxs("div",{className:P.loadingMessage,children:[e.jsx("div",{className:P.loadingSpinner}),"Loading leaderboard..."]}):i?e.jsxs("div",{className:P.errorMessage,children:["Error: ",i]}):s.length===0?e.jsx("div",{className:P.emptyMessage,children:"No players found for this time period."}):e.jsx("div",{className:P.leaderboardList,"data-gamepad-scrollable":"true",tabIndex:"0",children:s.map(o=>e.jsxs("div",{className:`panel-alt ${P.leaderboardRow}`,children:[e.jsx("div",{className:P.rankCell,children:e.jsx("span",{className:P.rank,children:f(o.rank)})}),e.jsx("div",{className:P.playerCell,children:e.jsx(Ye,{userId:o.userId,size:"small",showName:!0,showTitle:!0,namePosition:"right"})}),e.jsx("div",{className:P.statsCell,children:e.jsx(q,{amount:o.totalProfit,size:"small"})})]},o.userId))})]})},ma="_statsPlaceholder_1uz5o_1",pa="_statsGrid_1uz5o_14",ga="_statLabel_1uz5o_47",ha="_statValue_1uz5o_54",fa="_statSuffix_1uz5o_62",ya="_historyTable_1uz5o_77",xa="_tableBody_1uz5o_89",ba="_tableHeader_1uz5o_117",_a="_gameNameHeader_1uz5o_130",va="_playerCountHeader_1uz5o_130",ja="_roundsHeader_1uz5o_130",wa="_endDateHeader_1uz5o_130",ka="_historyRow_1uz5o_146",Ca="_gameNameCell_1uz5o_159",Na="_playerCountCell_1uz5o_167",Sa="_roundsCell_1uz5o_167",Pa="_endDateCell_1uz5o_175",Ia="_gameNameLink_1uz5o_183",Ta="_pageButton_1uz5o_262",$a="_pageInfo_1uz5o_293",Aa="_errorMessage_1uz5o_304",Ba="_loadingMessage_1uz5o_325",La="_loadingSpinner_1uz5o_336",Ma="_dateMobile_1uz5o_351",Ea="_dateDesktop_1uz5o_355",j={statsPlaceholder:ma,statsGrid:pa,statLabel:ga,statValue:ha,statSuffix:fa,historyTable:ya,tableBody:xa,tableHeader:ba,gameNameHeader:_a,playerCountHeader:va,roundsHeader:ja,endDateHeader:wa,historyRow:ka,gameNameCell:Ca,playerCountCell:Na,roundsCell:Sa,endDateCell:Pa,gameNameLink:Ia,pageButton:Ta,pageInfo:$a,errorMessage:Aa,loadingMessage:Ba,loadingSpinner:La,dateMobile:Ma,dateDesktop:Ea},Ua=({onClose:s})=>{const{token:t}=re(),[n,a]=d.useState("leaderboard"),[i,m]=d.useState(!0),[c,p]=d.useState(null),[h,k]=d.useState({games:[],pagination:{}}),[f,o]=d.useState(0),[u,x]=d.useState(!1),[y,r]=d.useState(null),[g,S]=d.useState(null),[N,C]=d.useState(!0),[T,B]=d.useState(null),M=5;d.useEffect(()=>{(async()=>{m(!0),p(null);try{const b=await fetch(`${X}/games/history?pageSize=${M}&pageNumber=${f}`,{headers:{Authorization:`Bearer ${t}`}});if(!b.ok)throw new Error("Failed to fetch game history");const A=await b.json();k(A)}catch(b){console.error("Error fetching game history:",b),p(b.message)}finally{m(!1)}})()},[t,f]),d.useEffect(()=>{(async()=>{C(!0),B(null);try{const b=await fetch(`${X}/me/stats`,{headers:{Authorization:`Bearer ${t}`}});if(!b.ok)throw new Error("Failed to fetch lifetime stats");const A=await b.json();S(A.stats)}catch(b){console.error("Error fetching lifetime stats:",b),B(b.message)}finally{C(!1)}})()},[t]);const z=()=>{f>0&&o(f-1)},D=()=>{h.pagination&&h.games.length===M&&o(f+1)},U=(v,b=!1)=>{if(!v)return"Unknown";const A=new Date(v);return b?new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}).format(A):new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(A)},F=(v,b)=>typeof b=="number"?v==="currency"?e.jsx(q,{amount:b,size:"small"}):v==="percentage"?`${(b*100).toFixed(1)}%`:b.toLocaleString():typeof b=="boolean"?b?"Yes":"No":v==="date"||b instanceof Date?U(b):v==="number"?Number(b).toLocaleString():String(b),R=v=>v.roundCount||0,H=v=>{const b=h.games.find(A=>A.id===v);b&&(r(b),x(!0))};return e.jsxs(e.Fragment,{children:[e.jsxs(E,{title:"Player Stats",onClose:s,style:{maxWidth:800,height:"80vh"},children:[e.jsxs("div",{className:"tabs-container",children:[e.jsx("button",{className:`tab-button ${n==="leaderboard"?"active":""}`,onClick:()=>a("leaderboard"),"data-gamepad-focusable":"true",children:"Leaderboard"}),e.jsx("button",{className:`tab-button ${n==="stats"?"active":""}`,onClick:()=>a("stats"),"data-gamepad-focusable":"true",children:"Lifetime Stats"}),e.jsx("button",{className:`tab-button ${n==="history"?"active":""}`,onClick:()=>a("history"),"data-gamepad-focusable":"true",children:"Game History"})]}),n==="leaderboard"&&e.jsx("div",{className:"tab-content",children:e.jsx(ua,{})}),n==="stats"&&e.jsx("div",{className:"tab-content",children:N?e.jsxs("div",{className:j.loadingMessage,children:[e.jsx("div",{className:j.loadingSpinner}),"Loading your lifetime stats..."]}):T?e.jsxs("div",{className:j.errorMessage,children:["Error: ",T]}):!g||g.length===0?e.jsx("div",{className:j.statsPlaceholder,children:e.jsx("p",{children:"No lifetime statistics available."})}):e.jsx("div",{className:j.statsGrid,"data-gamepad-scrollable":"true",tabIndex:"0",children:g.map((v,b)=>e.jsxs("div",{className:"panel-alt",children:[e.jsx("div",{className:j.statLabel,children:v.label}),e.jsxs("div",{className:j.statValue,children:[F(v.type,v.value),v.suffix&&e.jsx("span",{className:j.statSuffix,children:v.suffix})]})]},v.key||`stat-${b}`))})}),n==="history"&&e.jsx("div",{className:"tab-content",children:i?e.jsxs("div",{className:j.loadingMessage,children:[e.jsx("div",{className:j.loadingSpinner}),"Loading your game history..."]}):c?e.jsxs("div",{className:j.errorMessage,children:["Error: ",c]}):h.games.length===0?e.jsx("div",{className:j.statsPlaceholder,children:e.jsx("p",{children:"No games found in your history."})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`panel-alt ${j.historyTable}`,children:[e.jsxs("div",{className:j.tableHeader,children:[e.jsx("div",{className:j.gameNameHeader,children:"Game"}),e.jsx("div",{className:j.playerCountHeader,children:"Players"}),e.jsx("div",{className:j.roundsHeader,children:"Rounds"}),e.jsx("div",{className:j.endDateHeader,children:"Ended"})]}),e.jsx("div",{className:j.tableBody,"data-gamepad-scrollable":"true",tabIndex:"0",children:h.games.map(v=>e.jsxs("div",{className:j.historyRow,children:[e.jsx("div",{className:j.gameNameCell,children:e.jsxs("span",{className:j.gameNameLink,onClick:()=>H(v.id),tabIndex:"0",role:"button","data-gamepad-focusable":"true",children:["#",v.id]})}),e.jsx("div",{className:j.playerCountCell,children:v.totalPlayerCount}),e.jsx("div",{className:j.roundsCell,children:R(v)}),e.jsxs("div",{className:j.endDateCell,children:[e.jsx("span",{className:j.dateDesktop,children:U(v.endedAt)}),e.jsx("span",{className:j.dateMobile,children:U(v.endedAt,!0)})]})]},v.id))})]}),e.jsxs("div",{className:j.pageInfo,children:[e.jsx("button",{onClick:z,disabled:f===0,className:j.pageButton,"aria-label":"Previous page","data-gamepad-focusable":"true",children:"←"}),"Page ",f+1,h.pagination&&h.pagination.total?` of ${Math.ceil(h.pagination.total/M)}`:"",e.jsx("button",{onClick:D,disabled:!h.pagination||h.games.length<M,className:j.pageButton,"aria-label":"Next page","data-gamepad-focusable":"true",children:"→"})]})]})})]}),u&&y&&e.jsx(Kt,{gameData:y,onClose:()=>{x(!1),r(null)}})]})},Xa=({onModalStateChange:s,...t})=>{const[n,a]=d.useState(!1),i=()=>{a(!0)},m=()=>{a(!1)};return d.useEffect(()=>{s&&s(n)},[n,s]),e.jsxs(e.Fragment,{children:[e.jsx(W,{onClick:i,icon:e.jsx(Pt,{color:"white",size:20}),"aria-label":"Open Player Stats",variant:"stats",title:"Player Stats",...t}),n&&e.jsx(Ua,{isOpen:n,onClose:m})]})},Da=({className:s="h-6 w-6",...t})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.8,stroke:"currentColor",className:s,...t,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 10.5V6a3.75 3.75 0 10-7.5 0v4.5m-2.25 9h12a1.5 1.5 0 001.5-1.5v-6a1.5 1.5 0 00-1.5-1.5h-12a1.5 1.5 0 00-1.5 1.5v6a1.5 1.5 0 001.5 1.5z"})}),Ka=({onClick:s,...t})=>e.jsx(W,{onClick:s,icon:e.jsx(Da,{style:{color:"white",width:20,height:20}}),"aria-label":"Store",variant:"store",title:"Store",...t}),Ra=({color:s="currentColor",size:t=24})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 24 24",fill:"none",stroke:s,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),e.jsx("line",{x1:"12",y1:"17",x2:"12",y2:"17.01"})]}),za=({onClose:s})=>e.jsxs(E,{title:"Game Rules",onClose:s,style:{maxWidth:600},children:[e.jsxs("div",{style:{marginBottom:22},children:[e.jsx("div",{className:I.sectionHeader,children:"Objective"}),e.jsx("div",{className:I.settingDescription,children:'The goal is to bet on whether the third card will have a value that falls "in between" the first two cards.'})]}),e.jsxs("div",{style:{marginBottom:22},children:[e.jsx("div",{className:I.sectionHeader,children:"Card Values"}),e.jsx("div",{className:I.settingDescription,children:"Cards are valued numerically: 2-10 as face value, Jack = 11, Queen = 12, King = 13, and Ace = 1 or 14 (player's choice)."})]}),e.jsxs("div",{style:{marginBottom:22},children:[e.jsx("div",{className:I.sectionHeader,children:"Game Flow"}),e.jsx("div",{className:I.settingDescription,children:e.jsxs("ol",{style:{paddingLeft:20,margin:0},children:[e.jsx("li",{children:"Each player antes up to join the round."}),e.jsx("li",{children:"The player to the right of the dealer goes first."}),e.jsx("li",{children:"Two cards are dealt face up."}),e.jsx("li",{children:"Player decides whether to bet or pass."}),e.jsx("li",{children:"If a bet is placed, the third card is revealed."}),e.jsx("li",{children:"Bets are settled."}),e.jsx("li",{children:"Next player goes."}),e.jsx("li",{children:"If the pot is empty, players ante up again to start a new round."})]})})]}),e.jsxs("div",{style:{marginBottom:22},children:[e.jsx("div",{className:I.sectionHeader,children:"Betting"}),e.jsxs("div",{className:I.settingDescription,children:["If you think the third card will fall between the first two cards, you can bet up to the pot amount.",e.jsx("br",{}),"If you win, you receive the amount of your bet from the pot.",e.jsx("br",{}),"If you lose, your bet is added to the pot."]})]}),e.jsxs("div",{style:{marginBottom:22},children:[e.jsx("div",{className:I.sectionHeader,children:"POT Button"}),e.jsx("div",{className:I.settingDescription,children:"The POT button allows you to bet the entire pot amount at once for maximum winnings."})]}),e.jsxs("div",{style:{marginBottom:6},children:[e.jsx("div",{className:I.sectionHeader,children:"Special Rules"}),e.jsx("div",{className:I.settingDescription,children:e.jsxs("ul",{style:{paddingLeft:20,margin:0},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Ace Choice:"})," If the first card is an Ace, you can choose to play it as low (1) or high (14)."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Second Chance:"})," If the first two cards are the same, you can chose to ante again to see another hand."]})]})})]})]}),Ya=({title:s="View Game Rules",onModalStateChange:t,...n})=>{const[a,i]=d.useState(!1),m=()=>{i(!0)},c=()=>{i(!1)};return d.useEffect(()=>{t&&t(a)},[a,t]),e.jsxs(e.Fragment,{children:[e.jsx(W,{icon:e.jsx(Ra,{color:"white",size:20}),title:s,onClick:m,variant:"default",...n}),a&&e.jsx(za,{onClose:c})]})},Fa="_coinPacksGrid_n27te_3",Ha={coinPacksGrid:Fa};class Ga{constructor(){this.API_URL="https://api.in-between.live",this.baseURL=`${this.API_URL}/purchases`}getAuthHeaders(){const t=localStorage.getItem("token");return{"Content-Type":"application/json",Authorization:t?`Bearer ${t}`:""}}async getOfferingsByType(t){try{const n=`${this.baseURL}/offerings?offeringType=${encodeURIComponent(t)}`,a=await fetch(n,{method:"GET",headers:this.getAuthHeaders(),credentials:"include"});if(!a.ok){const m=await a.json().catch(()=>({}));throw new Error(m.error||`HTTP ${a.status}: Failed to fetch offerings`)}return(await a.json()).offerings||[]}catch(n){throw console.error("[PURCHASE_SERVICE] Error fetching offerings:",n),new Error(`Failed to fetch product offerings: ${n.message}`)}}async getAllOfferings(){try{const t=await fetch(`${this.baseURL}/offerings`,{method:"GET",headers:this.getAuthHeaders(),credentials:"include"});if(!t.ok){const a=await t.json().catch(()=>({}));throw new Error(a.error||`HTTP ${t.status}: Failed to fetch offerings`)}return(await t.json()).offerings||[]}catch(t){throw console.error("[PURCHASE_SERVICE] Error fetching all offerings:",t),new Error(`Failed to fetch product offerings: ${t.message}`)}}async processPurchase(t){try{if(!t)throw new Error("Product ID is required");const n=await fetch(`${this.baseURL}/process`,{method:"POST",headers:this.getAuthHeaders(),credentials:"include",body:JSON.stringify({productId:t})});if(!n.ok){const i=await n.json().catch(()=>({}));throw new Error(i.error||`HTTP ${n.status}: Purchase failed`)}const a=await n.json();return console.log("[PURCHASE_SERVICE] Purchase completed:",{productId:t,coinsAdded:a.coinsAdded,newBalance:a.newBalance}),a}catch(n){throw console.error("[PURCHASE_SERVICE] Error processing purchase:",n),new Error(`Purchase failed: ${n.message}`)}}async getCoinOfferings(){return this.getOfferingsByType("coin")}}const ne=new Ga,Za=({onClose:s})=>{const[t,n]=d.useState("coins"),[a,i]=d.useState([]),[m,c]=d.useState(!0),[p,h]=d.useState(null),[k,f]=d.useState(null);d.useEffect(()=>{o()},[]);const o=async()=>{try{c(!0),f(null);const r=await ne.getCoinOfferings();i(r)}catch(r){console.error("Failed to load coin offerings:",r),f("Failed to load products. Please try again.")}finally{c(!1)}},u=async r=>{try{h(r),f(null);const g=await ne.processPurchase(r);console.log("Purchase successful:",g),s()}catch(g){console.error("Purchase failed:",g),f(g.message||"Purchase failed. Please try again.")}finally{h(null)}},x=r=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(r),y=r=>new Intl.NumberFormat("en-US").format(r);return m?e.jsx(E,{title:"Store",onClose:s,style:{maxWidth:800,height:"80vh"},children:e.jsx("div",{style:{textAlign:"center",padding:"2rem",color:"#a0b9d6"},children:"Loading products..."})}):e.jsxs(E,{title:"Store",onClose:s,style:{maxWidth:800,height:"80vh"},children:[e.jsx("div",{className:"tabs-container",children:e.jsx("button",{className:`tab-button ${t==="coins"?"active":""}`,onClick:()=>n("coins"),"data-gamepad-focusable":"true",children:"Coin Packs"})}),k&&e.jsx("div",{style:{marginBottom:"1rem",padding:"0.75rem",backgroundColor:"rgba(231, 76, 60, 0.1)",border:"1px solid #e74c3c",borderRadius:"8px",color:"#ffb3b3"},children:k}),t==="coins"&&e.jsx("div",{className:"tab-content",children:a.length===0?e.jsx("div",{style:{textAlign:"center",padding:"2rem",color:"#a0b9d6"},children:"No coin packs available at the moment."}):e.jsx("div",{className:Ha.coinPacksGrid,"data-gamepad-scrollable":"true",tabIndex:"0",children:a.map(r=>e.jsxs("div",{className:"panel-alt",style:{display:"flex",flexDirection:"column",padding:"10px",minHeight:"280px"},children:[e.jsxs("h3",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#FFD700",margin:"0 0 1rem 0",textAlign:"center"},children:[y(r.coinAmount)," Coins"]}),r.imageUrl&&e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",marginBottom:"1rem"},children:e.jsx("img",{src:r.imageUrl,alt:r.name,style:{width:"64px",height:"64px",objectFit:"contain"},onError:g=>{g.target.style.display="none"}})}),e.jsx("p",{style:{color:"#a0b9d6",fontSize:"0.875rem",margin:"0 0 1rem 0",textAlign:"center",lineHeight:"1.4",flex:"1"},children:r.description}),e.jsx("div",{style:{fontSize:"1.75rem",fontWeight:"bold",color:"#bcdcff",textAlign:"center",marginBottom:"1rem"},children:x(r.priceUSD)}),e.jsx("button",{onClick:()=>u(r.id),disabled:p===r.id,className:"btn btn-primary","data-gamepad-focusable":"true",children:p===r.id?"Processing...":"Purchase"})]},r.id))})})]})},Ja=({type:s="text",title:t="",...n})=>{const a=d.useRef(null);let i=null;try{i=me()?.enhanceInput}catch{console.warn("VirtualKeyboardProvider not found - GamepadInput working as regular input")}return d.useEffect(()=>{if(a.current&&i)return i(a.current,s,t)},[i,s,t]),e.jsx("input",{ref:a,type:s,"data-gamepad-focusable":"true",...n})};export{q as C,Ja as G,W as I,Xa as P,Ya as R,Ka as S,te as T,Ye as U,Va as a,Za as b,Kt as c,ye as d,Wa as g};
