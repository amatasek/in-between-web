const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./useGamepadNavigation-Vd4_Qxse.js","./index-DCTCU-m8.js","./vendor-KCSzRvRf.js","./socket-CA1CrNgP.js","./audio-Bhw8yDMU.js","./index-BjEhzJEb.css"])))=>i.map(i=>d[i]);
import{Y as c,_ as G,X as v,c as V,t as $,Z as R,U as e,$ as U,a0 as C}from"./index-DCTCU-m8.js";import{u as T,r}from"./vendor-KCSzRvRf.js";import{u as D}from"./useGamepadNavigation-Vd4_Qxse.js";import{g as H,A as q,o as E}from"./AppHeader-BdJdpvFZ.js";import"./socket-CA1CrNgP.js";import"./audio-Bhw8yDMU.js";const j=R.isNativePlatform(),l={async signInWithApple(){return(await c.signInWithApple()).user},async signInWithGoogle(){return(await c.signInWithGoogle()).user},async signInWithFacebook(){return(await c.signInWithFacebook({useLimitedLogin:!0})).user},async signInWithEmail(t,o){return(j?await c.signInWithEmailAndPassword({email:t,password:o}):await $(v,t,o)).user},async createAccountWithEmail(t,o){return(j?await c.createUserWithEmailAndPassword({email:t,password:o}):await V(v,t,o)).user},async getCurrentUser(){return(await c.getCurrentUser()).user},async signOut(){await c.signOut()},async sendPasswordResetEmail(t){if(j)await c.sendPasswordResetEmail({email:t});else{const{sendPasswordResetEmail:o}=await G(async()=>{const{sendPasswordResetEmail:n}=await import("./useGamepadNavigation-Vd4_Qxse.js").then(d=>d.i);return{sendPasswordResetEmail:n}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url);await o(v,t,{url:`${window.location.origin}/auth`,handleCodeInApp:!1})}},getErrorMessage(t){return{"auth/invalid-email":"Invalid email address","auth/user-disabled":"This account has been disabled","auth/user-not-found":"No account found with this email","auth/wrong-password":"Incorrect password","auth/email-already-in-use":"An account with this email already exists","auth/weak-password":"Password should be at least 6 characters","auth/operation-not-allowed":"This sign-in method is not enabled","auth/popup-closed-by-user":"Sign-in cancelled","auth/cancelled-popup-request":"Sign-in cancelled","auth/popup-blocked":"Pop-up blocked. Please allow pop-ups and try again"}[t?.code]||t?.message||"An error occurred during authentication"}},O="_socialButton_1ecle_1",X="_disabled_1ecle_20",Y="_icon_1ecle_35",Z="_label_1ecle_42",J="_apple_1ecle_48",K="_google_1ecle_60",Q="_facebook_1ecle_72",ee="_spinner_1ecle_84",u={socialButton:O,disabled:X,icon:Y,label:Z,apple:J,google:K,facebook:Q,spinner:ee},P=({provider:t,onClick:o,disabled:n,loading:d})=>{const a=(()=>{switch(t){case"apple":return{icon:e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M17.05 20.28c-.98.95-2.05.8-3.08.35-1.09-.46-2.09-.48-3.24 0-1.44.62-2.2.44-3.06-.35C2.79 15.25 3.51 7.59 9.05 7.31c1.35.07 2.29.74 3.08.8 1.18-.24 2.31-.93 3.57-.84 1.51.12 2.65.72 3.4 1.8-3.12 1.87-2.38 5.98.48 7.13-.57 1.5-1.31 2.99-2.54 4.09l.01-.01zM12.03 7.25c-.15-2.23 1.66-4.07 3.74-4.25.29 2.58-2.34 4.5-3.74 4.25z"})}),label:"Sign in with Apple",className:u.apple};case"google":return{icon:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),e.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),label:"Continue with Google",className:u.google};case"facebook":return{icon:e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),label:"Continue with Facebook",className:u.facebook};default:return null}})();return a?e.jsx("button",{type:"button",className:`${u.socialButton} ${a.className} ${n?u.disabled:""}`,onClick:o,disabled:n||d,children:d?e.jsx("div",{className:u.spinner}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:u.icon,children:a.icon}),e.jsx("span",{className:u.label,children:a.label})]})}):null},se="_authPage_1ggtc_1",te="_container_1ggtc_31",ae="_content_1ggtc_43",oe="_errorAlert_1ggtc_61",ne="_socialButtons_1ggtc_86",ie="_divider_1ggtc_94",re="_emailButton_1ggtc_116",le="_privacyNote_1ggtc_150",ce="_emailForm_1ggtc_159",ue="_inputGroup_1ggtc_165",de="_label_1ggtc_171",ge="_input_1ggtc_165",he="_submitButton_1ggtc_200",me="_spinner_1ggtc_231",pe="_toggleMode_1ggtc_244",_e="_backButton_1ggtc_263",fe="_forgotPasswordLink_1ggtc_287",xe="_forgotPasswordText_1ggtc_306",we="_successMessage_1ggtc_315",be="_migrationBanner_1ggtc_349",ve="_migrationLink_1ggtc_371",je="_footer_1ggtc_387",ke="_footerLinks_1ggtc_399",ye="_footerLink_1ggtc_399",Ne="_footerDivider_1ggtc_420",Be="_footerVersion_1ggtc_424",s={authPage:se,container:te,content:ae,errorAlert:oe,socialButtons:ne,divider:ie,emailButton:re,privacyNote:le,emailForm:ce,inputGroup:ue,label:de,input:ge,submitButton:he,spinner:me,toggleMode:pe,backButton:_e,forgotPasswordLink:fe,forgotPasswordText:xe,successMessage:we,migrationBanner:be,migrationLink:ve,footer:je,footerLinks:ke,footerLink:ye,footerDivider:Ne,footerVersion:Be},Le=()=>{const t=T(),{user:o}=U(),[n,d]=r.useState(null),[x,a]=r.useState(null),[S,k]=r.useState(!1),[m,A]=r.useState(!1),[g,w]=r.useState(""),[b,F]=r.useState(""),[h,_]=r.useState(!1),[L,f]=r.useState(!1),[M,y]=r.useState(!1),[N,I]=r.useState(null);D(!1),r.useEffect(()=>{H().then(I)},[]),r.useEffect(()=>{o&&t("/")},[o,t]);const B=async i=>{a(null),d(i);try{switch(i){case"apple":await l.signInWithApple();break;case"google":await l.signInWithGoogle();break;case"facebook":await l.signInWithFacebook();break;default:throw new Error("Unknown provider")}}catch(p){a(l.getErrorMessage(p))}finally{d(null)}},W=async i=>{i.preventDefault(),a(null),_(!0);try{m?await l.createAccountWithEmail(g,b):await l.signInWithEmail(g,b)}catch(p){a(l.getErrorMessage(p))}finally{_(!1)}},z=async i=>{i.preventDefault(),a(null),_(!0);try{if(!g){a("Please enter your email address");return}await l.sendPasswordResetEmail(g),y(!0)}catch(p){a(l.getErrorMessage(p))}finally{_(!1)}};return e.jsxs("div",{className:`screen app-gradient-bg ${s.authPage}`,children:[e.jsx(q,{}),e.jsxs("div",{className:s.container,children:[e.jsxs("div",{className:s.migrationBanner,children:[e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"})}),e.jsxs("span",{children:["Have an existing account?"," ",e.jsx("button",{type:"button",className:s.migrationLink,onClick:()=>t("/migrate"),children:"Migrate your account"})]})]}),e.jsxs("div",{className:s.content,children:[x&&e.jsxs("div",{className:s.errorAlert,children:[e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"})}),e.jsx("span",{children:x})]}),S?L?e.jsx(e.Fragment,{children:M?e.jsxs("div",{className:s.successMessage,children:[e.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),e.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),e.jsx("h3",{children:"Check your email"}),e.jsxs("p",{children:["We've sent a password reset link to ",e.jsx("strong",{children:g})]}),e.jsx("button",{type:"button",className:s.backButton,onClick:()=>{f(!1),y(!1),w("")},children:"← Back to sign in"})]}):e.jsxs("form",{onSubmit:z,className:s.emailForm,children:[e.jsx("p",{className:s.forgotPasswordText,children:"Enter your email address and we'll send you a link to reset your password."}),e.jsxs("div",{className:s.inputGroup,children:[e.jsx("label",{htmlFor:"reset-email",className:s.label,children:"Email"}),e.jsx("input",{id:"reset-email",type:"email",value:g,onChange:i=>w(i.target.value),className:s.input,placeholder:"your@email.com",required:!0,autoComplete:"email",autoFocus:!0})]}),e.jsx("button",{type:"submit",className:s.submitButton,disabled:h,children:h?e.jsx("div",{className:s.spinner}):"Send reset link"}),e.jsx("button",{type:"button",className:s.backButton,onClick:()=>{f(!1),a(null)},disabled:h,children:"← Back to sign in"})]})}):e.jsx(e.Fragment,{children:e.jsxs("form",{onSubmit:W,className:s.emailForm,children:[e.jsxs("div",{className:s.inputGroup,children:[e.jsx("label",{htmlFor:"email",className:s.label,children:"Email"}),e.jsx("input",{id:"email",name:"username",type:"email",value:g,onChange:i=>w(i.target.value),className:s.input,placeholder:"your@email.com",required:!0,autoComplete:"username",autoFocus:!0})]}),e.jsxs("div",{className:s.inputGroup,children:[e.jsx("label",{htmlFor:"password",className:s.label,children:"Password"}),e.jsx("input",{id:"password",name:"password",type:"password",value:b,onChange:i=>F(i.target.value),className:s.input,placeholder:"••••••••",required:!0,autoComplete:m?"new-password":"current-password",minLength:"6"}),!m&&e.jsx("button",{type:"button",className:s.forgotPasswordLink,onClick:()=>f(!0),children:"Forgot password?"})]}),e.jsx("button",{type:"submit",className:s.submitButton,disabled:h,children:h?e.jsx("div",{className:s.spinner}):m?"Create Account":"Sign In"}),e.jsx("button",{type:"button",className:s.toggleMode,onClick:()=>A(!m),disabled:h,children:m?"Already have an account? Sign in":"Need an account? Sign up"}),e.jsx("button",{type:"button",className:s.backButton,onClick:()=>{k(!1),f(!1),a(null)},disabled:h,children:"← Back to all sign-in options"})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:s.socialButtons,children:[e.jsx(P,{provider:"google",onClick:()=>B("google"),disabled:n!==null,loading:n==="google"}),e.jsx(P,{provider:"facebook",onClick:()=>B("facebook"),disabled:n!==null,loading:n==="facebook"})]}),e.jsx("p",{className:s.privacyNote,children:"We only access your email address"}),e.jsx("div",{className:s.divider,children:e.jsx("span",{children:"or"})}),e.jsxs("button",{type:"button",className:s.emailButton,onClick:()=>k(!0),disabled:n!==null,children:[e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("rect",{x:"3",y:"5",width:"18",height:"14",rx:"2"}),e.jsx("path",{d:"M3 7l9 6 9-6"})]}),e.jsx("span",{children:"Continue with Email"})]})]})]}),e.jsxs("div",{className:s.footer,children:[e.jsxs("div",{className:s.footerLinks,children:[e.jsx("button",{onClick:()=>E(`${C}/terms`),className:s.footerLink,children:"Terms of Service"}),e.jsx("span",{className:s.footerDivider,children:"•"}),e.jsx("button",{onClick:()=>E(`${C}/privacy`),className:s.footerLink,children:"Privacy Policy"})]}),N&&e.jsx("div",{className:s.footerVersion,children:N.display})]})]})]})};export{Le as default};
