import{u as e,j as a,a as r,A as t}from"./index-yrjwo6er.js";import{r as s,u as n}from"./vendor-D3vErxIQ.js";import{u as o}from"./useGamepadNavigation-Tj-O-nX_.js";import{A as i}from"./AppHeader-rUQErDwv.js";import"./audio-D4HOgbU8.js";import"./socket-DfKCw8Ob.js";const l="_authForm_1wx71_1",u="_errorAlert_1wx71_95",c=({onSubmit:r,mode:t})=>{const[n,o]=s.useState(""),[i,c]=s.useState(""),[d,m]=s.useState(""),p=s.useRef(null),h=s.useRef(null),{enhanceInput:g}=e();s.useEffect((()=>{let e,a;return p.current&&(e=g(p.current,"text","Enter Username")),h.current&&(a=g(h.current,"password","Enter Password")),()=>{e&&e(),a&&a()}}),[g]);return a.jsxs("div",{className:`card ${l}`,children:[a.jsx("h2",{style:{color:"var(--text-primary)",fontWeight:600,textAlign:"center",marginTop:0},children:"login"===t?"Welcome Back":"Create Account"}),a.jsx("div",{className:"divider",style:{marginBottom:"1.5rem"}}),d&&a.jsx("div",{className:u,children:d}),a.jsxs("form",{onSubmit:async e=>{e.preventDefault(),m("");try{await r(n,i)}catch(a){m(a.message)}},children:[a.jsxs("div",{className:"input-group",children:[a.jsx("label",{htmlFor:"username",className:"input-label required",children:"Username"}),a.jsx("input",{ref:p,id:"username",type:"text",className:"no-validation",placeholder:"Enter your username",value:n,onChange:e=>o(e.target.value),required:!0,minLength:3,"data-gamepad-focusable":"true",autoCapitalize:"none",autoCorrect:"off",autoComplete:"username"})]}),a.jsxs("div",{className:"input-group",children:[a.jsx("label",{htmlFor:"password",className:"input-label required",children:"Password"}),a.jsx("input",{ref:h,id:"password",type:"password",className:"no-validation",placeholder:"Enter your password",value:i,onChange:e=>c(e.target.value),required:!0,minLength:6,"data-gamepad-focusable":"true",autoComplete:"login"===t?"current-password":"new-password"})]}),a.jsx("button",{type:"submit",className:"btn btn-primary","data-gamepad-focusable":"true",children:"login"===t?"Sign In":"Create Account"})]})]})},d="_authPage_1tu3k_1",m="_error_1tu3k_21",p="_formContainer_1tu3k_34",h="_toggleContainer_1tu3k_98",g="_toggleButton_1tu3k_103",f=()=>{const[e,l]=s.useState("login"),{login:u}=r(),f=n();o(!0);const[j,v]=s.useState(null);return a.jsxs("div",{className:`screen ${d}`,children:[a.jsx(i,{}),a.jsxs("div",{className:p,children:[j&&a.jsx("div",{className:m,children:j}),a.jsx(c,{mode:e,onSubmit:async(a,r)=>{if(!a||!r)return void v("Username and password are required");v(null);const s=`${t}/auth/${e}`;try{const e={username:a,password:r},t=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});let o;try{o=await t.json()}catch(n){throw new Error("Invalid response from server")}if(!t.ok)throw new Error(o.message||"Authentication failed");if(!o.user?.username||!o.user?.id||!o.token)throw new Error("Invalid server response format");try{u(o.user,o.token),f("/")}catch(n){throw new Error("Failed to initialize user session")}}catch(n){v(n.message||"Failed to connect to server")}}}),a.jsx("div",{className:h,children:a.jsx("button",{className:g,onClick:()=>l("login"===e?"register":"login"),"data-gamepad-focusable":"true",children:"login"===e?"Don't have an account? Register":"Already have an account? Login"})})]})]})};export{f as default};
