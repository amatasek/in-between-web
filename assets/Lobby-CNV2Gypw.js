import{j as e,u as s,I as a}from"./ui-D6NhbJM_.js";import{r as t,u as n}from"./vendor--mFYx9eN.js";import{a as r,b as i,u as l,B as o,c,d as m,s as d}from"./index-DAqpCjzk.js";import{u}from"./useGamepadNavigation-D-XLtfPQ.js";import{A as h,G as p}from"./AppHeader-BAHraF2A.js";import{C as x,U as g,R as j,P as N,S as _,a as v,b as f,T as b,G as C}from"./GamepadInput-6Zq6i_1i.js";const y="_gameListTitle_1033u_29",w="_searchContainer_1033u_42",I="_searchIcon_1033u_84",S="_gameListWrapper_1033u_89",P="_userDisconnectedGame_1033u_108",B="_userInGame_1033u_115",k="_gameListInfo_1033u_138",G="_gameListId_1033u_143",A="_disconnectedBadge_1033u_152",L="_inGameBadge_1033u_164",O="_gameListPlayers_1033u_176",$="_emptyStateIcon_1033u_243",D="_emptyStateMessage_1033u_249",E="_emptyStateHint_1033u_256",T="_privatePill_1033u_262",W="_gameActionsSection_1033u_275",M="_pill_q09di_1",z="_pulse_q09di_23",q="_text_q09di_49",U=()=>{const{socket:s,isConnected:a}=r(),[n,i]=t.useState(null);return t.useEffect((()=>{if(!s||!a)return;s.emit("getOnlinePlayerCount",(e=>{i(e)}));const e=e=>i(e);return s.on("onlinePlayerCountUpdate",e),()=>{s.off("onlinePlayerCountUpdate",e)}}),[s,a]),null===n?null:e.jsxs("div",{className:M,children:[e.jsx("span",{className:z}),e.jsxs("span",{className:q,children:[n," online"]})]})},F="_balanceSection_1ap8t_1",H="_balanceLabel_1ap8t_10",R="_xpSection_1ap8t_17",J="_xpBarContainer_1ap8t_21",Y="_xpOverlay_1ap8t_31",X="_xpLevel_1ap8t_45",Q="_xpNext_1ap8t_52",V="_xpBar_1ap8t_21",Z=({userId:s,balance:a})=>{const t=i(s);return e.jsxs("div",{className:"panel-alt",style:{width:"100%",flex:2},children:[e.jsxs("div",{className:F,children:[e.jsx("span",{className:H,children:"Balance:"}),e.jsx(x,{amount:Number(a)||0,size:"medium"})]}),t&&e.jsx("div",{className:R,children:e.jsxs("div",{className:J,children:[e.jsx("div",{className:V,style:{width:t.level>=100?"100%":`${t.percentToNextLevel||0}%`}}),e.jsxs("div",{className:Y,children:[e.jsxs("div",{className:X,children:["Level ",t.level]}),e.jsx("div",{className:Q,children:t.level<100?`${t.xpToNextLevel.toLocaleString()} XP`:"MAX"})]})]})})]})},K={userSection:"_userSection_11tfr_2",avatarContainer:"_avatarContainer_11tfr_7",headerButtons:"_headerButtons_11tfr_11",logoutButton:"_logoutButton_11tfr_35"},ee=()=>{const{user:s,logout:a,refreshUserData:n}=l(),[r,i]=t.useState(!1);return e.jsxs("div",{style:{width:"100%"},children:[e.jsxs("div",{className:`panel ${K.userSection}`,children:[e.jsx("div",{className:K.avatarContainer,children:e.jsx(g,{userId:s?.id,size:"medium",showName:!0,namePosition:"right"})}),e.jsx(Z,{userId:s?.id,balance:s?.balance}),e.jsxs("div",{className:K.headerButtons,children:[e.jsx("button",{className:K.logoutButton,onClick:a,"data-gamepad-focusable":"true",children:e.jsx("span",{className:K.buttonText,children:"Logout"})}),e.jsx(j,{"data-gamepad-focusable":"true"}),e.jsx(N,{"data-gamepad-focusable":"true"}),e.jsx(_,{onClick:()=>i(!0),"data-gamepad-focusable":"true"}),e.jsx(v,{"data-gamepad-focusable":"true"})]})]}),r&&e.jsx(f,{onClose:()=>{i(!1),n&&n()}})]})},se=({className:s="",width:a="1em",height:t="1em",...n})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`feather feather-lock ${s}`,width:a,height:t,...n,children:[e.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),e.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]});function ae({game:s,onJoin:a,userId:t}){const n=s.settings?.customName||`Game ${s.id}`,r=s.disconnectedPlayers?.some((e=>e.userId===t)),i=s.allPlayers?.some((e=>e.userId===t&&!e.disconnected));let l="Join";r?l="Reconnect":i&&(l="Continue");let o="panel";return r?o+=` ${P}`:i&&(o+=` ${B}`),e.jsxs("div",{className:o,style:{marginBottom:"0.75rem",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"nowrap",fontSize:"1rem",padding:"0.75rem 1rem"},children:[" ",e.jsxs("div",{className:k,style:{flex:1},children:[e.jsxs("div",{className:G,children:[" ",n,s.settings?.isPrivate&&e.jsxs("span",{className:T,title:"Private Game",children:[e.jsx(se,{width:"0.9em",height:"0.9em",style:{marginRight:"4px",verticalAlign:"middle"}}),"Private"]}),r&&e.jsx("span",{className:A,title:"You're disconnected from this game",children:"⚠️ Reconnect"}),i&&e.jsx("span",{className:L,title:"You're in this game",children:"You're In"})]}),e.jsxs("div",{className:O,children:[" ",s.playerCount," ",1===s.playerCount?"player":"players"]})]}),e.jsx("button",{className:"btn btn-primary",style:{padding:"0.4rem 1rem",fontSize:"0.9rem",minWidth:"80px",maxWidth:"100px",flexShrink:0},onClick:()=>a(s.id),disabled:!t,"data-gamepad-focusable":"true",children:l})]})}const te={useCustomName:!1,customName:"",isPrivate:!1,password:"",enableAceChoice:!0,enableSecondChance:!0,numberOfBots:0},ne=({initialSettings:s=te,onSubmit:a,onClose:n})=>{const[r,i]=t.useState({...te,...s}),[l,m]=t.useState({}),d=(e,s)=>{i((a=>{const t={...a,[e]:s};return"useCustomName"!==e||s||(t.customName="",l.customName&&m((e=>{const s={...e};return delete s.customName,s}))),"isPrivate"!==e||s||(t.password="",l.password&&m((e=>{const s={...e};return delete s.password,s}))),t})),"customName"!==e&&"useCustomName"!==e||!l.customName||m((e=>{const s={...e};return delete s.customName,s})),"password"!==e&&"isPrivate"!==e||!l.password||m((e=>{const s={...e};return delete s.password,s})),"numberOfBots"===e&&l.numberOfBots&&m((e=>{const s={...e};return delete s.numberOfBots,s}))};return e.jsx(o,{title:"Game Options",onClose:n,style:{maxWidth:600},footer:e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("button",{type:"button",onClick:n,className:"btn btn-secondary","data-gamepad-focusable":"true",children:"Cancel"}),e.jsx("button",{type:"submit",form:"gameSettingsForm",className:"btn btn-primary",disabled:Object.keys(l).length>0,"data-gamepad-focusable":"true",children:"Create Game"})]}),children:e.jsx("form",{id:"gameSettingsForm",onSubmit:e=>{e.preventDefault();const s=(e=>{const s={};if(e.useCustomName){const a=e.customName||"";a?a.length<4||a.length>26?s.customName="Name must be 4-26 characters.":/^[a-zA-Z0-9_-]+$/.test(a)||(s.customName="Use letters, numbers, -, or _."):s.customName="Custom name is required."}if(e.isPrivate){const a=e.password||"";a?(a.length<3||a.length>36)&&(s.password="Password must be 3-36 characters."):s.password="Password is required."}const a=e.numberOfBots;return(a<0||a>16)&&(s.numberOfBots="Number of bots must be between 0 and 16."),s})(r);if(Object.keys(s).length>0)m(s);else{m({});const e={...r,customName:r.useCustomName?r.customName:null};delete e.useCustomName,a(e)}},children:e.jsxs("div",{className:c.settingsContainer,children:[e.jsxs("div",{className:c.settingItem,children:[e.jsxs("div",{className:c.settingDescription,children:[e.jsx("h4",{children:"Custom Game Name"}),e.jsx("p",{children:"Set a custom name for your game lobby"})]}),e.jsxs("div",{className:c.settingControls,children:[e.jsx(b,{isChecked:r.useCustomName,onChange:e=>d("useCustomName",e.target.checked)}),r.useCustomName&&e.jsx(C,{title:"Enter Game Name",type:"text",value:r.customName||"",onChange:e=>d("customName",e.target.value),className:`${c.textInput}${l.customName?" "+c.inputError:""}`,placeholder:"Game Name",maxLength:26,autoFocus:!0,style:{marginTop:8}}),l.customName&&e.jsx("span",{className:"errorMessage",children:l.customName})]})]}),e.jsxs("div",{className:c.settingItem,children:[e.jsxs("div",{className:c.settingDescription,children:[e.jsx("h4",{children:"Private Game"}),e.jsx("p",{children:"Only players with the password can join"})]}),e.jsxs("div",{className:c.settingControls,children:[e.jsx(b,{isChecked:r.isPrivate,onChange:e=>d("isPrivate",e.target.checked)}),r.isPrivate&&e.jsx(C,{title:"Enter Game Password",type:"password",value:r.password||"",onChange:e=>d("password",e.target.value),className:`${c.textInput}${l.password?" "+c.inputError:""}`,placeholder:"Password",maxLength:36,autoFocus:r.isPrivate&&!r.useCustomName,style:{marginTop:8}}),l.password&&e.jsx("span",{className:"errorMessage",children:l.password})]})]}),e.jsxs("div",{className:c.settingItem,children:[e.jsxs("div",{className:c.settingDescription,children:[e.jsx("h4",{children:"Number of Bots"}),e.jsx("p",{children:"Add AI players to your game (0-16)"})]}),e.jsxs("div",{className:c.settingControls,children:[e.jsx(C,{title:"Number of AI Players",type:"number",min:"0",max:"16",value:r.numberOfBots,onChange:e=>d("numberOfBots",parseInt(e.target.value)||0),className:`${c.textInput}${l.numberOfBots?" "+c.inputError:""}`}),l.numberOfBots&&e.jsx("span",{className:"errorMessage",children:l.numberOfBots})]})]}),e.jsxs("div",{className:c.settingItem,children:[e.jsxs("div",{className:c.settingDescription,children:[e.jsx("h4",{children:"Enable Ace Choice"}),e.jsx("p",{children:"Allow players to choose high/low on Ace"})]}),e.jsx("div",{className:c.settingControls,children:e.jsx(b,{isChecked:r.enableAceChoice,onChange:e=>d("enableAceChoice",e.target.checked)})})]}),e.jsxs("div",{className:c.settingItem,children:[e.jsxs("div",{className:c.settingDescription,children:[e.jsx("h4",{children:"Enable Second Chance"}),e.jsx("p",{children:"Allow players to ante up for a second chance"})]}),e.jsx("div",{className:c.settingControls,children:e.jsx(b,{isChecked:r.enableSecondChance,onChange:e=>d("enableSecondChance",e.target.checked)})})]})]})})})},re=()=>{const{gameList:i}=m(),{user:o,logout:c}=l(),{socket:x,isConnected:g}=r();u(!0);const j=n(),[N,_]=t.useState(""),[v,f]=t.useState(!1),b=s("(max-width:400px)"),C=o?.username?`user_${o.username}`:null;t.useEffect((()=>{o&&(o.username&&o.id||c())}),[o,c]);const P=e=>{g&&o&&(d.play("ui.click"),j(`/${e}`))},B=e=>{if(!o?.id||!g)return;const s=e=>{x.off("gameCreated",s),e?.game?.id&&j(`/${e.game.id}`)};x.on("gameCreated",s),e?x.emit("createGame",{settings:e}):x.emit("createGame")},k=t.useMemo((()=>{if(!i)return[];let e=i;if(N.trim()){const s=N.trim().toLowerCase();e=i.filter((e=>e.id.toLowerCase().includes(s)))}return e.sort(((e,s)=>{const a=e.allPlayers?.some((e=>e.userId===C)),t=s.allPlayers?.some((e=>e.userId===C)),n=e.disconnectedPlayers?.some((e=>e.userId===C)),r=s.disconnectedPlayers?.some((e=>e.userId===C));return n&&!r?-1:!n&&r?1:a&&!t?-1:!a&&t?1:e.id.localeCompare(s.id)}))}),[i,N,C]);return e.jsxs("div",{className:"screen",children:[e.jsx(h,{}),e.jsx("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginTop:"1.1em",marginBottom:"-0.6em"},children:e.jsx(U,{})}),e.jsxs("div",{className:"card",style:{width:"100%",maxWidth:"600px",marginBottom:"2rem"},children:[e.jsx(ee,{}),e.jsx("div",{className:"divider"}),e.jsxs("div",{className:W,children:[e.jsx("button",{className:"btn btn-primary",onClick:()=>B({numberOfBots:5}),disabled:!o?.username,"data-gamepad-focusable":"true",children:"Create Quick Game"}),e.jsx("button",{className:"btn btn-primary",onClick:()=>{f(!0)},disabled:!o?.username,"data-gamepad-focusable":"true",children:"Create Custom Game"})]})]}),e.jsxs("div",{className:"card",style:{width:"100%",maxWidth:"600px",minHeight:"200px"},children:[e.jsx("h2",{className:y,children:"Available Games"}),e.jsx("div",{className:w,children:e.jsx(p,{title:"Search Games",placeholder:"Search games by ID",variant:"outlined",fullWidth:!0,value:N,onChange:e=>{_(e.target.value)},size:b?"small":"medium",type:"text",InputProps:{startAdornment:e.jsx(a,{position:"start",children:e.jsx("span",{className:I,children:"🔍"})})}})}),k&&k.length>0?e.jsx("div",{className:S,children:k.map((s=>e.jsx(ae,{game:s,onJoin:P,userId:C},s.id)))}):e.jsxs("div",{className:"panel-alt",style:{textAlign:"center",padding:"2rem",minHeight:"150px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[e.jsx("div",{className:$,children:"🃏"}),e.jsx("p",{className:D,children:N.trim()?"No matching games found":"No games in progress"}),e.jsx("p",{className:E,children:N.trim()?"Try a different search or create a new game":"Create a new game to get started!"})]})]}),v&&e.jsx(ne,{onSubmit:e=>{f(!1),B(e)},onClose:()=>f(!1)})]})};export{re as default};
