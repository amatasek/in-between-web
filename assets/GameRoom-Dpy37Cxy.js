import{b as e,a,s,j as t,e as n,U as r,L as l}from"./index-BGl51GMi.js";import{r as i,e as c,u as o}from"./vendor-D3vErxIQ.js";import{C as d,a as u,R as m,P as _,S as h,I as p,c as x,b as j,g,G as N,d as v,U as b}from"./GamepadInput-COlpLOBl.js";import{u as y}from"./useGamepadNavigation-Tj-O-nX_.js";import"./audio-D4HOgbU8.js";import"./socket-DfKCw8Ob.js";const f="♥",C="♦",k="♣",w="♠",T="→",A="↑",I="↓",S="↻",$="✓",P="✕",{TIMERS:E}={TIMERS:{BETTING_DURATION:3e4,DECISION_DURATION:15e3}},B=i.createContext(),L=()=>{const e=i.useContext(B);if(void 0===e)throw new Error("useGameContext must be used within a GameProvider");return e},R=({children:n,gameId:r,initialGameState:l=null})=>{const{socket:c,error:o}=e(),{user:d}=a(),[u,m]=i.useState(l);i.useRef({});const _=i.useRef(null),[h,p]=i.useState(null),x=i.useCallback((()=>{p(null)}),[]);i.useEffect((()=>{o&&p(o)}),[o]),i.useEffect((()=>{if(c)return c.on("gameReconnected",(e=>{m(e.game),p(null),e.game&&e.game.id&&setTimeout((()=>{c.emit("getGameState",{gameId:e.game.id})}),500)})),c.on("gameState",(e=>{if(e&&e.id&&JSON.stringify(u)!==JSON.stringify(e)){if(e.currentPlayerId&&d?.id){const a=e.currentPlayerId===d.id,t=_.current===d.id;a&&!t&&s.play("ui.alert"),_.current=e.currentPlayerId}m(e),x()}})),c.on("gameError",(e=>{p(e)})),()=>{c.off("gameReconnected"),c.off("gameState"),c.off("gameError")}}),[c]);const j=i.useCallback((e=>{if(c&&r)try{c.emit("placeBet",{bet:e,gameId:r})}catch(a){p("Failed to place bet. Please try again.")}}),[c,r]),g=i.useCallback((()=>{if(c&&r)try{c.emit("payAnte",{gameId:r})}catch(e){p("Failed to pay ante. Please try again.")}}),[c,r]),N=i.useCallback((()=>{if(c&&r)try{c.emit("dealCards",{gameId:r})}catch(e){p("Failed to deal cards. Please try again.")}}),[c,r]),v=i.useCallback((()=>{if(c&&r)try{c.emit("revealMiddleCard",{gameId:r})}catch(e){p("Failed to reveal middle card. Please try again.")}}),[c,r]),b=i.useCallback((()=>{if(c&&r)try{c.emit("nextRound",{gameId:r})}catch(e){p("Failed to move to next round. Please try again.")}}),[c,r]),y=i.useCallback((()=>{if(c&&r)try{c.emit("ready")}catch(e){p("Failed to set player ready. Please try again.")}}),[c,r]),f=i.useCallback((()=>{if(c&&r)try{c.emit("unready")}catch(e){p("Failed to set player unready. Please try again.")}}),[c,r]),C={gameState:u,error:h,gameId:r,placeBet:j,payAnte:g,playerReady:y,playerUnready:f,dealCards:N,revealMiddleCard:v,nextRound:b,clearError:x};return t.jsx(B.Provider,{value:C,children:n})},O="_gameContainer_1kxnm_1",D="_gameScreen_1kxnm_6",M="_loadingContainer_1kxnm_41",z="_errorContainer_1kxnm_50",F="_errorText_1kxnm_66",q="_gameBottomSection_1kxnm_95",G="_headerContainer_1ki61_1",Y="_header_1ki61_1",U="_headerLeft_1ki61_30",H="_gameTitle_1ki61_39",W="_liveTag_1ki61_50",V="_gameIdText_1ki61_68",J="_gameIdLink_1ki61_75",K="_headerRight_1ki61_88",Q="_controlsStack_1ki61_94",X="_balanceDisplay_1ki61_101",Z="_balanceLabel_1ki61_114",ee="_controlsGroup_1ki61_120",ae=({color:e="currentColor",size:a=24})=>t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:a,height:a,viewBox:"0 0 24 24",fill:"none",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),t.jsx("polyline",{points:"16 17 21 12 16 7"}),t.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),se=({handleLeaveGame:s,onModalStateChange:n})=>{const{gameState:r,gameId:l}=L(),{socket:c}=e(),{user:o}=a(),g=c?.auth?.userId,N=g&&r?.players?r.players[g]:null,v=N?.balance??o?.balance??0,b=N?.isReady||!1,[y,f]=i.useState(!1),[C,k]=i.useState(!1),[w,T]=i.useState(!1),[A,I]=i.useState(!1),[S,$]=i.useState(!1);return i.useEffect((()=>{n&&n(y||C||w||A||S)}),[y,C,w,A,S,n]),t.jsxs("div",{className:G,children:[t.jsxs("div",{className:Y,children:[t.jsxs("div",{className:U,children:[t.jsxs("h1",{className:H,children:["In Between ",t.jsx("span",{className:W,children:"LIVE"})]}),t.jsx("p",{className:V,children:t.jsxs("span",{className:J,onClick:()=>f(!0),title:"Click to view game summary","data-gamepad-focusable":"true",tabIndex:"0",children:["Game #",l]})})]}),t.jsx("div",{className:K,children:t.jsxs("div",{className:Q,children:[t.jsxs("div",{className:X,children:[t.jsx("span",{className:Z,children:"Balance:"}),t.jsx(d,{amount:Number(v),size:"small"})]}),t.jsxs("div",{className:ee,children:[t.jsx(u,{onModalStateChange:T,"data-gamepad-focusable":"true"}),t.jsx(m,{onModalStateChange:I,"data-gamepad-focusable":"true"}),t.jsx(_,{onModalStateChange:$,"data-gamepad-focusable":"true"}),t.jsx(h,{onClick:()=>k(!0),"data-gamepad-focusable":"true"}),t.jsx(p,{icon:t.jsx(ae,{color:"white",size:20}),title:"Leave Game",onClick:s,variant:"danger",disabled:b,"data-gamepad-focusable":"true"})]})]})})]}),y&&t.jsx(x,{onClose:()=>f(!1),gameData:r}),C&&t.jsx(j,{onClose:()=>k(!1)})]})},te={table:"_table_1c3a2_2",feltTexture:"_feltTexture_1c3a2_75",sitOutOverlay:"_sitOutOverlay_1c3a2_104"},ne={cardsRow:"_cardsRow_12pga_1",card:"_card_12pga_1",dealingPhase:"_dealingPhase_12pga_74",revealingPhase:"_revealingPhase_12pga_83",cardBack:"_cardBack_12pga_109",redCard:"_redCard_12pga_119",blackCard:"_blackCard_12pga_123",cardCorner:"_cardCorner_12pga_127",bottomRight:"_bottomRight_12pga_136",cardValue:"_cardValue_12pga_144",cardSuit:"_cardSuit_12pga_150",cardCenter:"_cardCenter_12pga_155",aceCard:"_aceCard_12pga_212",aceIndicator:"_aceIndicator_12pga_216",aceHigh:"_aceHigh_12pga_236",aceLow:"_aceLow_12pga_242",indicatorContent:"_indicatorContent_12pga_248"},re=()=>{const{gameState:e}=L(),[a,s]=i.useState(g());if(i.useEffect((()=>{const e=()=>{s(g())};return window.addEventListener("cardbackchange",e),()=>window.removeEventListener("cardbackchange",e)}),[]),!e)return t.jsx("div",{className:ne.loading,children:"Loading game state..."});const{firstCard:n,secondCard:r,thirdCard:l,phase:c,dealer:o}=e,d={2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10",J:"J",Q:"Q",K:"K",A:"A"},u={hearts:f,diamonds:C,clubs:k,spades:w,[f]:f,[C]:C,[k]:k,[w]:w},m=(e,s)=>{if(!e)return t.jsx("div",{className:ne.card,children:t.jsx("div",{className:ne.cardBack,style:{backgroundImage:`url(${a})`}})},`empty-${s}`);const n=(e=>e===f||e===C||"hearts"===e||"diamonds"===e)(e.suit),r="A"===e.value,l=e.isAceLow,i=1===s;return t.jsxs("div",{className:`${ne.card} ${n?ne.redCard:ne.blackCard} ${r?ne.aceCard:""}`,children:[r&&!i&&t.jsx("div",{className:`${ne.aceIndicator} ${l?ne.aceLow:ne.aceHigh} ${n?ne.redCard:ne.blackCard}`,children:l?t.jsxs("span",{className:ne.indicatorContent,children:["LOW ",I]}):t.jsxs("span",{className:ne.indicatorContent,children:["HIGH ",A]})}),t.jsxs("div",{className:ne.cardCorner,children:[t.jsx("div",{className:ne.cardValue,children:d[e.value]}),t.jsx("div",{className:ne.cardSuit,children:u[e.suit]})]}),t.jsx("div",{className:ne.cardCenter,children:u[e.suit]}),t.jsxs("div",{className:`${ne.cardCorner} ${ne.bottomRight}`,children:[t.jsx("div",{className:ne.cardValue,children:d[e.value]}),t.jsx("div",{className:ne.cardSuit,children:u[e.suit]})]})]},`${e.value}-${e.suit}-${s}`)};return t.jsx("div",{className:`${ne.cardsRow} ${"dealing"===c?ne.dealingPhase:""} ${"revealing"===c?ne.revealingPhase:""}`,children:(()=>{let e=[null,null,null];return n||r||l?(n&&(e[0]={...n}),r&&(e[2]={...r}),l&&(e[1]={...l}),e.map(((e,a)=>m(e,a)))):e.map(((e,a)=>m(e,a)))})()})},le="_potDisplay_1o95d_2",ie="_potLabel_1o95d_18",ce=()=>{const{gameState:e}=L();if(!e)return null;const{pot:a=0}=e;return t.jsxs("div",{className:le,children:[t.jsx("span",{className:ie,children:"POT"}),t.jsx(d,{amount:a,size:"large"})]})},oe="_aceOverlay_1apr0_2",de="_cardGlow_1apr0_14",ue="_countdownRing_1apr0_24",me="_countdownCircle_1apr0_34",_e="_choiceButton_1apr0_43",he="_highButton_1apr0_74",pe="_lowButton_1apr0_85",xe="_timerDisplay_1apr0_96",je="_waitingMessage_1apr0_109",ge="_aceControlsBottom_1apr0_136",Ne="_timerContainer_1apr0_150",ve="_aceButtonContainer_1apr0_158",be="_choicePrompt_1apr0_165",ye="_bottomChoiceButton_1apr0_174",fe="_lowButtonBottom_1apr0_200",Ce="_highButtonBottom_1apr0_210",ke=({direction:e="up",color:a="currentColor",size:s=24})=>{const n="down"===e?"rotate(180deg)":"rotate(0deg)";return t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:a,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{transform:n,display:"inline-block",transformOrigin:"center"},children:t.jsx("path",{d:"M7 11l5-5 5 5M7 17l5-5 5 5"})})},we="_waitingTimer_egezv_2",Te="_timerContent_egezv_16",Ae="_playerName_egezv_23",Ie="_action_egezv_29",Se="_timerBar_egezv_35",$e="_timerProgress_egezv_43",Pe=({playerName:e,action:a="deciding",duration:s=15e3})=>{const[n,r]=i.useState(s),l=i.useRef(Date.now());i.useEffect((()=>{l.current=Date.now(),r(s)}),[s]),i.useEffect((()=>{const e=setInterval((()=>{const a=Date.now()-l.current,t=Math.max(0,s-a);r(t),t<=0&&clearInterval(e)}),100);return()=>clearInterval(e)}),[s]);const c=(s-n)/s*100;return t.jsxs("div",{className:`panel-game ${we}`,children:[t.jsxs("div",{className:Te,children:[t.jsx("span",{className:Ae,children:e}),t.jsxs("span",{className:Ie,children:["is ",a,"..."]})]}),t.jsx("div",{className:Se,children:t.jsx("div",{className:$e,style:{width:`${c}%`}})})]})},Ee="_countdownTimer_1r3bp_3",Be="_progressRing_1r3bp_19",Le="_progressRingBackground_1r3bp_25",Re="_progressRingCircle_1r3bp_31",Oe="_timeDisplay_1r3bp_40",De=({duration:e=15,isActive:a=!0})=>{const[s,n]=i.useState(e),r=i.useRef(Date.now());i.useEffect((()=>{a&&(r.current=Date.now(),n(e))}),[e,a]),i.useEffect((()=>{if(!a)return;const s=setInterval((()=>{const a=Math.floor((Date.now()-r.current)/1e3),t=Math.max(0,e-a);n(t),t<=0&&clearInterval(s)}),100);return()=>clearInterval(s)}),[e,a]);const l=s/e*100,c=50,o=44*Math.PI,d=o-l/100*o;return t.jsxs("div",{className:Ee,children:[t.jsxs("svg",{className:Be,width:c,height:c,viewBox:"0 0 50 50",children:[t.jsx("circle",{className:Le,cx:25,cy:25,r:22,strokeWidth:3}),t.jsx("circle",{className:Re,cx:25,cy:25,r:22,strokeWidth:3,strokeDasharray:`${o} ${o}`,strokeDashoffset:d,style:{stroke:(()=>{const a=s/e*100;return a>66?"var(--color-ready)":a>33?"var(--accent)":"var(--secondary)"})()}})]}),t.jsxs("div",{className:Oe,children:[s,"s"]})]})},Me=({card:a,isCurrentPlayersTurn:s,bottomPosition:n=!1})=>{const{socket:r}=e(),{gameState:l}=L(),[c,o]=i.useState(null),d=e=>{null===c&&(o(e),r.emit("chooseAceValue",{isAceLow:e}))},u=l.players[l.currentPlayerId]?.name||"Current player";return n?s?t.jsxs("div",{className:`panel-game ${ge}`,children:[t.jsx("div",{className:Ne,children:t.jsx(De,{duration:15,isActive:!0})}),t.jsxs("div",{className:ve,children:[t.jsx("span",{className:be,children:"ACE VALUE:"}),t.jsxs("button",{className:`${ye} ${fe}`,onClick:()=>d(!0),disabled:null!==c,"data-gamepad-focusable":"true",autoFocus:!0,children:[t.jsx(ke,{direction:"down",size:16}),t.jsx("span",{children:"LOW"})]}),t.jsxs("button",{className:`${ye} ${Ce}`,onClick:()=>d(!1),disabled:null!==c,"data-gamepad-focusable":"true",children:[t.jsx("span",{children:"HIGH"}),t.jsx(ke,{direction:"up",size:16})]})]})]}):t.jsx(Pe,{playerName:u,action:"choosing ace value",duration:E.DECISION_DURATION}):t.jsxs("div",{className:oe,children:[t.jsx("div",{className:de}),s&&t.jsx("svg",{className:ue,children:t.jsx("circle",{className:me,cx:"60",cy:"87",r:"80",style:{strokeDasharray:countdown/15*502+" 502"}})}),s?t.jsxs(t.Fragment,{children:[t.jsxs("button",{className:`${_e} ${he}`,onClick:()=>d(!1),disabled:null!==c,"data-gamepad-focusable":"true",autoFocus:!0,children:[t.jsx(ke,{direction:"up",size:20}),t.jsx("span",{children:"HIGH"})]}),t.jsxs("button",{className:`${_e} ${pe}`,onClick:()=>d(!0),disabled:null!==c,"data-gamepad-focusable":"true",children:[t.jsx("span",{children:"LOW"}),t.jsx(ke,{direction:"down",size:20})]}),t.jsxs("div",{className:xe,children:[countdown,"s"]})]}):t.jsxs("div",{className:je,children:[u," is choosing..."]})]})},ze="_bettingOverlay_1q32g_2",Fe="_timerContainer_1q32g_26",qe="_betButton_1q32g_57",Ge="_passButton_1q32g_84",Ye="_amountButton_1q32g_96",Ue="_customButton_1q32g_108",He="_amountPill_1q32g_120",We="_potButtonWrapper_1q32g_137",Ve="_customInput_1q32g_142",Je="_betInput_1q32g_152",Ke="_confirmButton_1q32g_172",Qe="_cancelButton_1q32g_173",Xe="_potButton_1pkys_3",Ze="_glowEffect_1pkys_37",ea="_potLabel_1pkys_53",aa="_currencyPill_1pkys_63",sa="_disabled_1pkys_102",ta=({amount:e,disabled:a,onClick:s,...n})=>t.jsxs("button",{className:`${Xe} ${a?sa:""}`,onClick:s,disabled:a,"aria-label":`Bet the pot: ${e} chips`,"data-gamepad-focusable":"true",...n,children:[t.jsx("div",{className:Ze}),t.jsx("span",{className:ea,children:"POT"}),t.jsx("div",{className:aa,children:t.jsx(d,{amount:e,size:"small"})})]}),na=({isCurrentPlayersTurn:a})=>{const{gameState:s,placeBet:n}=L(),{socket:r}=e(),[l,c]=i.useState(""),[o,u]=i.useState(!1),[m,_]=i.useState(!1);if(!s||!a)return t.jsx(Pe,{playerName:s?.players[s.currentPlayerId]?.name||"Player",action:"betting",duration:E.BETTING_DURATION});const{pot:h,firstCard:p,secondCard:x,players:j,currentPlayerId:g,anteAmount:v=1}=s,b=j[g],y=b?.balance||0;Math.abs(p.numericValue-x.numericValue);const f="A"===p?.value&&"A"===x?.value?Math.floor(y/3):Math.floor(y/2),C=Math.min(h,f),k=v,w=[1,5,10,20,50,100].filter((e=>e>=k&&e<=C)).slice(-3),T=e=>{m||e>=k&&e<=C&&(_(!0),n(e),u(!1))},A=()=>{const e=parseInt(l);!isNaN(e)&&e>=k&&e<=C&&(T(e),c(""))};return t.jsxs("div",{className:`panel-game ${ze}`,children:[t.jsx("div",{className:Fe,children:t.jsx(De,{duration:30,isActive:!0})}),o?t.jsxs("div",{className:Ve,children:[t.jsx(N,{title:"Enter Custom Bet",type:"number",value:l,onChange:e=>c(e.target.value),onKeyPress:e=>"Enter"===e.key&&A(),placeholder:`${k}-${C}`,min:k,max:C,autoFocus:!0,className:Je}),t.jsx("button",{onClick:A,className:Ke,disabled:m,"data-gamepad-focusable":"true",children:$}),t.jsx("button",{onClick:()=>{u(!1),c("")},className:Qe,disabled:m,"data-gamepad-focusable":"true",children:P})]}):t.jsxs(t.Fragment,{children:[t.jsx("button",{className:`${qe} ${Ge}`,onClick:()=>{m||(_(!0),n(0))},disabled:m,"data-gamepad-focusable":"true",autoFocus:!0,children:t.jsx("span",{children:"PASS"})}),w.map((e=>t.jsx("button",{className:`${qe} ${Ye}`,onClick:()=>T(e),disabled:m,"data-gamepad-focusable":"true",children:t.jsx("div",{className:He,children:t.jsx(d,{amount:e,size:"small"})})},e))),C===h&&t.jsx("div",{className:We,children:t.jsx(ta,{onClick:()=>T(h),disabled:m,amount:h})}),t.jsx("button",{className:`${qe} ${Ue}`,onClick:()=>u(!0),disabled:m,"data-gamepad-focusable":"true",children:t.jsx("span",{children:"CUSTOM"})})]})]})},ra="_secondChanceOverlay_1sq4x_2",la="_bridge_1sq4x_13",ia="_bridgeLine_1sq4x_20",ca="_matchBadge_1sq4x_57",oa="_matchText_1sq4x_69",da="_choiceContainer_1sq4x_78",ua="_timer_1sq4x_87",ma="_buttons_1sq4x_106",_a="_choiceButton_1sq4x_112",ha="_anteButton_1sq4x_139",pa="_passButton_1sq4x_151",xa="_buttonIcon_1sq4x_162",ja="_buttonText_1sq4x_168",ga="_buttonAmount_1sq4x_174",Na="_waitingContainer_1sq4x_180",va="_waitingMessage_1sq4x_187",ba="_secondChanceBottom_1sq4x_229",ya="_timerContainer_1sq4x_243",fa="_bottomButtonContainer_1sq4x_251",Ca="_choicePrompt_1sq4x_258",ka="_bottomChoiceButton_1sq4x_267",wa="_anteButtonBottom_1sq4x_293",Ta="_passButtonBottom_1sq4x_302",Aa=({firstCard:a,secondCard:s,isCurrentPlayersTurn:n,bottomPosition:r=!1,indicatorOnly:l=!1})=>{const{gameState:c}=L(),{socket:o}=e(),[u,m]=i.useState(null),{anteAmount:_=1,players:h,currentPlayerId:p}=c,x=h[p],j=x?.name||"Player",g=e=>{null===u&&o&&(m(e),o.emit("secondChance",{anteAgain:e}))};return a&&s&&(a.numericValue,s.numericValue),l?null:r?n?t.jsxs("div",{className:`panel-game ${ba}`,children:[t.jsx("div",{className:ya,children:t.jsx(De,{duration:15,isActive:!0})}),t.jsxs("div",{className:fa,children:[t.jsx("span",{className:Ca,children:"SECOND CHANCE:"}),t.jsxs("button",{className:`${ka} ${wa}`,onClick:()=>g(!0),disabled:null!==u,"data-gamepad-focusable":"true",autoFocus:!0,children:[t.jsx("span",{className:xa,children:S}),t.jsx("span",{children:"ANTE AGAIN"}),t.jsx(d,{amount:_,size:"small"})]}),t.jsxs("button",{className:`${ka} ${Ta}`,onClick:()=>g(!1),disabled:null!==u,"data-gamepad-focusable":"true",children:[t.jsx("span",{children:"PASS"}),t.jsx("span",{className:xa,children:T})]})]})]}):t.jsx(Pe,{playerName:j,action:"deciding on second chance",duration:E.DECISION_DURATION}):t.jsxs("div",{className:ra,children:[t.jsxs("div",{className:la,children:[t.jsx("div",{className:ia}),t.jsx("div",{className:ca,children:t.jsx("span",{className:oa,children:"MATCH!"})})]}),n?t.jsxs("div",{className:da,children:[t.jsxs("div",{className:ua,children:[countdown,"s"]}),t.jsxs("div",{className:ma,children:[t.jsxs("button",{className:`${_a} ${ha}`,onClick:()=>g(!0),disabled:null!==u,"data-gamepad-focusable":"true",autoFocus:!0,children:[t.jsx("span",{className:xa,children:S}),t.jsx("span",{className:ja,children:"ANTE AGAIN"}),t.jsx("span",{className:ga,children:t.jsx(d,{amount:_,size:"small"})})]}),t.jsxs("button",{className:`${_a} ${pa}`,onClick:()=>g(!1),disabled:null!==u,"data-gamepad-focusable":"true",children:[t.jsx("span",{className:ja,children:"PASS"}),t.jsx("span",{className:xa,children:T})]})]})]}):t.jsx("div",{className:Na,children:t.jsxs("div",{className:va,children:[j," is deciding..."]})})]})},Ia="_resultsContainer_upvys_2",Sa="_messageArea_upvys_11",$a="_resultBar_upvys_22",Pa="_playerName_upvys_66",Ea="_resultText_upvys_71",Ba="_winBar_upvys_78",La="_winAmount_upvys_82",Ra="_lossBar_upvys_91",Oa="_lossAmount_upvys_95",Da="_penaltyBar_upvys_104",Ma="_penaltyText_upvys_108",za="_penaltyAmount_upvys_114",Fa="_animationContainer_upvys_124",qa="_cautionTapeContainer_upvys_132",Ga="_cautionTape_upvys_132",Ya="_rainContainer_fxhyg_2",Ua="_fallingItem_fxhyg_10",Ha="_emoji_fxhyg_18",Wa="_confetti_fxhyg_26",Va=({type:e="emoji",items:a=[],count:s=10,animationDuration:n=2.5,className:r=""})=>t.jsx("div",{className:`${Ya} ${r}`,children:[...Array(s)].map(((r,l)=>(r=>{const l=r/s*n+.3*(Math.random()-.5),i=100*Math.random();switch(e){case"coin":return t.jsx("div",{className:Ua,style:{left:`${i}%`,animationDelay:`${l}s`,"--animation-duration":`${n}s`},children:t.jsx(v,{size:"large"})},r);case"confetti":const e=a.length>0?a:["#ffd700","#ffed4e","#fff","#ff6b6b","#4CAF50"];return t.jsx("div",{className:`${Ua} ${Wa}`,style:{left:`${i}%`,animationDelay:`${l}s`,"--animation-duration":1.2*n+"s",backgroundColor:e[Math.floor(Math.random()*e.length)]}},r);default:const s=a.length>0?a:["🎉"];return t.jsx("div",{className:Ua,style:{left:`${i}%`,animationDelay:`${l}s`,"--animation-duration":`${n}s`},children:t.jsx("span",{className:Ha,children:s[Math.floor(Math.random()*s.length)]})},r)}})(l)))}),Ja=({result:e,players:a})=>{const[s,n]=i.useState(!0);if(i.useEffect((()=>{n(!0);const e=setTimeout((()=>n(!1)),3e3);return()=>clearTimeout(e)}),[e]),!e)return null;const r=a[e.playerId]?.name||"Player",l=e.outcome;if("win"===l){const a=e.winnings||0,s=Math.min(a/500,1),n=Math.floor(10+40*s),l=Math.floor(5+20*s);return t.jsxs("div",{className:Ia,children:[t.jsxs("div",{className:Fa,children:[t.jsx(Va,{type:"confetti",count:n,animationDuration:3,items:["#ffd700","#ffed4e","#fff","#ff6b6b","#4CAF50"]}),t.jsx(Va,{type:"coin",count:l,animationDuration:2})]}),t.jsx("div",{className:Sa,children:t.jsxs("div",{className:`panel ${$a} ${Ba}`,children:[t.jsx("span",{className:Pa,children:r}),t.jsx("span",{className:Ea,children:"WINS"}),e.winnings&&e.winnings>0&&t.jsx("span",{className:La,children:t.jsx(d,{amount:e.winnings/2,size:"small"})})]})})]})}if("lose"===l){const a=e.betAmount||0,s=Math.min(a/500,1),n=Math.floor(8+22*s);let l;return l=a<50?["😢","😔","😕","👎","📉","💔","🗑️","🤦‍♂️"]:a<200?["😭","😩","🤦","💸","📉","😤","😣","🗑️","🤡","💩","🙈"]:["🤡","💩","😂","🤣","🗑️","💀","☠️","🪦","⚰️","🤪","😵‍💫","🙃","🤮"],t.jsxs("div",{className:Ia,children:[t.jsx("div",{className:Fa,children:t.jsx(Va,{type:"emoji",items:l,count:n,animationDuration:2.5})}),t.jsx("div",{className:Sa,children:t.jsxs("div",{className:`panel ${$a} ${Ra}`,children:[t.jsx("span",{className:Pa,children:r}),t.jsx("span",{className:Ea,children:"LOST"}),e.betAmount&&e.betAmount>0&&t.jsx("span",{className:Oa,children:t.jsx(d,{amount:e.betAmount,size:"small"})})]})})]})}const c=(e.betAmount||0)*(e.isTripleAceTie?3:2),o=e.isTripleAceTie?15:8,u=e.isTripleAceTie?["💀","☠️","⚠️","🚨","⛔","💥","🔥","😱","🎰","💸"]:["⚠️","🚨","⛔","🔴","❌","💥","🎯","🎲"];return t.jsxs("div",{className:Ia,children:[t.jsxs("div",{className:qa,children:[t.jsxs("div",{className:Ga,children:[t.jsx("span",{children:e.isTripleAceTie?"TRIPLE PENALTY":"PENALTY"}),t.jsx("span",{children:e.isTripleAceTie?"TRIPLE PENALTY":"PENALTY"}),t.jsx("span",{children:e.isTripleAceTie?"TRIPLE PENALTY":"PENALTY"})]}),t.jsxs("div",{className:Ga,children:[t.jsx("span",{children:e.isTripleAceTie?"TRIPLE PENALTY":"PENALTY"}),t.jsx("span",{children:e.isTripleAceTie?"TRIPLE PENALTY":"PENALTY"}),t.jsx("span",{children:e.isTripleAceTie?"TRIPLE PENALTY":"PENALTY"})]})]}),t.jsx("div",{className:Fa,children:t.jsx(Va,{type:"emoji",items:u,count:o,animationDuration:e.isTripleAceTie?2:3})}),t.jsx("div",{className:Sa,children:t.jsxs("div",{className:`panel ${$a} ${Da}`,children:[t.jsx("span",{className:Pa,children:r}),t.jsx("span",{className:Ea,children:e.isTripleAceTie?"TRIPLE":""}),t.jsxs("span",{className:Ma,children:[e.isTripleAceTie?"3x":"2x"," PENALTY"]}),t.jsx("span",{className:za,children:t.jsx(d,{amount:c,size:"small"})})]})})]})},Ka="_revealingOverlay_hpopv_2",Qa="_revealingContent_hpopv_26",Xa="_playerName_hpopv_35",Za="_actionText_hpopv_43",es="_betAmount_hpopv_51",as=({playerName:e,betAmount:a})=>e&&a?t.jsx("div",{className:`panel-game ${Ka}`,children:t.jsxs("div",{className:Qa,children:[t.jsx("span",{className:Xa,children:e}),t.jsx("span",{className:Za,children:"bets"}),t.jsx("div",{className:es,children:t.jsx(d,{amount:a,size:"small"})})]})}):null,ss="_anteControls_68v5e_4",ts="_anteButton_68v5e_27",ns="_backOutButton_68v5e_27",rs="_sitOutHalfWidth_68v5e_27",ls="_shimmerBorder_68v5e_110",is="_buttonInfo_68v5e_125",cs="_buttonLabel_68v5e_132",os="_buttonAmount_68v5e_143",ds="_notEnoughChipsText_68v5e_154",us="_toggleLabel_b88gt_2",ms="_toggleInput_b88gt_9",_s="_toggleSlider_b88gt_15",hs="_toggleText_b88gt_64",ps="_loading_b88gt_86",xs=()=>{const{preferences:a,toggleAutoAnte:s,loading:r}=n(),{gameState:l,playerReady:i}=L(),{socket:c}=e();return r?t.jsx("div",{className:ps,children:"Loading preferences..."}):t.jsxs("label",{className:us,children:[t.jsx("input",{type:"checkbox",checked:a.autoAnte,onChange:async()=>{const e=!a.autoAnte,t=await s();if(e&&t&&i){let e=null;if(c&&c.auth?.userId&&l?.players){const a=Object.keys(l.players);for(const s of a)if(l.players[s].userId===c.auth.userId){e=l.players[s];break}}const a=e?.isReady;a||i()}},className:ms,"data-gamepad-focusable":"true"}),t.jsx("span",{className:_s}),t.jsx("span",{className:hs,children:"Auto-Ante"})]})},js=()=>{const{gameState:s,playerReady:n,playerUnready:r}=L(),{socket:l}=e(),{user:c}=a(),[o,u]=i.useState(!1);if(!s)return null;const{players:m,anteAmount:_,phase:h}=s;if("waiting"!==h)return null;let p=null;if(l&&l.auth?.userId&&m){const e=Object.keys(m);for(const a of e)if(m[a].userId===l.auth.userId){p=m[a];break}}else if(c&&m){const e=Object.keys(m);for(const a of e)if(m[a].userId===c.id){p=m[a];break}}const x=Number(p?.balance||0),j=p?.isReady,g=x>=_;return t.jsxs("div",{className:`panel-game ${ss}`,children:[j?t.jsxs("button",{className:ns,onClick:()=>{o||"function"==typeof r&&(u(!0),r())},disabled:o,"aria-label":"Back out","data-gamepad-focusable":"true",children:[t.jsx("div",{className:ls}),t.jsx("div",{className:is,children:t.jsx("span",{className:cs,children:"BACK OUT"})})]}):t.jsxs(t.Fragment,{children:[t.jsx(xs,{}),t.jsxs("button",{className:ts,onClick:()=>{o||(u(!0),n())},disabled:!g||o,"aria-label":"Ante up","data-gamepad-focusable":"true",autoFocus:!0,children:[t.jsx("div",{className:ls}),t.jsxs("div",{className:is,children:[t.jsx("span",{className:cs,children:"ANTE"}),t.jsx("span",{className:os,children:t.jsx(d,{amount:_})})]})]}),t.jsxs("button",{className:`${ns} ${rs}`,onClick:()=>{o||l&&s&&c&&(u(!0),l.emit("sitOut",{gameId:s.id,userId:l.auth?.userId||c.id}))},disabled:p?.isSittingOut||o,title:p?.isSittingOut?"You are currently sitting out":"Sit out next round","aria-label":"Sit Out","data-gamepad-focusable":"true",children:[t.jsx("div",{className:ls}),t.jsx("div",{className:is,children:t.jsx("span",{className:cs,children:"SIT OUT"})})]})]}),!j&&!g&&t.jsx("p",{className:ds,children:"Not enough coins"})]})},gs="_imBackOverlay_1wm7i_3",Ns="_container_1wm7i_11",vs="_sittingOutText_1wm7i_21",bs="_imBackButton_1wm7i_30",ys="_buttonText_1wm7i_48",fs="_helpText_1wm7i_66",Cs=({onClick:e,disabled:a=!1})=>t.jsx("div",{className:gs,children:t.jsxs("div",{className:Ns,children:[t.jsx("h3",{className:vs,children:"You are sitting out"}),t.jsx("button",{className:bs,onClick:e,disabled:a,"data-gamepad-focusable":"true",autoFocus:!0,children:t.jsx("span",{className:ys,children:"I'M BACK!"})}),t.jsx("p",{className:fs,children:"Click to rejoin the game"})]})}),ks=()=>{const{gameState:s}=L(),{socket:n}=e(),{user:r}=a(),[l,c]=i.useState(!1);if(!s)return null;const{phase:o,currentPlayerId:d,players:u,waitingForAceDecision:m,waitingForSecondChance:_,firstCard:h,secondCard:p,result:x}=s,j=r?.id,g=u&&j?u[j]:null,N=j===d,v=g?.isSittingOut||!1;return t.jsxs("div",{className:te.table,children:[t.jsx("div",{className:te.feltTexture}),t.jsx(ce,{}),t.jsx(re,{}),m&&t.jsx("div",{className:te.aceGlowEffect}),_&&t.jsx(Aa,{firstCard:h,secondCard:p,isCurrentPlayersTurn:N,indicatorOnly:!0}),!v&&t.jsxs(t.Fragment,{children:["betting"===o&&!m&&!_&&t.jsx(na,{isCurrentPlayersTurn:N}),m&&t.jsx(Me,{card:h,isCurrentPlayersTurn:N,bottomPosition:!0}),_&&t.jsx(Aa,{firstCard:h,secondCard:p,isCurrentPlayersTurn:N,bottomPosition:!0})]}),"revealing"===o&&!v&&t.jsx(as,{playerName:u[d]?.name||"Player",betAmount:u[d]?.currentBet||0}),"results"===o&&x&&!v&&t.jsx(Ja,{result:x,players:u}),"waiting"===o&&!v&&t.jsx(js,{}),v&&t.jsx("div",{className:te.sitOutOverlay,children:t.jsx(Cs,{onClick:()=>{l||n&&s.id&&(c(!0),n.emit("imBack",{gameId:s.id}))},disabled:l})})]})},ws="_playersContainer_1b112_1",Ts="_playersTitle_1b112_21",As="_playersList_1b112_45",Is="_currentPlayerGlow_1b112_53",Ss="_currentUser_1b112_67",$s="_playerInfo_1b112_71",Ps="_playerStatus_1b112_79",Es="_disconnectedIndicator_1b112_86",Bs="_playerBalanceContainer_1b112_93",Ls="_playerBalance_1b112_93",Rs="_balanceIncrease_1b112_112",Os="_balanceDecrease_1b112_116",Ds="_readyIndicator_1b112_146",Ms="_ready_1b112_146",zs="_notReady_1b112_157",Fs="_sittingOut_1b112_161",qs="_emptyPlayerList_1b112_176",Gs=()=>{const{gameState:a}=L(),{socket:s}=e(),n=i.useContext(r);if(i.useEffect((()=>{if(a?.players&&n){const e=Object.values(a.players).map((e=>e.userId)).filter(Boolean);e.length>0&&n.prefetchUsers(e)}}),[a?.players,n]),!a||!a.players)return t.jsx("div",{className:qs,children:t.jsx("p",{children:"Waiting for game data..."})});const{players:l,currentPlayerId:c,gameTransactions:o=[]}=a,d=s?.auth?.userId,u=a.totals||{};return l&&0!==Object.keys(l).length?t.jsxs("div",{className:ws,children:[t.jsx("h3",{className:Ts,children:"Scoreboard"}),t.jsx("div",{className:As,children:a.seats.filter((e=>null!==e&&l[e])).map((e=>{const a=l[e],s=e===c,n=a.userId===d;return a.disconnected,t.jsxs("div",{className:`\n                  ${s?"panel":"panel-alt"}\n                  ${s?Is:""}\n                  ${n?Ss:""}\n                `,style:{padding:"0.35rem 0.75rem",gap:"0.5rem",flexDirection:"row",fontSize:"0.9rem",alignItems:"center",justifyContent:"space-between",height:"40px"},children:[t.jsxs("div",{className:$s,children:[t.jsx(b,{userId:a.userId,size:"small",showName:!0,namePosition:"right",fontWeight:"bold"}),t.jsx("span",{className:Ps,children:a.disconnected&&t.jsx("span",{className:Es,title:"Player disconnected",children:"⚠️ Disconnected"})})]}),t.jsxs("div",{className:Bs,children:[t.jsx(Ys,{balance:u[e]||0}),t.jsx("div",{className:`\n                    ${Ds} \n                    ${a.isSittingOut?Fs:a.isReady?Ms:zs}\n                  `,title:a.isSittingOut?"Sitting Out":a.isReady?"Ready":"Not Ready"})]})]},e)}))})]}):t.jsx("div",{className:qs,children:t.jsx("p",{children:"Waiting for players to join..."})})},Ys=({balance:e})=>{const[a,s]=i.useState(e),[n,r]=i.useState(""),l=i.useRef(null);return i.useEffect((()=>{if(e!==a){r(e>a?Rs:Os),l.current&&clearTimeout(l.current),l.current=setTimeout((()=>{r("")}),1e3),s(e)}return()=>{l.current&&clearTimeout(l.current)}}),[e]),t.jsx("span",{className:`${Ls} ${n}`,children:t.jsx(d,{amount:e})})},Us="_gameLogContainer_avo5w_1",Hs="_gameLogHeader_avo5w_15",Ws="_expandIcon_avo5w_29",Vs="_gameLogEntries_avo5w_53",Js="_logEntry_avo5w_63",Ks="_logTime_avo5w_88",Qs="_logMessage_avo5w_95",Xs="_systemMessage_avo5w_100",Zs="_emptyLog_avo5w_111",et="_showMoreButton_avo5w_119",at={turnPanel:"_turnPanel_1mzsb_2",leftSection:"_leftSection_1mzsb_15",win:"_win_1mzsb_22",lose:"_lose_1mzsb_27",penalty:"_penalty_1mzsb_32",pass:"_pass_1mzsb_37",cardsContainer:"_cardsContainer_1mzsb_43",playerName:"_playerName_1mzsb_49",action:"_action_1mzsb_56",amount:"_amount_1mzsb_65"},st="_cardMini_tdd1b_2",tt="_red_tdd1b_18",nt="_black_tdd1b_22",rt="_rank_tdd1b_26",lt="_aceIndicator_tdd1b_34",it="_suit_tdd1b_53",ct="_cardPlaceholder_tdd1b_58",ot=({card:e})=>{if(!e)return t.jsx("div",{className:ct,children:"?"});const a=e.value||"?",s=e.suit||"?",n="♥"===s||"♦"===s||"hearts"===s||"diamonds"===s,r="A"===a,l=!0===e.isAceLow,i=r&&!l;return t.jsxs("div",{className:`${st} ${n?tt:nt}`,children:[t.jsxs("span",{className:rt,children:[a,r&&(i?t.jsx("span",{className:lt,children:"↑"}):l?t.jsx("span",{className:lt,children:"↓"}):null)]}),t.jsx("span",{className:it,children:(e=>{switch(e){case"hearts":case"♥":return f;case"diamonds":case"♦":return C;case"clubs":case"♣":return k;case"spades":case"♠":return w;default:return e||""}})(s)})]})},dt=({summary:e})=>{if(!e)return null;const a=()=>e.winAmount?e.winAmount/2:e.lossAmount?e.lossAmount:e.betAmount?e.betAmount:0;return t.jsxs("div",{className:`panel-alt ${at.turnPanel} ${(e=>{switch(e){case"win":return at.win;case"lose":return at.lose;case"penalty":case"triple_penalty":return at.penalty;case"pass":return at.pass;default:return at.default}})(e.action)}`,children:[t.jsxs("div",{className:at.leftSection,children:[t.jsxs("div",{className:at.cardsContainer,children:[t.jsx(ot,{card:e.cards?.left}),e.cards?.middle&&t.jsx(ot,{card:e.cards?.middle}),t.jsx(ot,{card:e.cards?.right})]}),t.jsx("span",{className:at.playerName,children:e.playerName}),t.jsx("span",{className:at.action,children:(e=>{switch(e){case"win":return"WON";case"lose":return"LOST";case"penalty":return"PENALTY";case"triple_penalty":return"TRIPLE PENALTY";case"pass":return"PASSED";case"bet":return"BET";default:return e?.toUpperCase()||""}})(e.action)})]}),a()>0&&t.jsx("div",{className:at.amount,children:t.jsx(d,{amount:a(),size:"small"})})]})},ut="_roundPanel_1npc7_2",mt="_dividerLine_1npc7_26",_t="_roundLabel_1npc7_38",ht=({roundNumber:e})=>t.jsxs("div",{className:`panel-alt ${ut}`,children:[t.jsx("div",{className:mt}),t.jsxs("span",{className:_t,children:["Round ",e]}),t.jsx("div",{className:mt})]}),pt=()=>{const{gameState:e}=L(),[a,s]=i.useState(!1);if(!e||!e.gameLog)return null;const n=e.gameLog||[],r=e.seats?e.seats.filter((e=>null!==e)).length:0,l=Math.max(r,4),[c,o]=i.useState(l);i.useEffect((()=>{a||o(l)}),[r,l,a]);const d=e=>new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"}),u=a?[]:n.slice(0,c);return t.jsxs("div",{className:Us,children:[t.jsxs("h3",{className:Hs,onClick:()=>{s(!a),a&&o(l)},children:["Game Log",t.jsx("span",{className:Ws,children:a?"▶":"▼"})]}),!a&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:Vs,children:0===n.length?t.jsx("div",{className:Zs,children:"No game events yet"}):u.map(((e,a)=>"turn"===e.type?t.jsx(dt,{summary:e},e.id):"round_start"===e.type?t.jsx(ht,{roundNumber:e.roundNumber},e.id):"system"===e.type||"error"===e.type?t.jsxs("div",{className:`${Js} ${Xs}`,children:[t.jsx("span",{className:Ks,children:d(e.timestamp)}),t.jsx("span",{className:Qs,children:e.message})]},e.id):t.jsxs("div",{className:Js,children:[t.jsx("span",{className:Ks,children:d(e.timestamp)}),t.jsx("span",{className:Qs,children:e.message})]},e.id)))}),n.length>c&&t.jsxs("div",{className:et,onClick:()=>{o((e=>e+Math.max(r,5)))},children:["Show ",Math.min(Math.max(r,5),n.length-c)," more",n.length-c>Math.max(r,5)&&` (${n.length-c} remaining)`]})]})]})},xt="_emojiReactions_1y1z5_1",jt="_toggleButton_1y1z5_8",gt="_emojiPanel_1y1z5_35",Nt="_emojiGrid_1y1z5_60",vt="_emojiButton_1y1z5_66",bt=()=>{const[s,n]=i.useState(!1),{socket:r}=e(),{gameState:l}=L(),{user:c}=a(),o=i.useRef(null);return i.useEffect((()=>{const e=e=>{o.current&&!o.current.contains(e.target)&&n(!1)};return s&&(document.addEventListener("mousedown",e),document.addEventListener("touchstart",e)),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}}),[s]),t.jsxs("div",{className:xt,ref:o,children:[t.jsx("button",{className:jt,onClick:()=>{n(!s)},"data-gamepad-focusable":"true","aria-label":"Toggle emoji reactions",children:"😊"}),s&&t.jsx("div",{className:gt,children:t.jsx("div",{className:Nt,children:[{emoji:"🔥",name:"Fire",color:"#FF6B35"},{emoji:"😄",name:"Happy",color:"#FFD93D"},{emoji:"💩",name:"Poop",color:"#8B4513"},{emoji:"😎",name:"Cool",color:"#4A5568"},{emoji:"🤯",name:"Mind Blown",color:"#FFA500"},{emoji:"😈",name:"Devilish",color:"#9333EA"},{emoji:"😬",name:"Worried",color:"#FCD34D"},{emoji:"👏",name:"Applause",color:"#FBBF24"},{emoji:"😭",name:"Crying",color:"#3B82F6"},{emoji:"🤡",name:"Clown",color:"#EF4444"},{emoji:"💪",name:"Strong",color:"#F59E0B"},{emoji:"😅",name:"Nervous",color:"#60A5FA"},{emoji:"🎉",name:"Celebration",color:"#A855F7"},{emoji:"🤔",name:"Thinking",color:"#6B7280"},{emoji:"🙈",name:"See No Evil",color:"#A0522D"},{emoji:"😤",name:"Confident",color:"#DC2626"}].map(((e,a)=>t.jsx("button",{className:vt,onClick:()=>(e=>{r&&l&&c&&(r.emit("emojiReaction",{gameId:l.id,emoji:e.emoji,color:e.color,playerName:c.username}),n(!1))})(e),"data-gamepad-focusable":"true",title:e.name,style:{"--emoji-color":e.color},children:e.emoji},a)))})})]})},yt=({onReturnToLobby:s})=>{const[n,r]=i.useState(!1),{gameState:l,error:c,clearError:o}=L();y(!0),i.useEffect((()=>{if(c){const e=setTimeout((()=>{o()}),1e4);return()=>clearTimeout(e)}}),[c,o]);const{socket:d}=e(),{user:u}=a();if(!l)return t.jsx("div",{className:M,children:t.jsx("p",{children:"Loading game state..."})});l.phase;const m=u?.id;return l.players&&m&&l.players[m],t.jsxs("div",{className:`screen ${O}`,children:[t.jsxs("div",{className:`${D} mobile-scale-content`,children:[t.jsx(se,{handleLeaveGame:()=>{s&&s()},onModalStateChange:r}),c&&t.jsx("div",{className:z,children:t.jsx("p",{className:F,children:c})}),t.jsx(ks,{}),t.jsxs("div",{className:q,children:[t.jsx(Gs,{}),t.jsx(pt,{})]})]}),!n&&t.jsx(bt,{})]})},ft="_modalOverlay_17ksc_1",Ct="_modalContent_17ksc_14",kt="_passwordInput_17ksc_34",wt="_modalActions_17ksc_54",Tt="_modalButton_17ksc_60",At="_cancelButton_17ksc_71",It="_submitButton_17ksc_80";function St({isOpen:e,onClose:a,onSubmit:s,gameId:n}){const[r,l]=i.useState("");if(!e)return null;return t.jsx("div",{className:ft,children:t.jsxs("div",{className:Ct,children:[t.jsx("h2",{children:"Password Required"}),t.jsxs("p",{children:["Please enter the password for game ",t.jsx("strong",{children:n||""}),":"]}),t.jsxs("form",{onSubmit:e=>{e.preventDefault(),s(r),l("")},autoComplete:"off",children:[t.jsx(N,{title:"Enter Game Password",type:"text",value:r,onChange:e=>l(e.target.value),className:kt,autoFocus:!0,required:!0,autoComplete:"off","data-form-type":"other","data-lpignore":"true"}),t.jsxs("div",{className:wt,children:[t.jsx("button",{type:"button",onClick:()=>{l(""),a()},className:`${Tt} ${At}`,"data-gamepad-focusable":"true",children:"Cancel"}),t.jsx("button",{type:"submit",className:`${Tt} ${It}`,"data-gamepad-focusable":"true",children:"Join Game"})]})]})]})})}const $t=()=>{const{gameId:a}=c(),n=o(),{socket:r,isConnected:d}=e(),[u,m]=i.useState(!0),[_,h]=i.useState(null),[p,x]=i.useState(!1),j=i.useRef(!1),g=i.useCallback((()=>{r&&d&&a&&(s.play("ui.leave"),r.emit("leaveGame",{gameId:a}),n("/"))}),[r,d,a,n]),N=i.useCallback((e=>{x(!1),r&&a&&e&&(h(null),r.emit("joinGame",{gameId:a,password:e}),m(!0))}),[r,a]),v=i.useCallback((()=>{x(!1),n("/")}),[n]);i.useEffect((()=>{h(null),x(!1),m(!0)}),[a]),i.useEffect((()=>{if(!r)return;const e=e=>{e&&e.game&&e.game.id===a&&(s.play("ui.join"),m(!1),h(null),x(!1))},t=e=>{const a=e.message||"An unknown error occurred";"Password required"===a?(x(!0),m(!1),h(null)):"Invalid password"===a?(h("Invalid password."),x(!0),m(!1)):"Game not found"===a?n("/"):"Game is full"===a?(h(a),m(!1),x(!1),setTimeout((()=>n("/")),3e3)):(h(a),m(!1),x(!1))};return r.on("gameJoined",e),r.on("error",t),()=>{r.off("gameJoined",e),r.off("error",t)}}),[r,a,n]),i.useEffect((()=>{r&&a&&!j.current&&(j.current=!0,m(!0),h(null),x(!1),r.emit("joinGame",{gameId:a}))}),[r,a]);const b=()=>{const{gameState:s}=L(),{socket:n}=e();return i.useEffect((()=>{const e=e=>{const a=n?.auth?.userId,t=a&&s?.players?s.players[a]:null;if(t?.isReady||!1)return e.preventDefault(),e.returnValue="You have money in the pot! Are you sure you want to leave?",e.returnValue};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}}),[s,n]),t.jsxs(t.Fragment,{children:[t.jsx(St,{isOpen:p,onClose:v,onSubmit:N,gameId:a}),u&&t.jsx(l,{message:`Joining game ${a}...`}),_&&!u&&!p&&t.jsxs("div",{className:"error-container",style:{padding:"20px",color:"red",textAlign:"center"},children:[t.jsx("h2",{children:"An error occurred"}),t.jsx("p",{children:_}),t.jsx("button",{onClick:()=>window.location.reload(),children:"Refresh Page"})]}),!u&&!_&&s&&t.jsx(yt,{onReturnToLobby:g})]})};return t.jsx(R,{gameId:a,children:t.jsx(b,{})})};export{$t as default};
