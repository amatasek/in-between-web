import{a1 as T,Z as e,a2 as Z,_ as L,a3 as q,a4 as J}from"./index-NRT9ESP6.js";import{b as N,f as Q,u as X}from"./vendor-CT7sGowS.js";import{u as Y}from"./useGamepadNavigation-DKu7SyYo.js";import{A as H}from"./AppHeader-C3gLasUJ.js";import{F as V}from"./Footer-DUncH9lC.js";import{c as M}from"./createLucideIcon-D-AJSOET.js";import{B as K,T as w,G as S,C as ee,Z as se,U as te,R as ae,P as ne,S as oe,a as re,b as ie,u as ce,A as le,c as me,d as O}from"./useAdInterstitial-BxbIF6Az.js";import"./socket-CA1CrNgP.js";import"./audio-hxunv4lQ.js";/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],ue=M("lock",de);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],he=M("search",pe),ge="_lobbyScreen_pke86_1",xe="_withAds_pke86_9",_e="_gameListTitle_pke86_30",fe="_searchContainer_pke86_41",je="_gameListWrapper_pke86_73",Ne="_userDisconnectedGame_pke86_80",be="_userInGame_pke86_92",ve="_gameListInfo_pke86_114",Ce="_gameListId_pke86_120",ye="_disconnectedBadge_pke86_129",Se="_inGameBadge_pke86_141",we="_gameListPlayers_pke86_153",Ie="_emptyStateMessage_pke86_159",Ae="_privatePill_pke86_168",Be="_onlineCountWrapper_pke86_182",Le="_playerSection_pke86_190",Pe="_gameActionsSection_pke86_196",Ge="_gameListSection_pke86_205",ke="_gameCard_pke86_212",l={lobbyScreen:ge,withAds:xe,gameListTitle:_e,searchContainer:fe,gameListWrapper:je,userDisconnectedGame:Ne,userInGame:be,gameListInfo:ve,gameListId:Ce,disconnectedBadge:ye,inGameBadge:Se,gameListPlayers:we,emptyStateMessage:Ie,privatePill:Ae,onlineCountWrapper:Be,playerSection:Le,gameActionsSection:Pe,gameListSection:Ge,gameCard:ke},$e="_pill_19yh2_1",Ee="_pulse_19yh2_23",Oe="_text_19yh2_49",B={pill:$e,pulse:Ee,text:Oe},De=()=>{const{socket:n,isConnected:r}=T(),[c,t]=N.useState(null);return N.useEffect(()=>{if(!n||!r)return;n.emit("getOnlinePlayerCount",a=>{t(a)});const x=a=>t(a);return n.on("onlinePlayerCountUpdate",x),()=>{n.off("onlinePlayerCountUpdate",x)}},[n,r]),c===null?null:e.jsxs("div",{className:B.pill,children:[e.jsx("span",{className:B.pulse}),e.jsxs("span",{className:B.text,children:[c," online"]})]})};function Te({game:n,onJoin:r,userId:c}){const t=n.settings?.customName||n.id,x=n.disconnectedPlayers?.some(h=>h.userId===c),a=n.allPlayers?.some(h=>h.userId===c&&!h.disconnected);let p="Join";x?p="Reconnect":a&&(p="Continue");let j=`panel-frost ${l.gameCard}`;return x?j+=` ${l.userDisconnectedGame}`:a&&(j+=` ${l.userInGame}`),e.jsxs("div",{className:j,children:[e.jsxs("div",{className:l.gameListInfo,style:{flex:1},children:[e.jsxs("div",{className:l.gameListId,children:[" ",t,n.settings?.isPrivate&&e.jsxs("span",{className:l.privatePill,title:"Private Game",children:[e.jsx(ue,{size:"0.9em",style:{marginRight:"4px",verticalAlign:"middle"}}),"Private"]}),x&&e.jsx("span",{className:l.disconnectedBadge,title:"You're disconnected from this game",children:"⚠️ Reconnect"}),a&&e.jsx("span",{className:l.inGameBadge,title:"You're in this game",children:"You're In"})]}),e.jsxs("div",{className:l.gameListPlayers,children:[" ",n.playerCount," ",n.playerCount===1?"player":"players"]})]}),e.jsx("button",{type:"button",className:"btn btn-primary",style:{padding:"0.4rem 1rem",fontSize:"0.9rem",minWidth:"80px",maxWidth:"100px",flexShrink:0},onClick:()=>r(n.id),disabled:!c,"data-gamepad-focusable":"true",children:p})]})}const Me="_gameSettingItem_tzwbj_1",We="_settingDescription_tzwbj_13",ze="_settingControls_tzwbj_35",Ue="_textInput_tzwbj_42",Fe="_inputError_tzwbj_60",o={gameSettingItem:Me,settingDescription:We,settingControls:ze,textInput:Ue,inputError:Fe},D={useCustomName:!1,customName:"",isPrivate:!1,password:"",enableAceChoice:!0,enableSecondChance:!0,numberOfBots:0,anteAmount:""},Re=({initialSettings:n=D,onSubmit:r,onClose:c})=>{const[t,x]=N.useState({...D,...n}),[a,p]=N.useState({}),j=s=>{const u={};if(s.useCustomName){const d=s.customName||"";d?d.length<4||d.length>26?u.customName="Name must be 4-26 characters.":/^[a-zA-Z0-9_-]+$/.test(d)||(u.customName="Use letters, numbers, -, or _."):u.customName="Custom name is required."}if(s.isPrivate){const d=s.password||"";d?(d.length<3||d.length>36)&&(u.password="Password must be 3-36 characters."):u.password="Password is required."}const m=s.numberOfBots;(m<0||m>16)&&(u.numberOfBots="Number of bots must be between 0 and 16.");const i=s.anteAmount;if(i!==""&&i!==null&&i!==void 0){const d=parseInt(i);(isNaN(d)||d<1||d>100)&&(u.anteAmount="Ante amount must be between 1 and 100.")}return u},h=(s,u)=>{x(m=>{const i={...m,[s]:u};return s==="useCustomName"&&!u&&(i.customName="",a.customName&&p(d=>{const _={...d};return delete _.customName,_})),s==="isPrivate"&&!u&&(i.password="",a.password&&p(d=>{const _={...d};return delete _.password,_})),i}),(s==="customName"||s==="useCustomName")&&a.customName&&p(m=>{const i={...m};return delete i.customName,i}),(s==="password"||s==="isPrivate")&&a.password&&p(m=>{const i={...m};return delete i.password,i}),s==="numberOfBots"&&a.numberOfBots&&p(m=>{const i={...m};return delete i.numberOfBots,i}),s==="anteAmount"&&a.anteAmount&&p(m=>{const i={...m};return delete i.anteAmount,i})},I=s=>{s.preventDefault();const u=j(t);if(Object.keys(u).length>0)p(u);else{p({});const m={...t,customName:t.useCustomName?t.customName:null,anteAmount:t.anteAmount===""?1:parseInt(t.anteAmount)};delete m.useCustomName,r(m)}};return e.jsx(K,{title:"Game Options",onClose:c,style:{maxWidth:600},footer:e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("button",{type:"button",onClick:c,className:"btn btn-secondary","data-gamepad-focusable":"true",children:"Cancel"}),e.jsx("button",{type:"submit",form:"gameSettingsForm",className:"btn btn-primary",disabled:Object.keys(a).length>0,"data-gamepad-focusable":"true",children:"Create Game"})]}),children:e.jsxs("form",{id:"gameSettingsForm",onSubmit:I,children:[e.jsxs("div",{className:`panel-alt ${o.gameSettingItem}`,children:[e.jsxs("div",{className:o.settingDescription,children:[e.jsx("h4",{children:"Custom Game Name"}),e.jsx("p",{children:"Set a custom name for your game lobby"})]}),e.jsxs("div",{className:o.settingControls,children:[e.jsx(w,{isChecked:t.useCustomName,onChange:s=>h("useCustomName",s.target.checked)}),t.useCustomName&&e.jsx(S,{title:"Enter Game Name",type:"text",value:t.customName||"",onChange:s=>h("customName",s.target.value),className:`${o.textInput}${a.customName?` ${o.inputError}`:""}`,placeholder:"Game Name",maxLength:26,style:{marginTop:8}}),a.customName&&e.jsx("span",{className:"errorMessage",children:a.customName})]})]}),e.jsxs("div",{className:`panel-alt ${o.gameSettingItem}`,children:[e.jsxs("div",{className:o.settingDescription,children:[e.jsx("h4",{children:"Private Game"}),e.jsx("p",{children:"Only players with the password can join"})]}),e.jsxs("div",{className:o.settingControls,children:[e.jsx(w,{isChecked:t.isPrivate,onChange:s=>h("isPrivate",s.target.checked)}),t.isPrivate&&e.jsx(S,{title:"Enter Game Password",type:"text",value:t.password||"",onChange:s=>h("password",s.target.value),className:`${o.textInput}${a.password?` ${o.inputError}`:""}`,placeholder:"Password",maxLength:36,style:{marginTop:8}}),a.password&&e.jsx("span",{className:"errorMessage",children:a.password})]})]}),e.jsxs("div",{className:`panel-alt ${o.gameSettingItem}`,children:[e.jsxs("div",{className:o.settingDescription,children:[e.jsx("h4",{children:"Number of Bots"}),e.jsx("p",{children:"Add AI players to your game (0-16)"})]}),e.jsxs("div",{className:o.settingControls,children:[e.jsx(S,{title:"Number of AI Players",type:"number",min:"0",max:"16",value:t.numberOfBots===0?"":t.numberOfBots,onChange:s=>h("numberOfBots",s.target.value===""?0:parseInt(s.target.value)||0),className:`${o.textInput} no-validation${a.numberOfBots?` ${o.inputError}`:""}`,placeholder:"0"}),a.numberOfBots&&e.jsx("span",{className:"errorMessage",children:a.numberOfBots})]})]}),e.jsxs("div",{className:`panel-alt ${o.gameSettingItem}`,children:[e.jsxs("div",{className:o.settingDescription,children:[e.jsx("h4",{children:"Ante Amount"}),e.jsx("p",{children:"Set the ante amount for each round (1-100)"})]}),e.jsxs("div",{className:o.settingControls,children:[e.jsx(S,{title:"Ante Amount",type:"number",min:"1",max:"100",value:t.anteAmount,onChange:s=>h("anteAmount",s.target.value),className:`${o.textInput} no-validation${a.anteAmount?` ${o.inputError}`:""}`,placeholder:"1"}),a.anteAmount&&e.jsx("span",{className:"errorMessage",children:a.anteAmount})]})]}),e.jsxs("div",{className:`panel-alt ${o.gameSettingItem}`,children:[e.jsxs("div",{className:o.settingDescription,children:[e.jsx("h4",{children:"Enable Ace Choice"}),e.jsx("p",{children:"Allow players to choose high/low on Ace"})]}),e.jsx("div",{className:o.settingControls,children:e.jsx(w,{isChecked:t.enableAceChoice,onChange:s=>h("enableAceChoice",s.target.checked)})})]}),e.jsxs("div",{className:`panel-alt ${o.gameSettingItem}`,children:[e.jsxs("div",{className:o.settingDescription,children:[e.jsx("h4",{children:"Enable Second Chance"}),e.jsx("p",{children:"Allow players to ante up for a second chance"})]}),e.jsx("div",{className:o.settingControls,children:e.jsx(w,{isChecked:t.enableSecondChance,onChange:s=>h("enableSecondChance",s.target.checked)})})]})]})})},Ze="_userSection_1jcu2_1",qe="_avatarContainer_1jcu2_10",Je="_headerButtons_1jcu2_14",Qe="_logoutButton_1jcu2_38",y={userSection:Ze,avatarContainer:qe,headerButtons:Je,logoutButton:Qe},Xe="_progressContainer_1gewg_1",Ye="_balanceSection_1gewg_9",He="_balanceLeft_1gewg_16",Ve="_xpBonusIndicator_1gewg_29",Ke="_xpBonusIcon_1gewg_35",es="_xpBonusText_1gewg_41",ss="_xpSection_1gewg_49",ts="_xpBarContainer_1gewg_53",as="_xpOverlay_1gewg_63",ns="_xpLevel_1gewg_77",os="_xpNext_1gewg_84",rs="_xpBar_1gewg_53",f={progressContainer:Xe,balanceSection:Ye,balanceLeft:He,xpBonusIndicator:Ve,xpBonusIcon:Ke,xpBonusText:es,xpSection:ss,xpBarContainer:ts,xpOverlay:as,xpLevel:ns,xpNext:os,xpBar:rs},is=({userId:n,balance:r})=>{const c=Z(n),{user:t}=L(),x=t?.subscription?.isPremium;return e.jsxs("div",{className:`panel-frost ${f.progressContainer}`,children:[e.jsxs("div",{className:f.balanceSection,children:[e.jsx("div",{className:f.balanceLeft,children:e.jsx(ee,{amount:Number(r)||0,size:"medium"})}),x&&e.jsxs("div",{className:f.xpBonusIndicator,children:[e.jsx(se,{size:16,strokeWidth:2.5,className:f.xpBonusIcon}),e.jsx("span",{className:f.xpBonusText,children:"2x XP"})]})]}),c&&e.jsx("div",{className:f.xpSection,children:e.jsxs("div",{className:f.xpBarContainer,children:[e.jsx("div",{className:f.xpBar,style:{width:c.level>=100?"100%":`${c.percentToNextLevel||0}%`}}),e.jsxs("div",{className:f.xpOverlay,children:[e.jsxs("div",{className:f.xpLevel,children:["Level ",c.level]}),e.jsx("div",{className:f.xpNext,children:c.level<100?`${c.xpToNextLevel.toLocaleString()} XP`:"MAX"})]})]})})]})},cs=()=>{const{user:n,logout:r}=L(),[c,t]=N.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`panel-frost ${y.userSection}`,children:[e.jsx("div",{className:y.avatarContainer,children:e.jsx(te,{userId:n?.id,size:"medium",showName:!0,namePosition:"right"})}),e.jsx(is,{userId:n?.id,balance:n?.balance}),e.jsxs("div",{className:y.headerButtons,children:[e.jsx("button",{type:"button",className:y.logoutButton,onClick:r,"data-gamepad-focusable":"true",children:e.jsx("span",{className:y.buttonText,children:"Logout"})}),e.jsx(ae,{"data-gamepad-focusable":"true"}),e.jsx(ne,{"data-gamepad-focusable":"true"}),e.jsx(oe,{onClick:()=>t(!0),"data-gamepad-focusable":"true"}),e.jsx(re,{"data-gamepad-focusable":"true"})]})]}),c&&e.jsx(ie,{onClose:()=>t(!1)})]})},fs=()=>{const{gameList:n}=q(),{user:r,logout:c}=L(),{socket:t,isConnected:x}=T(),a=Q();Y(!0);const p=X(),[j,h]=N.useState(""),[I,s]=N.useState(!1),{shouldShowAd:u,showAd:m,hideAd:i}=ce(),d=!r?.subscription?.isPremium,_=r?.id||null;N.useEffect(()=>{a.state?.fromGame&&m()},[a.state,m]),N.useEffect(()=>{r&&(!r.username||!r.id)&&(console.error("[Lobby] Invalid user data received:",r),c())},[r,c]);const W=g=>{!x||!r||(J.play("ui.click"),p(`/${g}`))},z=g=>{h(g.target.value)},P=g=>{if(!r?.id||!x)return;const b=v=>{t.off("gameCreated",b),v?.game?.id&&p(`/${v.game.id}`)};t.on("gameCreated",b),g?t.emit("createGame",{settings:g}):t.emit("createGame")},U=()=>P({numberOfBots:5}),F=()=>{s(!0)},R=g=>{s(!1),P(g)},A=N.useMemo(()=>{if(!n)return[];let g=n;if(j.trim()){const b=j.trim().toLowerCase();g=n.filter(v=>v.id.toLowerCase().includes(b))}return g.sort((b,v)=>{const G=b.allPlayers?.some(C=>C.userId===_),k=v.allPlayers?.some(C=>C.userId===_),$=b.disconnectedPlayers?.some(C=>C.userId===_),E=v.disconnectedPlayers?.some(C=>C.userId===_);return $&&!E?-1:!$&&E?1:G&&!k?-1:!G&&k?1:b.id.localeCompare(v.id)})},[n,j,_]);return e.jsxs("div",{className:`screen app-gradient-bg ${l.lobbyScreen} ${d?l.withAds:""}`,children:[e.jsx(H,{}),e.jsx("div",{className:l.onlineCountWrapper,children:e.jsx(De,{})}),e.jsx("div",{className:l.playerSection,children:e.jsx(cs,{})}),e.jsxs("div",{className:l.gameActionsSection,children:[e.jsx("button",{type:"button",className:"btn btn-primary",onClick:U,disabled:!r?.username,"data-gamepad-focusable":"true",children:"Create Quick Game"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:F,disabled:!r?.username,"data-gamepad-focusable":"true",children:"Create Custom Game"})]}),e.jsxs("div",{className:`panel-frost ${l.gameListSection}`,children:[e.jsx("h2",{className:l.gameListTitle,children:"Available Games"}),e.jsx("div",{className:l.searchContainer,children:e.jsxs("div",{className:"input-with-icon",children:[e.jsx("span",{className:"input-icon left",style:{display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(he,{size:18,strokeWidth:2.5})}),e.jsx(S,{title:"Search Games",type:"search",className:"no-validation",placeholder:"Search available games",value:j,onChange:z})]})}),A&&A.length>0?e.jsx("div",{className:l.gameListWrapper,children:A.map(g=>e.jsx(Te,{game:g,onJoin:W,userId:_},g.id))}):e.jsx("p",{className:l.emptyStateMessage,children:j.trim()?"No games found":"No games available"})]}),I&&e.jsx(Re,{onSubmit:R,onClose:()=>s(!1)}),e.jsx(V,{}),u&&e.jsx(le,{onClose:i}),e.jsx(me,{hideAtWidth:1e3}),e.jsx(O,{position:"left"}),e.jsx(O,{position:"right"})]})};export{fs as default};
