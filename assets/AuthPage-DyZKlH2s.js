import{r,j as e,u as o}from"./react-LCTZrjTk.js";import{G as t,A as a}from"./AppHeader-CjmG8wGb.js";import{u as n,P as i,T as s,A as l,B as u,a as d}from"./mui-BSPbzN1w.js";import{u as c,A as m}from"./index-BdiHqHA_.js";import{u as g}from"./useGamepadNavigation-B8bT5PUC.js";import"./vendor-DCzzBhLE.js";import"./socket-DDuR0C0b.js";const f="_authForm_121ec_1",p="_submitButton_121ec_99",h=({onSubmit:o,mode:a})=>{const[d,c]=r.useState(""),[m,g]=r.useState(""),[h,x]=r.useState("");n("(max-width:600px)");const v=n("(max-width:400px)");return e.jsxs(i,{className:f,elevation:0,children:[e.jsx(s,{variant:"h5",component:"h2",gutterBottom:!0,sx:{color:"var(--info)",fontWeight:600},children:"login"===a?"Welcome Back":"Create Account"}),h&&e.jsx(l,{severity:"error",sx:{mb:2,backgroundColor:"rgba(231, 76, 60, 0.2)",color:"var(--text-primary)"},children:h}),e.jsxs("form",{onSubmit:async r=>{r.preventDefault(),x("");try{await o(d,m)}catch(e){x(e.message)}},children:[e.jsx(t,{title:"Enter Username",label:"Username",variant:"outlined",fullWidth:!0,margin:"normal",value:d,onChange:r=>c(r.target.value),required:!0,size:v?"small":"medium",inputProps:{minLength:3},sx:{"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:"var(--info-light)"},"&:hover fieldset":{borderColor:"var(--info)"},"&.Mui-focused fieldset":{borderColor:"var(--info)"},backgroundColor:"rgba(255, 255, 255, 0.1)"},"& .MuiInputLabel-root":{color:"var(--info-light)",fontSize:v?"0.9rem":"1rem"},"& .MuiOutlinedInput-input":{color:"var(--text-dark)",fontWeight:500,backgroundColor:"rgba(255, 255, 255, 0.85)",padding:v?"12px 14px":"16.5px 14px"},"& .MuiInputLabel-root.Mui-focused":{color:"var(--info)"},marginBottom:v?"0.5rem":"1rem"}}),e.jsx(t,{title:"Enter Password",label:"Password",type:"password",variant:"outlined",fullWidth:!0,margin:"normal",value:m,onChange:r=>g(r.target.value),required:!0,size:v?"small":"medium",inputProps:{minLength:6},sx:{"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:"var(--info-light)"},"&:hover fieldset":{borderColor:"var(--info)"},"&.Mui-focused fieldset":{borderColor:"var(--info)"},backgroundColor:"rgba(255, 255, 255, 0.1)"},"& .MuiInputLabel-root":{color:"var(--info-light)",fontSize:v?"0.9rem":"1rem"},"& .MuiOutlinedInput-input":{color:"var(--text-dark)",fontWeight:500,backgroundColor:"rgba(255, 255, 255, 0.85)",padding:v?"12px 14px":"16.5px 14px"},"& .MuiInputLabel-root.Mui-focused":{color:"var(--info)"},marginBottom:v?"0.5rem":"1rem"}}),e.jsx(u,{type:"submit",variant:"contained",fullWidth:!0,size:"large",className:p,"data-gamepad-focusable":"true",sx:{mt:v?2:3,background:"linear-gradient(to right, var(--info), var(--success))",textTransform:"none",fontWeight:"bold",letterSpacing:"0.5px",padding:v?"10px":"12px",fontSize:v?"0.9rem":"1rem","&:hover":{background:"linear-gradient(to right, var(--info-dark), var(--success-dark))",boxShadow:"var(--shadow-lg)",transform:"translateY(-2px)"}},children:"login"===a?"Sign In":"Create Account"})]})]})},x="_authPage_1fizs_1",v="_error_1fizs_40",b="_formContainer_1fizs_53",j=()=>{const[t,n]=r.useState("login"),{login:i}=c(),l=o();g(!0);const[f,p]=r.useState(null);return e.jsxs(d,{className:x,children:[e.jsx(a,{}),e.jsxs(d,{className:b,children:[f&&e.jsx(s,{className:v,children:f}),e.jsx(h,{mode:t,onSubmit:async(r,e)=>{if(!r||!e)return void p("Username and password are required");p(null);const o=`${m}/auth/${t}`;try{const t={username:r,password:e},n=await fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});let s;try{s=await n.json()}catch(a){throw new Error("Invalid response from server")}if(!n.ok)throw new Error(s.message||"Authentication failed");if(!s.user?.username||!s.user?.id||!s.token)throw new Error("Invalid server response format");try{i(s.user,s.token),l("/")}catch(a){throw new Error("Failed to initialize user session")}}catch(a){p(a.message||"Failed to connect to server")}}}),e.jsx(d,{textAlign:"center",mt:3,children:e.jsx(u,{color:"primary",onClick:()=>n("login"===t?"register":"login"),"data-gamepad-focusable":"true",sx:{color:"#ecf0f1",textTransform:"none",fontSize:"1rem","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.1)"}},children:"login"===t?"Don't have an account? Register":"Already have an account? Login"})})]})]})};export{j as default};
