import{j as e}from"./ui-DgYMOojV.js";import{r as a,g as s,u as n}from"./vendor-BoU4GIkp.js";import{a as t,u as l,s as r,U as i,f as o,L as c}from"./index-pHr3zac6.js";import{I as d,C as u,a as m,R as _,P as h,S as g,c as x,b as p,G as j,U as v}from"./StoreModal-DXJo4HnO.js";import{u as N}from"./useGamepadNavigation-Kc11nJyB.js";const y="ðŸ¯",b="ðŸƒ",C="âœ“",f="ðŸƒ",{TIMERS:k}={TIMERS:{DEALING_DURATION:3e3,BETTING_DURATION:3e4,REVEALING_DURATION:3e3,RESULTS_DURATION:5e3}},I=a.createContext(),w=()=>{const e=a.useContext(I);if(void 0===e)throw new Error("useGameContext must be used within a GameProvider");return e},T=({children:s,gameId:n,initialGameState:i=null})=>{const{socket:o,error:c}=t(),{user:d}=l(),[u,m]=a.useState(i);a.useRef({});const _=a.useRef(null),[h,g]=a.useState(null),x=a.useCallback((()=>{g(null)}),[]);a.useEffect((()=>{c&&g(c)}),[c]),a.useEffect((()=>{if(o)return o.on("gameReconnected",(e=>{console.log(`[Game] Reconnected to game: ${e.gameId}`,e.game),m(e.game),console.log(`[Game] Successfully reconnected as user ID: ${null==d?void 0:d.id}`),g(null),e.game&&e.game.id&&setTimeout((()=>{console.log("[Game] Requesting fresh game state after reconnection"),o.emit("getGameState",{gameId:e.game.id})}),500)})),o.on("gameState",(e=>{if(e&&e.id&&JSON.stringify(u)!==JSON.stringify(e)){if(e.currentPlayerId&&(null==d?void 0:d.id)){const a=e.currentPlayerId===d.id,s=_.current===d.id;a&&!s&&r.play("ui.alert"),_.current=e.currentPlayerId}m(e),x()}})),o.on("gameError",(e=>{console.error("Game error:",e),g(e)})),()=>{o.off("gameReconnected"),o.off("gameState"),o.off("gameError")}}),[o]);const p=a.useCallback((e=>{if(o&&n)try{o.emit("placeBet",{bet:e,gameId:n})}catch(a){console.error("Error placing bet:",a),g("Failed to place bet. Please try again.")}}),[o,n]),j=a.useCallback((()=>{if(o&&n)try{o.emit("payAnte",{gameId:n})}catch(e){console.error("Error paying ante:",e),g("Failed to pay ante. Please try again.")}}),[o,n]),v=a.useCallback((()=>{if(o&&n)try{o.emit("dealCards",{gameId:n})}catch(e){console.error("Error dealing cards:",e),g("Failed to deal cards. Please try again.")}}),[o,n]),N=a.useCallback((()=>{if(o&&n)try{o.emit("revealMiddleCard",{gameId:n})}catch(e){console.error("Error revealing middle card:",e),g("Failed to reveal middle card. Please try again.")}}),[o,n]),y=a.useCallback((()=>{if(o&&n)try{o.emit("nextRound",{gameId:n})}catch(e){console.error("Error moving to next round:",e),g("Failed to move to next round. Please try again.")}}),[o,n]),b=a.useCallback((()=>{if(o&&n)try{o.emit("ready")}catch(e){console.error("Error setting player ready:",e),g("Failed to set player ready. Please try again.")}}),[o,n]),C=a.useCallback((()=>{if(o&&n)try{o.emit("unready")}catch(e){console.error("Error setting player unready:",e),g("Failed to set player unready. Please try again.")}}),[o,n]),f={gameState:u,error:h,gameId:n,placeBet:p,payAnte:j,playerReady:b,playerUnready:C,dealCards:v,revealMiddleCard:N,nextRound:y,clearError:x};return e.jsx(I.Provider,{value:f,children:s})},S={gameContainer:"_gameContainer_hptx1_1",gameScreen:"_gameScreen_hptx1_16",errorContainer:"_errorContainer_hptx1_60",errorText:"_errorText_hptx1_70",gameInfoWrapper:"_gameInfoWrapper_hptx1_75",gameBottomSection:"_gameBottomSection_hptx1_90",playerListContainer:"_playerListContainer_hptx1_97",gameLogContainer:"_gameLogContainer_hptx1_102",imBackButton:"_imBackButton_hptx1_205"},B={headerContainer:"_headerContainer_1ypzm_1",desktopLayout:"_desktopLayout_1ypzm_14",mobileLayout:"_mobileLayout_1ypzm_22",mobileTopRow:"_mobileTopRow_1ypzm_28",mobileRight:"_mobileRight_1ypzm_40",mobileActions:"_mobileActions_1ypzm_47",iconButton:"_iconButton_1ypzm_54",exitButton:"_exitButton_1ypzm_84",mobileBottomRow:"_mobileBottomRow_1ypzm_94",headerLeft:"_headerLeft_1ypzm_103",headerRight:"_headerRight_1ypzm_109",controlsGroup:"_controlsGroup_1ypzm_115",controlsStack:"_controlsStack_1ypzm_122",mobileControlsStack:"_mobileControlsStack_1ypzm_129",gameTitle:"_gameTitle_1ypzm_138",liveTag:"_liveTag_1ypzm_148",pulse:"_pulse_1ypzm_1",gameIdText:"_gameIdText_1ypzm_200",gameIdLink:"_gameIdLink_1ypzm_207",balanceDisplay:"_balanceDisplay_1ypzm_224",headerCenter:"_headerCenter_1ypzm_257",buttonGroup:"_buttonGroup_1ypzm_264",gamePhase:"_gamePhase_1ypzm_290",leaveButton:"_leaveButton_1ypzm_319",phaseIcon:"_phaseIcon_1ypzm_367",phaseText:"_phaseText_1ypzm_372",timerBar:"_timerBar_1ypzm_376",timerProgress:"_timerProgress_1ypzm_386",dealPulse:"_dealPulse_1ypzm_1",betPulse:"_betPulse_1ypzm_1",revealFade:"_revealFade_1ypzm_1",resultPulse:"_resultPulse_1ypzm_1",phaseWaiting:"_phaseWaiting_1ypzm_564",phaseDealing:"_phaseDealing_1ypzm_569",phaseBettingYourTurn:"_phaseBettingYourTurn_1ypzm_576",phaseBettingWaiting:"_phaseBettingWaiting_1ypzm_583",phaseRevealing:"_phaseRevealing_1ypzm_589",timerDrain:"_timerDrain_1ypzm_1",phaseResults:"_phaseResults_1ypzm_627",reveal:"_reveal_1ypzm_1",sparkle:"_sparkle_1ypzm_1"},A=({color:a="currentColor",size:s=24})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:a,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),e.jsx("polyline",{points:"16 17 21 12 16 7"}),e.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),R=({onClick:a,title:s="Leave Game",...n})=>e.jsx(d,{icon:e.jsx(A,{color:"white",size:20}),title:s,onClick:a,variant:"danger",...n}),P={waiting:{text:"Waiting for Players",icon:"ðŸ‘¥"},dealing:{text:"Dealing Cards",icon:b},revealing:{text:"Revealing Cards",icon:"ðŸ¥"},results:{text:"Round Results",icon:"ðŸ†"}},L=({handleLeaveGame:s,onModalStateChange:n})=>{var r,i;const{gameState:o,gameId:c}=w(),{socket:d}=t(),{user:j}=l(),v=null==(r=null==d?void 0:d.auth)?void 0:r.userId,N=v&&(null==o?void 0:o.players)?o.players[v]:null,y=(null==N?void 0:N.balance)??(null==j?void 0:j.balance)??0,b=(null==o?void 0:o.phase)||"waiting",[C,f]=a.useState(null),[I,T]=a.useState(!1),[S,A]=a.useState(!1),[L,$]=a.useState(!1),[E,z]=a.useState(!1),[D,O]=a.useState(!1);a.useEffect((()=>{let e;return"dealing"===b?(f(k.DEALING_DURATION),e=setInterval((()=>{f((e=>Math.max(0,e-100)))}),100)):"betting"===b?(f(k.BETTING_DURATION),e=setInterval((()=>{f((e=>Math.max(0,e-100)))}),100)):"revealing"===b?(f(k.REVEALING_DURATION),e=setInterval((()=>{f((e=>Math.max(0,e-100)))}),100)):"results"===b?(f(k.RESULTS_DURATION),e=setInterval((()=>{f((e=>Math.max(0,e-100)))}),100)):f(null),()=>{e&&clearInterval(e)}}),[b,null==o?void 0:o.waitingForAceDecision]),a.useEffect((()=>{n&&n(I||S||L||E||D)}),[I,S,L,E,D,n]);let F=P[b]||{text:"Unknown Phase",icon:"â“"};(null==o?void 0:o.waitingForAceDecision)&&"dealing"===b&&(F={text:"Choosing Ace Value",icon:"ðŸ¤”"}),(null==o?void 0:o.waitingForSecondChance)&&(F={text:"Second Chance Decision",icon:"ðŸ¤”"});const G=d&&(null==(i=d.auth)?void 0:i.userId)&&(null==o?void 0:o.currentPlayerId)===d.auth.userId;if("betting"===b&&(null==o?void 0:o.currentPlayerId)&&(null==o?void 0:o.players)){const e=o.players[o.currentPlayerId];F=e?G?{text:"Pass or Bet",icon:"ðŸ¤”"}:{text:`${e.name} is Betting`,icon:"ðŸ¤”"}:{text:"Betting Round",icon:"ðŸ¤”"}}return e.jsxs("div",{className:B.headerContainer,children:[e.jsxs("div",{className:B.desktopLayout,children:[e.jsxs("div",{className:B.headerLeft,children:[e.jsxs("h1",{className:B.gameTitle,children:["In Between ",e.jsx("span",{className:B.liveTag,children:"LIVE"})]}),e.jsx("p",{className:B.gameIdText,children:e.jsxs("span",{className:B.gameIdLink,onClick:()=>T(!0),title:"Click to view game summary","data-gamepad-focusable":"true",tabIndex:"0",children:["Game #",c]})})]}),e.jsx("div",{className:B.headerCenter,children:e.jsxs("div",{className:`${B.gamePhase} ${"betting"===b?G?B.phaseBettingYourTurn:B.phaseBettingWaiting:B[`phase${b.charAt(0).toUpperCase()+b.slice(1)}`]}`,"data-phase":b,children:[e.jsx("span",{className:B.phaseIcon,children:F.icon}),e.jsx("span",{className:B.phaseText,children:F.text}),null!==C&&e.jsx("div",{className:B.timerBar,children:e.jsx("div",{className:B.timerProgress,style:{width:C/("dealing"===b?k.DEALING_DURATION:"betting"===b?k.BETTING_DURATION:"revealing"===b?k.REVEALING_DURATION:k.RESULTS_DURATION)*100+"%"}})})]})}),e.jsx("div",{className:B.headerRight,children:e.jsxs("div",{className:B.controlsStack,children:[e.jsxs("div",{className:B.balanceDisplay,children:["Balance: ",e.jsx(u,{amount:Number(y),size:"small"})]}),e.jsxs("div",{className:B.controlsGroup,children:[e.jsx(m,{onModalStateChange:$,"data-gamepad-focusable":"true"}),e.jsx(_,{onModalStateChange:z,"data-gamepad-focusable":"true"}),e.jsx(h,{onModalStateChange:O,"data-gamepad-focusable":"true"}),e.jsx(g,{onClick:()=>A(!0),"data-gamepad-focusable":"true"}),e.jsx(R,{onClick:s,"data-gamepad-focusable":"true"})]})]})})]}),e.jsxs("div",{className:B.mobileLayout,children:[e.jsxs("div",{className:B.mobileTopRow,children:[e.jsxs("div",{className:B.headerLeft,children:[e.jsxs("h1",{className:B.gameTitle,children:["In Between ",e.jsx("span",{className:B.liveTag,children:"LIVE"})]}),e.jsx("p",{className:B.gameIdText,children:e.jsxs("span",{className:B.gameIdLink,onClick:()=>T(!0),title:"Click to view game summary","data-gamepad-focusable":"true",tabIndex:"0",children:["Game #",c]})})]}),e.jsx("div",{className:B.mobileRight,children:e.jsxs("div",{className:B.mobileControlsStack,children:[e.jsxs("div",{className:B.balanceDisplay,children:["Balance: ",e.jsx(u,{amount:Number(y),size:"small"})]}),e.jsxs("div",{className:B.mobileActions,children:[e.jsx(m,{onModalStateChange:$,"data-gamepad-focusable":"true"}),e.jsx(_,{onModalStateChange:z,"data-gamepad-focusable":"true"}),e.jsx(h,{onModalStateChange:O,"data-gamepad-focusable":"true"}),e.jsx(g,{onClick:()=>A(!0),"data-gamepad-focusable":"true"}),e.jsx(R,{onClick:s,"data-gamepad-focusable":"true"})]})]})})]}),e.jsx("div",{className:B.mobileBottomRow,children:e.jsxs("div",{className:`${B.gamePhase} ${"betting"===b?G?B.phaseBettingYourTurn:B.phaseBettingWaiting:B[`phase${b.charAt(0).toUpperCase()+b.slice(1)}`]}`,"data-phase":b,children:[e.jsx("span",{className:B.phaseIcon,children:F.icon}),e.jsx("span",{className:B.phaseText,children:F.text}),null!==C&&e.jsx("div",{className:B.timerBar,children:e.jsx("div",{className:B.timerProgress,style:{width:C/("dealing"===b?k.DEALING_DURATION:"betting"===b?k.BETTING_DURATION:"revealing"===b?k.REVEALING_DURATION:k.RESULTS_DURATION)*100+"%"}})})]})})]}),I&&e.jsx(x,{onClose:()=>T(!1),gameData:o}),S&&e.jsx(p,{onClose:()=>A(!1)})]})},$={cardDisplayContainer:"_cardDisplayContainer_nd4gl_1",cardsRow:"_cardsRow_nd4gl_9",card:"_card_nd4gl_1",dealingPhase:"_dealingPhase_nd4gl_59",revealingPhase:"_revealingPhase_nd4gl_68",cardBack:"_cardBack_nd4gl_94",redCard:"_redCard_nd4gl_103",blackCard:"_blackCard_nd4gl_107",cardCorner:"_cardCorner_nd4gl_111",bottomRight:"_bottomRight_nd4gl_120",cardValue:"_cardValue_nd4gl_128",cardSuit:"_cardSuit_nd4gl_134",cardCenter:"_cardCenter_nd4gl_139",aceCard:"_aceCard_nd4gl_147",aceIndicator:"_aceIndicator_nd4gl_151",aceHigh:"_aceHigh_nd4gl_171",aceLow:"_aceLow_nd4gl_177",indicatorContent:"_indicatorContent_nd4gl_183"},E=({direction:a="up",color:s="currentColor",size:n=24})=>{const t="down"===a?"rotate(180deg)":"rotate(0deg)";return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:s,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{transform:t,display:"inline-block",transformOrigin:"center"},children:e.jsx("path",{d:"M7 11l5-5 5 5M7 17l5-5 5 5"})})},z=()=>{const{gameState:a}=w();if(!a)return e.jsx("div",{className:$.loading,children:"Loading game state..."});const{firstCard:s,secondCard:n,thirdCard:t,phase:l,dealer:r}=a;null==r||r.name;const i={2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10",J:"J",Q:"Q",K:"K",A:"A"},o={hearts:"â™¥",diamonds:"â™¦",clubs:"â™£",spades:"â™ ","â™¥":"â™¥","â™¦":"â™¦","â™£":"â™£","â™ ":"â™ "},c=(a,s)=>{if(!a)return e.jsx("div",{className:$.card,children:e.jsx("div",{className:$.cardBack})},`empty-${s}`);const n="â™¥"===(t=a.suit)||"â™¦"===t||"hearts"===t||"diamonds"===t;var t;const l="A"===a.value,r=a.isAceLow,c=1===s;return e.jsxs("div",{className:`${$.card} ${n?$.redCard:$.blackCard} ${l?$.aceCard:""}`,children:[l&&!c&&e.jsx("div",{className:`${$.aceIndicator} ${r?$.aceLow:$.aceHigh} ${n?$.redCard:$.blackCard}`,children:r?e.jsxs("span",{className:$.indicatorContent,children:["LOW ",e.jsx(E,{direction:"down",color:n?"#e74c3c":"#2c3e50",size:16})]}):e.jsxs("span",{className:$.indicatorContent,children:["HIGH ",e.jsx(E,{direction:"up",color:n?"#e74c3c":"#2c3e50",size:16})]})}),e.jsxs("div",{className:$.cardCorner,children:[e.jsx("div",{className:$.cardValue,children:i[a.value]}),e.jsx("div",{className:$.cardSuit,children:o[a.suit]})]}),e.jsx("div",{className:$.cardCenter,children:o[a.suit]}),e.jsxs("div",{className:`${$.cardCorner} ${$.bottomRight}`,children:[e.jsx("div",{className:$.cardValue,children:i[a.value]}),e.jsx("div",{className:$.cardSuit,children:o[a.suit]})]})]},`${a.value}-${a.suit}-${s}`)};return e.jsx("div",{className:$.cardDisplayContainer,children:e.jsx("div",{className:`${$.cardsRow} ${"dealing"===l?$.dealingPhase:""} ${"revealing"===l?$.revealingPhase:""}`,children:(()=>{let e=[null,null,null];return s||n||t?(s&&(e[0]={...s}),n&&(e[2]={...n}),t&&(e[1]={...t}),e.map(((e,a)=>c(e,a)))):e.map(((e,a)=>c(e,a)))})()})})},D="_bettingPanel_tec12_1",O="_betContainer_tec12_145",F="_betText_tec12_154",G="_extremeOptionsRow_tec12_186",U="_betButtons_tec12_201",M="_betButton_tec12_201",W="_disabledButton_tec12_251",q="_extremeButton_tec12_258",V="_passButton_tec12_272",H="_customBetContainer_tec12_415",J="_customBetInput_tec12_429",Y="_customBetButton_tec12_440",K="_potButton_146vb_5",Q="_shimmerBorder_146vb_47",X="_buttonBackground_146vb_81",Z="_reflectionEffect_146vb_101",ee="_buttonContent_146vb_148",ae="_potText_146vb_164",se="_potAmount_146vb_185",ne="_disabled_146vb_258",te=({amount:a,disabled:s,onClick:n,...t})=>e.jsxs("button",{className:`${K} ${s?ne:""}`,onClick:n,disabled:s,"aria-label":`Bet the pot: ${a} chips`,...t,children:[e.jsx("div",{className:Q}),e.jsx("div",{className:X}),e.jsx("div",{className:Z}),e.jsxs("div",{className:ee,children:[e.jsx("span",{className:ae,children:"POT"}),e.jsx("span",{className:se,children:e.jsx(u,{amount:a,background:"pill"})})]})]}),le=()=>{var s,n;const{gameState:l,placeBet:r}=w(),{socket:i}=t(),[o,c]=a.useState("");if(!l)return null;const{players:d,currentPlayerId:m,pot:_,phase:h,firstCard:g,secondCard:x}=l;if("betting"!==h)return null;const p=i&&m===(null==(s=i.auth)?void 0:s.userId),v=i&&d&&(null==(n=i.auth)?void 0:n.userId)?d[i.auth.userId]:null,N=Number((null==v?void 0:v.balance)||0),y=e=>{const a=e.target.value.replace(/[^0-9]/g,""),s=Math.min(_,N);a&&parseInt(a)>s?c(s.toString()):c(a)},b=()=>{if(o&&!isNaN(o)){const e=parseInt(o,10);e>=1&&e<=Math.min(_,N)&&(r(e),c(""))}},C=e=>{"Enter"===e.key&&b()};return p?e.jsx("div",{className:D,children:p?e.jsxs("div",{className:O,children:[e.jsxs("p",{className:F,children:["Place your bet (Min: ",e.jsx(u,{amount:1}),", Max: ",e.jsx(u,{amount:Math.min(_,N)}),")"]}),e.jsxs("div",{className:G,children:[e.jsx("button",{className:`${M} ${q} ${V}`,onClick:()=>r(0),"data-gamepad-focusable":"true",autoFocus:!0,children:"PASS"}),e.jsx(te,{amount:_,onClick:()=>r(_),disabled:_>N,"data-gamepad-focusable":"true"})]}),e.jsxs("div",{className:U,children:[[1,2,5].map((a=>{const s=Math.min(_,N),n=a>s;return e.jsx("button",{className:`${M} ${n?W:""}`,onClick:()=>r(a),disabled:n,"data-gamepad-focusable":"true",children:e.jsx(u,{amount:a})},a)})),e.jsxs("div",{className:H,children:[e.jsx(j,{title:"Enter Bet Amount",type:"number",className:J,placeholder:"Custom",value:o,onChange:y,onKeyPress:C}),e.jsx("button",{className:Y,onClick:b,disabled:!o,"data-gamepad-focusable":"true",children:"Bet"})]})]})]}):null}):null},re="_playersContainer_1etil_1",ie="_playersTitle_1etil_15",oe="_playersList_1etil_38",ce="_playerItem_1etil_44",de="_currentPlayer_1etil_72",ue="_currentUser_1etil_78",me="_playerInfo_1etil_82",_e="_playerName_1etil_89",he="_playerStatus_1etil_94",ge="_disconnectedIndicator_1etil_101",xe="_playerBalanceContainer_1etil_108",pe="_playerBalance_1etil_108",je="_balanceIncrease_1etil_127",ve="_balanceDecrease_1etil_131",Ne="_readyIndicator_1etil_161",ye="_ready_1etil_161",be="_notReady_1etil_172",Ce="_sittingOut_1etil_176",fe="_emptyPlayerList_1etil_191",ke=()=>{var s;const{gameState:n}=w(),{socket:l}=t(),r=a.useContext(i);if(a.useEffect((()=>{if((null==n?void 0:n.players)&&r){const e=Object.values(n.players).map((e=>e.userId)).filter(Boolean);e.length>0&&r.prefetchUsers(e)}}),[null==n?void 0:n.players,r]),!n||!n.players)return e.jsx("div",{className:fe,children:e.jsx("p",{children:"Waiting for game data..."})});const{players:o,currentPlayerId:c,dealerId:d,gameTransactions:u=[]}=n,m=null==(s=null==l?void 0:l.auth)?void 0:s.userId,_=n.totals||{};return o&&0!==Object.keys(o).length?e.jsxs("div",{className:re,children:[e.jsx("h3",{className:ie,children:"Scoreboard"}),e.jsx("div",{className:oe,children:n.seats.filter((e=>null!==e&&o[e])).map((a=>{const s=o[a],n=a===c,t=s.userId===m,l=a===d;return s.disconnected,e.jsxs("div",{className:`\n                  ${ce}\n                  ${n?de:""}\n                  ${t?ue:""}\n                `,children:[e.jsxs("div",{className:me,children:[e.jsx(v,{userId:s.userId,size:"small",showName:!1}),e.jsxs("span",{className:_e,children:[s.name,e.jsxs("span",{className:he,children:[l&&` ${b}`,s.disconnected&&e.jsx("span",{className:ge,title:"Player disconnected",children:"âš ï¸ Disconnected"})]})]})]}),e.jsxs("div",{className:xe,children:[e.jsx(Ie,{balance:_[a]||0}),e.jsx("div",{className:`\n                    ${Ne} \n                    ${s.isSittingOut?Ce:s.isReady?ye:be}\n                  `,title:s.isSittingOut?"Sitting Out":s.isReady?"Ready":"Not Ready"})]})]},a)}))})]}):e.jsx("div",{className:fe,children:e.jsx("p",{children:"Waiting for players to join..."})})},Ie=({balance:s})=>{const[n,t]=a.useState(s),[l,r]=a.useState(""),i=a.useRef(null);return a.useEffect((()=>{if(s!==n){r(s>n?je:ve),i.current&&clearTimeout(i.current),i.current=setTimeout((()=>{r("")}),1e3),t(s)}return()=>{i.current&&clearTimeout(i.current)}}),[s]),e.jsx("span",{className:`${pe} ${l}`,children:e.jsx(u,{amount:s})})},we="_potDisplayContainer_1seua_1",Te="_potIconWrapper_1seua_29",Se="_potIcon_1seua_29",Be="_potInfo_1seua_55",Ae="_potLabel_1seua_61",Re="_potAmount_1seua_73",Pe="_potCounter_1seua_80",Le=()=>{const{gameState:a}=w();if(!a)return null;const{pot:s,round:n=1}=a;return e.jsxs("div",{className:we,children:[e.jsx("div",{className:Te,children:e.jsx("span",{className:Se,children:y})}),e.jsxs("div",{className:Be,children:[e.jsxs("h3",{className:Ae,children:["POT ",e.jsxs("span",{className:Pe,children:["(",n,")"]})]}),e.jsx("span",{className:Re,children:e.jsx(u,{amount:s,size:"medium"})})]})]})},$e="_deckDisplayContainer_1nuck_1",Ee="_deckVisual_1nuck_29",ze="_deckIcon_1nuck_37",De="_deckThick_1nuck_45",Oe="_deckMedium_1nuck_46",Fe="_deckThin_1nuck_47",Ge="_deckVeryThin_1nuck_48",Ue="_deckInfo_1nuck_95",Me="_deckLabel_1nuck_101",We="_deckCount_1nuck_113",qe="_deckCounter_1nuck_120",Ve=()=>{const{gameState:a}=w();if(!a)return null;const{deckSize:s=0,deckCount:n=1}=a;return e.jsxs("div",{className:$e,children:[e.jsx("div",{className:`${Ee} ${s>=40?De:s>=25?Oe:s>=10?Fe:Ge}`,children:e.jsx("div",{className:ze,children:f})}),e.jsxs("div",{className:Ue,children:[e.jsxs("h3",{className:Me,children:["DECK ",e.jsxs("span",{className:qe,children:["(",n,")"]})]}),e.jsx("span",{className:We,children:s})]})]})},He="_anteControlsWrapper_kosev_1",Je="_controlsContainer_kosev_8",Ye="_autoAnteContainer_kosev_25",Ke="_anteButton_kosev_32",Qe="_backOutButton_kosev_32",Xe="_shimmerBorder_kosev_107",Ze="_anteIcon_kosev_225",ea="_backOutIcon_kosev_225",aa="_buttonInfo_kosev_244",sa="_buttonLabel_kosev_250",na="_buttonAmount_kosev_267",ta="_notEnoughChipsText_kosev_282",la="_buttonContainerRow_kosev_294",ra="_sitOutHalfWidth_kosev_304",ia="_toggleContainer_11qbc_1",oa="_toggleLabel_11qbc_12",ca="_toggleInput_11qbc_19",da="_toggleSlider_11qbc_25",ua="_toggleText_11qbc_74",ma="_loading_11qbc_82",_a=()=>{const{preferences:a,toggleAutoAnte:s,loading:n}=o(),{gameState:l,playerReady:r}=w(),{socket:i}=t();return n?e.jsx("div",{className:ma,children:"Loading preferences..."}):e.jsx("div",{className:ia,children:e.jsxs("label",{className:oa,children:[e.jsx("input",{type:"checkbox",checked:a.autoAnte,onChange:async()=>{var e;const n=!a.autoAnte,t=await s();if(n&&t&&r){let a=null;if(i&&(null==(e=i.auth)?void 0:e.userId)&&(null==l?void 0:l.players)){const e=Object.keys(l.players);for(const s of e)if(l.players[s].userId===i.auth.userId){a=l.players[s];break}}(null==a?void 0:a.isReady)||r()}},className:ca,"data-gamepad-focusable":"true"}),e.jsx("span",{className:da}),e.jsx("span",{className:ua,children:"Auto-Ante"})]})})},ha=()=>{var a;const{gameState:s,playerReady:n,playerUnready:r}=w(),{socket:i}=t(),{user:o}=l();if(!s)return null;const{players:c,anteAmount:d,phase:m}=s;if("waiting"!==m)return null;let _=null;if(i&&(null==(a=i.auth)?void 0:a.userId)&&c){const e=Object.keys(c);for(const a of e)if(c[a].userId===i.auth.userId){_=c[a];break}}else if(o&&c){const e=Object.keys(c);for(const a of e)if(c[a].userId===o.id){_=c[a],console.log("[AnteControls] Found player by user ID instead of socket ID");break}}const h=Number((null==_?void 0:_.balance)||0),g=null==_?void 0:_.isReady,x=h>=d;return e.jsx("div",{className:He,children:e.jsxs("div",{className:Je,children:[e.jsx("div",{className:la,children:g?e.jsx("div",{className:la,children:e.jsxs("button",{className:Qe,onClick:()=>{"function"==typeof r?r():console.error("playerUnready is not a function")},"aria-label":"Back out","data-gamepad-focusable":"true",children:[e.jsx("div",{className:Xe}),e.jsx("span",{className:ea,children:"âœ•"}),e.jsx("div",{className:aa,children:e.jsx("h3",{className:sa,children:"BACK OUT"})})]})}):e.jsxs("div",{className:la,children:[e.jsxs("button",{className:Ke,onClick:n,disabled:!x,"aria-label":"Ante up","data-gamepad-focusable":"true",autoFocus:!0,children:[e.jsx("div",{className:Xe}),e.jsx("span",{className:Ze,children:C}),e.jsxs("div",{className:aa,children:[e.jsx("h3",{className:sa,children:"ANTE"}),e.jsx("span",{className:na,children:e.jsx(u,{amount:d})})]})]}),e.jsxs("button",{className:`${Qe} ${ra}`,onClick:()=>{var e;i&&s&&o&&i.emit("sitOut",{gameId:s.id,userId:(null==(e=i.auth)?void 0:e.userId)||o.id})},disabled:null==_?void 0:_.isSittingOut,title:(null==_?void 0:_.isSittingOut)?"You are currently sitting out":"Sit out next round","aria-label":"Sit Out","data-gamepad-focusable":"true",children:[e.jsx("div",{className:Xe}),e.jsx("div",{className:aa,children:e.jsx("h3",{className:sa,children:"SIT OUT"})})]}),!x&&e.jsxs("p",{className:ta,children:["Not enough coins (",e.jsx(u,{amount:d})," required)"]})]})}),e.jsx("div",{className:Ye,children:e.jsx(_a,{})})]})})},ga={resultsPanel:"_resultsPanel_ayp0x_1",resultContent:"_resultContent_ayp0x_19",resultText:"_resultText_ayp0x_27",winText:"_winText_ayp0x_34",tieText:"_tieText_ayp0x_39",loseText:"_loseText_ayp0x_50",winningsText:"_winningsText_ayp0x_55",countdownContainer:"_countdownContainer_ayp0x_62",countdownText:"_countdownText_ayp0x_67",countdownProgress:"_countdownProgress_ayp0x_74",countdownBar:"_countdownBar_ayp0x_82",penaltyWarning:"_penaltyWarning_ayp0x_95"},xa=()=>{var a;const{gameState:s}=w();if(!s.result)return null;const{result:n,players:t,resultCountdown:l}=s,r=null==(a=t[n.playerId])?void 0:a.name;return e.jsx("div",{className:ga.resultsPanel,children:e.jsxs("div",{className:ga.resultContent,children:[(()=>{switch(n.outcome){case"win":return e.jsxs(e.Fragment,{children:[e.jsxs("h2",{className:`${ga.resultText} ${ga.winText}`,children:[r," WON!"]}),n.winnings>0&&e.jsxs("p",{className:ga.winningsText,children:["Winnings: ",e.jsx(u,{amount:n.winnings/2,size:"medium"})]})]});case"lose":return e.jsxs(e.Fragment,{children:[e.jsxs("h2",{className:`${ga.resultText} ${ga.loseText}`,children:[r," LOST!"]}),n.betAmount>0&&e.jsxs("p",{className:ga.winningsText,children:["Loss: ",e.jsx(u,{amount:n.betAmount,size:"medium"})]})]});case"tie":return(()=>{const a=n.betAmount*(n.isTripleAceTie?3:2);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:ga.penaltyWarning,children:e.jsx("div",{className:ga.cautionTape})}),e.jsxs("h2",{className:`${ga.resultText} ${ga.tieText}`,children:[r," ",n.isTripleAceTie?"3X":"2X"," PENALTY!"]}),n.betAmount>0&&e.jsxs("p",{className:ga.winningsText,children:["Penalty: ",e.jsx(u,{amount:a,size:"medium"})]})]})})();default:return null}})(),l&&e.jsxs("div",{className:ga.countdownContainer,children:[e.jsxs("p",{className:ga.countdownText,children:["Next hand in: ",l.countdownSeconds,"s"]}),e.jsx("div",{className:ga.countdownProgress,children:e.jsx("div",{className:ga.countdownBar,style:{width:l.countdownSeconds/5*100+"%"}})})]})]})})},pa="_aceChoicePanel_1y6rg_1",ja="_aceChoiceControls_1y6rg_18",va="_aceChoiceText_1y6rg_31",Na="_waitingMessage_1y6rg_39",ya="_waitingText_1y6rg_53",ba="_countdown_1y6rg_60",Ca="_aceChoiceButtons_1y6rg_66",fa="_aceChoiceButton_1y6rg_66",ka="_aceHighButton_1y6rg_100",Ia="_aceLowButton_1y6rg_111",wa="_buttonContent_1y6rg_122",Ta=()=>{var s,n,r;const{socket:i}=t(),{gameState:o}=w(),{user:c}=l(),[d,u]=a.useState(15);a.useEffect((()=>{var e;if((null==o?void 0:o.waitingForAceDecision)&&(null==(e=null==i?void 0:i.auth)?void 0:e.userId)===o.currentPlayerId){u(15);const e=setInterval((()=>{u((a=>a<=1?(clearInterval(e),0):a-1))}),1e3);return()=>clearInterval(e)}}),[null==o?void 0:o.waitingForAceDecision,null==o?void 0:o.currentPlayerId,null==(s=null==i?void 0:i.auth)?void 0:s.userId]);const m=e=>{i.emit("chooseAceValue",{isAceLow:e})},_=(null==(n=null==i?void 0:i.auth)?void 0:n.userId)===o.currentPlayerId,h=(null==(r=o.players[o.currentPlayerId])?void 0:r.name)||"Current player";return e.jsxs("div",{className:pa,children:[_?e.jsxs("div",{className:ja,children:[e.jsxs("p",{className:va,children:["You've been dealt an Ace! Choose whether it should be high or low.",e.jsxs("span",{className:ba,children:[" (",d,"s)"]})]}),e.jsxs("div",{className:Ca,children:[e.jsx("button",{className:`${fa} ${ka}`,onClick:()=>m(!1),"data-gamepad-focusable":"true",autoFocus:!0,children:e.jsxs("span",{className:wa,children:["ACE HIGH ",e.jsx(E,{direction:"up",color:"white",size:20})]})}),e.jsx("button",{className:`${fa} ${Ia}`,onClick:()=>m(!0),"data-gamepad-focusable":"true",children:e.jsxs("span",{className:wa,children:["ACE LOW ",e.jsx(E,{direction:"down",color:"white",size:20})]})})]})]}):null,_?null:e.jsx("div",{className:Na,children:e.jsxs("p",{className:ya,children:[h," is choosing whether their Ace is high or low..."]})})]})},Sa="_secondChancePanel_mgk8a_1",Ba="_secondChanceControls_mgk8a_18",Aa="_secondChanceText_mgk8a_31",Ra="_waitingMessage_mgk8a_40",Pa="_waitingText_mgk8a_54",La="_countdown_mgk8a_61",$a="_secondChanceButtons_mgk8a_68",Ea="_secondChanceButton_mgk8a_68",za="_anteAgainButton_mgk8a_94",Da="_passButton_mgk8a_107",Oa="_currencyWrapper_mgk8a_120",Fa=()=>{var s,n;const{gameState:l}=w(),{socket:r}=t(),[i,o]=a.useState(!1),[c,d]=a.useState(null),[m,_]=a.useState(15);a.useEffect((()=>{var e;if((null==l?void 0:l.waitingForSecondChance)&&(null==(e=null==r?void 0:r.auth)?void 0:e.userId)===l.currentPlayerId){_(15);const e=setInterval((()=>{_((a=>a<=1?(clearInterval(e),0):a-1))}),1e3);return()=>clearInterval(e)}}),[null==l?void 0:l.waitingForSecondChance,null==l?void 0:l.currentPlayerId,null==(s=null==r?void 0:r.auth)?void 0:s.userId]);const{players:h,currentPlayerId:g,anteAmount:x=1}=l,p=r&&g===(null==(n=r.auth)?void 0:n.userId),j=h[g],v=e=>{r&&(o(!0),d(e?"ante":"pass"),r.emit("secondChance",{anteAgain:e}))};return e.jsxs("div",{className:Sa,children:[p?e.jsxs("div",{className:Ba,children:[e.jsxs("p",{className:Aa,children:["Would you like to ante up again for a second chance?",e.jsxs("span",{className:La,children:[" (",m,"s)"]})]}),e.jsxs("div",{className:$a,children:[e.jsx("button",{className:`${Ea} ${za}`,onClick:()=>v(!0),"data-gamepad-focusable":"true",autoFocus:!0,children:i&&"ante"===c?"Processing...":e.jsxs(e.Fragment,{children:["Ante Up ",e.jsx("span",{className:Oa,children:e.jsx(u,{amount:x,size:"small"})})]})}),e.jsx("button",{className:`${Ea} ${Da}`,onClick:()=>v(!1),"data-gamepad-focusable":"true",children:i&&"pass"===c?"Processing...":"Pass"})]})]}):null,p?null:e.jsx("div",{className:Ra,children:e.jsxs("p",{className:Pa,children:[null==j?void 0:j.name," is deciding whether to take a second chance."]})})]})},Ga="_gameLogContainer_1c2o8_1",Ua="_gameLogHeader_1c2o8_10",Ma="_expandIcon_1c2o8_28",Wa="_gameLogEntries_1c2o8_51",qa="_expanded_1c2o8_61",Va="_logEntry_1c2o8_65",Ha="_logTime_1c2o8_90",Ja="_logMessage_1c2o8_97",Ya="_emptyLog_1c2o8_102",Ka="_showMoreButton_1c2o8_110",Qa=()=>{const{gameState:s}=w(),[n,t]=a.useState(!1);if(!s||!s.gameLog)return null;const l=s.gameLog||[],r=()=>{t(!n)},i=n?l:l.slice(0,5);return e.jsxs("div",{className:Ga,children:[e.jsxs("div",{className:Ua,onClick:r,children:[e.jsx("h3",{children:"Game Log"}),e.jsx("span",{className:Ma,children:n?"â–²":"â–¼"})]}),e.jsx("div",{className:`${Wa} ${n?qa:""}`,children:0===i.length?e.jsx("div",{className:Ya,children:"No game events yet"}):i.map(((a,s)=>{return e.jsxs("div",{className:Va,children:[e.jsx("span",{className:Ha,children:(n=a.timestamp,new Date(n).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"}))}),e.jsx("span",{className:Ja,children:a.message})]},s);var n}))}),!n&&l.length>5&&e.jsxs("div",{className:Ka,onClick:r,children:["Show ",l.length-5," more entries"]})]})},Xa="_emojiReactions_19n7s_1",Za="_toggleButton_19n7s_8",es="_emojiPanel_19n7s_34",as="_emojiGrid_19n7s_59",ss="_emojiButton_19n7s_65",ns=()=>{const[s,n]=a.useState(!1),{socket:r}=t(),{gameState:i}=w(),{user:o}=l();return e.jsxs("div",{className:Xa,children:[e.jsx("button",{className:Za,onClick:()=>{n(!s)},"data-gamepad-focusable":"true","aria-label":"Toggle emoji reactions",children:"ðŸ˜Š"}),s&&e.jsx("div",{className:es,children:e.jsx("div",{className:as,children:[{emoji:"ðŸ”¥",name:"Fire",color:"#FF6B35"},{emoji:"ðŸ˜„",name:"Happy",color:"#FFD93D"},{emoji:"ðŸ’©",name:"Poop",color:"#8B4513"},{emoji:"ðŸ˜Ž",name:"Cool",color:"#4A5568"},{emoji:"ðŸ¤¯",name:"Mind Blown",color:"#FFA500"},{emoji:"ðŸ˜ˆ",name:"Devilish",color:"#9333EA"},{emoji:"ðŸ˜¬",name:"Worried",color:"#FCD34D"},{emoji:"ðŸ‘",name:"Applause",color:"#FBBF24"},{emoji:"ðŸ˜­",name:"Crying",color:"#3B82F6"},{emoji:"ðŸ¤¡",name:"Clown",color:"#EF4444"},{emoji:"ðŸ’ª",name:"Strong",color:"#F59E0B"},{emoji:"ðŸ˜…",name:"Nervous",color:"#60A5FA"},{emoji:"ðŸŽ‰",name:"Celebration",color:"#A855F7"},{emoji:"ðŸ¤”",name:"Thinking",color:"#6B7280"},{emoji:"ðŸ™ˆ",name:"See No Evil",color:"#A0522D"},{emoji:"ðŸ˜¤",name:"Confident",color:"#DC2626"}].map(((a,s)=>e.jsx("button",{className:ss,onClick:()=>(e=>{r&&i&&o&&(r.emit("emojiReaction",{gameId:i.id,emoji:e.emoji,color:e.color,playerName:o.username}),n(!1))})(a),"data-gamepad-focusable":"true",title:a.name,style:{"--emoji-color":a.color},children:a.emoji},s)))})})]})},ts=({onReturnToLobby:s})=>{const[n,r]=a.useState(!1),{gameState:i,error:o,clearError:c}=w();N(!0),a.useEffect((()=>{if(o){const e=setTimeout((()=>{c()}),1e4);return()=>clearTimeout(e)}}),[o,c]);const{socket:d}=t(),{user:u}=l();if(!i)return e.jsx("div",{className:S.loadingContainer,children:e.jsx("p",{children:"Loading game state..."})});const m=i.phase||"waiting",_=null==u?void 0:u.id,h=i.players&&_?i.players[_]:null;return e.jsxs("div",{className:S.gameContainer,children:[e.jsxs("div",{className:`${S.gameScreen} mobile-scale-content`,children:[e.jsx(L,{handleLeaveGame:()=>{s&&s()},onModalStateChange:r}),o&&e.jsx("div",{className:S.errorContainer,children:e.jsx("p",{className:S.errorText,children:o})}),e.jsxs("div",{className:S.gameInfoWrapper,children:[e.jsx(Ve,{}),e.jsx(Le,{})]}),e.jsx(z,{}),(null==h?void 0:h.isSittingOut)?e.jsx("button",{onClick:()=>{d&&i.id?d.emit("imBack",{gameId:i.id}):console.error("Cannot emit 'imBack': socket or gameId missing.")},className:S.imBackButton,"data-gamepad-focusable":"true",autoFocus:!0,children:"I'm Back!"}):"waiting"===m?e.jsx(ha,{}):"results"===m?e.jsx(xa,{}):i.waitingForAceDecision?e.jsx(Ta,{}):i.waitingForSecondChance?e.jsx(Fa,{}):"betting"===m?e.jsx(le,{}):null,e.jsxs("div",{className:S.gameBottomSection,children:[e.jsx("div",{className:S.playerListContainer,children:e.jsx(ke,{})}),e.jsx("div",{className:S.gameLogContainer,children:e.jsx(Qa,{})})]})]}),!n&&e.jsx(ns,{})]})},ls="_modalOverlay_quw6f_1",rs="_modalContent_quw6f_14",is="_passwordInput_quw6f_34",os="_modalActions_quw6f_52",cs="_modalButton_quw6f_58",ds="_cancelButton_quw6f_69",us="_submitButton_quw6f_78";function ms({isOpen:s,onClose:n,onSubmit:t,gameId:l}){const[r,i]=a.useState("");if(!s)return null;return e.jsx("div",{className:ls,children:e.jsxs("div",{className:rs,children:[e.jsx("h2",{children:"Password Required"}),e.jsxs("p",{children:["Please enter the password for game ",e.jsx("strong",{children:l||""}),":"]}),e.jsxs("form",{onSubmit:e=>{e.preventDefault(),t(r),i("")},children:[e.jsx(j,{title:"Enter Game Password",type:"password",value:r,onChange:e=>i(e.target.value),className:is,autoFocus:!0,required:!0}),e.jsxs("div",{className:os,children:[e.jsx("button",{type:"button",onClick:()=>{i(""),n()},className:`${cs} ${ds}`,"data-gamepad-focusable":"true",children:"Cancel"}),e.jsx("button",{type:"submit",className:`${cs} ${us}`,"data-gamepad-focusable":"true",children:"Join Game"})]})]})]})})}const _s=()=>{const{gameId:l}=s(),i=n(),{socket:o,isConnected:d}=t(),[u,m]=a.useState(!0),[_,h]=a.useState(null),[g,x]=a.useState(!1),p=a.useRef(!1),j=a.useCallback((()=>{o&&d&&l&&(r.play("ui.leave"),o.emit("leaveGame",{gameId:l}),i("/"))}),[o,d,l,i]),v=a.useCallback((e=>{x(!1),o&&l&&e&&(h(null),o.emit("joinGame",{gameId:l,password:e}),m(!0))}),[o,l]),N=a.useCallback((()=>{x(!1),i("/")}),[i]);a.useEffect((()=>{h(null),x(!1),m(!0)}),[l]),a.useEffect((()=>{if(!o)return;const e=e=>{e&&e.game&&e.game.id===l&&(r.play("ui.join"),m(!1),h(null),x(!1))},a=e=>{const a=e.message||"An unknown error occurred";"Password required"===a?(console.error(e),x(!0),m(!1),h(null)):"Invalid password"===a?(console.error(e),h("Invalid password."),x(!0),m(!1)):"Game not found"===a?i("/"):"Game is full"===a?(h(a),m(!1),x(!1),setTimeout((()=>i("/")),3e3)):(h(a),m(!1),x(!1))};return o.on("gameJoined",e),o.on("error",a),()=>{o.off("gameJoined",e),o.off("error",a)}}),[o,l,i]),a.useEffect((()=>{o&&l&&!p.current&&(p.current=!0,m(!0),h(null),x(!1),o.emit("joinGame",{gameId:l}))}),[o,l]);const y=()=>{const{gameState:a}=w();return e.jsxs(e.Fragment,{children:[e.jsx(ms,{isOpen:g,onClose:N,onSubmit:v,gameId:l}),u&&e.jsx(c,{message:`Joining game ${l}...`}),_&&!u&&!g&&e.jsxs("div",{className:"error-container",style:{padding:"20px",color:"red",textAlign:"center"},children:[e.jsx("h2",{children:"An error occurred"}),e.jsx("p",{children:_}),e.jsx("button",{onClick:()=>window.location.reload(),children:"Refresh Page"})]}),!u&&!_&&a&&e.jsx(ts,{onReturnToLobby:j})]})};return e.jsx(T,{gameId:l,children:e.jsx(y,{})})};export{_s as default};
//# sourceMappingURL=GameRoom-BGEh5mP6.js.map
