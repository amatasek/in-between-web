import{b as e,a,s,j as t,U as n,f as r,L as i}from"./index-GgSw9UCw.js";import{r as l,e as c,u as o}from"./vendor-D3vErxIQ.js";import{C as d,a as m,R as u,P as _,S as h,I as x,c as g,b as p,G as j,U as f}from"./GamepadInput-CVhpUhXg.js";import{u as b}from"./useGamepadNavigation-Tj-O-nX_.js";import"./audio-D4HOgbU8.js";import"./socket-DfKCw8Ob.js";const v="🍯",N="🃏",y="✓",C="🃏",{TIMERS:I}={TIMERS:{DEALING_DURATION:3e3,BETTING_DURATION:3e4,REVEALING_DURATION:3e3,RESULTS_DURATION:5e3}},w=l.createContext(),k=()=>{const e=l.useContext(w);if(void 0===e)throw new Error("useGameContext must be used within a GameProvider");return e},T=({children:n,gameId:r,initialGameState:i=null})=>{const{socket:c,error:o}=e(),{user:d}=a(),[m,u]=l.useState(i);l.useRef({});const _=l.useRef(null),[h,x]=l.useState(null),g=l.useCallback((()=>{x(null)}),[]);l.useEffect((()=>{o&&x(o)}),[o]),l.useEffect((()=>{if(c)return c.on("gameReconnected",(e=>{u(e.game),x(null),e.game&&e.game.id&&setTimeout((()=>{c.emit("getGameState",{gameId:e.game.id})}),500)})),c.on("gameState",(e=>{if(e&&e.id&&JSON.stringify(m)!==JSON.stringify(e)){if(e.currentPlayerId&&d?.id){const a=e.currentPlayerId===d.id,t=_.current===d.id;a&&!t&&s.play("ui.alert"),_.current=e.currentPlayerId}u(e),g()}})),c.on("gameError",(e=>{x(e)})),()=>{c.off("gameReconnected"),c.off("gameState"),c.off("gameError")}}),[c]);const p=l.useCallback((e=>{if(c&&r)try{c.emit("placeBet",{bet:e,gameId:r})}catch(a){x("Failed to place bet. Please try again.")}}),[c,r]),j=l.useCallback((()=>{if(c&&r)try{c.emit("payAnte",{gameId:r})}catch(e){x("Failed to pay ante. Please try again.")}}),[c,r]),f=l.useCallback((()=>{if(c&&r)try{c.emit("dealCards",{gameId:r})}catch(e){x("Failed to deal cards. Please try again.")}}),[c,r]),b=l.useCallback((()=>{if(c&&r)try{c.emit("revealMiddleCard",{gameId:r})}catch(e){x("Failed to reveal middle card. Please try again.")}}),[c,r]),v=l.useCallback((()=>{if(c&&r)try{c.emit("nextRound",{gameId:r})}catch(e){x("Failed to move to next round. Please try again.")}}),[c,r]),N=l.useCallback((()=>{if(c&&r)try{c.emit("ready")}catch(e){x("Failed to set player ready. Please try again.")}}),[c,r]),y=l.useCallback((()=>{if(c&&r)try{c.emit("unready")}catch(e){x("Failed to set player unready. Please try again.")}}),[c,r]),C={gameState:m,error:h,gameId:r,placeBet:p,payAnte:j,playerReady:N,playerUnready:y,dealCards:f,revealMiddleCard:b,nextRound:v,clearError:g};return t.jsx(w.Provider,{value:C,children:n})},S="_gameContainer_1f8yw_1",A="_gameScreen_1f8yw_5",B="_loadingContainer_1f8yw_31",P="_errorContainer_1f8yw_40",R="_errorText_1f8yw_50",L="_gameInfoWrapper_1f8yw_55",E="_gameBottomSection_1f8yw_70",$="_playerListContainer_1f8yw_77",O="_gameLogContainer_1f8yw_82",q={headerContainer:"_headerContainer_7fahv_1",desktopLayout:"_desktopLayout_7fahv_7",mobileLayout:"_mobileLayout_7fahv_13",mobileTopRow:"_mobileTopRow_7fahv_19",mobileRight:"_mobileRight_7fahv_31",mobileActions:"_mobileActions_7fahv_38",mobileBottomRow:"_mobileBottomRow_7fahv_45",headerLeft:"_headerLeft_7fahv_54",headerRight:"_headerRight_7fahv_60",controlsGroup:"_controlsGroup_7fahv_66",controlsStack:"_controlsStack_7fahv_73",mobileControlsStack:"_mobileControlsStack_7fahv_80",gameTitle:"_gameTitle_7fahv_89",liveTag:"_liveTag_7fahv_99",pulse:"_pulse_7fahv_1",gameIdText:"_gameIdText_7fahv_151",gameIdLink:"_gameIdLink_7fahv_158",headerCenter:"_headerCenter_7fahv_195",gamePhase:"_gamePhase_7fahv_223",phaseIcon:"_phaseIcon_7fahv_285",phaseText:"_phaseText_7fahv_290",timerBar:"_timerBar_7fahv_294",timerProgress:"_timerProgress_7fahv_304",dealPulse:"_dealPulse_7fahv_1",betPulse:"_betPulse_7fahv_1",revealFade:"_revealFade_7fahv_1",resultPulse:"_resultPulse_7fahv_1",phaseBettingYourTurn:"_phaseBettingYourTurn_7fahv_458",phaseBettingWaiting:"_phaseBettingWaiting_7fahv_465",reveal:"_reveal_7fahv_1",sparkle:"_sparkle_7fahv_1",timerDrain:"_timerDrain_7fahv_1"},D=({color:e="currentColor",size:a=24})=>t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:a,height:a,viewBox:"0 0 24 24",fill:"none",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),t.jsx("polyline",{points:"16 17 21 12 16 7"}),t.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),F={waiting:{text:"Waiting for Players",icon:"👥"},dealing:{text:"Dealing Cards",icon:N},revealing:{text:"Revealing Cards",icon:"🥁"},results:{text:"Round Results",icon:"🏆"}},G=({handleLeaveGame:s,onModalStateChange:n})=>{const{gameState:r,gameId:i}=k(),{socket:c}=e(),{user:o}=a(),j=c?.auth?.userId,f=j&&r?.players?r.players[j]:null,b=f?.balance??o?.balance??0,v=r?.phase||"waiting",N=f?.isReady||!1,[y,C]=l.useState(null),[w,T]=l.useState(!1),[S,A]=l.useState(!1),[B,P]=l.useState(!1),[R,L]=l.useState(!1),[E,$]=l.useState(!1);l.useEffect((()=>{let e;return"dealing"===v?(C(I.DEALING_DURATION),e=setInterval((()=>{C((e=>Math.max(0,e-100)))}),100)):"betting"===v?(C(I.BETTING_DURATION),e=setInterval((()=>{C((e=>Math.max(0,e-100)))}),100)):"revealing"===v?(C(I.REVEALING_DURATION),e=setInterval((()=>{C((e=>Math.max(0,e-100)))}),100)):"results"===v?(C(I.RESULTS_DURATION),e=setInterval((()=>{C((e=>Math.max(0,e-100)))}),100)):C(null),()=>{e&&clearInterval(e)}}),[v,r?.waitingForAceDecision]),l.useEffect((()=>{n&&n(w||S||B||R||E)}),[w,S,B,R,E,n]);let O=F[v]||{text:"Unknown Phase",icon:"❓"};r?.waitingForAceDecision&&"dealing"===v&&(O={text:"Choosing Ace Value",icon:"🤔"}),r?.waitingForSecondChance&&(O={text:"Second Chance Decision",icon:"🤔"});const G=c&&c.auth?.userId&&r?.currentPlayerId===c.auth.userId;if("betting"===v&&r?.currentPlayerId&&r?.players){const e=r.players[r.currentPlayerId];O=e?G?{text:"Pass or Bet",icon:"🤔"}:{text:`${e.name} is Betting`,icon:"🤔"}:{text:"Betting Round",icon:"🤔"}}return t.jsxs("div",{className:q.headerContainer,children:[t.jsxs("div",{className:`panel ${q.desktopLayout}`,children:[t.jsxs("div",{className:q.headerLeft,children:[t.jsxs("h1",{className:q.gameTitle,children:["In Between ",t.jsx("span",{className:q.liveTag,children:"LIVE"})]}),t.jsx("p",{className:q.gameIdText,children:t.jsxs("span",{className:q.gameIdLink,onClick:()=>T(!0),title:"Click to view game summary","data-gamepad-focusable":"true",tabIndex:"0",children:["Game #",i]})})]}),t.jsx("div",{className:q.headerCenter,children:t.jsxs("div",{className:`${q.gamePhase} ${"betting"===v?G?q.phaseBettingYourTurn:q.phaseBettingWaiting:q[`phase${v.charAt(0).toUpperCase()+v.slice(1)}`]}`,"data-phase":v,children:[t.jsx("span",{className:q.phaseIcon,children:O.icon}),t.jsx("span",{className:q.phaseText,children:O.text}),null!==y&&t.jsx("div",{className:q.timerBar,children:t.jsx("div",{className:q.timerProgress,style:{width:y/("dealing"===v?I.DEALING_DURATION:"betting"===v?I.BETTING_DURATION:"revealing"===v?I.REVEALING_DURATION:I.RESULTS_DURATION)*100+"%"}})})]})}),t.jsx("div",{className:q.headerRight,children:t.jsxs("div",{className:q.controlsStack,children:[t.jsx("div",{className:"panel-alt",style:{padding:"0.2rem 0.4rem",margin:"0 0 0.2rem 0",gap:"0.25rem"},children:t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem",fontSize:"0.85rem",fontWeight:600,color:"#ecf0f1"},children:[t.jsx("span",{children:"Balance:"}),t.jsx(d,{amount:Number(b),size:"small"})]})}),t.jsxs("div",{className:q.controlsGroup,children:[t.jsx(m,{onModalStateChange:P,"data-gamepad-focusable":"true"}),t.jsx(u,{onModalStateChange:L,"data-gamepad-focusable":"true"}),t.jsx(_,{onModalStateChange:$,"data-gamepad-focusable":"true"}),t.jsx(h,{onClick:()=>A(!0),"data-gamepad-focusable":"true"}),t.jsx(x,{icon:t.jsx(D,{color:"white",size:20}),title:"Leave Game",onClick:s,variant:"danger",disabled:N,"data-gamepad-focusable":"true"})]})]})})]}),t.jsxs("div",{className:`panel ${q.mobileLayout}`,children:[t.jsxs("div",{className:q.mobileTopRow,children:[t.jsxs("div",{className:q.headerLeft,children:[t.jsxs("h1",{className:q.gameTitle,children:["In Between ",t.jsx("span",{className:q.liveTag,children:"LIVE"})]}),t.jsx("p",{className:q.gameIdText,children:t.jsxs("span",{className:q.gameIdLink,onClick:()=>T(!0),title:"Click to view game summary","data-gamepad-focusable":"true",tabIndex:"0",children:["Game #",i]})})]}),t.jsx("div",{className:q.mobileRight,children:t.jsxs("div",{className:q.mobileControlsStack,children:[t.jsx("div",{className:"panel-alt",style:{padding:"0.15rem 0.35rem",margin:"0 0 0.2rem 0",gap:"0.25rem"},children:t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem",fontSize:"0.85rem",fontWeight:600,color:"#ecf0f1"},children:[t.jsx("span",{children:"Balance:"}),t.jsx(d,{amount:Number(b),size:"small"})]})}),t.jsxs("div",{className:q.mobileActions,children:[t.jsx(m,{onModalStateChange:P,"data-gamepad-focusable":"true"}),t.jsx(u,{onModalStateChange:L,"data-gamepad-focusable":"true"}),t.jsx(_,{onModalStateChange:$,"data-gamepad-focusable":"true"}),t.jsx(h,{onClick:()=>A(!0),"data-gamepad-focusable":"true"}),t.jsx(x,{icon:t.jsx(D,{color:"white",size:20}),title:"Leave Game",onClick:s,variant:"danger",disabled:N,"data-gamepad-focusable":"true"})]})]})})]}),t.jsx("div",{className:q.mobileBottomRow,children:t.jsxs("div",{className:`${q.gamePhase} ${"betting"===v?G?q.phaseBettingYourTurn:q.phaseBettingWaiting:q[`phase${v.charAt(0).toUpperCase()+v.slice(1)}`]}`,"data-phase":v,children:[t.jsx("span",{className:q.phaseIcon,children:O.icon}),t.jsx("span",{className:q.phaseText,children:O.text}),null!==y&&t.jsx("div",{className:q.timerBar,children:t.jsx("div",{className:q.timerProgress,style:{width:y/("dealing"===v?I.DEALING_DURATION:"betting"===v?I.BETTING_DURATION:"revealing"===v?I.REVEALING_DURATION:I.RESULTS_DURATION)*100+"%"}})})]})})]}),w&&t.jsx(g,{onClose:()=>T(!1),gameData:r}),S&&t.jsx(p,{onClose:()=>A(!1)})]})},U={cardDisplayContainer:"_cardDisplayContainer_a7qnj_1",cardsRow:"_cardsRow_a7qnj_9",card:"_card_a7qnj_1",dealingPhase:"_dealingPhase_a7qnj_53",revealingPhase:"_revealingPhase_a7qnj_62",cardBack:"_cardBack_a7qnj_88",redCard:"_redCard_a7qnj_97",blackCard:"_blackCard_a7qnj_101",cardCorner:"_cardCorner_a7qnj_105",bottomRight:"_bottomRight_a7qnj_114",cardValue:"_cardValue_a7qnj_122",cardSuit:"_cardSuit_a7qnj_128",cardCenter:"_cardCenter_a7qnj_133",aceCard:"_aceCard_a7qnj_166",aceIndicator:"_aceIndicator_a7qnj_170",aceHigh:"_aceHigh_a7qnj_190",aceLow:"_aceLow_a7qnj_196",indicatorContent:"_indicatorContent_a7qnj_202"},z=({direction:e="up",color:a="currentColor",size:s=24})=>{const n="down"===e?"rotate(180deg)":"rotate(0deg)";return t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:a,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{transform:n,display:"inline-block",transformOrigin:"center"},children:t.jsx("path",{d:"M7 11l5-5 5 5M7 17l5-5 5 5"})})},W=()=>{const{gameState:e}=k();if(!e)return t.jsx("div",{className:U.loading,children:"Loading game state..."});const{firstCard:a,secondCard:s,thirdCard:n,phase:r,dealer:i}=e,l={2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10",J:"J",Q:"Q",K:"K",A:"A"},c={hearts:"♥",diamonds:"♦",clubs:"♣",spades:"♠","♥":"♥","♦":"♦","♣":"♣","♠":"♠"},o=(e,a)=>{if(!e)return t.jsx("div",{className:U.card,children:t.jsx("div",{className:U.cardBack})},`empty-${a}`);const s="♥"===(n=e.suit)||"♦"===n||"hearts"===n||"diamonds"===n;var n;const r="A"===e.value,i=e.isAceLow,o=1===a;return t.jsxs("div",{className:`${U.card} ${s?U.redCard:U.blackCard} ${r?U.aceCard:""}`,children:[r&&!o&&t.jsx("div",{className:`${U.aceIndicator} ${i?U.aceLow:U.aceHigh} ${s?U.redCard:U.blackCard}`,children:i?t.jsxs("span",{className:U.indicatorContent,children:["LOW ",t.jsx(z,{direction:"down",color:s?"#e74c3c":"#2c3e50",size:16})]}):t.jsxs("span",{className:U.indicatorContent,children:["HIGH ",t.jsx(z,{direction:"up",color:s?"#e74c3c":"#2c3e50",size:16})]})}),t.jsxs("div",{className:U.cardCorner,children:[t.jsx("div",{className:U.cardValue,children:l[e.value]}),t.jsx("div",{className:U.cardSuit,children:c[e.suit]})]}),t.jsx("div",{className:U.cardCenter,children:c[e.suit]}),t.jsxs("div",{className:`${U.cardCorner} ${U.bottomRight}`,children:[t.jsx("div",{className:U.cardValue,children:l[e.value]}),t.jsx("div",{className:U.cardSuit,children:c[e.suit]})]})]},`${e.value}-${e.suit}-${a}`)};return t.jsx("div",{className:U.cardDisplayContainer,children:t.jsx("div",{className:`${U.cardsRow} ${"dealing"===r?U.dealingPhase:""} ${"revealing"===r?U.revealingPhase:""}`,children:(()=>{let e=[null,null,null];return a||s||n?(a&&(e[0]={...a}),s&&(e[2]={...s}),n&&(e[1]={...n}),e.map(((e,a)=>o(e,a)))):e.map(((e,a)=>o(e,a)))})()})})},M="_bettingPanel_2vdkb_1",V="_betContainer_2vdkb_19",H="_betText_2vdkb_28",J="_extremeOptionsRow_2vdkb_45",Y="_betButtons_2vdkb_60",K="_customBetContainer_2vdkb_78",Q="_customBetInput_2vdkb_90",X="_potButton_1wzdu_5",Z="_shimmerBorder_1wzdu_47",ee="_buttonBackground_1wzdu_81",ae="_reflectionEffect_1wzdu_101",se="_buttonContent_1wzdu_148",te="_potText_1wzdu_164",ne="_potAmount_1wzdu_185",re="_disabled_1wzdu_258",ie=({amount:e,disabled:a,onClick:s,...n})=>t.jsxs("button",{className:`${X} ${a?re:""}`,onClick:s,disabled:a,"aria-label":`Bet the pot: ${e} chips`,...n,children:[t.jsx("div",{className:Z}),t.jsx("div",{className:ee}),t.jsx("div",{className:ae}),t.jsxs("div",{className:se,children:[t.jsx("span",{className:te,children:"POT"}),t.jsx("span",{className:ne,children:t.jsx(d,{amount:e,background:"pill"})})]})]}),le=()=>{const{gameState:a,placeBet:s}=k(),{socket:n}=e(),[r,i]=l.useState("");if(!a)return null;const{players:c,currentPlayerId:o,pot:m,phase:u,firstCard:_,secondCard:h}=a;if("betting"!==u)return null;const x=n&&o===n.auth?.userId,g=n&&c&&n.auth?.userId?c[n.auth.userId]:null,p=Number(g?.balance||0),f=e=>{const a=e.target.value.replace(/[^0-9]/g,""),s=Math.min(m,p);a&&parseInt(a)>s?i(s.toString()):i(a)},b=()=>{if(r&&!isNaN(r)){const e=parseInt(r,10);e>=1&&e<=Math.min(m,p)&&(s(e),i(""))}},v=e=>{"Enter"===e.key&&b()};return x?t.jsx("div",{className:M,children:x?t.jsxs("div",{className:V,children:[t.jsxs("p",{className:H,children:["Place your bet (Min: ",t.jsx(d,{amount:1}),", Max: ",t.jsx(d,{amount:Math.min(m,p)}),")"]}),t.jsxs("div",{className:J,children:[t.jsx("button",{className:"btn btn-secondary",style:{flex:1},onClick:()=>s(0),"data-gamepad-focusable":"true",autoFocus:!0,children:"PASS"}),t.jsx(ie,{amount:m,onClick:()=>s(m),disabled:m>p,"data-gamepad-focusable":"true"})]}),t.jsxs("div",{className:Y,children:[[1,2,5].map((e=>{const a=Math.min(m,p),n=e>a;return t.jsx("button",{className:"btn btn-tertiary",style:{minWidth:"40px",padding:"0.65rem 0.4rem",fontSize:"0.95rem"},onClick:()=>s(e),disabled:n,"data-gamepad-focusable":"true",children:t.jsx(d,{amount:e})},e)})),t.jsxs("div",{className:K,children:[t.jsx(j,{title:"Enter Bet Amount",type:"number",className:Q,placeholder:"Custom",value:r,onChange:f,onKeyPress:v}),t.jsx("button",{className:"btn btn-primary",style:{minWidth:"40px",padding:"0.65rem 0.4rem",fontSize:"0.95rem"},onClick:b,disabled:!r,"data-gamepad-focusable":"true",children:"Bet"})]})]})]}):null}):null},ce="_playersContainer_arq91_1",oe="_playersTitle_arq91_15",de="_playersList_arq91_38",me="_playerItem_arq91_46",ue="_currentPlayerGlow_arq91_61",_e="_currentUser_arq91_75",he="_playerInfo_arq91_79",xe="_playerStatus_arq91_87",ge="_disconnectedIndicator_arq91_94",pe="_playerBalanceContainer_arq91_101",je="_playerBalance_arq91_101",fe="_balanceIncrease_arq91_120",be="_balanceDecrease_arq91_124",ve="_readyIndicator_arq91_154",Ne="_ready_arq91_154",ye="_notReady_arq91_165",Ce="_sittingOut_arq91_169",Ie="_emptyPlayerList_arq91_184",we=()=>{const{gameState:a}=k(),{socket:s}=e(),r=l.useContext(n);if(l.useEffect((()=>{if(a?.players&&r){const e=Object.values(a.players).map((e=>e.userId)).filter(Boolean);e.length>0&&r.prefetchUsers(e)}}),[a?.players,r]),!a||!a.players)return t.jsx("div",{className:Ie,children:t.jsx("p",{children:"Waiting for game data..."})});const{players:i,currentPlayerId:c,dealerId:o,gameTransactions:d=[]}=a,m=s?.auth?.userId,u=a.totals||{};return i&&0!==Object.keys(i).length?t.jsxs("div",{className:ce,children:[t.jsx("h3",{className:oe,children:"Scoreboard"}),t.jsx("div",{className:de,children:a.seats.filter((e=>null!==e&&i[e])).map((e=>{const a=i[e],s=e===c,n=a.userId===m,r=e===o;return a.disconnected,t.jsxs("div",{className:`\n                  ${s?"panel":"panel-alt"}\n                  ${me}\n                  ${s?ue:""}\n                  ${n?_e:""}\n                `,style:{padding:"0.35rem 0.75rem",gap:"0.5rem",flexDirection:"row",fontSize:"0.9rem"},children:[t.jsxs("div",{className:he,children:[t.jsx(f,{userId:a.userId,size:"small",showName:!0,namePosition:"right"}),t.jsxs("span",{className:xe,children:[r&&` ${N}`,a.disconnected&&t.jsx("span",{className:ge,title:"Player disconnected",children:"⚠️ Disconnected"})]})]}),t.jsxs("div",{className:pe,children:[t.jsx(ke,{balance:u[e]||0}),t.jsx("div",{className:`\n                    ${ve} \n                    ${a.isSittingOut?Ce:a.isReady?Ne:ye}\n                  `,title:a.isSittingOut?"Sitting Out":a.isReady?"Ready":"Not Ready"})]})]},e)}))})]}):t.jsx("div",{className:Ie,children:t.jsx("p",{children:"Waiting for players to join..."})})},ke=({balance:e})=>{const[a,s]=l.useState(e),[n,r]=l.useState(""),i=l.useRef(null);return l.useEffect((()=>{if(e!==a){r(e>a?fe:be),i.current&&clearTimeout(i.current),i.current=setTimeout((()=>{r("")}),1e3),s(e)}return()=>{i.current&&clearTimeout(i.current)}}),[e]),t.jsx("span",{className:`${je} ${n}`,children:t.jsx(d,{amount:e})})},Te="_potIconWrapper_58b18_2",Se="_potIcon_58b18_2",Ae="_potInfo_58b18_28",Be="_potLabel_58b18_34",Pe="_potAmount_58b18_46",Re="_potCounter_58b18_53",Le=()=>{const{gameState:e}=k();if(!e)return null;const{pot:a,round:s=1}=e;return t.jsxs("div",{className:"card",style:{width:"150px",padding:"0.75rem 1rem",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"0.5rem",border:"2px solid #f1c40f"},children:[t.jsx("div",{className:Te,children:t.jsx("span",{className:Se,children:v})}),t.jsxs("div",{className:Ae,children:[t.jsxs("h3",{className:Be,children:["POT ",t.jsxs("span",{className:Re,children:["(",s,")"]})]}),t.jsx("span",{className:Pe,children:t.jsx(d,{amount:a,size:"medium"})})]})]})},Ee="_deckVisual_nb490_2",$e="_deckIcon_nb490_9",Oe="_deckInfo_nb490_25",qe="_deckLabel_nb490_31",De="_deckCount_nb490_43",Fe="_deckCounter_nb490_50",Ge=()=>{const{gameState:e}=k();if(!e)return null;const{deckSize:a=0,deckCount:s=1}=e;return t.jsxs("div",{className:"card",style:{width:"150px",padding:"0.75rem 1rem",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"0.5rem",border:"2px solid var(--info)"},children:[t.jsx("div",{className:Ee,children:t.jsx("div",{className:$e,children:C})}),t.jsxs("div",{className:Oe,children:[t.jsxs("h3",{className:qe,children:["DECK ",t.jsxs("span",{className:Fe,children:["(",s,")"]})]}),t.jsx("span",{className:De,children:a})]})]})},Ue="_anteControlsWrapper_ypuxr_1",ze="_controlsContainer_ypuxr_8",We="_autoAnteContainer_ypuxr_25",Me="_anteButton_ypuxr_32",Ve="_backOutButton_ypuxr_32",He="_shimmerBorder_ypuxr_106",Je="_anteIcon_ypuxr_224",Ye="_backOutIcon_ypuxr_224",Ke="_buttonInfo_ypuxr_243",Qe="_buttonLabel_ypuxr_249",Xe="_buttonAmount_ypuxr_266",Ze="_notEnoughChipsText_ypuxr_281",ea="_buttonContainerRow_ypuxr_293",aa="_sitOutHalfWidth_ypuxr_303",sa="_toggleLabel_8n6m6_2",ta="_toggleInput_8n6m6_9",na="_toggleSlider_8n6m6_15",ra="_toggleText_8n6m6_64",ia="_loading_8n6m6_72",la=()=>{const{preferences:a,toggleAutoAnte:s,loading:n}=r(),{gameState:i,playerReady:l}=k(),{socket:c}=e();return n?t.jsx("div",{className:ia,children:"Loading preferences..."}):t.jsx("div",{className:"panel-alt",style:{padding:"0.5rem 0.75rem",gap:"0",marginTop:"5px",maxWidth:"fit-content"},children:t.jsxs("label",{className:sa,children:[t.jsx("input",{type:"checkbox",checked:a.autoAnte,onChange:async()=>{const e=!a.autoAnte,t=await s();if(e&&t&&l){let e=null;if(c&&c.auth?.userId&&i?.players){const a=Object.keys(i.players);for(const s of a)if(i.players[s].userId===c.auth.userId){e=i.players[s];break}}const a=e?.isReady;a||l()}},className:ta,"data-gamepad-focusable":"true"}),t.jsx("span",{className:na}),t.jsx("span",{className:ra,children:"Auto-Ante"})]})})},ca=()=>{const{gameState:s,playerReady:n,playerUnready:r}=k(),{socket:i}=e(),{user:l}=a();if(!s)return null;const{players:c,anteAmount:o,phase:m}=s;if("waiting"!==m)return null;let u=null;if(i&&i.auth?.userId&&c){const e=Object.keys(c);for(const a of e)if(c[a].userId===i.auth.userId){u=c[a];break}}else if(l&&c){const e=Object.keys(c);for(const a of e)if(c[a].userId===l.id){u=c[a];break}}const _=Number(u?.balance||0),h=u?.isReady,x=_>=o;return t.jsx("div",{className:Ue,children:t.jsxs("div",{className:ze,children:[t.jsx("div",{className:ea,children:h?t.jsx("div",{className:ea,children:t.jsxs("button",{className:Ve,onClick:()=>{"function"==typeof r&&r()},"aria-label":"Back out","data-gamepad-focusable":"true",children:[t.jsx("div",{className:He}),t.jsx("span",{className:Ye,children:"✕"}),t.jsx("div",{className:Ke,children:t.jsx("h3",{className:Qe,children:"BACK OUT"})})]})}):t.jsxs("div",{className:ea,children:[t.jsxs("button",{className:Me,onClick:n,disabled:!x,"aria-label":"Ante up","data-gamepad-focusable":"true",autoFocus:!0,children:[t.jsx("div",{className:He}),t.jsx("span",{className:Je,children:y}),t.jsxs("div",{className:Ke,children:[t.jsx("h3",{className:Qe,children:"ANTE"}),t.jsx("span",{className:Xe,children:t.jsx(d,{amount:o})})]})]}),t.jsxs("button",{className:`${Ve} ${aa}`,onClick:()=>{i&&s&&l&&i.emit("sitOut",{gameId:s.id,userId:i.auth?.userId||l.id})},disabled:u?.isSittingOut,title:u?.isSittingOut?"You are currently sitting out":"Sit out next round","aria-label":"Sit Out","data-gamepad-focusable":"true",children:[t.jsx("div",{className:He}),t.jsx("div",{className:Ke,children:t.jsx("h3",{className:Qe,children:"SIT OUT"})})]}),!x&&t.jsxs("p",{className:Ze,children:["Not enough coins (",t.jsx(d,{amount:o})," required)"]})]})}),t.jsx("div",{className:We,children:t.jsx(la,{})})]})})},oa={resultContent:"_resultContent_8ie9r_4",resultText:"_resultText_8ie9r_12",winText:"_winText_8ie9r_19",tieText:"_tieText_8ie9r_24",loseText:"_loseText_8ie9r_35",winningsText:"_winningsText_8ie9r_40",countdownContainer:"_countdownContainer_8ie9r_47",countdownText:"_countdownText_8ie9r_52",countdownProgress:"_countdownProgress_8ie9r_59",countdownBar:"_countdownBar_8ie9r_67",penaltyWarning:"_penaltyWarning_8ie9r_80",tiePanel:"_tiePanel_8ie9r_90"},da=()=>{const{gameState:e}=k();if(!e.result)return null;const{result:a,players:s,resultCountdown:n}=e,r=s[a.playerId]?.name,i="tie"===a.outcome?`panel-alt ${oa.tiePanel}`:"panel-alt";return t.jsx("div",{className:i,style:{maxWidth:"500px",margin:"1rem auto",width:"90%",animation:"fadeIn 0.5s ease-out"},children:t.jsxs("div",{className:oa.resultContent,children:[(()=>{switch(a.outcome){case"win":return t.jsxs(t.Fragment,{children:[t.jsxs("h2",{className:`${oa.resultText} ${oa.winText}`,children:[r," WON!"]}),a.winnings>0&&t.jsxs("p",{className:oa.winningsText,children:["Winnings: ",t.jsx(d,{amount:a.winnings/2,size:"medium"})]})]});case"lose":return t.jsxs(t.Fragment,{children:[t.jsxs("h2",{className:`${oa.resultText} ${oa.loseText}`,children:[r," LOST!"]}),a.betAmount>0&&t.jsxs("p",{className:oa.winningsText,children:["Loss: ",t.jsx(d,{amount:a.betAmount,size:"medium"})]})]});case"tie":return(()=>{const e=a.betAmount*(a.isTripleAceTie?3:2);return t.jsxs(t.Fragment,{children:[t.jsx("div",{className:oa.penaltyWarning,children:t.jsx("div",{className:oa.cautionTape})}),t.jsxs("h2",{className:`${oa.resultText} ${oa.tieText}`,children:[r," ",a.isTripleAceTie?"3X":"2X"," PENALTY!"]}),a.betAmount>0&&t.jsxs("p",{className:oa.winningsText,children:["Penalty: ",t.jsx(d,{amount:e,size:"medium"})]})]})})();default:return null}})(),n&&t.jsxs("div",{className:oa.countdownContainer,children:[t.jsxs("p",{className:oa.countdownText,children:["Next hand in: ",n.countdownSeconds,"s"]}),t.jsx("div",{className:oa.countdownProgress,children:t.jsx("div",{className:oa.countdownBar,style:{width:n.countdownSeconds/5*100+"%"}})})]})]})})},ma="_aceChoicePanel_xp6de_1",ua="_aceChoiceText_xp6de_19",_a="_waitingText_xp6de_28",ha="_countdown_xp6de_35",xa="_aceChoiceButtons_xp6de_41",ga="_buttonContent_xp6de_50",pa=()=>{const{socket:s}=e(),{gameState:n}=k(),{user:r}=a(),[i,c]=l.useState(15);l.useEffect((()=>{if(n?.waitingForAceDecision&&s?.auth?.userId===n.currentPlayerId){c(15);const e=setInterval((()=>{c((a=>a<=1?(clearInterval(e),0):a-1))}),1e3);return()=>clearInterval(e)}}),[n?.waitingForAceDecision,n?.currentPlayerId,s?.auth?.userId]);const o=e=>{s.emit("chooseAceValue",{isAceLow:e})},d=s?.auth?.userId===n.currentPlayerId,m=n.players[n.currentPlayerId]?.name||"Current player";return t.jsxs("div",{className:ma,children:[d?t.jsxs("div",{className:"panel-alt",style:{width:"100%",marginBottom:"0.5rem",alignItems:"center"},children:[t.jsxs("p",{className:ua,children:["You've been dealt an Ace! Choose whether it should be high or low.",t.jsxs("span",{className:ha,children:[" (",i,"s)"]})]}),t.jsxs("div",{className:xa,children:[t.jsx("button",{className:"btn btn-primary",onClick:()=>o(!0),"data-gamepad-focusable":"true",autoFocus:!0,children:t.jsxs("span",{className:ga,children:["ACE LOW ",t.jsx(z,{direction:"down",color:"white",size:20})]})}),t.jsx("button",{className:"btn btn-tertiary",onClick:()=>o(!1),"data-gamepad-focusable":"true",children:t.jsxs("span",{className:ga,children:["ACE HIGH ",t.jsx(z,{direction:"up",color:"white",size:20})]})})]})]}):null,d?null:t.jsx("div",{className:"panel-alt",style:{width:"100%",marginBottom:"0.5rem"},children:t.jsxs("p",{className:_a,children:[m," is choosing whether their Ace is high or low..."]})})]})},ja="_secondChancePanel_1sg84_1",fa="_secondChanceText_1sg84_19",ba="_waitingText_1sg84_29",va="_countdown_1sg84_36",Na="_secondChanceButtons_1sg84_43",ya="_currencyWrapper_1sg84_95",Ca=()=>{const{gameState:a}=k(),{socket:s}=e(),[n,r]=l.useState(!1),[i,c]=l.useState(null),[o,m]=l.useState(15);l.useEffect((()=>{if(a?.waitingForSecondChance&&s?.auth?.userId===a.currentPlayerId){m(15);const e=setInterval((()=>{m((a=>a<=1?(clearInterval(e),0):a-1))}),1e3);return()=>clearInterval(e)}}),[a?.waitingForSecondChance,a?.currentPlayerId,s?.auth?.userId]);const{players:u,currentPlayerId:_,anteAmount:h=1}=a,x=s&&_===s.auth?.userId,g=u[_],p=e=>{s&&(r(!0),c(e?"ante":"pass"),s.emit("secondChance",{anteAgain:e}))};return t.jsxs("div",{className:ja,children:[x?t.jsxs("div",{className:"panel-alt",style:{width:"100%",marginBottom:"0.5rem",alignItems:"center"},children:[t.jsxs("p",{className:fa,children:["Would you like to ante up again for a second chance?",t.jsxs("span",{className:va,children:[" (",o,"s)"]})]}),t.jsxs("div",{className:Na,children:[t.jsx("button",{className:"btn btn-primary",onClick:()=>p(!0),"data-gamepad-focusable":"true",autoFocus:!0,children:n&&"ante"===i?"Processing...":t.jsxs(t.Fragment,{children:["Ante Up ",t.jsx("span",{className:ya,children:t.jsx(d,{amount:h,size:"small"})})]})}),t.jsx("button",{className:"btn btn-secondary",onClick:()=>p(!1),"data-gamepad-focusable":"true",children:n&&"pass"===i?"Processing...":"Pass"})]})]}):null,x?null:t.jsx("div",{className:"panel-alt",style:{width:"100%",marginBottom:"0.5rem"},children:t.jsxs("p",{className:ba,children:[g?.name," is deciding whether to take a second chance."]})})]})},Ia="_gameLogContainer_9fbgp_1",wa="_gameLogHeader_9fbgp_10",ka="_expandIcon_9fbgp_28",Ta="_gameLogEntries_9fbgp_51",Sa="_expanded_9fbgp_61",Aa="_logEntry_9fbgp_65",Ba="_logTime_9fbgp_90",Pa="_logMessage_9fbgp_97",Ra="_emptyLog_9fbgp_102",La="_showMoreButton_9fbgp_110",Ea=()=>{const{gameState:e}=k(),[a,s]=l.useState(!1);if(!e||!e.gameLog)return null;const n=e.gameLog||[],r=()=>{s(!a)},i=a?n:n.slice(0,10);return t.jsxs("div",{className:Ia,children:[t.jsxs("div",{className:wa,onClick:r,children:[t.jsx("h3",{children:"Game Log"}),t.jsx("span",{className:ka,children:a?"▲":"▼"})]}),t.jsx("div",{className:`${Ta} ${a?Sa:""}`,children:0===i.length?t.jsx("div",{className:Ra,children:"No game events yet"}):i.map(((e,a)=>{return t.jsxs("div",{className:Aa,children:[t.jsx("span",{className:Ba,children:(s=e.timestamp,new Date(s).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"}))}),t.jsx("span",{className:Pa,children:e.message})]},a);var s}))}),!a&&n.length>5&&t.jsxs("div",{className:La,onClick:r,children:["Show ",n.length-5," more entries"]})]})},$a="_emojiReactions_1ibvr_1",Oa="_toggleButton_1ibvr_8",qa="_emojiPanel_1ibvr_34",Da="_emojiGrid_1ibvr_59",Fa="_emojiButton_1ibvr_65",Ga=()=>{const[s,n]=l.useState(!1),{socket:r}=e(),{gameState:i}=k(),{user:c}=a();return t.jsxs("div",{className:$a,children:[t.jsx("button",{className:Oa,onClick:()=>{n(!s)},"data-gamepad-focusable":"true","aria-label":"Toggle emoji reactions",children:"😊"}),s&&t.jsx("div",{className:qa,children:t.jsx("div",{className:Da,children:[{emoji:"🔥",name:"Fire",color:"#FF6B35"},{emoji:"😄",name:"Happy",color:"#FFD93D"},{emoji:"💩",name:"Poop",color:"#8B4513"},{emoji:"😎",name:"Cool",color:"#4A5568"},{emoji:"🤯",name:"Mind Blown",color:"#FFA500"},{emoji:"😈",name:"Devilish",color:"#9333EA"},{emoji:"😬",name:"Worried",color:"#FCD34D"},{emoji:"👏",name:"Applause",color:"#FBBF24"},{emoji:"😭",name:"Crying",color:"#3B82F6"},{emoji:"🤡",name:"Clown",color:"#EF4444"},{emoji:"💪",name:"Strong",color:"#F59E0B"},{emoji:"😅",name:"Nervous",color:"#60A5FA"},{emoji:"🎉",name:"Celebration",color:"#A855F7"},{emoji:"🤔",name:"Thinking",color:"#6B7280"},{emoji:"🙈",name:"See No Evil",color:"#A0522D"},{emoji:"😤",name:"Confident",color:"#DC2626"}].map(((e,a)=>t.jsx("button",{className:Fa,onClick:()=>(e=>{r&&i&&c&&(r.emit("emojiReaction",{gameId:i.id,emoji:e.emoji,color:e.color,playerName:c.username}),n(!1))})(e),"data-gamepad-focusable":"true",title:e.name,style:{"--emoji-color":e.color},children:e.emoji},a)))})})]})},Ua=({onReturnToLobby:s})=>{const[n,r]=l.useState(!1),{gameState:i,error:c,clearError:o}=k();b(!0),l.useEffect((()=>{if(c){const e=setTimeout((()=>{o()}),1e4);return()=>clearTimeout(e)}}),[c,o]);const{socket:d}=e(),{user:m}=a();if(!i)return t.jsx("div",{className:B,children:t.jsx("p",{children:"Loading game state..."})});const u=i.phase||"waiting",_=m?.id,h=i.players&&_?i.players[_]:null;return t.jsxs("div",{className:`screen ${S}`,children:[t.jsxs("div",{className:`${A} mobile-scale-content`,children:[t.jsx(G,{handleLeaveGame:()=>{s&&s()},onModalStateChange:r}),c&&t.jsx("div",{className:P,children:t.jsx("p",{className:R,children:c})}),t.jsxs("div",{className:L,children:[t.jsx(Ge,{}),t.jsx(Le,{})]}),t.jsx(W,{}),h?.isSittingOut?t.jsx("button",{onClick:()=>{d&&i.id&&d.emit("imBack",{gameId:i.id})},className:"btn btn-primary",style:{maxWidth:"300px"},"data-gamepad-focusable":"true",autoFocus:!0,children:"I'm Back!"}):"waiting"===u?t.jsx(ca,{}):"results"===u?t.jsx(da,{}):i.waitingForAceDecision?t.jsx(pa,{}):i.waitingForSecondChance?t.jsx(Ca,{}):"betting"===u?t.jsx(le,{}):null,t.jsxs("div",{className:E,children:[t.jsx("div",{className:$,children:t.jsx(we,{})}),t.jsx("div",{className:O,children:t.jsx(Ea,{})})]})]}),!n&&t.jsx(Ga,{})]})},za="_modalOverlay_jrbqi_1",Wa="_modalContent_jrbqi_14",Ma="_passwordInput_jrbqi_34",Va="_modalActions_jrbqi_52",Ha="_modalButton_jrbqi_58",Ja="_cancelButton_jrbqi_69",Ya="_submitButton_jrbqi_78";function Ka({isOpen:e,onClose:a,onSubmit:s,gameId:n}){const[r,i]=l.useState("");if(!e)return null;return t.jsx("div",{className:za,children:t.jsxs("div",{className:Wa,children:[t.jsx("h2",{children:"Password Required"}),t.jsxs("p",{children:["Please enter the password for game ",t.jsx("strong",{children:n||""}),":"]}),t.jsxs("form",{onSubmit:e=>{e.preventDefault(),s(r),i("")},children:[t.jsx(j,{title:"Enter Game Password",type:"password",value:r,onChange:e=>i(e.target.value),className:Ma,autoFocus:!0,required:!0}),t.jsxs("div",{className:Va,children:[t.jsx("button",{type:"button",onClick:()=>{i(""),a()},className:`${Ha} ${Ja}`,"data-gamepad-focusable":"true",children:"Cancel"}),t.jsx("button",{type:"submit",className:`${Ha} ${Ya}`,"data-gamepad-focusable":"true",children:"Join Game"})]})]})]})})}const Qa=()=>{const{gameId:a}=c(),n=o(),{socket:r,isConnected:d}=e(),[m,u]=l.useState(!0),[_,h]=l.useState(null),[x,g]=l.useState(!1),p=l.useRef(!1),j=l.useCallback((()=>{r&&d&&a&&(s.play("ui.leave"),r.emit("leaveGame",{gameId:a}),n("/"))}),[r,d,a,n]),f=l.useCallback((e=>{g(!1),r&&a&&e&&(h(null),r.emit("joinGame",{gameId:a,password:e}),u(!0))}),[r,a]),b=l.useCallback((()=>{g(!1),n("/")}),[n]);l.useEffect((()=>{h(null),g(!1),u(!0)}),[a]),l.useEffect((()=>{if(!r)return;const e=e=>{e&&e.game&&e.game.id===a&&(s.play("ui.join"),u(!1),h(null),g(!1))},t=e=>{const a=e.message||"An unknown error occurred";"Password required"===a?(g(!0),u(!1),h(null)):"Invalid password"===a?(h("Invalid password."),g(!0),u(!1)):"Game not found"===a?n("/"):"Game is full"===a?(h(a),u(!1),g(!1),setTimeout((()=>n("/")),3e3)):(h(a),u(!1),g(!1))};return r.on("gameJoined",e),r.on("error",t),()=>{r.off("gameJoined",e),r.off("error",t)}}),[r,a,n]),l.useEffect((()=>{r&&a&&!p.current&&(p.current=!0,u(!0),h(null),g(!1),r.emit("joinGame",{gameId:a}))}),[r,a]);const v=()=>{const{gameState:s}=k(),{socket:n}=e();return l.useEffect((()=>{const e=e=>{const a=n?.auth?.userId,t=a&&s?.players?s.players[a]:null;if(t?.isReady||!1)return e.preventDefault(),e.returnValue="You have money in the pot! Are you sure you want to leave?",e.returnValue};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}}),[s,n]),t.jsxs(t.Fragment,{children:[t.jsx(Ka,{isOpen:x,onClose:b,onSubmit:f,gameId:a}),m&&t.jsx(i,{message:`Joining game ${a}...`}),_&&!m&&!x&&t.jsxs("div",{className:"error-container",style:{padding:"20px",color:"red",textAlign:"center"},children:[t.jsx("h2",{children:"An error occurred"}),t.jsx("p",{children:_}),t.jsx("button",{onClick:()=>window.location.reload(),children:"Refresh Page"})]}),!m&&!_&&s&&t.jsx(Ua,{onReturnToLobby:j})]})};return t.jsx(T,{gameId:a,children:t.jsx(v,{})})};export{Qa as default};
