import{u as r,j as e,P as o,T as t,A as a,B as n,a as i}from"./ui-98buBbu4.js";import{r as s,u as l}from"./vendor--mFYx9eN.js";import{G as u,A as d}from"./AppHeader-CzrtMwka.js";import{u as c,A as m}from"./index-C5hn7wtV.js";import{u as g}from"./useGamepadNavigation-D-XLtfPQ.js";const f="_authForm_121ec_1",p="_submitButton_121ec_99",h=({onSubmit:i,mode:l})=>{const[d,c]=s.useState(""),[m,g]=s.useState(""),[h,x]=s.useState("");r("(max-width:600px)");const v=r("(max-width:400px)");return e.jsxs(o,{className:f,elevation:0,children:[e.jsx(t,{variant:"h5",component:"h2",gutterBottom:!0,sx:{color:"var(--info)",fontWeight:600},children:"login"===l?"Welcome Back":"Create Account"}),h&&e.jsx(a,{severity:"error",sx:{mb:2,backgroundColor:"rgba(231, 76, 60, 0.2)",color:"var(--text-primary)"},children:h}),e.jsxs("form",{onSubmit:async r=>{r.preventDefault(),x("");try{await i(d,m)}catch(e){x(e.message)}},children:[e.jsx(u,{title:"Enter Username",label:"Username",variant:"outlined",fullWidth:!0,margin:"normal",value:d,onChange:r=>c(r.target.value),required:!0,size:v?"small":"medium",inputProps:{minLength:3},sx:{"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:"var(--info-light)"},"&:hover fieldset":{borderColor:"var(--info)"},"&.Mui-focused fieldset":{borderColor:"var(--info)"},backgroundColor:"rgba(255, 255, 255, 0.1)"},"& .MuiInputLabel-root":{color:"var(--info-light)",fontSize:v?"0.9rem":"1rem"},"& .MuiOutlinedInput-input":{color:"var(--text-dark)",fontWeight:500,backgroundColor:"rgba(255, 255, 255, 0.85)",padding:v?"12px 14px":"16.5px 14px"},"& .MuiInputLabel-root.Mui-focused":{color:"var(--info)"},marginBottom:v?"0.5rem":"1rem"}}),e.jsx(u,{title:"Enter Password",label:"Password",type:"password",variant:"outlined",fullWidth:!0,margin:"normal",value:m,onChange:r=>g(r.target.value),required:!0,size:v?"small":"medium",inputProps:{minLength:6},sx:{"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:"var(--info-light)"},"&:hover fieldset":{borderColor:"var(--info)"},"&.Mui-focused fieldset":{borderColor:"var(--info)"},backgroundColor:"rgba(255, 255, 255, 0.1)"},"& .MuiInputLabel-root":{color:"var(--info-light)",fontSize:v?"0.9rem":"1rem"},"& .MuiOutlinedInput-input":{color:"var(--text-dark)",fontWeight:500,backgroundColor:"rgba(255, 255, 255, 0.85)",padding:v?"12px 14px":"16.5px 14px"},"& .MuiInputLabel-root.Mui-focused":{color:"var(--info)"},marginBottom:v?"0.5rem":"1rem"}}),e.jsx(n,{type:"submit",variant:"contained",fullWidth:!0,size:"large",className:p,"data-gamepad-focusable":"true",sx:{mt:v?2:3,background:"linear-gradient(to right, var(--info), var(--success))",textTransform:"none",fontWeight:"bold",letterSpacing:"0.5px",padding:v?"10px":"12px",fontSize:v?"0.9rem":"1rem","&:hover":{background:"linear-gradient(to right, var(--info-dark), var(--success-dark))",boxShadow:"var(--shadow-lg)",transform:"translateY(-2px)"}},children:"login"===l?"Sign In":"Create Account"})]})]})},x="_authPage_1fizs_1",v="_error_1fizs_40",b="_formContainer_1fizs_53",j=()=>{const[r,o]=s.useState("login"),{login:a}=c(),u=l();g(!0);const[f,p]=s.useState(null);return e.jsxs(i,{className:x,children:[e.jsx(d,{}),e.jsxs(i,{className:b,children:[f&&e.jsx(t,{className:v,children:f}),e.jsx(h,{mode:r,onSubmit:async(e,o)=>{if(!e||!o)return void p("Username and password are required");p(null);const t=`${m}/auth/${r}`;try{const r={username:e,password:o},i=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(r)});let s;try{s=await i.json()}catch(n){throw new Error("Invalid response from server")}if(!i.ok)throw new Error(s.message||"Authentication failed");if(!s.user?.username||!s.user?.id||!s.token)throw new Error("Invalid server response format");try{a(s.user,s.token),u("/")}catch(n){throw new Error("Failed to initialize user session")}}catch(n){p(n.message||"Failed to connect to server")}}}),e.jsx(i,{textAlign:"center",mt:3,children:e.jsx(n,{color:"primary",onClick:()=>o("login"===r?"register":"login"),"data-gamepad-focusable":"true",sx:{color:"#ecf0f1",textTransform:"none",fontSize:"1rem","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.1)"}},children:"login"===r?"Don't have an account? Register":"Already have an account? Login"})})]})]})};export{j as default};
