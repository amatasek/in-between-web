import{r,j as e}from"./react-7X_HfTL4.js";import{G as o,A as t}from"./AppHeader-Bu2zqVZw.js";import{b as a,P as n,T as i,A as s,B as l,d as u}from"./mui-B3QJ8a6B.js";import{u as d,A as c}from"./index-DlJ1vvfx.js";import{u as m}from"./useGamepadNavigation-DCtNTfjZ.js";import{I as g}from"./vendor-CrXq7rKl.js";import"./socket-CR9bC8yV.js";const f="_authForm_121ec_1",p="_submitButton_121ec_99",h=({onSubmit:t,mode:u})=>{const[d,c]=r.useState(""),[m,g]=r.useState(""),[h,x]=r.useState("");a("(max-width:600px)");const v=a("(max-width:400px)");return e.jsxs(n,{className:f,elevation:0,children:[e.jsx(i,{variant:"h5",component:"h2",gutterBottom:!0,sx:{color:"var(--info)",fontWeight:600},children:"login"===u?"Welcome Back":"Create Account"}),h&&e.jsx(s,{severity:"error",sx:{mb:2,backgroundColor:"rgba(231, 76, 60, 0.2)",color:"var(--text-primary)"},children:h}),e.jsxs("form",{onSubmit:async r=>{r.preventDefault(),x("");try{await t(d,m)}catch(e){x(e.message)}},children:[e.jsx(o,{title:"Enter Username",label:"Username",variant:"outlined",fullWidth:!0,margin:"normal",value:d,onChange:r=>c(r.target.value),required:!0,size:v?"small":"medium",inputProps:{minLength:3},sx:{"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:"var(--info-light)"},"&:hover fieldset":{borderColor:"var(--info)"},"&.Mui-focused fieldset":{borderColor:"var(--info)"},backgroundColor:"rgba(255, 255, 255, 0.1)"},"& .MuiInputLabel-root":{color:"var(--info-light)",fontSize:v?"0.9rem":"1rem"},"& .MuiOutlinedInput-input":{color:"var(--text-dark)",fontWeight:500,backgroundColor:"rgba(255, 255, 255, 0.85)",padding:v?"12px 14px":"16.5px 14px"},"& .MuiInputLabel-root.Mui-focused":{color:"var(--info)"},marginBottom:v?"0.5rem":"1rem"}}),e.jsx(o,{title:"Enter Password",label:"Password",type:"password",variant:"outlined",fullWidth:!0,margin:"normal",value:m,onChange:r=>g(r.target.value),required:!0,size:v?"small":"medium",inputProps:{minLength:6},sx:{"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:"var(--info-light)"},"&:hover fieldset":{borderColor:"var(--info)"},"&.Mui-focused fieldset":{borderColor:"var(--info)"},backgroundColor:"rgba(255, 255, 255, 0.1)"},"& .MuiInputLabel-root":{color:"var(--info-light)",fontSize:v?"0.9rem":"1rem"},"& .MuiOutlinedInput-input":{color:"var(--text-dark)",fontWeight:500,backgroundColor:"rgba(255, 255, 255, 0.85)",padding:v?"12px 14px":"16.5px 14px"},"& .MuiInputLabel-root.Mui-focused":{color:"var(--info)"},marginBottom:v?"0.5rem":"1rem"}}),e.jsx(l,{type:"submit",variant:"contained",fullWidth:!0,size:"large",className:p,"data-gamepad-focusable":"true",sx:{mt:v?2:3,background:"linear-gradient(to right, var(--info), var(--success))",textTransform:"none",fontWeight:"bold",letterSpacing:"0.5px",padding:v?"10px":"12px",fontSize:v?"0.9rem":"1rem","&:hover":{background:"linear-gradient(to right, var(--info-dark), var(--success-dark))",boxShadow:"var(--shadow-lg)",transform:"translateY(-2px)"}},children:"login"===u?"Sign In":"Create Account"})]})]})},x="_authPage_1fizs_1",v="_error_1fizs_40",b="_formContainer_1fizs_53",j=()=>{const[o,a]=r.useState("login"),{login:n}=d(),s=g();m(!0);const[f,p]=r.useState(null);return e.jsxs(u,{className:x,children:[e.jsx(t,{}),e.jsxs(u,{className:b,children:[f&&e.jsx(i,{className:v,children:f}),e.jsx(h,{mode:o,onSubmit:async(r,e)=>{if(!r||!e)return void p("Username and password are required");p(null);const t=`${c}/auth/${o}`;try{const o={username:r,password:e},i=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(o)});let l;try{l=await i.json()}catch(a){throw new Error("Invalid response from server")}if(!i.ok)throw new Error(l.message||"Authentication failed");if(!l.user?.username||!l.user?.id||!l.token)throw new Error("Invalid server response format");try{n(l.user,l.token),s("/")}catch(a){throw new Error("Failed to initialize user session")}}catch(a){p(a.message||"Failed to connect to server")}}}),e.jsx(u,{textAlign:"center",mt:3,children:e.jsx(l,{color:"primary",onClick:()=>a("login"===o?"register":"login"),"data-gamepad-focusable":"true",sx:{color:"#ecf0f1",textTransform:"none",fontSize:"1rem","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.1)"}},children:"login"===o?"Don't have an account? Register":"Already have an account? Login"})})]})]})};export{j as default};
