import{u as e,j as a,a as r,A as s}from"./index-DE0W_Yr4.js";import{r as t,u as n}from"./vendor-CbcgzysI.js";import{u as o}from"./useGamepadNavigation-CzXbN7fd.js";import{A as i}from"./AppHeader-CUL4wsoj.js";import"./audio-tWiGdEUv.js";import"./socket-Ba10ZAmw.js";const l="_authForm_1wx71_1",u="_errorAlert_1wx71_95",c=({onSubmit:r,mode:s})=>{const[n,o]=t.useState(""),[i,c]=t.useState(""),[d,m]=t.useState(""),p=t.useRef(null),h=t.useRef(null),{enhanceInput:g}=e();t.useEffect(()=>{let e,a;return p.current&&(e=g(p.current,"text","Enter Username")),h.current&&(a=g(h.current,"password","Enter Password")),()=>{e&&e(),a&&a()}},[g]);return a.jsxs("div",{className:`card ${l}`,children:[a.jsx("h2",{style:{color:"var(--text-primary)",fontWeight:600,textAlign:"center",marginTop:0},children:"login"===s?"Welcome Back":"Create Account"}),a.jsx("div",{className:"divider",style:{marginBottom:"1.5rem"}}),d&&a.jsx("div",{className:u,children:d}),a.jsxs("form",{onSubmit:async e=>{e.preventDefault(),m("");try{await r(n,i)}catch(a){m(a.message)}},children:[a.jsxs("div",{className:"input-group",children:[a.jsx("label",{htmlFor:"username",className:"input-label required",children:"Username"}),a.jsx("input",{ref:p,id:"username",type:"text",className:"no-validation",placeholder:"Enter your username",value:n,onChange:e=>o(e.target.value),required:!0,minLength:3,"data-gamepad-focusable":"true",autoCapitalize:"none",autoCorrect:"off",autoComplete:"username"})]}),a.jsxs("div",{className:"input-group",children:[a.jsx("label",{htmlFor:"password",className:"input-label required",children:"Password"}),a.jsx("input",{ref:h,id:"password",type:"password",className:"no-validation",placeholder:"Enter your password",value:i,onChange:e=>c(e.target.value),required:!0,minLength:6,"data-gamepad-focusable":"true",autoComplete:"login"===s?"current-password":"new-password"})]}),a.jsx("button",{type:"submit",className:"btn btn-primary","data-gamepad-focusable":"true",children:"login"===s?"Sign In":"Create Account"})]})]})},d="_authPage_jks4l_1",m="_error_jks4l_9",p="_formContainer_jks4l_22",h="_toggleContainer_jks4l_88",g="_toggleButton_jks4l_93",j=()=>{const[e,l]=t.useState("login"),{login:u}=r(),j=n();o(!0);const[f,v]=t.useState(null);return a.jsxs("div",{className:`screen ${d}`,children:[a.jsx(i,{}),a.jsxs("div",{className:p,children:[f&&a.jsx("div",{className:m,children:f}),a.jsx(c,{mode:e,onSubmit:async(a,r)=>{if(!a||!r)return void v("Username and password are required");v(null);const t=`${s}/auth/${e}`;try{const e={username:a,password:r},s=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});let o;try{o=await s.json()}catch(n){throw new Error("Invalid response from server")}if(!s.ok)throw new Error(o.message||"Authentication failed");if(!o.user?.username||!o.user?.id||!o.token)throw new Error("Invalid server response format");try{u(o.user,o.token),j("/")}catch(n){throw new Error("Failed to initialize user session")}}catch(n){v(n.message||"Failed to connect to server")}}}),a.jsx("div",{className:h,children:a.jsx("button",{className:g,onClick:()=>l("login"===e?"register":"login"),"data-gamepad-focusable":"true",children:"login"===e?"Don't have an account? Register":"Already have an account? Login"})})]})]})};export{j as default};
