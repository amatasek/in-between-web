import{a1 as O,_ as W,a4 as ne,Z as e,a9 as H,aa as ye,ab as fe,ac as je}from"./index-BuBMj0oT.js";import{b as m,h as be,u as Ce}from"./vendor-CT7sGowS.js";import{G as he,C as L,a as Ne,R as ve,P as Be,S as Ae,I as we,e as Te,b as Se,U as Ie,g as le,f as Pe,u as ke,A as Le,c as $e,d as de}from"./useAdInterstitial-DL5m_5LS.js";import{u as Ee}from"./useGamepadNavigation-DKu7SyYo.js";import{c as ae}from"./createLucideIcon-D-AJSOET.js";import"./socket-CA1CrNgP.js";import"./audio-hxunv4lQ.js";/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],ue=ae("chevron-down",Re);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],me=ae("chevron-up",Oe);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],De=ae("log-out",Me),ge=m.createContext(),P=()=>{const t=m.useContext(ge);if(t===void 0)throw new Error("useGameContext must be used within a GameProvider");return t},Ge=({children:t,gameId:n,initialGameState:o=null})=>{const{socket:s,error:c}=O(),{user:r}=W(),[d,a]=m.useState(o),l=m.useRef(null),[_,i]=m.useState(null),g=m.useCallback(()=>{i(null)},[]);m.useEffect(()=>{c&&i(c)},[c]),m.useEffect(()=>{if(s)return s.on("gameReconnected",h=>{console.log(`[Game] Reconnected to game: ${h.gameId}`,h.game),a(h.game),console.log(`[Game] Successfully reconnected as user ID: ${r?.id}`),i(null),h.game&&h.game.id&&setTimeout(()=>{console.log("[Game] Requesting fresh game state after reconnection"),s.emit("getGameState",{gameId:h.game.id})},500)}),s.on("gameState",h=>{if(h&&h.id&&JSON.stringify(d)!==JSON.stringify(h)){if(h.currentPlayerId&&r?.id){const Y=h.currentPlayerId===r.id,V=l.current===r.id;Y&&!V&&ne.play("ui.alert"),l.current=h.currentPlayerId}a(h),g()}}),s.on("gameError",h=>{console.error("Game error:",h),i(h)}),()=>{s.off("gameReconnected"),s.off("gameState"),s.off("gameError")}},[s,g,d,r]);const u=m.useCallback(h=>{if(!(!s||!n))try{s.emit("placeBet",{bet:h,gameId:n})}catch(Y){console.error("Error placing bet:",Y),i("Failed to place bet. Please try again.")}},[s,n]),p=m.useCallback(()=>{if(!(!s||!n))try{s.emit("payAnte",{gameId:n})}catch(h){console.error("Error paying ante:",h),i("Failed to pay ante. Please try again.")}},[s,n]),j=m.useCallback(()=>{if(!(!s||!n))try{s.emit("dealCards",{gameId:n})}catch(h){console.error("Error dealing cards:",h),i("Failed to deal cards. Please try again.")}},[s,n]),N=m.useCallback(()=>{if(!(!s||!n))try{s.emit("revealMiddleCard",{gameId:n})}catch(h){console.error("Error revealing middle card:",h),i("Failed to reveal middle card. Please try again.")}},[s,n]),C=m.useCallback(()=>{if(!(!s||!n))try{s.emit("nextRound",{gameId:n})}catch(h){console.error("Error moving to next round:",h),i("Failed to move to next round. Please try again.")}},[s,n]),$=m.useCallback(()=>{if(!(!s||!n))try{s.emit("ready")}catch(h){console.error("Error setting player ready:",h),i("Failed to set player ready. Please try again.")}},[s,n]),S=m.useCallback(()=>{if(!(!s||!n))try{s.emit("unready")}catch(h){console.error("Error setting player unready:",h),i("Failed to set player unready. Please try again.")}},[s,n]),A={gameState:d,error:_,gameId:n,placeBet:u,payAnte:p,playerReady:$,playerUnready:S,dealCards:j,revealMiddleCard:N,nextRound:C,clearError:g};return e.jsx(ge.Provider,{value:A,children:t})},Fe="_modalOverlay_17ksc_1",qe="_modalContent_17ksc_14",ze="_passwordInput_17ksc_34",Ue="_modalActions_17ksc_54",He="_modalButton_17ksc_60",We="_cancelButton_17ksc_71",Ye="_submitButton_17ksc_80",M={modalOverlay:Fe,modalContent:qe,passwordInput:ze,modalActions:Ue,modalButton:He,cancelButton:We,submitButton:Ye};function Ve({isOpen:t,onClose:n,onSubmit:o,gameId:s}){const[c,r]=m.useState("");if(!t)return null;const d=l=>{l.preventDefault(),o(c),r("")},a=()=>{r(""),n()};return e.jsx("div",{className:M.modalOverlay,children:e.jsxs("div",{className:M.modalContent,children:[e.jsx("h2",{children:"Password Required"}),e.jsxs("p",{children:["Please enter the password for game ",e.jsx("strong",{children:s||""}),":"]}),e.jsxs("form",{onSubmit:d,autoComplete:"off",children:[e.jsx(he,{title:"Enter Game Password",type:"text",value:c,onChange:l=>r(l.target.value),className:M.passwordInput,autoFocus:!0,required:!0,autoComplete:"off","data-form-type":"other","data-lpignore":"true"}),e.jsxs("div",{className:M.modalActions,children:[e.jsx("button",{type:"button",onClick:a,className:`${M.modalButton} ${M.cancelButton}`,"data-gamepad-focusable":"true",children:"Cancel"}),e.jsx("button",{type:"submit",className:`${M.modalButton} ${M.submitButton}`,"data-gamepad-focusable":"true",children:"Join Game"})]})]})]})})}const Je="_gameContainer_un67s_1",Ke="_gameScreen_un67s_7",Qe="_loadingContainer_un67s_41",Ze="_errorContainer_un67s_50",Xe="_errorText_un67s_66",et="_gameBottomSection_un67s_95",tt="_withAds_un67s_102",G={gameContainer:Je,gameScreen:Ke,loadingContainer:Qe,errorContainer:Ze,errorText:Xe,gameBottomSection:et,withAds:tt},st="_emojiReactions_1sxwe_1",nt="_withAds_1sxwe_8",at="_toggleButton_1sxwe_24",ot="_emojiPanel_1sxwe_51",rt="_emojiGrid_1sxwe_76",ct="_emojiButton_1sxwe_82",F={emojiReactions:st,withAds:nt,toggleButton:at,emojiPanel:ot,emojiGrid:rt,emojiButton:ct},it=()=>{const[t,n]=m.useState(!1),{socket:o}=O(),{gameState:s}=P(),{user:c}=W(),r=!c?.subscription?.isPremium,d=m.useRef(null),a=[{emoji:"ğŸ”¥",name:"Fire",color:"#FF6B35"},{emoji:"ğŸ˜„",name:"Happy",color:"#FFD93D"},{emoji:"ğŸ’©",name:"Poop",color:"#8B4513"},{emoji:"ğŸ˜",name:"Cool",color:"#4A5568"},{emoji:"ğŸ¤¯",name:"Mind Blown",color:"#FFA500"},{emoji:"ğŸ˜ˆ",name:"Devilish",color:"#9333EA"},{emoji:"ğŸ˜¬",name:"Worried",color:"#FCD34D"},{emoji:"ğŸ‘",name:"Applause",color:"#FBBF24"},{emoji:"ğŸ˜­",name:"Crying",color:"#3B82F6"},{emoji:"ğŸ¤¡",name:"Clown",color:"#EF4444"},{emoji:"ğŸ’ª",name:"Strong",color:"#F59E0B"},{emoji:"ğŸ˜…",name:"Nervous",color:"#60A5FA"},{emoji:"ğŸ‰",name:"Celebration",color:"#A855F7"},{emoji:"ğŸ¤”",name:"Thinking",color:"#6B7280"},{emoji:"ğŸ™ˆ",name:"See No Evil",color:"#A0522D"},{emoji:"ğŸ˜¤",name:"Confident",color:"#DC2626"}],l=i=>{!o||!s||!c||(o.emit("emojiReaction",{gameId:s.id,emoji:i.emoji,color:i.color,playerName:c.username}),n(!1))},_=()=>{n(!t)};return m.useEffect(()=>{const i=g=>{d.current&&!d.current.contains(g.target)&&n(!1)};return t&&(document.addEventListener("mousedown",i),document.addEventListener("touchstart",i)),()=>{document.removeEventListener("mousedown",i),document.removeEventListener("touchstart",i)}},[t]),e.jsxs("div",{className:`${F.emojiReactions} ${r?F.withAds:""}`,ref:d,children:[e.jsx("button",{type:"button",className:F.toggleButton,onClick:_,"data-gamepad-focusable":"true","aria-label":"Toggle emoji reactions",children:"ğŸ˜Š"}),t&&e.jsx("div",{className:F.emojiPanel,children:e.jsx("div",{className:F.emojiGrid,children:a.map(i=>e.jsx("button",{type:"button",className:F.emojiButton,onClick:()=>l(i),"data-gamepad-focusable":"true",title:i.name,style:{"--emoji-color":i.color},children:i.emoji},i.name))})})]})},lt="_headerContainer_el1d5_1",dt="_header_el1d5_1",ut="_headerLeft_el1d5_30",mt="_gameTitle_el1d5_39",_t="_gameIdText_el1d5_50",pt="_gameIdLink_el1d5_57",ht="_headerRight_el1d5_70",gt="_controlsStack_el1d5_76",xt="_balanceDisplay_el1d5_83",yt="_balanceLabel_el1d5_96",ft="_controlsGroup_el1d5_102",E={headerContainer:lt,header:dt,headerLeft:ut,gameTitle:mt,gameIdText:_t,gameIdLink:pt,headerRight:ht,controlsStack:gt,balanceDisplay:xt,balanceLabel:yt,controlsGroup:ft},jt=({handleLeaveGame:t,onModalStateChange:n})=>{const{gameState:o,gameId:s}=P(),{socket:c}=O(),{user:r}=W(),d=c?.auth?.userId,a=d&&o?.players?o.players[d]:null,l=a?.balance??r?.balance??0,_=a?.isReady||!1,[i,g]=m.useState(!1),[u,p]=m.useState(!1),[j,N]=m.useState(!1),[C,$]=m.useState(!1),[S,A]=m.useState(!1);return m.useEffect(()=>{n&&n(i||u||j||C||S)},[i,u,j,C,S,n]),e.jsxs("div",{className:E.headerContainer,children:[e.jsxs("div",{className:E.header,children:[e.jsxs("div",{className:E.headerLeft,children:[e.jsxs("h1",{className:E.gameTitle,children:["In Between ",e.jsx("span",{className:"live-tag small",children:"LIVE"})]}),e.jsx("p",{className:E.gameIdText,children:e.jsxs("span",{className:E.gameIdLink,onClick:()=>g(!0),title:"Click to view game summary","data-gamepad-focusable":"true",tabIndex:"0",children:["Game #",s]})})]}),e.jsx("div",{className:E.headerRight,children:e.jsxs("div",{className:E.controlsStack,children:[e.jsxs("div",{className:E.balanceDisplay,children:[e.jsx("span",{className:E.balanceLabel,children:"Balance:"}),e.jsx(L,{amount:Number(l),size:"small"})]}),e.jsxs("div",{className:E.controlsGroup,children:[e.jsx(Ne,{inGame:!0,onModalStateChange:N,"data-gamepad-focusable":"true"}),e.jsx(ve,{onModalStateChange:$,"data-gamepad-focusable":"true"}),e.jsx(Be,{onModalStateChange:A,"data-gamepad-focusable":"true"}),e.jsx(Ae,{onClick:()=>p(!0),"data-gamepad-focusable":"true"}),e.jsx(we,{icon:e.jsx(De,{size:20,style:{color:"white"}}),title:"Leave Game",onClick:t,variant:"danger",disabled:_,"data-gamepad-focusable":"true"})]})]})})]}),i&&e.jsx(Te,{onClose:()=>g(!1),gameData:o}),u&&e.jsx(Se,{onClose:()=>p(!1)})]})},bt="_gameLogContainer_avo5w_1",Ct="_gameLogHeader_avo5w_15",Nt="_expandIcon_avo5w_29",vt="_gameLogEntries_avo5w_53",Bt="_logEntry_avo5w_63",At="_logTime_avo5w_88",wt="_logMessage_avo5w_95",Tt="_systemMessage_avo5w_100",St="_emptyLog_avo5w_111",It="_showMoreButton_avo5w_119",k={gameLogContainer:bt,gameLogHeader:Ct,expandIcon:Nt,gameLogEntries:vt,logEntry:Bt,logTime:At,logMessage:wt,systemMessage:Tt,emptyLog:St,showMoreButton:It},Pt="_roundPanel_1npc7_2",kt="_dividerLine_1npc7_26",Lt="_roundLabel_1npc7_38",X={roundPanel:Pt,dividerLine:kt,roundLabel:Lt},$t=({roundNumber:t})=>e.jsxs("div",{className:`panel-alt ${X.roundPanel}`,children:[e.jsx("div",{className:X.dividerLine}),e.jsxs("span",{className:X.roundLabel,children:["Round ",t]}),e.jsx("div",{className:X.dividerLine})]}),Et="_turnPanel_1mzsb_2",Rt="_leftSection_1mzsb_15",Ot="_win_1mzsb_22",Mt="_lose_1mzsb_27",Dt="_penalty_1mzsb_32",Gt="_pass_1mzsb_37",Ft="_cardsContainer_1mzsb_43",qt="_playerName_1mzsb_49",zt="_action_1mzsb_56",Ut="_amount_1mzsb_65",R={turnPanel:Et,leftSection:Rt,win:Ot,lose:Mt,penalty:Dt,pass:Gt,cardsContainer:Ft,playerName:qt,action:zt,amount:Ut},Ht="_cardMini_tdd1b_2",Wt="_red_tdd1b_18",Yt="_black_tdd1b_22",Vt="_rank_tdd1b_26",Jt="_aceIndicator_tdd1b_34",Kt="_suit_tdd1b_53",Qt="_cardPlaceholder_tdd1b_58",D={cardMini:Ht,red:Wt,black:Yt,rank:Vt,aceIndicator:Jt,suit:Kt,cardPlaceholder:Qt},Zt={TIMERS:{BETTING_DURATION:3e4,DECISION_DURATION:15e3}},f={HEARTS:"â™¥",DIAMONDS:"â™¦",CLUBS:"â™£",SPADES:"â™ ",ARROW_RIGHT:"â†’",ARROW_UP:"â†‘",ARROW_DOWN:"â†“",ROTATE:"â†»",CHECK:"âœ“",CROSS:"âœ•"},{TIMERS:oe}=Zt,se=({card:t})=>{if(!t)return e.jsx("div",{className:D.cardPlaceholder,children:"?"});const n=l=>{switch(l){case"hearts":case"â™¥":return f.HEARTS;case"diamonds":case"â™¦":return f.DIAMONDS;case"clubs":case"â™£":return f.CLUBS;case"spades":case"â™ ":return f.SPADES;default:return l||""}},o=t.value||"?",s=t.suit||"?",c=s==="â™¥"||s==="â™¦"||s==="hearts"||s==="diamonds",r=o==="A",d=t.isAceLow===!0,a=r&&!d;return e.jsxs("div",{className:`${D.cardMini} ${c?D.red:D.black}`,children:[e.jsxs("span",{className:D.rank,children:[o,r&&(a?e.jsx("span",{className:D.aceIndicator,children:"â†‘"}):d?e.jsx("span",{className:D.aceIndicator,children:"â†“"}):null)]}),e.jsx("span",{className:D.suit,children:n(s)})]})},Xt=({summary:t})=>{if(!t)return null;const n=c=>{switch(c){case"win":return R.win;case"lose":return R.lose;case"penalty":case"triple_penalty":return R.penalty;case"pass":return R.pass;default:return R.default}},o=c=>{switch(c){case"win":return"WON";case"lose":return"LOST";case"penalty":return"PENALTY";case"triple_penalty":return"TRIPLE PENALTY";case"pass":return"PASSED";case"bet":return"BET";default:return c?.toUpperCase()||""}},s=()=>t.winAmount?t.winAmount/2:t.lossAmount?t.lossAmount:t.betAmount?t.betAmount:0;return e.jsxs("div",{className:`panel-alt ${R.turnPanel} ${n(t.action)}`,children:[e.jsxs("div",{className:R.leftSection,children:[e.jsxs("div",{className:R.cardsContainer,children:[e.jsx(se,{card:t.cards?.left}),t.cards?.middle&&e.jsx(se,{card:t.cards?.middle}),e.jsx(se,{card:t.cards?.right})]}),e.jsx("span",{className:R.playerName,children:e.jsx(H,{username:t.playerName})}),e.jsx("span",{className:R.action,children:o(t.action)})]}),s()>0&&e.jsx("div",{className:R.amount,children:e.jsx(L,{amount:s(),size:"small"})})]})},es=()=>{const{gameState:t}=P(),[n,o]=m.useState(!1),s=t?.gameLog||[],c=t?.seats?t.seats.filter(p=>p!==null).length:0,r=Math.max(c,4),[d,a]=m.useState(r);if(m.useEffect(()=>{n||a(r)},[c,r,n]),!t||!t.gameLog)return null;const l=p=>new Date(p).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"}),_=()=>{o(!n),n&&a(r)},i=()=>{a(p=>p+Math.max(c,5))},g=n?[]:s.slice(0,d),u=p=>p.type==="turn"?e.jsx(Xt,{summary:p},p.id):p.type==="round_start"?e.jsx($t,{roundNumber:p.roundNumber},p.id):p.type==="system"||p.type==="error"?e.jsxs("div",{className:`${k.logEntry} ${k.systemMessage}`,children:[e.jsx("span",{className:k.logTime,children:l(p.timestamp)}),e.jsx("span",{className:k.logMessage,children:p.message})]},p.id):e.jsxs("div",{className:k.logEntry,children:[e.jsx("span",{className:k.logTime,children:l(p.timestamp)}),e.jsx("span",{className:k.logMessage,children:p.message})]},p.id);return e.jsxs("div",{className:k.gameLogContainer,children:[e.jsxs("h3",{className:k.gameLogHeader,onClick:_,children:["Game Log",e.jsx("span",{className:k.expandIcon,children:n?"â–¶":"â–¼"})]}),!n&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:k.gameLogEntries,children:s.length===0?e.jsx("div",{className:k.emptyLog,children:"No game events yet"}):g.map(u)}),s.length>d&&e.jsxs("div",{className:k.showMoreButton,onClick:i,children:["Show ",Math.min(Math.max(c,5),s.length-d)," more",s.length-d>Math.max(c,5)&&` (${s.length-d} remaining)`]})]})]})},ts="_playersContainer_1b112_1",ss="_playersTitle_1b112_21",ns="_playersList_1b112_45",as="_currentPlayerGlow_1b112_53",os="_currentUser_1b112_67",rs="_playerInfo_1b112_71",cs="_playerStatus_1b112_79",is="_disconnectedIndicator_1b112_86",ls="_playerBalanceContainer_1b112_93",ds="_readyIndicator_1b112_146",us="_ready_1b112_146",ms="_notReady_1b112_157",_s="_sittingOut_1b112_161",ps="_emptyPlayerList_1b112_176",T={playersContainer:ts,playersTitle:ss,playersList:ns,currentPlayerGlow:as,currentUser:os,playerInfo:rs,playerStatus:cs,disconnectedIndicator:is,playerBalanceContainer:ls,readyIndicator:ds,ready:us,notReady:ms,sittingOut:_s,emptyPlayerList:ps},hs=()=>{const{gameState:t}=P(),{socket:n}=O(),o=m.useContext(ye);if(m.useEffect(()=>{if(t?.players&&o){const a=Object.values(t.players).map(l=>l.userId).filter(Boolean);a.length>0&&o.prefetchUsers(a)}},[t?.players,o]),!t||!t.players)return e.jsx("div",{className:T.emptyPlayerList,children:e.jsx("p",{children:"Waiting for game data..."})});const{players:s,currentPlayerId:c}=t,r=n?.auth?.userId,d=t.totals||{};return!s||Object.keys(s).length===0?e.jsx("div",{className:T.emptyPlayerList,children:e.jsx("p",{children:"Waiting for players to join..."})}):e.jsxs("div",{className:T.playersContainer,children:[e.jsx("h3",{className:T.playersTitle,children:"Scoreboard"}),e.jsx("div",{className:T.playersList,children:t.seats.filter(a=>a!==null&&s[a]).map(a=>{const l=s[a],_=a===c,i=l.userId===r;return e.jsxs("div",{className:`
                  ${_?"panel":"panel-alt"}
                  ${_?T.currentPlayerGlow:""}
                  ${i?T.currentUser:""}
                `,style:{padding:"0.35rem 0.75rem",gap:"0.5rem",flexDirection:"row",fontSize:"0.9rem",alignItems:"center",justifyContent:"space-between",height:"40px"},children:[e.jsxs("div",{className:T.playerInfo,children:[e.jsx(Ie,{userId:l.userId,size:"small",showName:!0,namePosition:"right",fontWeight:"bold"}),e.jsx("span",{className:T.playerStatus,children:l.disconnected&&e.jsx("span",{className:T.disconnectedIndicator,title:"Player disconnected",children:"âš ï¸ Disconnected"})})]}),e.jsxs("div",{className:T.playerBalanceContainer,children:[e.jsx(L,{amount:d[a]||0,size:"small"}),e.jsx("div",{className:`
                    ${T.readyIndicator} 
                    ${l.isSittingOut?T.sittingOut:l.isReady?T.ready:T.notReady}
                  `,title:l.isSittingOut?"Sitting Out":l.isReady?"Ready":"Not Ready"})]})]},a)})})]})},gs="_table_1c3a2_2",xs="_feltTexture_1c3a2_75",ys="_sitOutOverlay_1c3a2_104",ee={table:gs,feltTexture:xs,sitOutOverlay:ys},fs="_aceOverlay_1apr0_2",js="_cardGlow_1apr0_14",bs="_countdownRing_1apr0_24",Cs="_countdownCircle_1apr0_34",Ns="_choiceButton_1apr0_43",vs="_highButton_1apr0_74",Bs="_lowButton_1apr0_85",As="_timerDisplay_1apr0_96",ws="_waitingMessage_1apr0_109",Ts="_aceControlsBottom_1apr0_136",Ss="_timerContainer_1apr0_150",Is="_aceButtonContainer_1apr0_158",Ps="_choicePrompt_1apr0_165",ks="_bottomChoiceButton_1apr0_174",Ls="_lowButtonBottom_1apr0_200",$s="_highButtonBottom_1apr0_210",B={aceOverlay:fs,cardGlow:js,countdownRing:bs,countdownCircle:Cs,choiceButton:Ns,highButton:vs,lowButton:Bs,timerDisplay:As,waitingMessage:ws,aceControlsBottom:Ts,timerContainer:Ss,aceButtonContainer:Is,choicePrompt:Ps,bottomChoiceButton:ks,lowButtonBottom:Ls,highButtonBottom:$s},Es="_waitingTimer_egezv_2",Rs="_timerContent_egezv_16",Os="_playerName_egezv_23",Ms="_action_egezv_29",Ds="_timerBar_egezv_35",Gs="_timerProgress_egezv_43",q={waitingTimer:Es,timerContent:Rs,playerName:Os,action:Ms,timerBar:Ds,timerProgress:Gs},re=({playerName:t,action:n="deciding",duration:o=15e3})=>{const[s,c]=m.useState(o),r=m.useRef(Date.now());m.useEffect(()=>{r.current=Date.now(),c(o)},[o]),m.useEffect(()=>{const a=setInterval(()=>{const l=Date.now()-r.current,_=Math.max(0,o-l);c(_),_<=0&&clearInterval(a)},100);return()=>clearInterval(a)},[o]);const d=(o-s)/o*100;return e.jsxs("div",{className:`panel-game ${q.waitingTimer}`,children:[e.jsxs("div",{className:q.timerContent,children:[e.jsx("span",{className:q.playerName,children:e.jsx(H,{username:t})}),e.jsxs("span",{className:q.action,children:["is ",n,"..."]})]}),e.jsx("div",{className:q.timerBar,children:e.jsx("div",{className:q.timerProgress,style:{width:`${d}%`}})})]})},Fs="_countdownTimer_1r3bp_3",qs="_progressRing_1r3bp_19",zs="_progressRingBackground_1r3bp_25",Us="_progressRingCircle_1r3bp_31",Hs="_timeDisplay_1r3bp_40",J={countdownTimer:Fs,progressRing:qs,progressRingBackground:zs,progressRingCircle:Us,timeDisplay:Hs},ce=({duration:t=15,isActive:n=!0})=>{const[o,s]=m.useState(t),c=m.useRef(Date.now());m.useEffect(()=>{n&&(c.current=Date.now(),s(t))},[t,n]),m.useEffect(()=>{if(!n)return;const u=setInterval(()=>{const p=Math.floor((Date.now()-c.current)/1e3),j=Math.max(0,t-p);s(j),j<=0&&clearInterval(u)},100);return()=>clearInterval(u)},[t,n]);const r=o/t*100,d=()=>{const u=o/t*100;return u>66?"var(--color-ready)":u>33?"var(--accent)":"var(--secondary)"},a=50,l=3,_=(a-l*2)/2,i=_*2*Math.PI,g=i-r/100*i;return e.jsxs("div",{className:J.countdownTimer,children:[e.jsxs("svg",{className:J.progressRing,width:a,height:a,viewBox:`0 0 ${a} ${a}`,children:[e.jsx("circle",{className:J.progressRingBackground,cx:a/2,cy:a/2,r:_,strokeWidth:l}),e.jsx("circle",{className:J.progressRingCircle,cx:a/2,cy:a/2,r:_,strokeWidth:l,strokeDasharray:`${i} ${i}`,strokeDashoffset:g,style:{stroke:d()}})]}),e.jsxs("div",{className:J.timeDisplay,children:[o,"s"]})]})},Ws=({isCurrentPlayersTurn:t,bottomPosition:n=!1})=>{const{socket:o}=O(),{gameState:s}=P(),[c,r]=m.useState(null),d=l=>{c===null&&(r(l),o.emit("chooseAceValue",{isAceLow:l}))},a=s.players[s.currentPlayerId]?.name||"Current player";return n?t?e.jsxs("div",{className:`panel-game ${B.aceControlsBottom}`,children:[e.jsx("div",{className:B.timerContainer,children:e.jsx(ce,{duration:15,isActive:!0})}),e.jsxs("div",{className:B.aceButtonContainer,children:[e.jsx("span",{className:B.choicePrompt,children:"ACE VALUE:"}),e.jsxs("button",{type:"button",className:`${B.bottomChoiceButton} ${B.lowButtonBottom}`,onClick:()=>d(!0),disabled:c!==null,"data-gamepad-focusable":"true",autoFocus:!0,children:[e.jsx(ue,{size:16}),e.jsx("span",{children:"LOW"})]}),e.jsxs("button",{type:"button",className:`${B.bottomChoiceButton} ${B.highButtonBottom}`,onClick:()=>d(!1),disabled:c!==null,"data-gamepad-focusable":"true",children:[e.jsx("span",{children:"HIGH"}),e.jsx(me,{size:16})]})]})]}):e.jsx(re,{playerName:a,action:"choosing ace value",duration:oe.DECISION_DURATION}):e.jsxs("div",{className:B.aceOverlay,children:[e.jsx("div",{className:B.cardGlow}),t&&e.jsx("svg",{className:B.countdownRing,children:e.jsx("circle",{className:B.countdownCircle,cx:"60",cy:"87",r:"80",style:{strokeDasharray:`${countdown/15*502} 502`}})}),t?e.jsxs(e.Fragment,{children:[e.jsxs("button",{type:"button",className:`${B.choiceButton} ${B.highButton}`,onClick:()=>d(!1),disabled:c!==null,"data-gamepad-focusable":"true",autoFocus:!0,children:[e.jsx(me,{size:20}),e.jsx("span",{children:"HIGH"})]}),e.jsxs("button",{type:"button",className:`${B.choiceButton} ${B.lowButton}`,onClick:()=>d(!0),disabled:c!==null,"data-gamepad-focusable":"true",children:[e.jsx("span",{children:"LOW"}),e.jsx(ue,{size:20})]}),e.jsxs("div",{className:B.timerDisplay,children:[countdown,"s"]})]}):e.jsxs("div",{className:B.waitingMessage,children:[a," is choosing..."]})]})},Ys="_anteControls_1r55v_4",Vs="_anteButton_1r55v_27",Js="_backOutButton_1r55v_27",Ks="_sitOutHalfWidth_1r55v_27",Qs="_shimmerBorder_1r55v_105",Zs="_buttonInfo_1r55v_120",Xs="_buttonLabel_1r55v_127",en="_buttonAmount_1r55v_138",tn="_notEnoughChipsText_1r55v_149",w={anteControls:Ys,anteButton:Vs,backOutButton:Js,sitOutHalfWidth:Ks,shimmerBorder:Qs,buttonInfo:Zs,buttonLabel:Xs,buttonAmount:en,notEnoughChipsText:tn},sn="_toggleLabel_b88gt_2",nn="_toggleInput_b88gt_9",an="_toggleSlider_b88gt_15",on="_toggleText_b88gt_64",rn="_loading_b88gt_86",K={toggleLabel:sn,toggleInput:nn,toggleSlider:an,toggleText:on,loading:rn},cn=()=>{const{preferences:t,toggleAutoAnte:n,loading:o}=fe(),{gameState:s,playerReady:c}=P(),{socket:r}=O(),d=async()=>{const a=!t.autoAnte,l=await n();if(a&&l&&c){let _=null;if(r&&r.auth?.userId&&s?.players){const g=Object.keys(s.players);for(const u of g)if(s.players[u].userId===r.auth.userId){_=s.players[u];break}}_?.isReady||c()}};return o?e.jsx("div",{className:K.loading,children:"Loading preferences..."}):e.jsxs("label",{className:K.toggleLabel,children:[e.jsx("input",{type:"checkbox",checked:t.autoAnte,onChange:d,className:K.toggleInput,"data-gamepad-focusable":"true"}),e.jsx("span",{className:K.toggleSlider}),e.jsx("span",{className:K.toggleText,children:"Auto-Ante"})]})},ln=()=>{const{gameState:t,playerReady:n,playerUnready:o}=P(),{socket:s}=O(),{user:c}=W(),[r,d]=m.useState(!1);if(!t)return null;const{players:a,anteAmount:l,phase:_}=t;if(_!=="waiting")return null;let i=null;if(s&&s.auth?.userId&&a){const j=Object.keys(a);for(const N of j)if(a[N].userId===s.auth.userId){i=a[N];break}}else if(c&&a){const j=Object.keys(a);for(const N of j)if(a[N].userId===c.id){i=a[N],console.log("[AnteControls] Found player by user ID instead of socket ID");break}}const g=Number(i?.balance||0),u=i?.isReady,p=g>=l;return e.jsxs("div",{className:`panel-game ${w.anteControls}`,children:[u?e.jsxs("button",{type:"button",className:w.backOutButton,onClick:()=>{r||(typeof o=="function"?(d(!0),o()):console.error("playerUnready is not a function"))},disabled:r,"aria-label":"Back out","data-gamepad-focusable":"true",children:[e.jsx("div",{className:w.shimmerBorder}),e.jsx("div",{className:w.buttonInfo,children:e.jsx("span",{className:w.buttonLabel,children:"BACK OUT"})})]}):e.jsxs(e.Fragment,{children:[e.jsx(cn,{}),e.jsxs("button",{type:"button",className:w.anteButton,onClick:()=>{r||(d(!0),n())},disabled:!p||r,"aria-label":"Ante up","data-gamepad-focusable":"true",autoFocus:!0,children:[e.jsx("div",{className:w.shimmerBorder}),e.jsxs("div",{className:w.buttonInfo,children:[e.jsx("span",{className:w.buttonLabel,children:"ANTE"}),e.jsx("span",{className:w.buttonAmount,children:e.jsx(L,{amount:l})})]})]}),e.jsxs("button",{type:"button",className:`${w.backOutButton} ${w.sitOutHalfWidth}`,onClick:()=>{r||s&&t&&c&&(d(!0),s.emit("sitOut",{gameId:t.id,userId:s.auth?.userId||c.id}))},disabled:i?.isSittingOut||r,title:i?.isSittingOut?"You are currently sitting out":"Sit out next round","aria-label":"Sit Out","data-gamepad-focusable":"true",children:[e.jsx("div",{className:w.shimmerBorder}),e.jsx("div",{className:w.buttonInfo,children:e.jsx("span",{className:w.buttonLabel,children:"SIT OUT"})})]})]}),!u&&!p&&e.jsx("p",{className:w.notEnoughChipsText,children:"Not enough coins"})]})},dn="_bettingOverlay_1q32g_2",un="_timerContainer_1q32g_26",mn="_betButton_1q32g_57",_n="_passButton_1q32g_84",pn="_amountButton_1q32g_96",hn="_customButton_1q32g_108",gn="_amountPill_1q32g_120",xn="_potButtonWrapper_1q32g_137",yn="_customInput_1q32g_142",fn="_betInput_1q32g_152",jn="_confirmButton_1q32g_172",bn="_cancelButton_1q32g_173",I={bettingOverlay:dn,timerContainer:un,betButton:mn,passButton:_n,amountButton:pn,customButton:hn,amountPill:gn,potButtonWrapper:xn,customInput:yn,betInput:fn,confirmButton:jn,cancelButton:bn},Cn="_potButton_1pkys_3",Nn="_glowEffect_1pkys_37",vn="_potLabel_1pkys_53",Bn="_currencyPill_1pkys_63",An="_disabled_1pkys_102",Q={potButton:Cn,glowEffect:Nn,potLabel:vn,currencyPill:Bn,disabled:An},wn=({amount:t,disabled:n,onClick:o,...s})=>e.jsxs("button",{type:"button",className:`${Q.potButton} ${n?Q.disabled:""}`,onClick:o,disabled:n,"aria-label":`Bet the pot: ${t} chips`,"data-gamepad-focusable":"true",...s,children:[e.jsx("div",{className:Q.glowEffect}),e.jsx("span",{className:Q.potLabel,children:"POT"}),e.jsx("div",{className:Q.currencyPill,children:e.jsx(L,{amount:t,size:"small"})})]}),Tn=({isCurrentPlayersTurn:t})=>{const{gameState:n,placeBet:o}=P(),[s,c]=m.useState(""),[r,d]=m.useState(!1),[a,l]=m.useState(!1);if(!n||!t)return e.jsx(re,{playerName:n?.players[n.currentPlayerId]?.name||"Player",action:"betting",duration:oe.BETTING_DURATION});const{pot:_,firstCard:i,secondCard:g,players:u,currentPlayerId:p,anteAmount:j=1}=n,C=u[p]?.balance||0,$=i?.value==="A"&&g?.value==="A",S=Math.floor($?C/3:C/2),A=Math.min(_,S),h=j,Y=[1,5,10,20,50,100].filter(v=>v>=h&&v<=A).slice(-3),V=v=>{a||v>=h&&v<=A&&(l(!0),o(v),d(!1))},xe=()=>{a||(l(!0),o(0))},ie=()=>{const v=parseInt(s);!isNaN(v)&&v>=h&&v<=A&&(V(v),c(""))};return e.jsxs("div",{className:`panel-game ${I.bettingOverlay}`,children:[e.jsx("div",{className:I.timerContainer,children:e.jsx(ce,{duration:30,isActive:!0})}),r?e.jsxs("div",{className:I.customInput,children:[e.jsx(he,{title:"Enter Custom Bet",type:"number",value:s,onChange:v=>c(v.target.value),onKeyPress:v=>v.key==="Enter"&&ie(),placeholder:`${h}-${A}`,min:h,max:A,autoFocus:!0,className:I.betInput}),e.jsx("button",{type:"button",onClick:ie,className:I.confirmButton,disabled:a,"data-gamepad-focusable":"true",children:f.CHECK}),e.jsx("button",{type:"button",onClick:()=>{d(!1),c("")},className:I.cancelButton,disabled:a,"data-gamepad-focusable":"true",children:f.CROSS})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",className:`${I.betButton} ${I.passButton}`,onClick:xe,disabled:a,"data-gamepad-focusable":"true",autoFocus:!0,children:e.jsx("span",{children:"PASS"})}),Y.map(v=>e.jsx("button",{type:"button",className:`${I.betButton} ${I.amountButton}`,onClick:()=>V(v),disabled:a,"data-gamepad-focusable":"true",children:e.jsx("div",{className:I.amountPill,children:e.jsx(L,{amount:v,size:"small"})})},v)),A===_&&e.jsx("div",{className:I.potButtonWrapper,children:e.jsx(wn,{onClick:()=>V(_),disabled:a,amount:_})}),e.jsx("button",{type:"button",className:`${I.betButton} ${I.customButton}`,onClick:()=>d(!0),disabled:a,"data-gamepad-focusable":"true",children:e.jsx("span",{children:"CUSTOM"})})]})]})},Sn="_cardsRow_12pga_1",In="_card_12pga_1",Pn="_dealingPhase_12pga_74",kn="_revealingPhase_12pga_83",Ln="_cardBack_12pga_109",$n="_redCard_12pga_119",En="_blackCard_12pga_123",Rn="_cardCorner_12pga_127",On="_bottomRight_12pga_136",Mn="_cardValue_12pga_144",Dn="_cardSuit_12pga_150",Gn="_cardCenter_12pga_155",Fn="_aceCard_12pga_212",qn="_aceIndicator_12pga_216",zn="_aceHigh_12pga_236",Un="_aceLow_12pga_242",Hn="_indicatorContent_12pga_248",b={cardsRow:Sn,card:In,dealingPhase:Pn,revealingPhase:kn,cardBack:Ln,redCard:$n,blackCard:En,cardCorner:Rn,bottomRight:On,cardValue:Mn,cardSuit:Dn,cardCenter:Gn,aceCard:Fn,aceIndicator:qn,aceHigh:zn,aceLow:Un,indicatorContent:Hn},Wn=()=>{const{gameState:t}=P(),[n,o]=m.useState(le());if(m.useEffect(()=>{const u=()=>{o(le())};return window.addEventListener("cardbackchange",u),()=>window.removeEventListener("cardbackchange",u)},[]),!t)return e.jsx("div",{className:b.loading,children:"Loading game state..."});const{firstCard:s,secondCard:c,thirdCard:r,phase:d}=t,a={2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10",J:"J",Q:"Q",K:"K",A:"A"},l={hearts:f.HEARTS,diamonds:f.DIAMONDS,clubs:f.CLUBS,spades:f.SPADES,[f.HEARTS]:f.HEARTS,[f.DIAMONDS]:f.DIAMONDS,[f.CLUBS]:f.CLUBS,[f.SPADES]:f.SPADES},_=u=>u===f.HEARTS||u===f.DIAMONDS||u==="hearts"||u==="diamonds",i=(u,p)=>{if(!u)return e.jsx("div",{className:b.card,children:e.jsx("div",{className:b.cardBack,style:{backgroundImage:`url(${n})`}})},`empty-${p}`);const j=_(u.suit),N=u.value==="A",C=u.isAceLow,$=p===1;return e.jsxs("div",{className:`${b.card} ${j?b.redCard:b.blackCard} ${N?b.aceCard:""}`,children:[N&&!$&&e.jsx("div",{className:`${b.aceIndicator} ${C?b.aceLow:b.aceHigh} ${j?b.redCard:b.blackCard}`,children:C?e.jsxs("span",{className:b.indicatorContent,children:["LOW ",f.ARROW_DOWN]}):e.jsxs("span",{className:b.indicatorContent,children:["HIGH ",f.ARROW_UP]})}),e.jsxs("div",{className:b.cardCorner,children:[e.jsx("div",{className:b.cardValue,children:a[u.value]}),e.jsx("div",{className:b.cardSuit,children:l[u.suit]})]}),e.jsx("div",{className:b.cardCenter,children:l[u.suit]}),e.jsxs("div",{className:`${b.cardCorner} ${b.bottomRight}`,children:[e.jsx("div",{className:b.cardValue,children:a[u.value]}),e.jsx("div",{className:b.cardSuit,children:l[u.suit]})]})]},`${u.value}-${u.suit}-${p}`)},g=()=>{const u=[null,null,null];return!s&&!c&&!r?u.map((p,j)=>i(p,j)):(s&&(u[0]={...s}),c&&(u[2]={...c}),r&&(u[1]={...r}),u.map((p,j)=>i(p,j)))};return e.jsx("div",{className:`${b.cardsRow} ${d==="dealing"?b.dealingPhase:""} ${d==="revealing"?b.revealingPhase:""}`,children:g()})},Yn="_imBackOverlay_1wm7i_3",Vn="_container_1wm7i_11",Jn="_sittingOutText_1wm7i_21",Kn="_imBackButton_1wm7i_30",Qn="_buttonText_1wm7i_48",Zn="_helpText_1wm7i_66",z={imBackOverlay:Yn,container:Vn,sittingOutText:Jn,imBackButton:Kn,buttonText:Qn,helpText:Zn},Xn=({onClick:t,disabled:n=!1})=>e.jsx("div",{className:z.imBackOverlay,children:e.jsxs("div",{className:z.container,children:[e.jsx("h3",{className:z.sittingOutText,children:"You are sitting out"}),e.jsx("button",{type:"button",className:z.imBackButton,onClick:t,disabled:n,"data-gamepad-focusable":"true",autoFocus:!0,children:e.jsx("span",{className:z.buttonText,children:"I'M BACK!"})}),e.jsx("p",{className:z.helpText,children:"Click to rejoin the game"})]})}),ea="_potDisplay_1o95d_2",ta="_potLabel_1o95d_18",_e={potDisplay:ea,potLabel:ta},sa=()=>{const{gameState:t}=P();if(!t)return null;const{pot:n=0}=t;return e.jsxs("div",{className:_e.potDisplay,children:[e.jsx("span",{className:_e.potLabel,children:"POT"}),e.jsx(L,{amount:n,size:"large"})]})},na="_resultsContainer_upvys_2",aa="_messageArea_upvys_11",oa="_resultBar_upvys_22",ra="_playerName_upvys_66",ca="_resultText_upvys_71",ia="_winBar_upvys_78",la="_winAmount_upvys_82",da="_lossBar_upvys_91",ua="_lossAmount_upvys_95",ma="_penaltyBar_upvys_104",_a="_penaltyText_upvys_108",pa="_penaltyAmount_upvys_114",ha="_animationContainer_upvys_124",ga="_cautionTapeContainer_upvys_132",xa="_cautionTape_upvys_132",y={resultsContainer:na,messageArea:aa,resultBar:oa,playerName:ra,resultText:ca,winBar:ia,winAmount:la,lossBar:da,lossAmount:ua,penaltyBar:ma,penaltyText:_a,penaltyAmount:pa,animationContainer:ha,cautionTapeContainer:ga,cautionTape:xa},ya="_rainContainer_fxhyg_2",fa="_fallingItem_fxhyg_10",ja="_emoji_fxhyg_18",ba="_confetti_fxhyg_26",U={rainContainer:ya,fallingItem:fa,emoji:ja,confetti:ba},te=({type:t="emoji",items:n=[],count:o=10,animationDuration:s=2.5,className:c=""})=>{const r=d=>{const a=d/o*s,l=(Math.random()-.5)*.3,_=a+l,i=Math.random()*100;switch(t){case"coin":return e.jsx("div",{className:U.fallingItem,style:{left:`${i}%`,animationDelay:`${_}s`,"--animation-duration":`${s}s`},children:e.jsx(Pe,{size:"large"})},d);case"confetti":const g=n.length>0?n:["#ffd700","#ffed4e","#fff","#ff6b6b","#4CAF50"];return e.jsx("div",{className:`${U.fallingItem} ${U.confetti}`,style:{left:`${i}%`,animationDelay:`${_}s`,"--animation-duration":`${s*1.2}s`,backgroundColor:g[Math.floor(Math.random()*g.length)]}},d);case"emoji":default:const u=n.length>0?n:["ğŸ‰"];return e.jsx("div",{className:U.fallingItem,style:{left:`${i}%`,animationDelay:`${_}s`,"--animation-duration":`${s}s`},children:e.jsx("span",{className:U.emoji,children:u[Math.floor(Math.random()*u.length)]})},d)}};return e.jsx("div",{className:`${U.rainContainer} ${c}`,children:[...Array(o)].map((d,a)=>r(a))})},Ca=({result:t,players:n})=>{if(!t)return null;const o=n[t.playerId]?.name||"Player",s=t.outcome;if(s==="win"){const a=t.winnings||0,l=Math.min(a/500,1),_=Math.floor(10+l*40),i=Math.floor(5+l*20);return e.jsxs("div",{className:y.resultsContainer,children:[e.jsxs("div",{className:y.animationContainer,children:[e.jsx(te,{type:"confetti",count:_,animationDuration:3,items:["#ffd700","#ffed4e","#fff","#ff6b6b","#4CAF50"]}),e.jsx(te,{type:"coin",count:i,animationDuration:2})]}),e.jsx("div",{className:y.messageArea,children:e.jsxs("div",{className:`panel ${y.resultBar} ${y.winBar}`,children:[e.jsx("span",{className:y.playerName,children:e.jsx(H,{username:o})}),e.jsx("span",{className:y.resultText,children:"WINS"}),t.winnings&&t.winnings>0&&e.jsx("span",{className:y.winAmount,children:e.jsx(L,{amount:t.winnings/2,size:"small"})})]})})]})}if(s==="lose"){const a=t.betAmount||0,l=Math.min(a/500,1),_=Math.floor(8+l*22),i=["ğŸ˜¢","ğŸ˜”","ğŸ˜•","ğŸ‘","ğŸ“‰","ğŸ’”","ğŸ—‘ï¸","ğŸ¤¦â€â™‚ï¸"],g=["ğŸ˜­","ğŸ˜©","ğŸ¤¦","ğŸ’¸","ğŸ“‰","ğŸ˜¤","ğŸ˜£","ğŸ—‘ï¸","ğŸ¤¡","ğŸ’©","ğŸ™ˆ"],u=["ğŸ¤¡","ğŸ’©","ğŸ˜‚","ğŸ¤£","ğŸ—‘ï¸","ğŸ’€","â˜ ï¸","ğŸª¦","âš°ï¸","ğŸ¤ª","ğŸ˜µâ€ğŸ’«","ğŸ™ƒ","ğŸ¤®"];let p;return a<50?p=i:a<200?p=g:p=u,e.jsxs("div",{className:y.resultsContainer,children:[e.jsx("div",{className:y.animationContainer,children:e.jsx(te,{type:"emoji",items:p,count:_,animationDuration:2.5})}),e.jsx("div",{className:y.messageArea,children:e.jsxs("div",{className:`panel ${y.resultBar} ${y.lossBar}`,children:[e.jsx("span",{className:y.playerName,children:e.jsx(H,{username:o})}),e.jsx("span",{className:y.resultText,children:"LOST"}),t.betAmount&&t.betAmount>0&&e.jsx("span",{className:y.lossAmount,children:e.jsx(L,{amount:t.betAmount,size:"small"})})]})})]})}const c=(t.betAmount||0)*(t.isTripleAceTie?3:2),r=t.isTripleAceTie?15:8,d=t.isTripleAceTie?["ğŸ’€","â˜ ï¸","âš ï¸","ğŸš¨","â›”","ğŸ’¥","ğŸ”¥","ğŸ˜±","ğŸ°","ğŸ’¸"]:["âš ï¸","ğŸš¨","â›”","ğŸ”´","âŒ","ğŸ’¥","ğŸ¯","ğŸ²"];return e.jsxs("div",{className:y.resultsContainer,children:[e.jsxs("div",{className:y.cautionTapeContainer,children:[e.jsxs("div",{className:y.cautionTape,children:[e.jsx("span",{children:t.isTripleAceTie?"TRIPLE PENALTY":"PENALTY"}),e.jsx("span",{children:t.isTripleAceTie?"TRIPLE PENALTY":"PENALTY"}),e.jsx("span",{children:t.isTripleAceTie?"TRIPLE PENALTY":"PENALTY"})]}),e.jsxs("div",{className:y.cautionTape,children:[e.jsx("span",{children:t.isTripleAceTie?"TRIPLE PENALTY":"PENALTY"}),e.jsx("span",{children:t.isTripleAceTie?"TRIPLE PENALTY":"PENALTY"}),e.jsx("span",{children:t.isTripleAceTie?"TRIPLE PENALTY":"PENALTY"})]})]}),e.jsx("div",{className:y.animationContainer,children:e.jsx(te,{type:"emoji",items:d,count:r,animationDuration:t.isTripleAceTie?2:3})}),e.jsx("div",{className:y.messageArea,children:e.jsxs("div",{className:`panel ${y.resultBar} ${y.penaltyBar}`,children:[e.jsx("span",{className:y.playerName,children:e.jsx(H,{username:o})}),e.jsx("span",{className:y.resultText,children:t.isTripleAceTie?"TRIPLE":""}),e.jsxs("span",{className:y.penaltyText,children:[t.isTripleAceTie?"3x":"2x"," PENALTY"]}),e.jsx("span",{className:y.penaltyAmount,children:e.jsx(L,{amount:c,size:"small"})})]})})]})},Na="_revealingOverlay_hpopv_2",va="_revealingContent_hpopv_26",Ba="_playerName_hpopv_35",Aa="_actionText_hpopv_43",wa="_betAmount_hpopv_51",Z={revealingOverlay:Na,revealingContent:va,playerName:Ba,actionText:Aa,betAmount:wa},Ta=({playerName:t,betAmount:n})=>!t||!n?null:e.jsx("div",{className:`panel-game ${Z.revealingOverlay}`,children:e.jsxs("div",{className:Z.revealingContent,children:[e.jsx("span",{className:Z.playerName,children:e.jsx(H,{username:t})}),e.jsx("span",{className:Z.actionText,children:"bets"}),e.jsx("div",{className:Z.betAmount,children:e.jsx(L,{amount:n,size:"small"})})]})}),Sa="_secondChanceOverlay_1sq4x_2",Ia="_bridge_1sq4x_13",Pa="_bridgeLine_1sq4x_20",ka="_matchBadge_1sq4x_57",La="_matchText_1sq4x_69",$a="_choiceContainer_1sq4x_78",Ea="_timer_1sq4x_87",Ra="_buttons_1sq4x_106",Oa="_choiceButton_1sq4x_112",Ma="_anteButton_1sq4x_139",Da="_passButton_1sq4x_151",Ga="_buttonIcon_1sq4x_162",Fa="_buttonText_1sq4x_168",qa="_buttonAmount_1sq4x_174",za="_waitingContainer_1sq4x_180",Ua="_waitingMessage_1sq4x_187",Ha="_secondChanceBottom_1sq4x_229",Wa="_timerContainer_1sq4x_243",Ya="_bottomButtonContainer_1sq4x_251",Va="_choicePrompt_1sq4x_258",Ja="_bottomChoiceButton_1sq4x_267",Ka="_anteButtonBottom_1sq4x_293",Qa="_passButtonBottom_1sq4x_302",x={secondChanceOverlay:Sa,bridge:Ia,bridgeLine:Pa,matchBadge:ka,matchText:La,choiceContainer:$a,timer:Ea,buttons:Ra,choiceButton:Oa,anteButton:Ma,passButton:Da,buttonIcon:Ga,buttonText:Fa,buttonAmount:qa,waitingContainer:za,waitingMessage:Ua,secondChanceBottom:Ha,timerContainer:Wa,bottomButtonContainer:Ya,choicePrompt:Va,bottomChoiceButton:Ja,anteButtonBottom:Ka,passButtonBottom:Qa},pe=({isCurrentPlayersTurn:t,bottomPosition:n=!1,indicatorOnly:o=!1})=>{const{gameState:s}=P(),{socket:c}=O(),[r,d]=m.useState(null),{anteAmount:a=1,players:l,currentPlayerId:_}=s,g=l[_]?.name||"Player",u=p=>{r===null&&c&&(d(p),c.emit("secondChance",{anteAgain:p}))};return o?null:n?t?e.jsxs("div",{className:`panel-game ${x.secondChanceBottom}`,children:[e.jsx("div",{className:x.timerContainer,children:e.jsx(ce,{duration:15,isActive:!0})}),e.jsxs("div",{className:x.bottomButtonContainer,children:[e.jsx("span",{className:x.choicePrompt,children:"SECOND CHANCE:"}),e.jsxs("button",{type:"button",className:`${x.bottomChoiceButton} ${x.anteButtonBottom}`,onClick:()=>u(!0),disabled:r!==null,"data-gamepad-focusable":"true",autoFocus:!0,children:[e.jsx("span",{className:x.buttonIcon,children:f.ROTATE}),e.jsx("span",{children:"ANTE AGAIN"}),e.jsx(L,{amount:a,size:"small"})]}),e.jsxs("button",{type:"button",className:`${x.bottomChoiceButton} ${x.passButtonBottom}`,onClick:()=>u(!1),disabled:r!==null,"data-gamepad-focusable":"true",children:[e.jsx("span",{children:"PASS"}),e.jsx("span",{className:x.buttonIcon,children:f.ARROW_RIGHT})]})]})]}):e.jsx(re,{playerName:g,action:"deciding on second chance",duration:oe.DECISION_DURATION}):e.jsxs("div",{className:x.secondChanceOverlay,children:[e.jsxs("div",{className:x.bridge,children:[e.jsx("div",{className:x.bridgeLine}),e.jsx("div",{className:x.matchBadge,children:e.jsx("span",{className:x.matchText,children:"MATCH!"})})]}),t?e.jsxs("div",{className:x.choiceContainer,children:[e.jsxs("div",{className:x.timer,children:[countdown,"s"]}),e.jsxs("div",{className:x.buttons,children:[e.jsxs("button",{type:"button",className:`${x.choiceButton} ${x.anteButton}`,onClick:()=>u(!0),disabled:r!==null,"data-gamepad-focusable":"true",autoFocus:!0,children:[e.jsx("span",{className:x.buttonIcon,children:f.ROTATE}),e.jsx("span",{className:x.buttonText,children:"ANTE AGAIN"}),e.jsx("span",{className:x.buttonAmount,children:e.jsx(L,{amount:a,size:"small"})})]}),e.jsxs("button",{type:"button",className:`${x.choiceButton} ${x.passButton}`,onClick:()=>u(!1),disabled:r!==null,"data-gamepad-focusable":"true",children:[e.jsx("span",{className:x.buttonText,children:"PASS"}),e.jsx("span",{className:x.buttonIcon,children:f.ARROW_RIGHT})]})]})]}):e.jsx("div",{className:x.waitingContainer,children:e.jsxs("div",{className:x.waitingMessage,children:[g," is deciding..."]})})]})},Za=()=>{const{gameState:t}=P(),{socket:n}=O(),{user:o}=W(),[s,c]=m.useState(!1);if(!t)return null;const{phase:r,currentPlayerId:d,players:a,waitingForAceDecision:l,waitingForSecondChance:_,firstCard:i,secondCard:g,result:u}=t,p=o?.id,j=a&&p?a[p]:null,N=p===d,C=j?.isSittingOut||!1,$=()=>{s||n&&t.id&&(c(!0),n.emit("imBack",{gameId:t.id}))};return e.jsxs("div",{className:ee.table,children:[e.jsx("div",{className:ee.feltTexture}),e.jsx(sa,{}),e.jsx(Wn,{}),l&&e.jsx("div",{className:ee.aceGlowEffect}),_&&e.jsx(pe,{firstCard:i,secondCard:g,isCurrentPlayersTurn:N,indicatorOnly:!0}),!C&&e.jsxs(e.Fragment,{children:[r==="betting"&&!l&&!_&&e.jsx(Tn,{isCurrentPlayersTurn:N}),l&&e.jsx(Ws,{card:i,isCurrentPlayersTurn:N,bottomPosition:!0}),_&&e.jsx(pe,{firstCard:i,secondCard:g,isCurrentPlayersTurn:N,bottomPosition:!0})]}),r==="revealing"&&!C&&e.jsx(Ta,{playerName:a[d]?.name||"Player",betAmount:a[d]?.currentBet||0}),r==="results"&&u&&!C&&e.jsx(Ca,{result:u,players:a}),r==="waiting"&&!C&&e.jsx(ln,{}),C&&e.jsx("div",{className:ee.sitOutOverlay,children:e.jsx(Xn,{onClick:$,disabled:s})})]})},Xa=({onReturnToLobby:t})=>{const[n,o]=m.useState(!1),{gameState:s,error:c,clearError:r}=P(),{user:d}=W(),a=!d?.subscription?.isPremium;Ee(!0),m.useEffect(()=>{if(c){const _=setTimeout(()=>{r()},1e4);return()=>clearTimeout(_)}},[c,r]);const l=()=>{t&&t()};return s?e.jsxs("div",{className:`screen app-gradient-bg ${G.gameContainer} ${a?G.withAds:""}`,children:[e.jsxs("div",{className:`${G.gameScreen} mobile-scale-content`,children:[e.jsx(jt,{handleLeaveGame:l,onModalStateChange:o}),c&&e.jsx("div",{className:G.errorContainer,children:e.jsx("p",{className:G.errorText,children:c})}),e.jsx(Za,{}),e.jsxs("div",{className:G.gameBottomSection,children:[e.jsx(hs,{}),e.jsx(es,{})]})]}),!n&&e.jsx(it,{})]}):e.jsx("div",{className:G.loadingContainer,children:e.jsx("p",{children:"Loading game state..."})})},eo=({loading:t,error:n,isPasswordModalOpen:o,handlePasswordCancel:s,handlePasswordSubmit:c,handleReturnToLobby:r,gameId:d})=>{const{gameState:a}=P(),{socket:l}=O();return m.useEffect(()=>{const _=i=>{const g=l?.auth?.userId;if((g&&a?.players?a.players[g]:null)?.isReady||!1)return i.preventDefault(),i.returnValue="You have money in the pot! Are you sure you want to leave?",i.returnValue};return window.addEventListener("beforeunload",_),()=>{window.removeEventListener("beforeunload",_)}},[a,l]),e.jsxs(e.Fragment,{children:[e.jsx(Ve,{isOpen:o,onClose:s,onSubmit:c,gameId:d}),t&&e.jsx(je,{message:`Joining game ${d}...`}),n&&!t&&!o&&e.jsxs("div",{className:"error-container",style:{padding:"20px",color:"red",textAlign:"center"},children:[e.jsx("h2",{children:"An error occurred"}),e.jsx("p",{children:n}),e.jsx("button",{type:"button",onClick:()=>window.location.reload(),children:"Refresh Page"})]}),!t&&!n&&a&&e.jsx(Xa,{onReturnToLobby:r})]})},io=()=>{const{gameId:t}=be(),n=Ce(),{socket:o,isConnected:s}=O(),[c,r]=m.useState(!0),[d,a]=m.useState(null),[l,_]=m.useState(!1),i=m.useRef(!1),{shouldShowAd:g,hideAd:u}=ke(),p=m.useCallback(()=>{o&&s&&t&&(ne.play("ui.leave"),o.emit("leaveGame",{gameId:t}),n("/",{state:{fromGame:!0}}))},[o,s,t,n]),j=m.useCallback(C=>{_(!1),o&&t&&C&&(a(null),o.emit("joinGame",{gameId:t,password:C}),r(!0))},[o,t]),N=m.useCallback(()=>{_(!1),n("/")},[n]);return m.useEffect(()=>{a(null),_(!1),r(!0)},[t]),m.useEffect(()=>{if(!o)return;const C=S=>{S&&S.game&&S.game.id===t&&(ne.play("ui.join"),r(!1),a(null),_(!1))},$=S=>{const A=S.message||"An unknown error occurred";A==="Password required"?(console.error(S),_(!0),r(!1),a(null)):A==="Invalid password"?(console.error(S),a("Invalid password."),_(!0),r(!1)):A==="Game not found"?n("/"):A==="Game is full"?(a(A),r(!1),_(!1),setTimeout(()=>n("/"),3e3)):(a(A),r(!1),_(!1))};return o.on("gameJoined",C),o.on("error",$),()=>{o.off("gameJoined",C),o.off("error",$)}},[o,t,n]),m.useEffect(()=>{o&&t&&!i.current&&(i.current=!0,r(!0),a(null),_(!1),o.emit("joinGame",{gameId:t}))},[o,t]),e.jsxs(Ge,{gameId:t,children:[e.jsx(eo,{loading:c,error:d,isPasswordModalOpen:l,handlePasswordCancel:N,handlePasswordSubmit:j,handleReturnToLobby:p,gameId:t}),g&&e.jsx(Le,{onClose:u}),e.jsx($e,{}),e.jsx(de,{position:"left",minWidth:1200}),e.jsx(de,{position:"right",minWidth:1200})]})};export{io as default};
