import{u as e,j as r,a,A as s}from"./index-9FNDV-VY.js";import{r as t,u as n}from"./vendor-D3vErxIQ.js";import{u as o}from"./useGamepadNavigation-Tj-O-nX_.js";import{A as i}from"./AppHeader-BuT0LqXZ.js";import"./audio-D4HOgbU8.js";import"./socket-DfKCw8Ob.js";const l="_authForm_1wx71_1",c="_errorAlert_1wx71_95",u=({onSubmit:a,mode:s})=>{const[n,o]=t.useState(""),[i,u]=t.useState(""),[d,m]=t.useState(""),h=t.useRef(null),p=t.useRef(null),{enhanceInput:g}=e();t.useEffect((()=>{let e,r;return h.current&&(e=g(h.current,"text","Enter Username")),p.current&&(r=g(p.current,"password","Enter Password")),()=>{e&&e(),r&&r()}}),[g]);return r.jsxs("div",{className:`card ${l}`,children:[r.jsx("h2",{style:{color:"var(--text-primary)",fontWeight:600,textAlign:"center",marginTop:0},children:"login"===s?"Welcome Back":"Create Account"}),r.jsx("div",{className:"divider",style:{marginBottom:"1.5rem"}}),d&&r.jsx("div",{className:c,children:d}),r.jsxs("form",{onSubmit:async e=>{e.preventDefault(),m("");try{await a(n,i)}catch(r){m(r.message)}},children:[r.jsxs("div",{className:"input-group",children:[r.jsx("label",{htmlFor:"username",className:"input-label required",children:"Username"}),r.jsx("input",{ref:h,id:"username",type:"text",className:"no-validation",placeholder:"Enter your username",value:n,onChange:e=>o(e.target.value),required:!0,minLength:3,"data-gamepad-focusable":"true"})]}),r.jsxs("div",{className:"input-group",children:[r.jsx("label",{htmlFor:"password",className:"input-label required",children:"Password"}),r.jsx("input",{ref:p,id:"password",type:"password",className:"no-validation",placeholder:"Enter your password",value:i,onChange:e=>u(e.target.value),required:!0,minLength:6,"data-gamepad-focusable":"true"})]}),r.jsx("button",{type:"submit",className:"btn btn-primary","data-gamepad-focusable":"true",children:"login"===s?"Sign In":"Create Account"})]})]})},d="_authPage_vo5h9_1",m="_error_vo5h9_19",h="_formContainer_vo5h9_32",p="_toggleContainer_vo5h9_96",g="_toggleButton_vo5h9_101",v=()=>{const[e,l]=t.useState("login"),{login:c}=a(),v=n();o(!0);const[j,f]=t.useState(null);return r.jsxs("div",{className:`screen ${d}`,children:[r.jsx(i,{}),r.jsxs("div",{className:h,children:[j&&r.jsx("div",{className:m,children:j}),r.jsx(u,{mode:e,onSubmit:async(r,a)=>{if(!r||!a)return void f("Username and password are required");f(null);const t=`${s}/auth/${e}`;try{const e={username:r,password:a},s=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});let o;try{o=await s.json()}catch(n){throw new Error("Invalid response from server")}if(!s.ok)throw new Error(o.message||"Authentication failed");if(!o.user?.username||!o.user?.id||!o.token)throw new Error("Invalid server response format");try{c(o.user,o.token),v("/")}catch(n){throw new Error("Failed to initialize user session")}}catch(n){f(n.message||"Failed to connect to server")}}}),r.jsx("div",{className:p,children:r.jsx("button",{className:g,onClick:()=>l("login"===e?"register":"login"),"data-gamepad-focusable":"true",children:"login"===e?"Don't have an account? Register":"Already have an account? Login"})})]})]})};export{v as default};
