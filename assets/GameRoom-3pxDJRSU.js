import{b as e,a,s,j as t,U as n,f as r,L as i}from"./index-BZZJfyUK.js";import{r as l,e as c,u as o}from"./vendor-D3vErxIQ.js";import{C as d,a as m,R as u,P as _,S as h,I as x,c as g,b as p,G as j,U as b}from"./GamepadInput-B_gymb71.js";import{u as N}from"./useGamepadNavigation-Tj-O-nX_.js";import"./audio-D4HOgbU8.js";import"./socket-DfKCw8Ob.js";const v="🍯",f="🃏",y="✓",C="🃏",{TIMERS:I}={TIMERS:{DEALING_DURATION:3e3,BETTING_DURATION:3e4,REVEALING_DURATION:3e3,RESULTS_DURATION:5e3}},w=l.createContext(),k=()=>{const e=l.useContext(w);if(void 0===e)throw new Error("useGameContext must be used within a GameProvider");return e},T=({children:n,gameId:r,initialGameState:i=null})=>{const{socket:c,error:o}=e(),{user:d}=a(),[m,u]=l.useState(i);l.useRef({});const _=l.useRef(null),[h,x]=l.useState(null),g=l.useCallback((()=>{x(null)}),[]);l.useEffect((()=>{o&&x(o)}),[o]),l.useEffect((()=>{if(c)return c.on("gameReconnected",(e=>{u(e.game),x(null),e.game&&e.game.id&&setTimeout((()=>{c.emit("getGameState",{gameId:e.game.id})}),500)})),c.on("gameState",(e=>{if(e&&e.id&&JSON.stringify(m)!==JSON.stringify(e)){if(e.currentPlayerId&&d?.id){const a=e.currentPlayerId===d.id,t=_.current===d.id;a&&!t&&s.play("ui.alert"),_.current=e.currentPlayerId}u(e),g()}})),c.on("gameError",(e=>{x(e)})),()=>{c.off("gameReconnected"),c.off("gameState"),c.off("gameError")}}),[c]);const p=l.useCallback((e=>{if(c&&r)try{c.emit("placeBet",{bet:e,gameId:r})}catch(a){x("Failed to place bet. Please try again.")}}),[c,r]),j=l.useCallback((()=>{if(c&&r)try{c.emit("payAnte",{gameId:r})}catch(e){x("Failed to pay ante. Please try again.")}}),[c,r]),b=l.useCallback((()=>{if(c&&r)try{c.emit("dealCards",{gameId:r})}catch(e){x("Failed to deal cards. Please try again.")}}),[c,r]),N=l.useCallback((()=>{if(c&&r)try{c.emit("revealMiddleCard",{gameId:r})}catch(e){x("Failed to reveal middle card. Please try again.")}}),[c,r]),v=l.useCallback((()=>{if(c&&r)try{c.emit("nextRound",{gameId:r})}catch(e){x("Failed to move to next round. Please try again.")}}),[c,r]),f=l.useCallback((()=>{if(c&&r)try{c.emit("ready")}catch(e){x("Failed to set player ready. Please try again.")}}),[c,r]),y=l.useCallback((()=>{if(c&&r)try{c.emit("unready")}catch(e){x("Failed to set player unready. Please try again.")}}),[c,r]),C={gameState:m,error:h,gameId:r,placeBet:p,payAnte:j,playerReady:f,playerUnready:y,dealCards:b,revealMiddleCard:N,nextRound:v,clearError:g};return t.jsx(w.Provider,{value:C,children:n})},S="_gameContainer_126jq_1",A="_gameScreen_126jq_5",B="_loadingContainer_126jq_31",P="_errorContainer_126jq_40",R="_errorText_126jq_50",L="_gameInfoWrapper_126jq_55",E="_gameBottomSection_126jq_70",$={headerContainer:"_headerContainer_7fahv_1",desktopLayout:"_desktopLayout_7fahv_7",mobileLayout:"_mobileLayout_7fahv_13",mobileTopRow:"_mobileTopRow_7fahv_19",mobileRight:"_mobileRight_7fahv_31",mobileActions:"_mobileActions_7fahv_38",mobileBottomRow:"_mobileBottomRow_7fahv_45",headerLeft:"_headerLeft_7fahv_54",headerRight:"_headerRight_7fahv_60",controlsGroup:"_controlsGroup_7fahv_66",controlsStack:"_controlsStack_7fahv_73",mobileControlsStack:"_mobileControlsStack_7fahv_80",gameTitle:"_gameTitle_7fahv_89",liveTag:"_liveTag_7fahv_99",pulse:"_pulse_7fahv_1",gameIdText:"_gameIdText_7fahv_151",gameIdLink:"_gameIdLink_7fahv_158",headerCenter:"_headerCenter_7fahv_195",gamePhase:"_gamePhase_7fahv_223",phaseIcon:"_phaseIcon_7fahv_285",phaseText:"_phaseText_7fahv_290",timerBar:"_timerBar_7fahv_294",timerProgress:"_timerProgress_7fahv_304",dealPulse:"_dealPulse_7fahv_1",betPulse:"_betPulse_7fahv_1",revealFade:"_revealFade_7fahv_1",resultPulse:"_resultPulse_7fahv_1",phaseBettingYourTurn:"_phaseBettingYourTurn_7fahv_458",phaseBettingWaiting:"_phaseBettingWaiting_7fahv_465",reveal:"_reveal_7fahv_1",sparkle:"_sparkle_7fahv_1",timerDrain:"_timerDrain_7fahv_1"},O=({color:e="currentColor",size:a=24})=>t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:a,height:a,viewBox:"0 0 24 24",fill:"none",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),t.jsx("polyline",{points:"16 17 21 12 16 7"}),t.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),D={waiting:{text:"Waiting for Players",icon:"👥"},dealing:{text:"Dealing Cards",icon:f},revealing:{text:"Revealing Cards",icon:"🥁"},results:{text:"Round Results",icon:"🏆"}},q=({handleLeaveGame:s,onModalStateChange:n})=>{const{gameState:r,gameId:i}=k(),{socket:c}=e(),{user:o}=a(),j=c?.auth?.userId,b=j&&r?.players?r.players[j]:null,N=b?.balance??o?.balance??0,v=r?.phase||"waiting",f=b?.isReady||!1,[y,C]=l.useState(null),[w,T]=l.useState(!1),[S,A]=l.useState(!1),[B,P]=l.useState(!1),[R,L]=l.useState(!1),[E,q]=l.useState(!1);l.useEffect((()=>{let e;return"dealing"===v?(C(I.DEALING_DURATION),e=setInterval((()=>{C((e=>Math.max(0,e-100)))}),100)):"betting"===v?(C(I.BETTING_DURATION),e=setInterval((()=>{C((e=>Math.max(0,e-100)))}),100)):"revealing"===v?(C(I.REVEALING_DURATION),e=setInterval((()=>{C((e=>Math.max(0,e-100)))}),100)):"results"===v?(C(I.RESULTS_DURATION),e=setInterval((()=>{C((e=>Math.max(0,e-100)))}),100)):C(null),()=>{e&&clearInterval(e)}}),[v,r?.waitingForAceDecision]),l.useEffect((()=>{n&&n(w||S||B||R||E)}),[w,S,B,R,E,n]);let F=D[v]||{text:"Unknown Phase",icon:"❓"};r?.waitingForAceDecision&&"dealing"===v&&(F={text:"Choosing Ace Value",icon:"🤔"}),r?.waitingForSecondChance&&(F={text:"Second Chance Decision",icon:"🤔"});const z=c&&c.auth?.userId&&r?.currentPlayerId===c.auth.userId;if("betting"===v&&r?.currentPlayerId&&r?.players){const e=r.players[r.currentPlayerId];F=e?z?{text:"Pass or Bet",icon:"🤔"}:{text:`${e.name} is Betting`,icon:"🤔"}:{text:"Betting Round",icon:"🤔"}}return t.jsxs("div",{className:$.headerContainer,children:[t.jsxs("div",{className:`panel ${$.desktopLayout}`,children:[t.jsxs("div",{className:$.headerLeft,children:[t.jsxs("h1",{className:$.gameTitle,children:["In Between ",t.jsx("span",{className:$.liveTag,children:"LIVE"})]}),t.jsx("p",{className:$.gameIdText,children:t.jsxs("span",{className:$.gameIdLink,onClick:()=>T(!0),title:"Click to view game summary","data-gamepad-focusable":"true",tabIndex:"0",children:["Game #",i]})})]}),t.jsx("div",{className:$.headerCenter,children:t.jsxs("div",{className:`${$.gamePhase} ${"betting"===v?z?$.phaseBettingYourTurn:$.phaseBettingWaiting:$[`phase${v.charAt(0).toUpperCase()+v.slice(1)}`]}`,"data-phase":v,children:[t.jsx("span",{className:$.phaseIcon,children:F.icon}),t.jsx("span",{className:$.phaseText,children:F.text}),null!==y&&t.jsx("div",{className:$.timerBar,children:t.jsx("div",{className:$.timerProgress,style:{width:y/("dealing"===v?I.DEALING_DURATION:"betting"===v?I.BETTING_DURATION:"revealing"===v?I.REVEALING_DURATION:I.RESULTS_DURATION)*100+"%"}})})]})}),t.jsx("div",{className:$.headerRight,children:t.jsxs("div",{className:$.controlsStack,children:[t.jsx("div",{className:"panel-alt",style:{padding:"0.2rem 0.4rem",margin:"0 0 0.2rem 0",gap:"0.25rem"},children:t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem",fontSize:"0.85rem",fontWeight:600,color:"var(--text-primary)"},children:[t.jsx("span",{children:"Balance:"}),t.jsx(d,{amount:Number(N),size:"small"})]})}),t.jsxs("div",{className:$.controlsGroup,children:[t.jsx(m,{onModalStateChange:P,"data-gamepad-focusable":"true"}),t.jsx(u,{onModalStateChange:L,"data-gamepad-focusable":"true"}),t.jsx(_,{onModalStateChange:q,"data-gamepad-focusable":"true"}),t.jsx(h,{onClick:()=>A(!0),"data-gamepad-focusable":"true"}),t.jsx(x,{icon:t.jsx(O,{color:"white",size:20}),title:"Leave Game",onClick:s,variant:"danger",disabled:f,"data-gamepad-focusable":"true"})]})]})})]}),t.jsxs("div",{className:`panel ${$.mobileLayout}`,children:[t.jsxs("div",{className:$.mobileTopRow,children:[t.jsxs("div",{className:$.headerLeft,children:[t.jsxs("h1",{className:$.gameTitle,children:["In Between ",t.jsx("span",{className:$.liveTag,children:"LIVE"})]}),t.jsx("p",{className:$.gameIdText,children:t.jsxs("span",{className:$.gameIdLink,onClick:()=>T(!0),title:"Click to view game summary","data-gamepad-focusable":"true",tabIndex:"0",children:["Game #",i]})})]}),t.jsx("div",{className:$.mobileRight,children:t.jsxs("div",{className:$.mobileControlsStack,children:[t.jsx("div",{className:"panel-alt",style:{padding:"0.15rem 0.35rem",margin:"0 0 0.2rem 0",gap:"0.25rem"},children:t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem",fontSize:"0.85rem",fontWeight:600,color:"#ecf0f1"},children:[t.jsx("span",{children:"Balance:"}),t.jsx(d,{amount:Number(N),size:"small"})]})}),t.jsxs("div",{className:$.mobileActions,children:[t.jsx(m,{onModalStateChange:P,"data-gamepad-focusable":"true"}),t.jsx(u,{onModalStateChange:L,"data-gamepad-focusable":"true"}),t.jsx(_,{onModalStateChange:q,"data-gamepad-focusable":"true"}),t.jsx(h,{onClick:()=>A(!0),"data-gamepad-focusable":"true"}),t.jsx(x,{icon:t.jsx(O,{color:"white",size:20}),title:"Leave Game",onClick:s,variant:"danger",disabled:f,"data-gamepad-focusable":"true"})]})]})})]}),t.jsx("div",{className:$.mobileBottomRow,children:t.jsxs("div",{className:`${$.gamePhase} ${"betting"===v?z?$.phaseBettingYourTurn:$.phaseBettingWaiting:$[`phase${v.charAt(0).toUpperCase()+v.slice(1)}`]}`,"data-phase":v,children:[t.jsx("span",{className:$.phaseIcon,children:F.icon}),t.jsx("span",{className:$.phaseText,children:F.text}),null!==y&&t.jsx("div",{className:$.timerBar,children:t.jsx("div",{className:$.timerProgress,style:{width:y/("dealing"===v?I.DEALING_DURATION:"betting"===v?I.BETTING_DURATION:"revealing"===v?I.REVEALING_DURATION:I.RESULTS_DURATION)*100+"%"}})})]})})]}),w&&t.jsx(g,{onClose:()=>T(!1),gameData:r}),S&&t.jsx(p,{onClose:()=>A(!1)})]})},F={cardDisplayContainer:"_cardDisplayContainer_a7qnj_1",cardsRow:"_cardsRow_a7qnj_9",card:"_card_a7qnj_1",dealingPhase:"_dealingPhase_a7qnj_53",revealingPhase:"_revealingPhase_a7qnj_62",cardBack:"_cardBack_a7qnj_88",redCard:"_redCard_a7qnj_97",blackCard:"_blackCard_a7qnj_101",cardCorner:"_cardCorner_a7qnj_105",bottomRight:"_bottomRight_a7qnj_114",cardValue:"_cardValue_a7qnj_122",cardSuit:"_cardSuit_a7qnj_128",cardCenter:"_cardCenter_a7qnj_133",aceCard:"_aceCard_a7qnj_166",aceIndicator:"_aceIndicator_a7qnj_170",aceHigh:"_aceHigh_a7qnj_190",aceLow:"_aceLow_a7qnj_196",indicatorContent:"_indicatorContent_a7qnj_202"},z=({direction:e="up",color:a="currentColor",size:s=24})=>{const n="down"===e?"rotate(180deg)":"rotate(0deg)";return t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:a,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{transform:n,display:"inline-block",transformOrigin:"center"},children:t.jsx("path",{d:"M7 11l5-5 5 5M7 17l5-5 5 5"})})},G=()=>{const{gameState:e}=k();if(!e)return t.jsx("div",{className:F.loading,children:"Loading game state..."});const{firstCard:a,secondCard:s,thirdCard:n,phase:r,dealer:i}=e,l={2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10",J:"J",Q:"Q",K:"K",A:"A"},c={hearts:"♥",diamonds:"♦",clubs:"♣",spades:"♠","♥":"♥","♦":"♦","♣":"♣","♠":"♠"},o=(e,a)=>{if(!e)return t.jsx("div",{className:F.card,children:t.jsx("div",{className:F.cardBack})},`empty-${a}`);const s="♥"===(n=e.suit)||"♦"===n||"hearts"===n||"diamonds"===n;var n;const r="A"===e.value,i=e.isAceLow,o=1===a;return t.jsxs("div",{className:`${F.card} ${s?F.redCard:F.blackCard} ${r?F.aceCard:""}`,children:[r&&!o&&t.jsx("div",{className:`${F.aceIndicator} ${i?F.aceLow:F.aceHigh} ${s?F.redCard:F.blackCard}`,children:i?t.jsxs("span",{className:F.indicatorContent,children:["LOW ",t.jsx(z,{direction:"down",color:s?"#e74c3c":"#2c3e50",size:16})]}):t.jsxs("span",{className:F.indicatorContent,children:["HIGH ",t.jsx(z,{direction:"up",color:s?"#e74c3c":"#2c3e50",size:16})]})}),t.jsxs("div",{className:F.cardCorner,children:[t.jsx("div",{className:F.cardValue,children:l[e.value]}),t.jsx("div",{className:F.cardSuit,children:c[e.suit]})]}),t.jsx("div",{className:F.cardCenter,children:c[e.suit]}),t.jsxs("div",{className:`${F.cardCorner} ${F.bottomRight}`,children:[t.jsx("div",{className:F.cardValue,children:l[e.value]}),t.jsx("div",{className:F.cardSuit,children:c[e.suit]})]})]},`${e.value}-${e.suit}-${a}`)};return t.jsx("div",{className:F.cardDisplayContainer,children:t.jsx("div",{className:`${F.cardsRow} ${"dealing"===r?F.dealingPhase:""} ${"revealing"===r?F.revealingPhase:""}`,children:(()=>{let e=[null,null,null];return a||s||n?(a&&(e[0]={...a}),s&&(e[2]={...s}),n&&(e[1]={...n}),e.map(((e,a)=>o(e,a)))):e.map(((e,a)=>o(e,a)))})()})})},U="_bettingPanel_2vdkb_1",W="_betContainer_2vdkb_19",M="_betText_2vdkb_28",V="_extremeOptionsRow_2vdkb_45",H="_betButtons_2vdkb_60",J="_customBetContainer_2vdkb_78",Y="_customBetInput_2vdkb_90",K="_potButton_1wzdu_5",Q="_shimmerBorder_1wzdu_47",X="_buttonBackground_1wzdu_81",Z="_reflectionEffect_1wzdu_101",ee="_buttonContent_1wzdu_148",ae="_potText_1wzdu_164",se="_potAmount_1wzdu_185",te="_disabled_1wzdu_258",ne=({amount:e,disabled:a,onClick:s,...n})=>t.jsxs("button",{className:`${K} ${a?te:""}`,onClick:s,disabled:a,"aria-label":`Bet the pot: ${e} chips`,...n,children:[t.jsx("div",{className:Q}),t.jsx("div",{className:X}),t.jsx("div",{className:Z}),t.jsxs("div",{className:ee,children:[t.jsx("span",{className:ae,children:"POT"}),t.jsx("span",{className:se,children:t.jsx(d,{amount:e,background:"pill"})})]})]}),re=()=>{const{gameState:a,placeBet:s}=k(),{socket:n}=e(),[r,i]=l.useState("");if(!a)return null;const{players:c,currentPlayerId:o,pot:m,phase:u,firstCard:_,secondCard:h}=a;if("betting"!==u)return null;const x=n&&o===n.auth?.userId,g=n&&c&&n.auth?.userId?c[n.auth.userId]:null,p=Number(g?.balance||0),b=e=>{const a=e.target.value.replace(/[^0-9]/g,""),s=Math.min(m,p);a&&parseInt(a)>s?i(s.toString()):i(a)},N=()=>{if(r&&!isNaN(r)){const e=parseInt(r,10);e>=1&&e<=Math.min(m,p)&&(s(e),i(""))}},v=e=>{"Enter"===e.key&&N()};return x?t.jsx("div",{className:U,children:x?t.jsxs("div",{className:W,children:[t.jsxs("p",{className:M,children:["Place your bet (Min: ",t.jsx(d,{amount:1}),", Max: ",t.jsx(d,{amount:Math.min(m,p)}),")"]}),t.jsxs("div",{className:V,children:[t.jsx("button",{className:"btn btn-secondary",style:{flex:1},onClick:()=>s(0),"data-gamepad-focusable":"true",autoFocus:!0,children:"PASS"}),t.jsx(ne,{amount:m,onClick:()=>s(m),disabled:m>p,"data-gamepad-focusable":"true"})]}),t.jsxs("div",{className:H,children:[[1,2,5].map((e=>{const a=Math.min(m,p),n=e>a;return t.jsx("button",{className:"btn btn-tertiary",style:{minWidth:"40px",padding:"0.65rem 0.4rem",fontSize:"0.95rem"},onClick:()=>s(e),disabled:n,"data-gamepad-focusable":"true",children:t.jsx(d,{amount:e})},e)})),t.jsxs("div",{className:J,children:[t.jsx(j,{title:"Enter Bet Amount",type:"number",className:Y,placeholder:"Custom",value:r,onChange:b,onKeyPress:v}),t.jsx("button",{className:"btn btn-primary",style:{minWidth:"40px",padding:"0.65rem 0.4rem",fontSize:"0.95rem"},onClick:N,disabled:!r,"data-gamepad-focusable":"true",children:"Bet"})]})]})]}):null}):null},ie="_playersContainer_16b1x_1",le="_playersTitle_16b1x_23",ce="_playersList_16b1x_47",oe="_currentPlayerGlow_16b1x_57",de="_currentUser_16b1x_71",me="_playerInfo_16b1x_75",ue="_playerStatus_16b1x_83",_e="_disconnectedIndicator_16b1x_90",he="_playerBalanceContainer_16b1x_97",xe="_playerBalance_16b1x_97",ge="_balanceIncrease_16b1x_116",pe="_balanceDecrease_16b1x_120",je="_readyIndicator_16b1x_150",be="_ready_16b1x_150",Ne="_notReady_16b1x_161",ve="_sittingOut_16b1x_165",fe="_emptyPlayerList_16b1x_180",ye=()=>{const{gameState:a}=k(),{socket:s}=e(),r=l.useContext(n);if(l.useEffect((()=>{if(a?.players&&r){const e=Object.values(a.players).map((e=>e.userId)).filter(Boolean);e.length>0&&r.prefetchUsers(e)}}),[a?.players,r]),!a||!a.players)return t.jsx("div",{className:fe,children:t.jsx("p",{children:"Waiting for game data..."})});const{players:i,currentPlayerId:c,dealerId:o,gameTransactions:d=[]}=a,m=s?.auth?.userId,u=a.totals||{};return i&&0!==Object.keys(i).length?t.jsxs("div",{className:ie,children:[t.jsx("h3",{className:le,children:"Scoreboard"}),t.jsx("div",{className:ce,children:a.seats.filter((e=>null!==e&&i[e])).map((e=>{const a=i[e],s=e===c,n=a.userId===m,r=e===o;return a.disconnected,t.jsxs("div",{className:`\n                  ${s?"panel":"panel-alt"}\n                  ${s?oe:""}\n                  ${n?de:""}\n                `,style:{padding:"0.35rem 0.75rem",gap:"0.5rem",flexDirection:"row",fontSize:"0.9rem",alignItems:"center",justifyContent:"space-between"},children:[t.jsxs("div",{className:me,children:[t.jsx(b,{userId:a.userId,size:"small",showName:!0,namePosition:"right"}),t.jsxs("span",{className:ue,children:[r&&` ${f}`,a.disconnected&&t.jsx("span",{className:_e,title:"Player disconnected",children:"⚠️ Disconnected"})]})]}),t.jsxs("div",{className:he,children:[t.jsx(Ce,{balance:u[e]||0}),t.jsx("div",{className:`\n                    ${je} \n                    ${a.isSittingOut?ve:a.isReady?be:Ne}\n                  `,title:a.isSittingOut?"Sitting Out":a.isReady?"Ready":"Not Ready"})]})]},e)}))})]}):t.jsx("div",{className:fe,children:t.jsx("p",{children:"Waiting for players to join..."})})},Ce=({balance:e})=>{const[a,s]=l.useState(e),[n,r]=l.useState(""),i=l.useRef(null);return l.useEffect((()=>{if(e!==a){r(e>a?ge:pe),i.current&&clearTimeout(i.current),i.current=setTimeout((()=>{r("")}),1e3),s(e)}return()=>{i.current&&clearTimeout(i.current)}}),[e]),t.jsx("span",{className:`${xe} ${n}`,children:t.jsx(d,{amount:e})})},Ie="_potIconWrapper_58b18_2",we="_potIcon_58b18_2",ke="_potInfo_58b18_28",Te="_potLabel_58b18_34",Se="_potAmount_58b18_46",Ae="_potCounter_58b18_53",Be=()=>{const{gameState:e}=k();if(!e)return null;const{pot:a,round:s=1}=e;return t.jsxs("div",{className:"card",style:{width:"150px",padding:"0.75rem 1rem",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"0.5rem",border:"2px solid #f1c40f"},children:[t.jsx("div",{className:Ie,children:t.jsx("span",{className:we,children:v})}),t.jsxs("div",{className:ke,children:[t.jsxs("h3",{className:Te,children:["POT ",t.jsxs("span",{className:Ae,children:["(",s,")"]})]}),t.jsx("span",{className:Se,children:t.jsx(d,{amount:a,size:"medium"})})]})]})},Pe="_deckVisual_nb490_2",Re="_deckIcon_nb490_9",Le="_deckInfo_nb490_25",Ee="_deckLabel_nb490_31",$e="_deckCount_nb490_43",Oe="_deckCounter_nb490_50",De=()=>{const{gameState:e}=k();if(!e)return null;const{deckSize:a=0,deckCount:s=1}=e;return t.jsxs("div",{className:"card",style:{width:"150px",padding:"0.75rem 1rem",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"0.5rem",border:"2px solid var(--accent2)"},children:[t.jsx("div",{className:Pe,children:t.jsx("div",{className:Re,children:C})}),t.jsxs("div",{className:Le,children:[t.jsxs("h3",{className:Ee,children:["DECK ",t.jsxs("span",{className:Oe,children:["(",s,")"]})]}),t.jsx("span",{className:$e,children:a})]})]})},qe="_anteControlsWrapper_ypuxr_1",Fe="_controlsContainer_ypuxr_8",ze="_autoAnteContainer_ypuxr_25",Ge="_anteButton_ypuxr_32",Ue="_backOutButton_ypuxr_32",We="_shimmerBorder_ypuxr_106",Me="_anteIcon_ypuxr_224",Ve="_backOutIcon_ypuxr_224",He="_buttonInfo_ypuxr_243",Je="_buttonLabel_ypuxr_249",Ye="_buttonAmount_ypuxr_266",Ke="_notEnoughChipsText_ypuxr_281",Qe="_buttonContainerRow_ypuxr_293",Xe="_sitOutHalfWidth_ypuxr_303",Ze="_toggleLabel_8n6m6_2",ea="_toggleInput_8n6m6_9",aa="_toggleSlider_8n6m6_15",sa="_toggleText_8n6m6_64",ta="_loading_8n6m6_72",na=()=>{const{preferences:a,toggleAutoAnte:s,loading:n}=r(),{gameState:i,playerReady:l}=k(),{socket:c}=e();return n?t.jsx("div",{className:ta,children:"Loading preferences..."}):t.jsx("div",{className:"panel-alt",style:{padding:"0.5rem 0.75rem",gap:"0",marginTop:"5px",maxWidth:"fit-content"},children:t.jsxs("label",{className:Ze,children:[t.jsx("input",{type:"checkbox",checked:a.autoAnte,onChange:async()=>{const e=!a.autoAnte,t=await s();if(e&&t&&l){let e=null;if(c&&c.auth?.userId&&i?.players){const a=Object.keys(i.players);for(const s of a)if(i.players[s].userId===c.auth.userId){e=i.players[s];break}}const a=e?.isReady;a||l()}},className:ea,"data-gamepad-focusable":"true"}),t.jsx("span",{className:aa}),t.jsx("span",{className:sa,children:"Auto-Ante"})]})})},ra=()=>{const{gameState:s,playerReady:n,playerUnready:r}=k(),{socket:i}=e(),{user:l}=a();if(!s)return null;const{players:c,anteAmount:o,phase:m}=s;if("waiting"!==m)return null;let u=null;if(i&&i.auth?.userId&&c){const e=Object.keys(c);for(const a of e)if(c[a].userId===i.auth.userId){u=c[a];break}}else if(l&&c){const e=Object.keys(c);for(const a of e)if(c[a].userId===l.id){u=c[a];break}}const _=Number(u?.balance||0),h=u?.isReady,x=_>=o;return t.jsx("div",{className:qe,children:t.jsxs("div",{className:Fe,children:[t.jsx("div",{className:Qe,children:h?t.jsx("div",{className:Qe,children:t.jsxs("button",{className:Ue,onClick:()=>{"function"==typeof r&&r()},"aria-label":"Back out","data-gamepad-focusable":"true",children:[t.jsx("div",{className:We}),t.jsx("span",{className:Ve,children:"✕"}),t.jsx("div",{className:He,children:t.jsx("h3",{className:Je,children:"BACK OUT"})})]})}):t.jsxs("div",{className:Qe,children:[t.jsxs("button",{className:Ge,onClick:n,disabled:!x,"aria-label":"Ante up","data-gamepad-focusable":"true",autoFocus:!0,children:[t.jsx("div",{className:We}),t.jsx("span",{className:Me,children:y}),t.jsxs("div",{className:He,children:[t.jsx("h3",{className:Je,children:"ANTE"}),t.jsx("span",{className:Ye,children:t.jsx(d,{amount:o})})]})]}),t.jsxs("button",{className:`${Ue} ${Xe}`,onClick:()=>{i&&s&&l&&i.emit("sitOut",{gameId:s.id,userId:i.auth?.userId||l.id})},disabled:u?.isSittingOut,title:u?.isSittingOut?"You are currently sitting out":"Sit out next round","aria-label":"Sit Out","data-gamepad-focusable":"true",children:[t.jsx("div",{className:We}),t.jsx("div",{className:He,children:t.jsx("h3",{className:Je,children:"SIT OUT"})})]}),!x&&t.jsxs("p",{className:Ke,children:["Not enough coins (",t.jsx(d,{amount:o})," required)"]})]})}),t.jsx("div",{className:ze,children:t.jsx(na,{})})]})})},ia={resultContent:"_resultContent_8ie9r_4",resultText:"_resultText_8ie9r_12",winText:"_winText_8ie9r_19",tieText:"_tieText_8ie9r_24",loseText:"_loseText_8ie9r_35",winningsText:"_winningsText_8ie9r_40",countdownContainer:"_countdownContainer_8ie9r_47",countdownText:"_countdownText_8ie9r_52",countdownProgress:"_countdownProgress_8ie9r_59",countdownBar:"_countdownBar_8ie9r_67",penaltyWarning:"_penaltyWarning_8ie9r_80",tiePanel:"_tiePanel_8ie9r_90"},la=()=>{const{gameState:e}=k();if(!e.result)return null;const{result:a,players:s,resultCountdown:n}=e,r=s[a.playerId]?.name,i="tie"===a.outcome?`panel-alt ${ia.tiePanel}`:"panel-alt";return t.jsx("div",{className:i,style:{maxWidth:"500px",margin:"1rem auto",width:"90%",animation:"fadeIn 0.5s ease-out"},children:t.jsxs("div",{className:ia.resultContent,children:[(()=>{switch(a.outcome){case"win":return t.jsxs(t.Fragment,{children:[t.jsxs("h2",{className:`${ia.resultText} ${ia.winText}`,children:[r," WON!"]}),a.winnings>0&&t.jsxs("p",{className:ia.winningsText,children:["Winnings: ",t.jsx(d,{amount:a.winnings/2,size:"medium"})]})]});case"lose":return t.jsxs(t.Fragment,{children:[t.jsxs("h2",{className:`${ia.resultText} ${ia.loseText}`,children:[r," LOST!"]}),a.betAmount>0&&t.jsxs("p",{className:ia.winningsText,children:["Loss: ",t.jsx(d,{amount:a.betAmount,size:"medium"})]})]});case"tie":return(()=>{const e=a.betAmount*(a.isTripleAceTie?3:2);return t.jsxs(t.Fragment,{children:[t.jsx("div",{className:ia.penaltyWarning,children:t.jsx("div",{className:ia.cautionTape})}),t.jsxs("h2",{className:`${ia.resultText} ${ia.tieText}`,children:[r," ",a.isTripleAceTie?"3X":"2X"," PENALTY!"]}),a.betAmount>0&&t.jsxs("p",{className:ia.winningsText,children:["Penalty: ",t.jsx(d,{amount:e,size:"medium"})]})]})})();default:return null}})(),n&&t.jsxs("div",{className:ia.countdownContainer,children:[t.jsxs("p",{className:ia.countdownText,children:["Next hand in: ",n.countdownSeconds,"s"]}),t.jsx("div",{className:ia.countdownProgress,children:t.jsx("div",{className:ia.countdownBar,style:{width:n.countdownSeconds/5*100+"%"}})})]})]})})},ca="_aceChoicePanel_xp6de_1",oa="_aceChoiceText_xp6de_19",da="_waitingText_xp6de_28",ma="_countdown_xp6de_35",ua="_aceChoiceButtons_xp6de_41",_a="_buttonContent_xp6de_50",ha=()=>{const{socket:s}=e(),{gameState:n}=k(),{user:r}=a(),[i,c]=l.useState(15);l.useEffect((()=>{if(n?.waitingForAceDecision&&s?.auth?.userId===n.currentPlayerId){c(15);const e=setInterval((()=>{c((a=>a<=1?(clearInterval(e),0):a-1))}),1e3);return()=>clearInterval(e)}}),[n?.waitingForAceDecision,n?.currentPlayerId,s?.auth?.userId]);const o=e=>{s.emit("chooseAceValue",{isAceLow:e})},d=s?.auth?.userId===n.currentPlayerId,m=n.players[n.currentPlayerId]?.name||"Current player";return t.jsxs("div",{className:ca,children:[d?t.jsxs("div",{className:"panel-alt",style:{width:"100%",marginBottom:"0.5rem",alignItems:"center"},children:[t.jsxs("p",{className:oa,children:["You've been dealt an Ace! Choose whether it should be high or low.",t.jsxs("span",{className:ma,children:[" (",i,"s)"]})]}),t.jsxs("div",{className:ua,children:[t.jsx("button",{className:"btn btn-primary",onClick:()=>o(!0),"data-gamepad-focusable":"true",autoFocus:!0,children:t.jsxs("span",{className:_a,children:["ACE LOW ",t.jsx(z,{direction:"down",color:"white",size:20})]})}),t.jsx("button",{className:"btn btn-tertiary",onClick:()=>o(!1),"data-gamepad-focusable":"true",children:t.jsxs("span",{className:_a,children:["ACE HIGH ",t.jsx(z,{direction:"up",color:"white",size:20})]})})]})]}):null,d?null:t.jsx("div",{className:"panel-alt",style:{width:"100%",marginBottom:"0.5rem"},children:t.jsxs("p",{className:da,children:[m," is choosing whether their Ace is high or low..."]})})]})},xa="_secondChancePanel_1sg84_1",ga="_secondChanceText_1sg84_19",pa="_waitingText_1sg84_29",ja="_countdown_1sg84_36",ba="_secondChanceButtons_1sg84_43",Na="_currencyWrapper_1sg84_95",va=()=>{const{gameState:a}=k(),{socket:s}=e(),[n,r]=l.useState(!1),[i,c]=l.useState(null),[o,m]=l.useState(15);l.useEffect((()=>{if(a?.waitingForSecondChance&&s?.auth?.userId===a.currentPlayerId){m(15);const e=setInterval((()=>{m((a=>a<=1?(clearInterval(e),0):a-1))}),1e3);return()=>clearInterval(e)}}),[a?.waitingForSecondChance,a?.currentPlayerId,s?.auth?.userId]);const{players:u,currentPlayerId:_,anteAmount:h=1}=a,x=s&&_===s.auth?.userId,g=u[_],p=e=>{s&&(r(!0),c(e?"ante":"pass"),s.emit("secondChance",{anteAgain:e}))};return t.jsxs("div",{className:xa,children:[x?t.jsxs("div",{className:"panel-alt",style:{width:"100%",marginBottom:"0.5rem",alignItems:"center"},children:[t.jsxs("p",{className:ga,children:["Would you like to ante up again for a second chance?",t.jsxs("span",{className:ja,children:[" (",o,"s)"]})]}),t.jsxs("div",{className:ba,children:[t.jsx("button",{className:"btn btn-primary",onClick:()=>p(!0),"data-gamepad-focusable":"true",autoFocus:!0,children:n&&"ante"===i?"Processing...":t.jsxs(t.Fragment,{children:["Ante Up ",t.jsx("span",{className:Na,children:t.jsx(d,{amount:h,size:"small"})})]})}),t.jsx("button",{className:"btn btn-secondary",onClick:()=>p(!1),"data-gamepad-focusable":"true",children:n&&"pass"===i?"Processing...":"Pass"})]})]}):null,x?null:t.jsx("div",{className:"panel-alt",style:{width:"100%",marginBottom:"0.5rem"},children:t.jsxs("p",{className:pa,children:[g?.name," is deciding whether to take a second chance."]})})]})},fa="_gameLogContainer_16qz1_1",ya="_gameLogHeader_16qz1_16",Ca="_expandIcon_16qz1_30",Ia="_gameLogEntries_16qz1_54",wa="_logEntry_16qz1_64",ka="_logTime_16qz1_89",Ta="_logMessage_16qz1_96",Sa="_emptyLog_16qz1_101",Aa="_showMoreButton_16qz1_109",Ba=()=>{const{gameState:e}=k(),[a,s]=l.useState(!1),[n,r]=l.useState(10);if(!e||!e.gameLog)return null;const i=e.gameLog||[],c=a?[]:i.slice(0,n);return t.jsxs("div",{className:fa,children:[t.jsxs("h3",{className:ya,onClick:()=>{s(!a),a&&r(10)},children:["Game Log",t.jsx("span",{className:Ca,children:a?"▶":"▼"})]}),!a&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:Ia,children:0===i.length?t.jsx("div",{className:Sa,children:"No game events yet"}):c.map(((e,a)=>{return t.jsxs("div",{className:wa,children:[t.jsx("span",{className:ka,children:(s=e.timestamp,new Date(s).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"}))}),t.jsx("span",{className:Ta,children:e.message})]},a);var s}))}),i.length>n&&t.jsxs("div",{className:Aa,onClick:()=>{r((e=>e+10))},children:["Show ",Math.min(10,i.length-n)," more",i.length-n>10&&` (${i.length-n} remaining)`]})]})]})},Pa="_emojiReactions_1y1z5_1",Ra="_toggleButton_1y1z5_8",La="_emojiPanel_1y1z5_35",Ea="_emojiGrid_1y1z5_60",$a="_emojiButton_1y1z5_66",Oa=()=>{const[s,n]=l.useState(!1),{socket:r}=e(),{gameState:i}=k(),{user:c}=a();return t.jsxs("div",{className:Pa,children:[t.jsx("button",{className:Ra,onClick:()=>{n(!s)},"data-gamepad-focusable":"true","aria-label":"Toggle emoji reactions",children:"😊"}),s&&t.jsx("div",{className:La,children:t.jsx("div",{className:Ea,children:[{emoji:"🔥",name:"Fire",color:"#FF6B35"},{emoji:"😄",name:"Happy",color:"#FFD93D"},{emoji:"💩",name:"Poop",color:"#8B4513"},{emoji:"😎",name:"Cool",color:"#4A5568"},{emoji:"🤯",name:"Mind Blown",color:"#FFA500"},{emoji:"😈",name:"Devilish",color:"#9333EA"},{emoji:"😬",name:"Worried",color:"#FCD34D"},{emoji:"👏",name:"Applause",color:"#FBBF24"},{emoji:"😭",name:"Crying",color:"#3B82F6"},{emoji:"🤡",name:"Clown",color:"#EF4444"},{emoji:"💪",name:"Strong",color:"#F59E0B"},{emoji:"😅",name:"Nervous",color:"#60A5FA"},{emoji:"🎉",name:"Celebration",color:"#A855F7"},{emoji:"🤔",name:"Thinking",color:"#6B7280"},{emoji:"🙈",name:"See No Evil",color:"#A0522D"},{emoji:"😤",name:"Confident",color:"#DC2626"}].map(((e,a)=>t.jsx("button",{className:$a,onClick:()=>(e=>{r&&i&&c&&(r.emit("emojiReaction",{gameId:i.id,emoji:e.emoji,color:e.color,playerName:c.username}),n(!1))})(e),"data-gamepad-focusable":"true",title:e.name,style:{"--emoji-color":e.color},children:e.emoji},a)))})})]})},Da=({onReturnToLobby:s})=>{const[n,r]=l.useState(!1),{gameState:i,error:c,clearError:o}=k();N(!0),l.useEffect((()=>{if(c){const e=setTimeout((()=>{o()}),1e4);return()=>clearTimeout(e)}}),[c,o]);const{socket:d}=e(),{user:m}=a();if(!i)return t.jsx("div",{className:B,children:t.jsx("p",{children:"Loading game state..."})});const u=i.phase||"waiting",_=m?.id,h=i.players&&_?i.players[_]:null;return t.jsxs("div",{className:`screen ${S}`,children:[t.jsxs("div",{className:`${A} mobile-scale-content`,children:[t.jsx(q,{handleLeaveGame:()=>{s&&s()},onModalStateChange:r}),c&&t.jsx("div",{className:P,children:t.jsx("p",{className:R,children:c})}),t.jsxs("div",{className:L,children:[t.jsx(De,{}),t.jsx(Be,{})]}),t.jsx(G,{}),h?.isSittingOut?t.jsx("button",{onClick:()=>{d&&i.id&&d.emit("imBack",{gameId:i.id})},className:"btn btn-primary",style:{maxWidth:"300px"},"data-gamepad-focusable":"true",autoFocus:!0,children:"I'm Back!"}):"waiting"===u?t.jsx(ra,{}):"results"===u?t.jsx(la,{}):i.waitingForAceDecision?t.jsx(ha,{}):i.waitingForSecondChance?t.jsx(va,{}):"betting"===u?t.jsx(re,{}):null,t.jsxs("div",{className:E,children:[t.jsx(ye,{}),t.jsx(Ba,{})]})]}),!n&&t.jsx(Oa,{})]})},qa="_modalOverlay_jrbqi_1",Fa="_modalContent_jrbqi_14",za="_passwordInput_jrbqi_34",Ga="_modalActions_jrbqi_52",Ua="_modalButton_jrbqi_58",Wa="_cancelButton_jrbqi_69",Ma="_submitButton_jrbqi_78";function Va({isOpen:e,onClose:a,onSubmit:s,gameId:n}){const[r,i]=l.useState("");if(!e)return null;return t.jsx("div",{className:qa,children:t.jsxs("div",{className:Fa,children:[t.jsx("h2",{children:"Password Required"}),t.jsxs("p",{children:["Please enter the password for game ",t.jsx("strong",{children:n||""}),":"]}),t.jsxs("form",{onSubmit:e=>{e.preventDefault(),s(r),i("")},children:[t.jsx(j,{title:"Enter Game Password",type:"password",value:r,onChange:e=>i(e.target.value),className:za,autoFocus:!0,required:!0}),t.jsxs("div",{className:Ga,children:[t.jsx("button",{type:"button",onClick:()=>{i(""),a()},className:`${Ua} ${Wa}`,"data-gamepad-focusable":"true",children:"Cancel"}),t.jsx("button",{type:"submit",className:`${Ua} ${Ma}`,"data-gamepad-focusable":"true",children:"Join Game"})]})]})]})})}const Ha=()=>{const{gameId:a}=c(),n=o(),{socket:r,isConnected:d}=e(),[m,u]=l.useState(!0),[_,h]=l.useState(null),[x,g]=l.useState(!1),p=l.useRef(!1),j=l.useCallback((()=>{r&&d&&a&&(s.play("ui.leave"),r.emit("leaveGame",{gameId:a}),n("/"))}),[r,d,a,n]),b=l.useCallback((e=>{g(!1),r&&a&&e&&(h(null),r.emit("joinGame",{gameId:a,password:e}),u(!0))}),[r,a]),N=l.useCallback((()=>{g(!1),n("/")}),[n]);l.useEffect((()=>{h(null),g(!1),u(!0)}),[a]),l.useEffect((()=>{if(!r)return;const e=e=>{e&&e.game&&e.game.id===a&&(s.play("ui.join"),u(!1),h(null),g(!1))},t=e=>{const a=e.message||"An unknown error occurred";"Password required"===a?(g(!0),u(!1),h(null)):"Invalid password"===a?(h("Invalid password."),g(!0),u(!1)):"Game not found"===a?n("/"):"Game is full"===a?(h(a),u(!1),g(!1),setTimeout((()=>n("/")),3e3)):(h(a),u(!1),g(!1))};return r.on("gameJoined",e),r.on("error",t),()=>{r.off("gameJoined",e),r.off("error",t)}}),[r,a,n]),l.useEffect((()=>{r&&a&&!p.current&&(p.current=!0,u(!0),h(null),g(!1),r.emit("joinGame",{gameId:a}))}),[r,a]);const v=()=>{const{gameState:s}=k(),{socket:n}=e();return l.useEffect((()=>{const e=e=>{const a=n?.auth?.userId,t=a&&s?.players?s.players[a]:null;if(t?.isReady||!1)return e.preventDefault(),e.returnValue="You have money in the pot! Are you sure you want to leave?",e.returnValue};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}}),[s,n]),t.jsxs(t.Fragment,{children:[t.jsx(Va,{isOpen:x,onClose:N,onSubmit:b,gameId:a}),m&&t.jsx(i,{message:`Joining game ${a}...`}),_&&!m&&!x&&t.jsxs("div",{className:"error-container",style:{padding:"20px",color:"red",textAlign:"center"},children:[t.jsx("h2",{children:"An error occurred"}),t.jsx("p",{children:_}),t.jsx("button",{onClick:()=>window.location.reload(),children:"Refresh Page"})]}),!m&&!_&&s&&t.jsx(Da,{onReturnToLobby:j})]})};return t.jsx(T,{gameId:a,children:t.jsx(v,{})})};export{Ha as default};
