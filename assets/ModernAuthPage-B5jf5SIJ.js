const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./useGamepadNavigation-C3EA71Rv.js","./index-_xfNKmhx.js","./vendor-x77BqUlH.js","./audio-DijUiIHu.js","./socket-CA1CrNgP.js","./index-X5Ac-Wzm.css"])))=>i.map(i=>d[i]);
import{a1 as c,_ as W,a0 as v,c as z,t as G,X as V,U as e,a2 as R}from"./index-_xfNKmhx.js";import{u as T,r}from"./vendor-x77BqUlH.js";import{u as U}from"./useGamepadNavigation-C3EA71Rv.js";import{A as D}from"./AppHeader-BH5KBjjg.js";import{g as H}from"./version-DUDEi3OG.js";import"./audio-DijUiIHu.js";import"./socket-CA1CrNgP.js";const j=V.isNativePlatform(),l={async signInWithApple(){return(await c.signInWithApple()).user},async signInWithGoogle(){return(await c.signInWithGoogle()).user},async signInWithFacebook(){return(await c.signInWithFacebook()).user},async signInWithEmail(t,o){return(j?await c.signInWithEmailAndPassword({email:t,password:o}):await G(v,t,o)).user},async createAccountWithEmail(t,o){return(j?await c.createUserWithEmailAndPassword({email:t,password:o}):await z(v,t,o)).user},async getCurrentUser(){return(await c.getCurrentUser()).user},async signOut(){await c.signOut()},async sendPasswordResetEmail(t){if(j)await c.sendPasswordResetEmail({email:t});else{const{sendPasswordResetEmail:o}=await W(async()=>{const{sendPasswordResetEmail:a}=await import("./useGamepadNavigation-C3EA71Rv.js").then(d=>d.i);return{sendPasswordResetEmail:a}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url);await o(v,t,{url:window.location.origin+"/auth",handleCodeInApp:!1})}},getErrorMessage(t){return{"auth/invalid-email":"Invalid email address","auth/user-disabled":"This account has been disabled","auth/user-not-found":"No account found with this email","auth/wrong-password":"Incorrect password","auth/email-already-in-use":"An account with this email already exists","auth/weak-password":"Password should be at least 6 characters","auth/operation-not-allowed":"This sign-in method is not enabled","auth/popup-closed-by-user":"Sign-in cancelled","auth/cancelled-popup-request":"Sign-in cancelled","auth/popup-blocked":"Pop-up blocked. Please allow pop-ups and try again"}[t?.code]||t?.message||"An error occurred during authentication"}},$="_socialButton_1ecle_1",q="_disabled_1ecle_20",O="_icon_1ecle_35",X="_label_1ecle_42",J="_apple_1ecle_48",K="_google_1ecle_60",Q="_facebook_1ecle_72",Y="_spinner_1ecle_84",u={socialButton:$,disabled:q,icon:O,label:X,apple:J,google:K,facebook:Q,spinner:Y},y=({provider:t,onClick:o,disabled:a,loading:d})=>{const n=(()=>{switch(t){case"apple":return{icon:e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M17.05 20.28c-.98.95-2.05.8-3.08.35-1.09-.46-2.09-.48-3.24 0-1.44.62-2.2.44-3.06-.35C2.79 15.25 3.51 7.59 9.05 7.31c1.35.07 2.29.74 3.08.8 1.18-.24 2.31-.93 3.57-.84 1.51.12 2.65.72 3.4 1.8-3.12 1.87-2.38 5.98.48 7.13-.57 1.5-1.31 2.99-2.54 4.09l.01-.01zM12.03 7.25c-.15-2.23 1.66-4.07 3.74-4.25.29 2.58-2.34 4.5-3.74 4.25z"})}),label:"Sign in with Apple",className:u.apple};case"google":return{icon:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),e.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),label:"Continue with Google",className:u.google};case"facebook":return{icon:e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),label:"Continue with Facebook",className:u.facebook};default:return null}})();return n?e.jsx("button",{type:"button",className:`${u.socialButton} ${n.className} ${a?u.disabled:""}`,onClick:o,disabled:a||d,children:d?e.jsx("div",{className:u.spinner}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:u.icon,children:n.icon}),e.jsx("span",{className:u.label,children:n.label})]})}):null},Z="_authPage_asn8k_1",ee="_container_asn8k_31",se="_content_asn8k_43",te="_errorAlert_asn8k_61",ae="_socialButtons_asn8k_86",ne="_divider_asn8k_94",oe="_emailButton_asn8k_116",ie="_privacyNote_asn8k_150",re="_emailForm_asn8k_159",le="_inputGroup_asn8k_165",ce="_label_asn8k_171",ue="_input_asn8k_165",de="_submitButton_asn8k_200",he="_spinner_asn8k_231",me="_toggleMode_asn8k_244",pe="_backButton_asn8k_263",ge="_forgotPasswordLink_asn8k_287",_e="_forgotPasswordText_asn8k_306",fe="_successMessage_asn8k_315",xe="_migrationBanner_asn8k_349",ke="_migrationLink_asn8k_371",be="_footer_asn8k_387",we="_footerLinks_asn8k_399",ve="_footerLink_asn8k_399",je="_footerDivider_asn8k_415",ye="_footerVersion_asn8k_419",s={authPage:Z,container:ee,content:se,errorAlert:te,socialButtons:ae,divider:ne,emailButton:oe,privacyNote:ie,emailForm:re,inputGroup:le,label:ce,input:ue,submitButton:de,spinner:he,toggleMode:me,backButton:pe,forgotPasswordLink:ge,forgotPasswordText:_e,successMessage:fe,migrationBanner:xe,migrationLink:ke,footer:be,footerLinks:we,footerLink:ve,footerDivider:je,footerVersion:ye},Fe=()=>{const t=T(),{user:o}=R(),[a,d]=r.useState(null),[x,n]=r.useState(null),[P,N]=r.useState(!1),[p,E]=r.useState(!1),[h,k]=r.useState(""),[b,S]=r.useState(""),[m,_]=r.useState(!1),[A,f]=r.useState(!1),[F,C]=r.useState(!1),[B,M]=r.useState(null);U(!1),r.useEffect(()=>{H().then(M)},[]),r.useEffect(()=>{o&&t("/")},[o,t]);const w=async i=>{n(null),d(i);try{switch(i){case"apple":await l.signInWithApple();break;case"google":await l.signInWithGoogle();break;case"facebook":await l.signInWithFacebook();break;default:throw new Error("Unknown provider")}}catch(g){n(l.getErrorMessage(g))}finally{d(null)}},L=async i=>{i.preventDefault(),n(null),_(!0);try{p?await l.createAccountWithEmail(h,b):await l.signInWithEmail(h,b)}catch(g){n(l.getErrorMessage(g))}finally{_(!1)}},I=async i=>{i.preventDefault(),n(null),_(!0);try{if(!h){n("Please enter your email address");return}await l.sendPasswordResetEmail(h),C(!0)}catch(g){n(l.getErrorMessage(g))}finally{_(!1)}};return e.jsxs("div",{className:`screen app-gradient-bg ${s.authPage}`,children:[e.jsx(D,{}),e.jsxs("div",{className:s.container,children:[e.jsxs("div",{className:s.migrationBanner,children:[e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"})}),e.jsxs("span",{children:["Have an existing account?"," ",e.jsx("button",{type:"button",className:s.migrationLink,onClick:()=>t("/migrate"),children:"Migrate your account"})]})]}),e.jsxs("div",{className:s.content,children:[x&&e.jsxs("div",{className:s.errorAlert,children:[e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"})}),e.jsx("span",{children:x})]}),P?A?e.jsx(e.Fragment,{children:F?e.jsxs("div",{className:s.successMessage,children:[e.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),e.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),e.jsx("h3",{children:"Check your email"}),e.jsxs("p",{children:["We've sent a password reset link to ",e.jsx("strong",{children:h})]}),e.jsx("button",{type:"button",className:s.backButton,onClick:()=>{f(!1),C(!1),k("")},children:"← Back to sign in"})]}):e.jsxs("form",{onSubmit:I,className:s.emailForm,children:[e.jsx("p",{className:s.forgotPasswordText,children:"Enter your email address and we'll send you a link to reset your password."}),e.jsxs("div",{className:s.inputGroup,children:[e.jsx("label",{htmlFor:"reset-email",className:s.label,children:"Email"}),e.jsx("input",{id:"reset-email",type:"email",value:h,onChange:i=>k(i.target.value),className:s.input,placeholder:"your@email.com",required:!0,autoComplete:"email",autoFocus:!0})]}),e.jsx("button",{type:"submit",className:s.submitButton,disabled:m,children:m?e.jsx("div",{className:s.spinner}):"Send reset link"}),e.jsx("button",{type:"button",className:s.backButton,onClick:()=>{f(!1),n(null)},disabled:m,children:"← Back to sign in"})]})}):e.jsx(e.Fragment,{children:e.jsxs("form",{onSubmit:L,className:s.emailForm,children:[e.jsxs("div",{className:s.inputGroup,children:[e.jsx("label",{htmlFor:"email",className:s.label,children:"Email"}),e.jsx("input",{id:"email",name:"username",type:"email",value:h,onChange:i=>k(i.target.value),className:s.input,placeholder:"your@email.com",required:!0,autoComplete:"username",autoFocus:!0})]}),e.jsxs("div",{className:s.inputGroup,children:[e.jsx("label",{htmlFor:"password",className:s.label,children:"Password"}),e.jsx("input",{id:"password",name:"password",type:"password",value:b,onChange:i=>S(i.target.value),className:s.input,placeholder:"••••••••",required:!0,autoComplete:p?"new-password":"current-password",minLength:"6"}),!p&&e.jsx("button",{type:"button",className:s.forgotPasswordLink,onClick:()=>f(!0),children:"Forgot password?"})]}),e.jsx("button",{type:"submit",className:s.submitButton,disabled:m,children:m?e.jsx("div",{className:s.spinner}):p?"Create Account":"Sign In"}),e.jsx("button",{type:"button",className:s.toggleMode,onClick:()=>E(!p),disabled:m,children:p?"Already have an account? Sign in":"Need an account? Sign up"}),e.jsx("button",{type:"button",className:s.backButton,onClick:()=>{N(!1),f(!1),n(null)},disabled:m,children:"← Back to all sign-in options"})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:s.socialButtons,children:[e.jsx(y,{provider:"apple",onClick:()=>w("apple"),disabled:a!==null,loading:a==="apple"}),e.jsx(y,{provider:"google",onClick:()=>w("google"),disabled:a!==null,loading:a==="google"}),e.jsx(y,{provider:"facebook",onClick:()=>w("facebook"),disabled:a!==null,loading:a==="facebook"})]}),e.jsx("p",{className:s.privacyNote,children:"We only access your email address"}),e.jsx("div",{className:s.divider,children:e.jsx("span",{children:"or"})}),e.jsxs("button",{type:"button",className:s.emailButton,onClick:()=>N(!0),disabled:a!==null,children:[e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("rect",{x:"3",y:"5",width:"18",height:"14",rx:"2"}),e.jsx("path",{d:"M3 7l9 6 9-6"})]}),e.jsx("span",{children:"Continue with Email"})]})]})]}),e.jsxs("div",{className:s.footer,children:[e.jsxs("div",{className:s.footerLinks,children:[e.jsx("a",{href:"/terms",target:"_blank",rel:"noopener noreferrer",className:s.footerLink,children:"Terms of Service"}),e.jsx("span",{className:s.footerDivider,children:"•"}),e.jsx("a",{href:"/privacy",target:"_blank",rel:"noopener noreferrer",className:s.footerLink,children:"Privacy Policy"})]}),B&&e.jsx("div",{className:s.footerVersion,children:B.display})]})]})]})};export{Fe as default};
