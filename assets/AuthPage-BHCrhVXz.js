import{U as e,V as d,q as g,X as h}from"./index-DCTCU-m8.js";import{u as p,r as f}from"./vendor-KCSzRvRf.js";import{u as w}from"./useGamepadNavigation-Vd4_Qxse.js";import"./socket-CA1CrNgP.js";import"./audio-Bhw8yDMU.js";const y="_authPage_11yqn_1",v="_formContainer_11yqn_21",s={authPage:y,formContainer:v},k=()=>{const a=p();w(!1);const[o,n]=f.useState(null),u=async(i,c,m)=>{if(!i||!c||!m)throw new Error("Username, password, and email are required");n(null);try{const r=await fetch(`${d}/auth/migrate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:i,password:c,email:m})});let t;try{t=await r.json()}catch(l){throw console.error("[Client] Error parsing response:",l),new Error("Invalid response from server")}if(!r.ok)throw new Error(t.message||"Migration failed");if(!t.customToken)throw console.error("[Client] Invalid response format: missing customToken"),new Error("Invalid server response format");await g(h,t.customToken),n("Account migrated successfully! Redirecting..."),setTimeout(()=>{a("/")},1500)}catch(r){throw console.error("[Client] Migration error:",{message:r.message}),r}};return e.jsxs("div",{className:`screen ${s.authPage}`,children:[e.jsx(AppHeader,{}),e.jsxs("div",{className:s.formContainer,children:[o&&e.jsx("div",{className:s.successAlert,children:o}),e.jsx(AuthForm,{mode:"migrate",requireEmail:!0,onSubmit:u,description:"Enter your existing username and password, plus an email address to migrate your legacy account."}),e.jsx("div",{className:s.toggleContainer,children:e.jsx("button",{className:s.toggleButton,onClick:()=>a("/auth"),"data-gamepad-focusable":"true",children:"Back to Login"})})]})]})};export{k as default};
